?IS10744 ArcBase DSSSL
(STYLE-SHEET
AID TOKEN DOCBOOK
AUSE TOKEN AF BG BS CA CS DA DE EL EN ES ET EU FI FR HU ID IT JA KO NL NN NO PL PT PTBR RO RU SK SL SR SV TR UK XH ZHCN ZHTW DBPARAM DBLIB
(STYLE-SPECIFICATION
ACONTENT IMPLIED
(STYLE-SPECIFICATION-BODY
-\n;; $Id: docbook.dsl,v 1.10 2004/10/09 21:36:35 petere78 Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n(define if-front-page\n  (external-procedure "UNREGISTERED::James Clark//Procedure::if-front-page"))\n\n(define if-first-page\n  (external-procedure "UNREGISTERED::James Clark//Procedure::if-first-page"))\n\n(declare-characteristic heading-level \n   "UNREGISTERED::James Clark//Characteristic::heading-level" 0)\n\n(declare-characteristic page-number-format\n   "UNREGISTERED::James Clark//Characteristic::page-number-format" "1")\n\n(declare-characteristic page-number-restart?\n   "UNREGISTERED::James Clark//Characteristic::page-number-restart?" #f)\n\n(declare-characteristic page-two-side?\n   "UNREGISTERED::OpenJade//Characteristic::page-two-side?" %two-side%)\n\n(declare-characteristic two-side-start-on-right?\n   "UNREGISTERED::OpenJade//Characteristic::two-side-start-on-right?" %two-side%)\n\n(declare-characteristic page-n-columns\n   "UNREGISTERED::James Clark//Characteristic::page-n-columns" 1)\n\n(declare-characteristic page-column-sep\n   "UNREGISTERED::James Clark//Characteristic::page-column-sep" %page-column-sep%)\n\n(declare-characteristic page-balance-columns?\n   "UNREGISTERED::James Clark//Characteristic::page-balance-columns?" %page-balance-columns?%)\n\n;; This allows bottom-of-page footnotes\n(declare-flow-object-class page-footnote\n      "UNREGISTERED::Sebastian Rahtz//Flow Object Class::page-footnote")\n\n;; This allows formal objects to float\n(declare-flow-object-class page-float\n      "UNREGISTERED::Sebastian Rahtz//Flow Object Class::page-float")\n\n(define read-entity\n  (external-procedure "UNREGISTERED::James Clark//Procedure::read-entity"))\n\n(define all-element-number\n  (external-procedure "UNREGISTERED::James Clark//Procedure::all-element-number"))\n\n(define debug\n  (external-procedure "UNREGISTERED::James Clark//Procedure::debug"))\n\n;; Make text that comes from unimplemented tags easy to spot\n(default\n  (let* ((colr-space (color-space \n\011\011      "ISO/IEC 10179:1996//Color-Space Family::Device RGB"))\n\011 (red (color colr-space 1 0 0)))\n    (make sequence\n      color: red\n      (process-children))))\n\n;; $Id: dbcommon.dsl,v 1.14 2004/10/10 21:15:05 petere78 Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://nwalsh.com/docbook/dsssl/\n;;\n;; This file contains general functions common to both print and HTML\n;; versions of the DocBook stylesheets.\n;;\n\n;; If **ANY** change is made to this file, you _MUST_ alter the\n;; following definition:\n\n(define %docbook-common-version%\n  "Modular DocBook Stylesheet Common Functions")\n\n;; === element lists ====================================================\n\n;; these have to be functions because they have to be evaluated when\n;; there is a current-node so that normalize can know what declaration\n;; is in effect\n\n(define (set-element-list)\n  (list (normalize "set")))\n\n(define (book-element-list)\n  (list (normalize "book")))\n\n(define (division-element-list)\n  (list (normalize "part")))\n\n(define (component-element-list)\n  (list (normalize "preface")\n\011(normalize "chapter")\n\011(normalize "appendix") \n\011(normalize "article")\n\011(normalize "glossary")\n\011(normalize "bibliography")\n\011(normalize "index")\n\011(normalize "colophon")\n\011(normalize "setindex")\n\011(normalize "reference")\n\011(normalize "refentry")\n\011(normalize "book"))) ;; just in case nothing else matches...\n\n(define (major-component-element-list)\n  (list (normalize "preface")\n\011(normalize "chapter") \n\011(normalize "appendix") \n\011(normalize "article")\n\011(normalize "glossary")\n\011(normalize "bibliography")\n\011(normalize "index")\n\011(normalize "colophon")\n\011(normalize "setindex")\n\011(normalize "reference")\n\011(normalize "refentry")\n\011(normalize "part")\n\011(normalize "book"))) ;; just in case nothing else matches...\n\n(define (section-element-list)\n  (list (normalize "sect1")\n\011(normalize "sect2")\n\011(normalize "sect3") \n\011(normalize "sect4")\n\011(normalize "sect5")\n\011(normalize "section")\n\011(normalize "simplesect")\n\011(normalize "refsect1") \n\011(normalize "refsect2") \n\011(normalize "refsect3")))\n\n(define (block-element-list)\n  (list (normalize "example") \n\011(normalize "figure") \n\011(normalize "table") \n\011(normalize "equation") \n\011(normalize "procedure")))\n\n(define (outer-parent-list)\n  (list (normalize "toc") \n\011(normalize "lot") \n\011(normalize "appendix") \n\011(normalize "chapter") \n\011(normalize "part") \n\011(normalize "preface") \n\011(normalize "reference")\n\011(normalize "bibliography") \n\011(normalize "glossary") \n\011(normalize "index") \n\011(normalize "setindex")\n\011(normalize "sect1") \n\011(normalize "sect2") \n\011(normalize "sect3") \n\011(normalize "sect4") \n\011(normalize "sect5") \n\011(normalize "simplesect")\n\011(normalize "partintro") \n\011(normalize "bibliodiv") \n\011(normalize "glossdiv") \n\011(normalize "indexdiv")\n\011(normalize "refentry") \n\011(normalize "refsect1") \n\011(normalize "refsect2") \n\011(normalize "refsect3")\n\011(normalize "msgtext") \n\011(normalize "msgexplan")))\n\n(define (list-element-list)\n  (list (normalize "orderedlist") \n\011(normalize "itemizedlist") \n\011(normalize "variablelist") \n\011(normalize "segmentedlist")\n        (normalize "simplelist") \n\011(normalize "calloutlist") \n\011(normalize "step")))\n\n(define (info-element-list)\n  (list (normalize "appendixinfo")\n\011(normalize "articleinfo")\n\011(normalize "bibliographyinfo")\n\011(normalize "bookinfo")\n\011(normalize "chapterinfo")\n\011(normalize "glossaryinfo")\n\011(normalize "indexinfo")\n\011(normalize "objectinfo")\n\011(normalize "partinfo")\n\011(normalize "prefaceinfo")\n\011(normalize "refentryinfo")\n\011(normalize "referenceinfo")\n\011(normalize "refsect1info")\n\011(normalize "refsect2info")\n\011(normalize "refsect3info")\n\011(normalize "refsynopsisdivinfo")\n\011(normalize "sect1info")\n\011(normalize "sect2info")\n\011(normalize "sect3info")\n\011(normalize "sect4info")\n\011(normalize "sect5info")\n\011(normalize "sectioninfo")\n\011(normalize "setindexinfo")\n\011(normalize "setinfo")\n\011(normalize "sidebarinfo")\n\011;; historical\n\011(normalize "artheader")\n\011(normalize "docinfo")))\n\n;; === automatic TOC ====================================================\n\n;; Returns #t if nd should appear in the auto TOC\n(define (appears-in-auto-toc? nd)\n  (if (or (equal? (gi nd) (normalize "refsect1"))\n\011  (have-ancestor? (normalize "refsect1") nd))\n      #f\n      #t))\n\n;; # return elements of nl for which appears-in-auto-toc? is #t\n(define (toc-list-filter nodelist)\n  (let loop ((toclist (empty-node-list)) (nl nodelist))\n    (if (node-list-empty? nl)\n\011toclist\n\011(if (appears-in-auto-toc? (node-list-first nl))\n\011    (loop (node-list toclist (node-list-first nl))\n\011\011  (node-list-rest nl))\n\011    (loop toclist (node-list-rest nl))))))\n  \n;; === common ===========================================================\n\n(define (INLIST?)\n  (has-ancestor-member? (current-node) (list-element-list)))\n\n(define (INBLOCK?)\n  (has-ancestor-member? (current-node) \n\011\011\011(list (normalize "example") \n\011\011\011      (normalize "informalexample")\n\011\011\011      (normalize "figure") \n\011\011\011      (normalize "informalfigure")\n\011\011\011      (normalize "equation")\n\011\011\011      (normalize "informalequation")\n\011\011\011      (normalize "funcsynopsis")\n\011\011\011      (normalize "programlistingco")\n\011\011\011      (normalize "screenco")\n\011\011\011      (normalize "graphicco"))))\n\n(define (PARNUM)\n  (child-number (parent (current-node))))\n\n(define (NESTEDFNUM n fmt)\n  (if (number? n)\n      (format-number n fmt)\n      #f))\n\n(define (FNUM n) (NESTEDFNUM n "1"))\n\n(define (book-start?)\n  ;; Returns #t if the current-node is in the first division or \n  ;; component of a book.\n  (let ((book (ancestor (normalize "book")))\n\011(nd   (ancestor-member \n\011       (current-node) \n\011       (append (component-element-list) (division-element-list)))))\n    (let loop ((ch (children book)))\n      (if (node-list-empty? ch)\n\011  #f\n\011  (if (member (gi (node-list-first ch)) \n\011\011      (append (component-element-list) (division-element-list)))\n\011      (node-list=? (node-list-first ch) nd)\n\011      (loop (node-list-rest ch)))))))\n\n(define (first-chapter?)\n  ;; Returns #t if the current-node is in the first chapter of a book\n  (let* ((book (ancestor (normalize "book")))\n\011 (nd   (ancestor-member \n\011\011(current-node) \n\011\011(append (component-element-list) (division-element-list))))\n\011 (bookch (children book))\n\011 (bookcomp (expand-children bookch (list (normalize "part")))))\n    (let loop ((nl bookcomp))\n      (if (node-list-empty? nl)\n\011  #f\n\011  (if (equal? (gi (node-list-first nl)) (normalize "chapter"))\n\011      (if (node-list=? (node-list-first nl) nd)\n\011\011  #t\n\011\011  #f)\n\011      (loop (node-list-rest nl)))))))\n\n;; === bibliographic ====================================================\n\n;; Localized author-string\n\n(define (author-list-string #!optional (author (current-node)))\n  ;; Return a formatted string representation of the contents of AUTHOR\n  ;; *including appropriate punctuation* if the AUTHOR occurs in a list\n  ;; of AUTHORs in an AUTHORGROUP:\n  ;;\n  ;;   John Doe\n  ;; or\n  ;;   John Doe and Jane Doe\n  ;; or\n  ;;   John Doe, Jane Doe, and A. Nonymous\n  ;;\n\n  (let* ((author-node-list (select-elements\n\011\011\011    (descendants \n\011\011\011     (ancestor (normalize "authorgroup") author))\n\011\011\011    (normalize "author")))\n\011 (corpauthor-node-list (select-elements\n\011\011\011\011(descendants \n\011\011\011\011 (ancestor (normalize "authorgroup") author))\n\011\011\011\011(normalize "corpauthor")))\n\011 (othercredit-node-list (select-elements\n\011\011\011\011 (descendants \n\011\011\011\011  (ancestor (normalize "authorgroup") author))\n\011\011\011\011 (normalize "othercredit")))\n\011 (editor-node-list (select-elements\n\011\011\011    (descendants \n\011\011\011     (ancestor (normalize "authorgroup")))\n\011\011\011    (normalize "editor")))\n\011 (author-count (if (have-ancestor? (normalize "authorgroup") author)\n\011\011\011   (+ (node-list-length author-node-list)\n\011\011\011      (node-list-length corpauthor-node-list)\n\011\011\011      (node-list-length othercredit-node-list)\n\011\011\011      (node-list-length editor-node-list))\n\011\011\011   1))\n\011 (this-count (if (have-ancestor? (normalize "authorgroup") author)\n\011\011\011 (+ (node-list-length (preced author)) 1)\n\011\011\011 1)))\n    (string-append\n     (if (and (> author-count 1)\n\011      (absolute-last-sibling? author))\n\011 (string-append (gentext-and) " ")\n\011 "")\n\n     (author-string author)\n\n     (if (> author-count 2)\n\011 (if (> (- author-count this-count) 1)\n\011     (gentext-listcomma)\n\011     (if (= (- author-count this-count) 1)\n\011\011 (gentext-lastlistcomma)\n\011\011 ""))\n\011 "")\n     (if (and (> author-count 1)\n\011      (not (absolute-last-sibling? author)))\n\011 " "\n\011 ""))))\n\n;; === procedures =======================================================\n\n(define ($proc-hierarch-number-format$ depth)\n  (case (modulo depth 5)\n    ((1) "1")\n    ((2) "a")\n    ((3) "i")\n    ((4) "A")\n    (else "I")))\n\n(define ($proc-hierarch-number$ nd seperator)\n  (if (equal? (gi nd) (normalize "step"))\n      (string-append\n       (format-number\n\011(child-number nd) \n\011($proc-hierarch-number-format$ ($proc-step-depth$ nd)))\n       seperator)\n      ""))\n\n(define ($proc-step-depth$ nd)\n  (let loop ((step nd) (depth 0))\n    (if (equal? (gi step) (normalize "procedure"))\n\011depth\n\011(loop (parent step) \n\011      (if (equal? (gi step) (normalize "step"))\n\011\011  (+ depth 1)\n\011\011  depth)))))\n\n(define ($proc-step-number$ nd)\n  (let* ((step (if (equal? (gi nd) (normalize "step")) nd (parent nd)))\n\011 (str ($proc-hierarch-number$ step "")))\n    (string-append str (gentext-label-title-sep (normalize "step")))))\n\n(define ($proc-step-xref-number$ nd)\n  (let loop ((step nd) (str "") (first #t))\n    (if (equal? (gi step) (normalize "procedure"))\n\011str\n\011(loop (parent step) \n\011      (if (equal? (gi step) (normalize "step"))\n\011\011  (string-append \n\011\011   ($proc-hierarch-number$ step\n\011\011\011\011      (if first\n\011\011\011\011\011  ""\n\011\011\011\011\011  (gentext-intra-label-sep (normalize "step"))))\n\011\011   str)\n\011\011  str)\n\011      (if (equal? (gi step) (normalize "step"))\n\011\011  #f\n\011\011  first)))))\n\n;; === sections =========================================================\n\n(define (section-level-by-gi chunked? gi)\n  ;; Figure out the heading level of an element by its name.  We need\n  ;; to distinguish between the chunked processing mode (for HTML) and\n  ;; the non-chunked (print or HTML).  It is important that no heading\n  ;; level is skipped in a document structure (e.g., sect1 = 2, sect2\n  ;; = 4); this results in broken PDF bookmarks.\n  (if chunked?\n      (cond\n       ((equal? gi (normalize "sect5")) 5)\n       ((equal? gi (normalize "sect4")) 4)\n       ((equal? gi (normalize "sect3")) 3)\n       ((equal? gi (normalize "sect2")) 2)\n       ((equal? gi (normalize "sect1")) 1)\n       ((equal? gi (normalize "refsect3")) 4)\n       ((equal? gi (normalize "refsect2")) 3)\n       ((equal? gi (normalize "refsect1")) 2)\n       ((equal? gi (normalize "refsynopsisdiv")) 2)\n       ((equal? gi (normalize "bibliography")) 1)\n       ((equal? gi (normalize "bibliodiv")) 2)\n       ((equal? gi (normalize "index")) 1)\n       ((equal? gi (normalize "setindex")) 1)\n       ((equal? gi (normalize "indexdiv")) 2)\n       (else 1))\n      (cond\n       ((equal? gi (normalize "sect5")) 6)\n       ((equal? gi (normalize "sect4")) 5)\n       ((equal? gi (normalize "sect3")) 4)\n       ((equal? gi (normalize "sect2")) 3)\n       ((equal? gi (normalize "sect1")) 2)\n       ;; The next four are not used by the HTML stylesheets.\n       ((equal? gi (normalize "refsect3")) 5)\n       ((equal? gi (normalize "refsect2")) 4)\n       ((equal? gi (normalize "refsect1")) 3)\n       ((equal? gi (normalize "refsynopsisdiv")) 3)\n       ((equal? gi (normalize "bibliography")) 1)\n       ((equal? gi (normalize "bibliodiv")) 2)\n       ((equal? gi (normalize "index")) 1)\n       ((equal? gi (normalize "setindex")) 1)\n       ((equal? gi (normalize "indexdiv")) 2)\n       (else 1))))\n\n(define (section-level-by-node chunked? sect)\n  (if (equal? (gi sect) (normalize "section"))\n      ;; Section is special, it is recursive.\n      (let ((depth (length (hierarchical-number-recursive \n\011\011\011    (normalize "section")))))\n\011(if (> depth 5)\n\011    6\n\011    (if chunked? (+ depth 1) (+ depth 2))))\n      (if (equal? (gi sect) (normalize "simplesect"))\n\011  ;; SimpleSect is special, it should be level "n+1", where "n" is\n\011  ;; the level of the numbered section that contains it.  If it is\n\011  ;; the *first* sectioning element in a chapter, make it \n\011  ;; %default-simplesect-level%\n          (cond\n           ((have-ancestor? (normalize "sect5"))\n\011    (+ 1 (section-level-by-gi chunked? (normalize "sect5"))))\n           ((have-ancestor? (normalize "sect4"))\n\011    (+ 1 (section-level-by-gi chunked? (normalize "sect4"))))\n           ((have-ancestor? (normalize "sect3"))\n\011    (+ 1 (section-level-by-gi chunked? (normalize "sect3"))))\n           ((have-ancestor? (normalize "sect2"))\n\011    (+ 1 (section-level-by-gi chunked? (normalize "sect2"))))\n           ((have-ancestor? (normalize "sect1"))\n\011    (+ 1 (section-level-by-gi chunked? (normalize "sect1"))))\n           ((have-ancestor? (normalize "refsect3"))\n\011    (+ 1 (section-level-by-gi chunked? (normalize "refsect3"))))\n           ((have-ancestor? (normalize "refsect2"))\n\011    (+ 1 (section-level-by-gi chunked? (normalize "refsect2"))))\n           ((have-ancestor? (normalize "refsect1"))\n\011    (+ 1 (section-level-by-gi chunked? (normalize "refsect1"))))\n           (else %default-simplesect-level%))\n\011  ;; the rest of the section elements can be identified by name\n\011  (section-level-by-gi chunked? (gi sect)))))\n  \n;; === synopsis =========================================================\n\n;; The following definitions match those given in the reference\n;; documentation for DocBook V3.0\n(define\011%arg-choice-opt-open-str% "[")\n(define\011%arg-choice-opt-close-str% "]")\n(define\011%arg-choice-req-open-str% "{")\n(define\011%arg-choice-req-close-str% "}")\n(define\011%arg-choice-plain-open-str% " ")\n(define\011%arg-choice-plain-close-str% " ")\n(define\011%arg-choice-def-open-str% "[")\n(define\011%arg-choice-def-close-str% "]")\n(define\011%arg-rep-repeat-str% "...")\n(define\011%arg-rep-norepeat-str% "")\n(define\011%arg-rep-def-str% "")\n(define %arg-or-sep% " | ")\n(define %cmdsynopsis-hanging-indent% 4pi)\n\n;; === linking ==========================================================\n\n;; From the DocBook V3.0 Reference entry for element XREF:\n;;\n;; Description\n;;\n;;   Cross reference link to another part of the document. XRef is empty,\n;;   and has common, Linkend, and Endterm attributes.\n;;\n;;   Processing Expectations\n;;\n;;   XRef must have a Linkend, but the Endterm is optional. If it is used,\n;;   the content of the element it points to is displayed as the text of\n;;   the cross reference; if it is absent, the XRefLabel of the\n;;   cross-referenced object is displayed.\n;;\n;; If neither the ENDTERM nor the XREFLABEL is present, then the cross\n;; reference text is taken from the (gentext-xref-strings) function\n;; in the localization file, like this\n;; \n;; A cross reference to an element, the target, begins with the\n;; text returned by (gentext-xref-strings (gi target)).  Within\n;; that text, the following substitutions are made:\n;; \n;; %p is replaced by the number of the page on which target occurs\n;; %g is replaced by the (gentext-element-name)\n;; %n is replaced by the label\n;; %t is replaced by the title\n;;\n;; After the "direct" cross reference, a number of indirect references\n;; are possible.  If the target element is in a different block, section,\n;; component, division, or book an indirect cross reference may be made.\n;;\n;; The indirect cross reference will only be made if\n;;\n;;   (auto-xref-indirect? target ancestor) \n;;\n;; returns #t. The indirect reference is created by appending the\n;; connect returned by (auto-xref-indirect-connector) to the direct\n;; reference and then adding a direct refernce to the ancestor.\n;; The process is repeated for each ancestral element.\n;;\n;; For example, if a direct reference to a section returns\n;;\n;;    "the section called %t"\n;;\n;; and a direct reference to a chapter returns \n;;\n;;    "Chapter %n"\n;;\n;; and (auto-xref-indirect? sect1 chapter) returns #t, and \n;; (auto-xref-indirect-connector chapter) returns "in", then\n;; an xref to a section in another chapter will be:\n;;\n;;    "the section called %t in Chapter %n"\n;;\n;; Where %t and %n will be filled in accordingly.\n;;\n;; ======================================================================\n\n(define (auto-xref-indirect? target ancestor)\n  ;; This function answers the question: should an indirect reference\n  ;; to ancestor be made for target?  For example:\n  ;;\n  ;; (auto-xref-indirect? SECT1 CHAP)\n  ;;\n  ;; should return #t iff a reference of the form "in [CHAP-xref]" should\n  ;; be generated for a reference to SECT1 if SECT1 is in a different\n  ;; chapter than the XREF to SECT1.\n  ;;\n  ;; This function _does not_ have to consider the case of whether or\n  ;; not target and the xref are in the same ancestor.  \n  ;;\n  (cond\n   ;; Always add indirect references to another book\n   ((member (gi ancestor) (book-element-list))\n    #t)\n   ;; Add indirect references to the section or component a block\n   ;; is in iff chapters aren't autolabelled.  (Otherwise "Figure 1-3"\n   ;; is sufficient)\n   ((and (member (gi target) (block-element-list))\n\011 (not %chapter-autolabel%))\n    #t)\n   ;; Add indirect references to the component a section is in if\n   ;; the sections are not autolabelled\n   ((and (member (gi target) (section-element-list))\n\011 (member (gi ancestor) (component-element-list))\n\011 (not %section-autolabel%))\n    #t)\n   (else #f)))\n\n(define (auto-xref-direct target \n\011\011\011  #!optional \n\011\011\011  (xref-string (gentext-xref-strings target)))\n  (let* ((substitute (list\n\011\011      (list "%g"  (element-gi-sosofo target))\n\011\011      (list "%n"  (element-label-sosofo target))\n\011\011      (list "%p"  (element-page-number-sosofo target))\n\011\011      (list "%t"  (element-title-xref-sosofo target))))\n\011 (tlist   (match-split-list xref-string (assoc-objs substitute))))\n    (string-list-sosofo tlist substitute)))\n\n(define (auto-xref-indirect target \n\011\011\011    #!optional\n\011\011\011    (xref-string (gentext-xref-strings target)))\n  (make sequence\n    (auto-xref-indirect-connector target)\n    (auto-xref-direct target xref-string)))\n\n(define (auto-xref target \n\011\011   #!optional (xref-string (gentext-xref-strings target)))\n  (let ((source (current-node))\n\011(cont-blok (ancestor-member target (block-element-list)))\n\011(cont-sect (ancestor-member target (section-element-list)))\n\011(cont-comp (ancestor-member target (component-element-list)))\n\011(cont-divn (ancestor-member target (division-element-list)))\n\011(cont-book (ancestor-member target (book-element-list))))\n    (make sequence\n      (auto-xref-direct target xref-string)\n      (if (or (node-list=? cont-blok \n\011\011\011   (ancestor-member source (block-element-list)))\n\011      (node-list=? cont-blok target)\n\011      (not (auto-xref-indirect? target cont-blok)))\n\011  (empty-sosofo)\n\011  (auto-xref-indirect cont-blok))\n      (if (or (node-list=? cont-sect \n\011\011\011   (ancestor-member source (section-element-list)))\n\011      (node-list=? cont-sect target)\n\011      (not (auto-xref-indirect? target cont-sect)))\n\011  (empty-sosofo)\n\011  (auto-xref-indirect cont-sect))\n      (if (or (node-list=? cont-comp \n\011\011\011   (ancestor-member source (component-element-list)))\n\011      (node-list=? cont-comp target)\n\011      (not (auto-xref-indirect? target cont-comp)))\n\011  (empty-sosofo)\n\011  (auto-xref-indirect cont-comp))\n      (if (or (node-list=? cont-divn \n\011\011\011   (ancestor-member source (division-element-list)))\n\011      (node-list=? cont-divn target)\n\011      (not (auto-xref-indirect? target cont-divn)))\n\011  (empty-sosofo)\n\011  (auto-xref-indirect cont-divn))\n      (if (or (node-list=? cont-book \n\011\011\011   (ancestor-member source (book-element-list)))\n\011      (node-list=? cont-book target)\n\011      (not (auto-xref-indirect? target cont-book)))\n\011  (empty-sosofo)\n\011  (auto-xref-indirect cont-book)))))\n\n;; ======================================================================\n\n(define (set-number-restart-list cmp)       (list (normalize "set")))\n(define (book-number-restart-list cmp)      (list (normalize "set")))\n(define (part-number-restart-list cmp)      (list (normalize "book")))\n(define (reference-number-restart-list cmp) (list (normalize "book")))\n(define (preface-number-restart-list cmp)   (list (normalize "book")))\n(define (chapter-number-restart-list cmp)   (list (normalize "book")))\n(define (appendix-number-restart-list cmp)  (list (normalize "book") \n\011\011\011\011\011\011  (normalize "article")))\n(define (article-number-restart-list cmp)   (list (normalize "book")))\n(define (glossary-number-restart-list cmp)  (list (normalize "book")))\n(define (bibliography-number-restart-list cmp) (list (normalize "book")))\n(define (index-number-restart-list cmp)     (list (normalize "book")))\n(define (setindex-number-restart-list cmp)  (list (normalize "set")))\n(define (refentry-number-restart-list cmp)  (list (normalize "reference")))\n(define (default-number-restart-list cmp)   (list (normalize "book")))\n\n(define (component-number-restart-list cmp)\n  ;; Return the list of elements at which numbering of 'cmp' should reset.\n  ;; For example, for CHAPTER, it might return '("BOOK") causing chapters\n  ;; to be sequentially numbered across a book.  If it returned\n  ;; '("BOOK" "PART") then chapter numbering would restart at each \n  ;; BOOK or PART.\n  (let ((name (gi cmp)))\n    (cond\n     ((equal? name (normalize "set"))       (set-number-restart-list cmp))\n     ((equal? name (normalize "book"))      (book-number-restart-list cmp))\n     ((equal? name (normalize "part"))      (part-number-restart-list cmp))\n     ((equal? name (normalize "reference")) (reference-number-restart-list cmp))\n     ((equal? name (normalize "preface"))   (preface-number-restart-list cmp))\n     ((equal? name (normalize "chapter"))   (chapter-number-restart-list cmp))\n     ((equal? name (normalize "appendix"))  (appendix-number-restart-list cmp))\n     ((equal? name (normalize "article"))   (article-number-restart-list cmp))\n     ((equal? name (normalize "glossary"))  (glossary-number-restart-list cmp))\n     ((equal? name (normalize "bibliography")) (bibliography-number-restart-list cmp))\n     ((equal? name (normalize "index"))     (index-number-restart-list cmp))\n     ((equal? name (normalize "setindex"))  (setindex-number-restart-list cmp))\n     ((equal? name (normalize "refentry"))  (refentry-number-restart-list cmp))\n     (else (default-number-restart-list cmp)))))\n\n(define (set-number-ignore-list cmp)       '())\n(define (book-number-ignore-list cmp)      '())\n(define (part-number-ignore-list cmp)      '())\n(define (reference-number-ignore-list cmp) (list (normalize "part")))\n(define (preface-number-ignore-list cmp)   (list (normalize "part")))\n(define (chapter-number-ignore-list cmp)   (list (normalize "part")))\n(define (appendix-number-ignore-list cmp)  (list (normalize "part")))\n(define (article-number-ignore-list cmp)   (list (normalize "part")))\n(define (glossary-number-ignore-list cmp)  (list (normalize "part")))\n(define (bibliography-number-ignore-list cmp) (list (normalize "part")))\n(define (index-number-ignore-list cmp)     (list (normalize "part")))\n(define (setindex-number-ignore-list cmp)  (list (normalize "part")))\n(define (refentry-number-ignore-list cmp)  '())\n(define (default-number-ignore-list cmp)   '())\n\n(define (component-number-ignore-list cmp)\n  ;; Return the list of elements (inside the restart list) which are\n  ;; hierarchy levels which should be ignored.  For example, for CHAPTER,\n  ;; it might return '("PART") causing chapter numbering inside books\n  ;; to ignore parts.\n  ;;\n  ;; Basically, if you skip up past a component/division element in\n  ;; the restart list, you better put the element(s) you skipped in \n  ;; the ignore list or the stylesheet may never see your component\n  ;; when it's trying to do the numbering.\n  (let ((name (gi cmp)))\n    (cond\n     ((equal? name (normalize "set"))       (set-number-ignore-list cmp))\n     ((equal? name (normalize "book"))      (book-number-ignore-list cmp))\n     ((equal? name (normalize "part"))      (part-number-ignore-list cmp))\n     ((equal? name (normalize "reference")) (reference-number-ignore-list cmp))\n     ((equal? name (normalize "preface"))   (preface-number-ignore-list cmp))\n     ((equal? name (normalize "chapter"))   (chapter-number-ignore-list cmp))\n     ((equal? name (normalize "appendix"))  (appendix-number-ignore-list cmp))\n     ((equal? name (normalize "article"))   (article-number-ignore-list cmp))\n     ((equal? name (normalize "glossary"))  (glossary-number-ignore-list cmp))\n     ((equal? name (normalize "bibliography")) (bibliography-number-ignore-list cmp))\n     ((equal? name (normalize "index"))     (index-number-ignore-list cmp))\n     ((equal? name (normalize "setindex"))  (setindex-number-ignore-list cmp))\n     ((equal? name (normalize "refentry"))  (refentry-number-ignore-list cmp))\n     (else (default-number-ignore-list cmp)))))\n\n(define (set-number-sibling-list cmp)       '())\n(define (book-number-sibling-list cmp)      '())\n(define (part-number-sibling-list cmp)      '())\n(define (reference-number-sibling-list cmp) '())\n(define (preface-number-sibling-list cmp)   '())\n(define (chapter-number-sibling-list cmp)   '())\n(define (appendix-number-sibling-list cmp)  '())\n(define (article-number-sibling-list cmp)   '())\n(define (glossary-number-sibling-list cmp)  '())\n(define (bibliography-number-sibling-list cmp) '())\n(define (index-number-sibling-list cmp)     '())\n(define (setindex-number-sibling-list cmp)  '())\n(define (refentry-number-sibling-list cmp)  '())\n(define (default-number-sibling-list cmp)   '())\n\n(define (component-number-sibling-list cmp)\n  ;; Return the list of elements with which 'cmp' should be numbered.\n  ;; For example, for PART it might return '("PART" "REFERENCE") causing\n  ;; sibling parts and references to be numbered together.\n  (let ((name (gi cmp)))\n    (cond\n     ((equal? name (normalize "set"))       (set-number-sibling-list cmp))\n     ((equal? name (normalize "book"))      (book-number-sibling-list cmp))\n     ((equal? name (normalize "part"))      (part-number-sibling-list cmp))\n     ((equal? name (normalize "reference")) (reference-number-sibling-list cmp))\n     ((equal? name (normalize "preface"))   (preface-number-sibling-list cmp))\n     ((equal? name (normalize "chapter"))   (chapter-number-sibling-list cmp))\n     ((equal? name (normalize "appendix"))  (appendix-number-sibling-list cmp))\n     ((equal? name (normalize "article"))   (article-number-sibling-list cmp))\n     ((equal? name (normalize "glossary"))  (glossary-number-sibling-list cmp))\n     ((equal? name (normalize "bibliography")) (bibliography-number-sibling-list cmp))\n     ((equal? name (normalize "index"))     (index-number-sibling-list cmp))\n     ((equal? name (normalize "setindex"))  (setindex-number-sibling-list cmp))\n     ((equal? name (normalize "refentry"))  (refentry-number-sibling-list cmp))\n     (else (default-number-sibling-list cmp)))))\n\n(define (component-number component-node)\n  (let* ((root  (ancestor-member component-node \n\011\011\011\011 (component-number-restart-list \n\011\011\011\011  component-node)))\n\011 (clist (expand-children (children root) \n\011\011\011\011 (component-number-ignore-list\n\011\011\011\011  component-node)))\n\011 (slist (append (list (gi component-node))\n\011\011\011(component-number-sibling-list component-node))))\n    (let loop ((nl clist) (count 1))\n      (if (node-list-empty? nl) \n\011  1\n\011  (if (node-list=? (node-list-first nl) component-node)\n\011      count\n\011      (if (member (gi (node-list-first nl)) slist)\n\011\011  (loop (node-list-rest nl) (+ count 1))\n\011\011  (loop (node-list-rest nl) count)))))))\n\n;; == components and divisions == \n\n(define (set-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (book-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (part-autolabel nd #!optional (force-label? #f))\n  (format-number (component-number nd) (label-number-format nd)))\n\n(define (reference-autolabel nd #!optional (force-label? #f))\n  (format-number (component-number nd) (label-number-format nd)))\n\n(define (preface-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (chapter-autolabel nd #!optional (force-label? #f))\n  (if (or force-label? %chapter-autolabel%)\n      (format-number (component-number nd) (label-number-format nd))\n      ""))\n\n(define (appendix-autolabel nd #!optional (force-label? #f))\n  ;; Abandoned special processing for appendixes in articles. Maybe\n  ;; it's a good idea, but it can't be done here because it screws\n  ;; up cross references to appendixes.\n  (if (or force-label? %chapter-autolabel%)\n      (format-number (component-number nd) (label-number-format nd))\n      ""))\n\n(define (article-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (glossary-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (bibliography-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (index-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (indexdiv-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (colophon-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (setindex-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (refentry-autolabel nd #!optional (force-label? #f))\n  (let* ((isep       (gentext-intra-label-sep nd))\n\011 (refnamediv (select-elements (children nd)\n\011\011\011\011      (normalize "refnamediv")))\n\011 (refd       (select-elements (children refnamediv)\n\011\011\011\011      (normalize "refdescriptor")))\n\011 (refnames   (select-elements (children refnamediv)\n\011\011\011\011      (normalize "refname"))))\n    ""))\n\n;; == /components and divisions == \n\n(define (dedication-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (bibliodiv-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (glossdiv-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (section-autolabel-prefix nd)\n  (let* ((isep   (gentext-intra-label-sep nd))\n\011 (haschn (not (node-list-empty? (ancestor (normalize "chapter") nd))))\n\011 (hasapn (not (node-list-empty? (ancestor (normalize "appendix") nd)))))\n    (cond\n     (haschn (string-append \n\011      (element-label (ancestor (normalize "chapter") nd)) isep))\n     (hasapn (string-append \n\011      (element-label (ancestor (normalize "appendix") nd)) isep))\n     (else ""))))\n\n(define (section-autolabel nd #!optional (force-label? #f))\n  (let* ((isep (gentext-intra-label-sep nd))\n\011 (hasprf (not (node-list-empty? (ancestor (normalize "preface") nd))))\n\011 (prefix (section-autolabel-prefix nd)))\n    (if (and (or force-label? %section-autolabel%)\n\011     (or %label-preface-sections%\n\011\011 (not hasprf)))\n\011(cond\n\011 ((equal? (gi nd) (normalize "sect1"))\n\011  (string-append prefix (format-number (child-number nd) \n\011\011\011\011\011       (label-number-format nd))))\n\011 ((equal? (gi nd) (normalize "sect2"))\n\011  (string-append \n\011   (element-label (ancestor (normalize "sect1") nd) force-label?)\n\011   isep \n\011   (format-number (child-number nd) (label-number-format nd))))\n\011 ((equal? (gi nd) (normalize "sect3"))\n\011  (string-append\n\011   (element-label (ancestor (normalize "sect2") nd) force-label?)\n\011   isep \n\011   (format-number (child-number nd) (label-number-format nd))))\n\011 ((equal? (gi nd) (normalize "sect4"))\n\011  (string-append\n\011   (element-label (ancestor (normalize "sect3") nd) force-label?)\n\011   isep \n\011   (format-number (child-number nd) (label-number-format nd))))\n\011 ((equal? (gi nd) (normalize "sect5"))\n\011  (string-append \n\011   (element-label (ancestor (normalize "sect4") nd) force-label?)\n\011   isep \n\011   (format-number (child-number nd) (label-number-format nd))))\n\n\011 ((equal? (gi nd) (normalize "simplesect"))\n\011  (let* ((possible-sect-ancestors\n\011\011  (node-list (ancestor (normalize "section") nd)\n\011\011\011     (ancestor (normalize "sect5") nd)\n\011\011\011     (ancestor (normalize "sect4") nd)\n\011\011\011     (ancestor (normalize "sect3") nd)\n\011\011\011     (ancestor (normalize "sect2") nd)\n\011\011\011     (ancestor (normalize "sect1") nd)))\n\011\011 (section-ancestor (node-list-first possible-sect-ancestors)))\n\011    (if (node-list-empty? section-ancestor)\n\011\011(string-append prefix (format-number (child-number nd) \n\011\011\011\011\011\011     (label-number-format nd)))\n\011\011(string-append \n\011\011 (element-label section-ancestor force-label?)\n\011\011 isep \n\011\011 (format-number (child-number nd) (label-number-format nd))))))\n\n\011 ((equal? (gi nd) (normalize "section"))\n\011  (if (node-list-empty? (ancestor (normalize "section") nd))\n\011      (string-append prefix (format-number (child-number nd) \n\011\011\011\011\011\011   (label-number-format nd)))\n\011      (string-append \n\011       (element-label (ancestor (normalize "section") nd) force-label?)\n\011       isep \n\011       (format-number (child-number nd) (label-number-format nd)))))\n\011 (else (string-append (gi nd) " IS NOT A SECTION!")))\n\011"")))\n  \n(define (refsection-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (step-autolabel nd #!optional (force-label? #f))\n  ($proc-step-xref-number$ nd))\n\n(define (listitem-autolabel nd #!optional (force-label? #f))\n  (if (equal? (gi (parent nd)) (normalize "orderedlist"))\n      (number->string (child-number nd))\n      "[xref to LISTITEM only supported in ORDEREDLIST]"))\n\n(define (sidebar-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (legalnotice-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (abstract-autolabel nd #!optional (force-label? #f))\n  "")\n\n(define (block-autolabel nd #!optional (force-label? #f))\n  (let* ((chn    (element-label (ancestor (normalize "chapter") nd)))\n\011 (apn    (element-label (ancestor (normalize "appendix") nd)))\n\011 (rfn    (element-label (ancestor (normalize "refentry") nd)))\n\011 ;; If the root of this document isn't in component-element-list, these\n\011 ;; things all wind up being numbered 0. To avoid that, we force the\n\011 ;; root element to be in the list of components if it isn't already\n\011 ;; a component.\n\011 (incomp (member (gi (sgml-root-element)) (component-element-list)))\n\011 ;; In articles in books, number blocks from book not from article.\n\011 ;; Otherwise you get 1, 1, 1, 1, etc. for the first figure in each\n\011 ;; article.\n\011 (artinbook (and (not (node-list-empty? (ancestor (normalize "article") nd)))\n\011\011\011 (not (node-list-empty? (ancestor (normalize "book") nd)))))\n\n\011 (bkn    (if artinbook\n\011\011     (format-number (component-child-number\n\011\011\011\011     nd\n\011\011\011\011     (list (normalize "book")))\n\011\011\011\011    (label-number-format nd))\n\011\011     (if incomp\n\011\011\011 (format-number (component-child-number\n\011\011\011\011\011 nd\n\011\011\011\011\011 (component-element-list))\n\011\011\011\011\011(label-number-format nd))\n\011\011\011 (format-number (component-child-number\n\011\011\011\011\011 nd\n\011\011\011\011\011 (append (component-element-list)\n\011\011\011\011\011\011 (list (gi (sgml-root-element)))))\n\011\011\011\011\011(label-number-format nd))))))\n    (if (equal? chn "")\n\011(if (equal? apn "")\n\011    (if (equal? rfn "")\n\011\011bkn\n\011\011(string-append rfn (gentext-intra-label-sep nd) bkn))\n\011    (string-append apn (gentext-intra-label-sep nd) bkn))\n\011(string-append chn (gentext-intra-label-sep nd) bkn))))\n\n;; For all elements, if a LABEL attribute is present, that is the label\n;; that they get.  Otherwise:\n;; BOOK gets the Book volume, by book-autolabel\n;; PREFACE gets "", by preface-autolabel\n;; CHAPTER gets the Chapter number, by chapter-autolabel\n;; APPENDIX gets the Appendix letter, by appendix-autolabel\n;; REFERENCE gets "", by reference-autolabel\n;; REFENTRY gets "", by refentry-autolabel\n;; SECT* gets the nested section number (e.g., 1.3.5), by section-autolabel\n;; REFSECT* gets the nested section number, by refsection-autolabel\n;; everything else gets numbered by block-autolabel\n;;\n(define (element-label #!optional (nd (current-node)) (force-label? #f))\n  (if (node-list-empty? nd)\n      ""\n      (let ((label (attribute-string (normalize "label") nd)))\n\011(if label\n\011    label\n\011    (cond\n\011     ;; Use a seperately defined assoc list?\n\011     ((equal? (gi nd) (normalize "abstract"))\n\011      (abstract-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "appendix"))\n\011      (appendix-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "article"))\n\011      (article-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "bibliodiv"))\n\011      (bibliodiv-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "bibliography"))\n\011      (bibliography-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "book"))\n\011      (book-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "chapter"))\n\011      (chapter-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "dedication"))\n\011      (dedication-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "glossary"))\n\011      (glossary-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "glossdiv"))\n\011      (glossdiv-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "index"))\n\011      (index-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "colophon"))\n\011      (colophon-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "indexdiv"))\n\011      (indexdiv-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "setindex"))\n\011      (setindex-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "legalnotice"))\n\011      (legalnotice-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "listitem"))\n\011      (listitem-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "part"))\n\011      (part-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "preface"))\n\011      (preface-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "refentry"))\n\011      (refentry-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "reference"))\n\011      (reference-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "refsynopsisdiv"))\n\011      (refsection-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "refsect1"))\n\011      (refsection-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "refsect2"))\n\011      (refsection-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "refsect3"))\n\011      (refsection-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "sect1"))\n\011      (section-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "sect2"))\n\011      (section-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "sect3"))\n\011      (section-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "sect4"))\n\011      (section-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "sect5"))\n\011      (section-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "section"))\n\011      (section-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "simplesect"))\n\011      (section-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "set"))\n\011      (set-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "sidebar"))\n\011      (sidebar-autolabel nd force-label?))\n\011     ((equal? (gi nd) (normalize "step"))\n\011      (step-autolabel nd force-label?))\n\011     (else (block-autolabel nd force-label?)))))))\n\n;; ======================================================================\n\n;; Returns the element label as a sosofo\n;;\n(define (element-label-sosofo nd #!optional (force-label? #f))\n  (if (string=? (element-label nd force-label?) "")\n      (empty-sosofo)\n      (make sequence\n\011(literal (element-label nd force-label?)))))\n\n;; ======================================================================\n\n(define (set-title nd)\n  (let* ((setinfo (select-elements (children nd) (normalize "setinfo")))\n\011 (sititles (select-elements  \n\011\011    (expand-children (children setinfo) \n\011\011\011\011     (list (normalize "bookbiblio") \n\011\011\011\011\011    (normalize "bibliomisc")\n\011\011\011\011\011    (normalize "biblioset")))\n\011\011    (normalize "title")))\n\011 (settitles (select-elements (children nd) (normalize "title")))\n\011 (titles   (if (node-list-empty? settitles)\n\011\011       sititles\n\011\011       settitles)))\n    (if (node-list-empty? titles)\n\011""\n\011(node-list-first titles))))\n\n(define (book-title nd)\n  (let* ((bookinfo (select-elements (children nd) (normalize "bookinfo")))\n\011 (bititles (select-elements  \n\011\011    (expand-children (children bookinfo) \n\011\011\011\011     (list (normalize "bookbiblio") \n\011\011\011\011\011   (normalize "bibliomisc")\n\011\011\011\011\011   (normalize "biblioset")))\n\011\011    (normalize "title")))\n\011 (chtitles (select-elements (children nd) (normalize "title")))\n\011 (titles   (if (node-list-empty? chtitles)\n\011\011       bititles\n\011\011       chtitles)))\n    (if (node-list-empty? titles)\n\011""\n\011(node-list-first titles))))\n\n(define (part-title nd)\n  (let* ((docinfo  (select-elements (children nd) (normalize "docinfo")))\n\011 (dititles (select-elements  \n\011\011    (expand-children (children docinfo) \n\011\011\011\011     (list (normalize "bookbiblio") \n\011\011\011\011\011   (normalize "bibliomisc")\n\011\011\011\011\011   (normalize "biblioset")))\n\011\011    (normalize "title")))\n\011 (chtitles (select-elements (children nd) (normalize "title")))\n\011 (titles   (if (node-list-empty? chtitles)\n\011\011       dititles\n\011\011       chtitles)))\n    (if (node-list-empty? titles)\n\011""\n\011(node-list-first titles))))\n\n (define (article-title nd)\n   (let* ((titles\n\011   (or (select-elements (children\n\011\011\011\011 (node-list-filter-by-gi (children nd)\n\011\011\011\011\011\011\011 (list (normalize "artheader")\n\011\011\011\011\011\011\011       (normalize "articleinfo"))))\n\011\011\011\011(normalize "title"))\n\011       (select-elements (children nd)\n\011\011\011\011(normalize "title")))))\n     (if (node-list-empty? titles)\n\011""\n\011(node-list-first titles))))\n\n(define (preface-title nd)\n  (chapter-title nd))\n\n(define (chapter-title nd)\n  (let* ((docinfo  (select-elements (children nd) (normalize "docinfo")))\n\011 (dititles (select-elements  \n\011\011    (expand-children (children docinfo) \n\011\011\011\011     (list (normalize "bookbiblio") \n\011\011\011\011\011   (normalize "bibliomisc")\n\011\011\011\011\011   (normalize "biblioset")))\n\011\011    (normalize "title")))\n\011 (chtitles (select-elements (children nd) (normalize "title")))\n\011 (titles   (if (node-list-empty? chtitles)\n\011\011       dititles\n\011\011       chtitles)))\n    (if (node-list-empty? titles)\n\011""\n\011(node-list-first titles))))\n\n(define (appendix-title nd)\n  (chapter-title nd))\n\n(define (reference-title nd)\n  (chapter-title nd))\n\n(define (refsynopsisdiv-title nd)\n  (optional-title nd))\n\n;; Returns either the REFENTRYTITLE or the first REFNAME.\n;;\n(define (refentry-title nd)\n  (let* ((refmeta (select-elements (descendants nd) (normalize "refmeta")))\n\011 (refttl  (select-elements (descendants refmeta) (normalize "refentrytitle")))\n\011 (refndiv (select-elements (descendants nd) (normalize "refnamediv")))\n\011 (refname (select-elements (descendants refndiv) (normalize "refname"))))\n    (if (node-list-empty? refttl)\n\011(if (node-list-empty? refname)\n\011    ""\n\011    (node-list-first refname))\n\011(node-list-first refttl))))\n\n(define (optional-title nd)\n  (let* ((docinfo  (select-elements (children nd) (normalize "docinfo")))\n\011 (dititles (select-elements (children docinfo) (normalize "title")))\n\011 (chtitles (select-elements (children nd) (normalize "title")))\n\011 (titles   (if (node-list-empty? chtitles)\n\011\011       dititles\n\011\011       chtitles)))\n    (if (node-list-empty? titles)\n\011(gentext-element-name nd)\n\011(node-list-first titles))))\n\n(define (glossary-title nd)\n  (optional-title nd))\n\n(define (bibliography-title nd)\n  (optional-title nd))\n\n(define (index-title nd)\n  (optional-title nd))\n\n(define (setindex-title nd)\n  (optional-title nd))\n\n(define (dedication-title nd)\n  (optional-title nd))\n\n(define (colophon-title nd)\n  (gentext-element-name nd))\n\n(define (section-title nd)\n  (let* ((info     (select-elements (children nd) \n\011\011\011\011    (list (normalize "sect1info")\n\011\011\011\011\011  (normalize "sect2info")\n\011\011\011\011\011  (normalize "sect3info")\n\011\011\011\011\011  (normalize "sect4info")\n\011\011\011\011\011  (normalize "sect5info")\n\011\011\011\011\011  (normalize "section"))))\n\011 (ititles  (select-elements (children info) (normalize "title")))\n\011 (ctitles  (select-elements (children nd) (normalize "title")))\n\011 (titles   (if (node-list-empty? ctitles)\n\011\011       ititles\n\011\011       ctitles)))\n    (if (node-list-empty? titles)\n\011""\n\011(node-list-first titles))))\n\n(define (refsection-title nd)\n  (let* ((info     (select-elements (children nd) \n\011\011\011\011    (list (normalize "refsect1info")\n\011\011\011\011\011  (normalize "refsect2info") \n\011\011\011\011\011  (normalize "refsect3info"))))\n\011 (ititles  (select-elements (children info) (normalize "title")))\n\011 (ctitles  (select-elements (children nd) (normalize "title")))\n\011 (titles   (if (node-list-empty? ctitles)\n\011\011       ititles\n\011\011       ctitles)))\n    (if (node-list-empty? titles)\n\011""\n\011(node-list-first titles))))\n\n(define (block-title nd)\n  (let ((titles (select-elements (children nd) (normalize "title"))))\n    (if (node-list-empty? titles)\n\011""\n\011(node-list-first titles))))\n\n;; ======================================================================\n\n(define (set-title-sosofo nd)\n  (let ((title (set-title nd)))\n    (if (string? title)\n\011(empty-sosofo)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(define (book-title-sosofo nd)\n  (let ((title (book-title nd)))\n    (if (string? title)\n\011(empty-sosofo)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(define (part-title-sosofo nd)\n  (let ((title (part-title nd)))\n    (if (string? title)\n\011(empty-sosofo)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(define (article-title-sosofo nd)\n  (let ((title (article-title nd)))\n    (if (string? title)\n\011(empty-sosofo)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(define (preface-title-sosofo nd)\n  (let ((title (preface-title nd)))\n    (if (string? title)\n\011(empty-sosofo)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(define (chapter-title-sosofo nd)\n  (let ((title (chapter-title nd)))\n    (if (string? title)\n\011(empty-sosofo)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(define (appendix-title-sosofo nd)\n  (let ((title (appendix-title nd)))\n    (if (string? title)\n\011(empty-sosofo)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(define (reference-title-sosofo nd)\n  (let ((title (reference-title nd)))\n    (if (string? title)\n\011(empty-sosofo)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(define (refsynopsisdiv-title-sosofo nd)\n  (optional-title-sosofo nd))\n\n(define (refentry-title-sosofo nd)\n  (let ((title (refentry-title nd)))\n    (if (string? title)\n\011(empty-sosofo)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(define (optional-title-sosofo nd)\n  (let ((title (optional-title nd)))\n    (if (string? title)\n\011(literal title)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(define (glossary-title-sosofo nd)\n  (optional-title-sosofo nd))\n\n(define (bibliography-title-sosofo nd)\n  (optional-title-sosofo nd))\n\n(define (index-title-sosofo nd)\n  (optional-title-sosofo nd))\n\n(define (setindex-title-sosofo nd)\n  (optional-title-sosofo nd))\n\n(define (dedication-title-sosofo nd)\n  (optional-title-sosofo nd))\n\n(define (colophon-title-sosofo nd)\n  (literal (gentext-element-name nd)))\n\n(define (section-title-sosofo nd)\n  (let ((title (section-title nd)))\n    (if (string? title)\n\011(empty-sosofo)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(define (refsection-title-sosofo nd)\n  (let ((title (refsection-title nd)))\n    (if (string? title)\n\011(empty-sosofo)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(define (block-title-sosofo nd)\n  (let ((title (block-title nd)))\n    (if (string? title)\n\011(empty-sosofo)\n\011(with-mode title-sosofo-mode\n\011  (process-node-list title)))))\n\n(mode title-sosofo-mode\n  (element title\n    (process-children-trim))\n\n  (element citetitle\n    (process-children-trim))\n\n  (element refname\n    (process-children-trim))\n\n  (element refentrytitle\n    (process-children-trim)))\n\n;; Returns the title of the element as a sosofo.\n;;\n(define (element-title-sosofo #!optional (nd (current-node)))\n  (if (node-list-empty? nd)\n      (empty-sosofo)\n      (cond\n       ;; Use a seperately defined assoc list?\n       ((equal? (gi nd) (normalize "appendix")) (appendix-title-sosofo nd))\n       ((equal? (gi nd) (normalize "article")) (article-title-sosofo nd))\n       ((equal? (gi nd) (normalize "bibliography")) (bibliography-title-sosofo nd))\n       ((equal? (gi nd) (normalize "book")) (book-title-sosofo nd))\n       ((equal? (gi nd) (normalize "chapter")) (chapter-title-sosofo nd))\n       ((equal? (gi nd) (normalize "dedication")) (dedication-title-sosofo nd))\n       ((equal? (gi nd) (normalize "glossary")) (glossary-title-sosofo nd))\n       ((equal? (gi nd) (normalize "index")) (index-title-sosofo nd))\n       ((equal? (gi nd) (normalize "colophon")) (colophon-title-sosofo nd))\n       ((equal? (gi nd) (normalize "setindex")) (index-title-sosofo nd))\n       ((equal? (gi nd) (normalize "part")) (part-title-sosofo nd))\n       ((equal? (gi nd) (normalize "preface")) (preface-title-sosofo nd))\n       ((equal? (gi nd) (normalize "refentry")) (refentry-title-sosofo nd))\n       ((equal? (gi nd) (normalize "reference")) (reference-title-sosofo nd))\n       ((equal? (gi nd) (normalize "refsect1")) (refsection-title-sosofo nd))\n       ((equal? (gi nd) (normalize "refsect2")) (refsection-title-sosofo nd))\n       ((equal? (gi nd) (normalize "refsect3")) (refsection-title-sosofo nd))\n       ((equal? (gi nd) (normalize "refsynopsisdiv")) (refsynopsisdiv-title-sosofo nd))\n       ((equal? (gi nd) (normalize "sect1")) (section-title-sosofo nd))\n       ((equal? (gi nd) (normalize "sect2")) (section-title-sosofo nd))\n       ((equal? (gi nd) (normalize "sect3")) (section-title-sosofo nd))\n       ((equal? (gi nd) (normalize "sect4")) (section-title-sosofo nd))\n       ((equal? (gi nd) (normalize "sect5")) (section-title-sosofo nd))\n       ((equal? (gi nd) (normalize "set")) (set-title-sosofo nd))\n       (else (block-title-sosofo nd)))))\n\n;; ======================================================================\n\n;; Returns the title of the element; returns a node if possible, or a string\n(define (element-title nd)\n  (if (node-list-empty? nd)\n      ""\n      (cond\n       ;; Use a seperately defined assoc list?\n       ((equal? (gi nd) (normalize "appendix")) (appendix-title nd))\n       ((equal? (gi nd) (normalize "article")) (article-title nd))\n       ((equal? (gi nd) (normalize "bibliography")) (bibliography-title nd))\n       ((equal? (gi nd) (normalize "book")) (book-title nd))\n       ((equal? (gi nd) (normalize "chapter")) (chapter-title nd))\n       ((equal? (gi nd) (normalize "dedication")) (dedication-title nd))\n       ((equal? (gi nd) (normalize "glossary")) (glossary-title nd))\n       ((equal? (gi nd) (normalize "index")) (index-title nd))\n       ((equal? (gi nd) (normalize "colophon")) (colophon-title nd))\n       ((equal? (gi nd) (normalize "setindex")) (setindex-title nd))\n       ((equal? (gi nd) (normalize "part")) (part-title nd))\n       ((equal? (gi nd) (normalize "preface")) (preface-title nd))\n       ((equal? (gi nd) (normalize "refentry")) (refentry-title nd))\n       ((equal? (gi nd) (normalize "reference")) (reference-title nd))\n       ((equal? (gi nd) (normalize "refsect1")) (refsection-title nd))\n       ((equal? (gi nd) (normalize "refsect2")) (refsection-title nd))\n       ((equal? (gi nd) (normalize "refsect3")) (refsection-title nd))\n       ((equal? (gi nd) (normalize "refsynopsisdiv")) (refsynopsisdiv-title nd))\n       ((equal? (gi nd) (normalize "sect1")) (section-title nd))\n       ((equal? (gi nd) (normalize "sect2")) (section-title nd))\n       ((equal? (gi nd) (normalize "sect3")) (section-title nd))\n       ((equal? (gi nd) (normalize "sect4")) (section-title nd))\n       ((equal? (gi nd) (normalize "sect5")) (section-title nd))\n       ((equal? (gi nd) (normalize "set")) (set-title nd))\n       (else (block-title nd)))))\n\n;; ======================================================================\n;; Returns the data of a node, carefully excising INDEXTERMs from \n;; the data content\n;;\n\n(define (data-of node)\n  ;; return the data characters of a node, except for the content of\n  ;; indexterms which are suppressed.\n  (let loop ((nl (children node)) (result ""))\n    (if (node-list-empty? nl)\n\011result\n\011(if (equal? (node-property 'class-name (node-list-first nl)) 'element)\n\011    (if (or (equal? (gi (node-list-first nl)) (normalize "indexterm"))\n\011\011    (equal? (gi (node-list-first nl)) (normalize "comment"))\n\011\011    (equal? (gi (node-list-first nl)) (normalize "remark")))\n\011\011(loop (node-list-rest nl) result)\n\011\011(loop (node-list-rest nl)\n\011\011      (string-append result (data-of (node-list-first nl)))))\n\011    (if (or (equal? (node-property 'class-name (node-list-first nl))\n\011\011\011    'data-char)\n\011\011    (equal? (node-property 'class-name (node-list-first nl))\n\011\011\011    'sdata))\n\011\011(loop (node-list-rest nl)\n\011\011      (string-append result (data (node-list-first nl))))\n\011\011(loop (node-list-rest nl) result))))))\n\n;; ======================================================================\n;; Returns the element title data of nd\n;;\n(define (element-title-string nd)\n  (let ((title (element-title nd)))\n    (if (string? title)\n\011title\n\011(data-of title))))\n\n;; ======================================================================\n;; Returns the element gi as a sosofo\n;;\n(define (element-gi-sosofo nd)\n  (if (node-list-empty? nd)\n      (empty-sosofo)\n      (make sequence\n\011(literal (gentext-element-name nd)))))\n\n;; ======================================================================\n\n(define (titlepage-info-elements node info #!optional (intro (empty-node-list)))\n  ;; Returns a node-list of the elements that might appear on a title\n  ;; page.  This node-list is constructed as follows:\n  ;;\n  ;; 1. The "title" child of node is considered as a possibility\n  ;; 2. If info is not empty, then node-list starts as the children\n  ;;    of info.  If the children of info don't include a title, then\n  ;;    the title from the node is added.\n  ;; 3. If info is empty, then node-list starts as the children of node,\n  ;;    but with "partintro" filtered out.\n\n  (let* ((title (select-elements (children node) (normalize "title")))\n\011 (nl    (if (node-list-empty? info)\n\011\011    (node-list-filter-by-not-gi (children node) \n\011\011\011\011\011\011(list (normalize "partintro")))\n\011\011    (children info)))\n\011 (nltitle (node-list-filter-by-gi nl (list (normalize "title")))))\n    (if (node-list-empty? info)\n\011(node-list nl\n\011\011   intro)\n\011(node-list (if (node-list-empty? nltitle)\n\011\011       title\n\011\011       (empty-node-list))\n\011\011   nl\n\011\011   intro))))\n\n;; ======================================================================\n\n(define (info-element #!optional (nd (current-node)))\n  ;; Returns the *INFO element for the nd or (empty-node-list) if no\n  ;; such node exists...\n  (cond\n   ((equal? (gi nd) (normalize "set"))\n    (select-elements (children nd) (normalize "setinfo")))\n   ((equal? (gi nd) (normalize "book"))\n    (select-elements (children nd) (normalize "bookinfo")))\n   ((equal? (gi nd) (normalize "section"))\n    (select-elements (children nd) (normalize "sectioninfo")))\n   ((equal? (gi nd) (normalize "sect1"))\n    (select-elements (children nd) (normalize "sect1info")))\n   ((equal? (gi nd) (normalize "sect2"))\n    (select-elements (children nd) (normalize "sect2info")))\n   ((equal? (gi nd) (normalize "sect3"))\n    (select-elements (children nd) (normalize "sect3info")))\n   ((equal? (gi nd) (normalize "sect4"))\n    (select-elements (children nd) (normalize "sect4info")))\n   ((equal? (gi nd) (normalize "sect5"))\n    (select-elements (children nd) (normalize "sect5info")))\n   ((equal? (gi nd) (normalize "refsect1"))\n    (select-elements (children nd) (normalize "refsect1info")))\n   ((equal? (gi nd) (normalize "refsect2"))\n    (select-elements (children nd) (normalize "refsect2info")))\n   ((equal? (gi nd) (normalize "refsect3"))\n    (select-elements (children nd) (normalize "refsect3info")))\n   ((equal? (gi nd) (normalize "refsynopsisdiv"))\n    (select-elements (children nd) (normalize "refsynopsisdivinfo")))\n   ((equal? (gi nd) (normalize "article"))\n    (node-list-filter-by-gi (children nd) (list (normalize "artheader")\n\011\011\011\011\011\011(normalize "articleinfo"))))\n   (else ;; BIBLIODIV, GLOSSDIV, INDEXDIV, PARTINTRO, SIMPLESECT\n    (select-elements (children nd) (normalize "docinfo")))))\n\n;; ======================================================================\n;;\n;; Bibliography filtering...\n\n(define (biblio-filter allentries)\n  (let* ((all  (descendants (sgml-root-element)))\n\011 (link (select-elements all (normalize "link")))\n\011 (xref (select-elements all (normalize "xref")))\n\011 (cite (select-elements all (normalize "citation")))\n\011 (xref-elements (node-list link xref)))\n    (let loop ((entries allentries) (used (empty-node-list)))\n      (if (node-list-empty? entries)\n\011  used\n\011  (if (or (cited-by-xref (node-list-first entries) xref-elements)\n\011\011  (cited-by-citation (node-list-first entries) cite))\n\011      (loop (node-list-rest entries) \n\011\011    (node-list used (node-list-first entries)))\n\011      (loop (node-list-rest entries) used))))))\n\n(define (cited-by-xref bib xref-elements)\n  (let* ((id (attribute-string (normalize "id") bib)))\n    (if id\n\011(let loop ((links xref-elements))\n\011  (if (node-list-empty? links)\n\011      #f\n\011      (if (equal? (attribute-string (normalize "linkend") \n\011\011\011\011\011    (node-list-first links)) id)\n\011\011  #t\n\011\011  (loop (node-list-rest links)))))\n\011#f)))\n\n(define (cited-by-citation bib citations)\n  (let loop ((links citations))\n    (if (node-list-empty? links)\n\011#f\n\011(if (citation-matches-target? (node-list-first links) bib)\n\011    #t\n\011    (loop (node-list-rest links))))))\n\n(define (citation-matches-target? citation target)\n  (let* ((fchild (node-list-first \n\011\011  (node-list-filter-out-pis \n\011\011   (children target))))\n\011 (abbrev (if (equal? (gi fchild) (normalize "abbrev"))\n\011\011     fchild\n\011\011     (empty-node-list)))\n\011 (cite   (data-of citation)))\n    (or (equal? (attribute-string "id" target) (normalize cite))\n\011(equal? (attribute-string "xreflabel" target) (normalize cite))\n\011(equal? (normalize cite) (normalize (data-of abbrev))))))\n\n(define (bibentry-number bibentry)\n  (let* ((bgraphy (ancestor-member bibentry \n\011\011\011\011   (list (normalize "bibliography"))))\n\011 (comps   (expand-children (children bgraphy) \n\011\011\011\011   (list (normalize "bibliodiv")))))\n    (let loop ((nl comps) (count 1))\n      (if (node-list-empty? nl) \n\011  0\n\011  (if (node-list=? (node-list-first nl) bibentry)\n\011      count\n\011      (if (or (equal? (gi (node-list-first nl))\n\011\011\011      (normalize "biblioentry"))\n\011\011      (equal? (gi (node-list-first nl))\n\011\011\011      (normalize "bibliomixed")))\n\011\011  (loop (node-list-rest nl) (+ count 1))\n\011\011  (loop (node-list-rest nl) count)))))))\n\n;; ======================================================================\n\n(define (olink-resource-title pubid sysid)\n  ;; This version of olink-resource-title expects public identifiers\n  ;; with the following format:\n  ;;\n  ;;   -//owner//TEXT title Vx.x//EN\n  ;; \n  ;; Specifically the title is the description field of the public\n  ;; identifier minus the first word (TEXT, the type) and the last\n  ;; word, in my case a version string.  Words are blank delimited.\n  ;; The parsing will fail if a "/" appears anywhere in any field.\n  ;; The system identifier is ignored\n  ;; \n  (let* ((pubidparts   (if pubid\n\011\011\011   (split pubid '(#\\/))\n\011\011\011   (split "-//none//type version//la" '(#\\/))))\n\011 (description  (car (cdr (cdr pubidparts))))\n\011 (descparts    (split description))\n\011 (titleparts   (list-head (cdr descparts) (- (length descparts) 2))))\n    (join titleparts)))\n\n;; ======================================================================\n\n(define (orderedlist-listitem-number listitem)\n  ;; return the number of listitem, taking continuation into account\n  (let* ((orderedlist (parent listitem))\n\011 (listitems (select-elements (children orderedlist)\n\011\011\011\011     (normalize "listitem")))\n\011 (continue? (equal? (attribute-string (normalize "continuation")\n\011\011\011\011\011      orderedlist)\n\011\011\011    (normalize "continues")))\n\n;; If a list is the continuation of a previous list, we must find the\n;; list that is continued in order to calculate the starting\n;; item number of this list.\n;;\n;; Of all the lists in this component, only the following are candidates:\n;; 1. Lists which precede this list\n;; 2. Lists which are not ancestors of this list\n;; 3. Lists that do not have ancestors that are lists which precede this one\n;;\n;; Of the candidates, the last one, in document order, is the preceding\n;; list\n\011 (all-lists (select-elements\n\011\011     (descendants (ancestor-member orderedlist\n\011\011\011\011\011\011   (component-element-list)))\n\011\011     (normalize "orderedlist")))\n\n\011 (cand1     (if continue?\n\011\011\011(let loop ((nl all-lists)\n\011\011\011\011   (prec (empty-node-list)))\n\011\011\011  (if (node-list-empty? nl)\n\011\011\011      prec\n\011\011\011      (if (node-list=? (node-list-first nl)\n\011\011\011\011\011       orderedlist)\n\011\011\011\011  prec\n\011\011\011\011  (loop (node-list-rest nl)\n\011\011\011\011\011(node-list prec\n\011\011\011\011\011\011   (node-list-first nl))))))\n\011\011\011(empty-node-list)))\n\n\011 (cand2     (let loop ((nl cand1)\n\011\011\011       (cand2lists (empty-node-list)))\n\011\011      (if (node-list-empty? nl)\n\011\011\011  cand2lists\n\011\011\011  (loop (node-list-rest nl)\n\011\011\011\011(if (descendant-of? (node-list-first nl)\n\011\011\011\011\011\011    orderedlist)\n\011\011\011\011    cand2lists\n\011\011\011\011    (node-list cand2lists\n\011\011\011\011\011       (node-list-first nl)))))))\n\n\011 ;; now find the last item of cand2 that is not a descendant\n\011 ;; of some other element of the cand2 list.\n\011 (preclist  (let loop ((nl (node-list-reverse cand2)))\n\011\011      (if (node-list-empty? nl)\n\011\011\011  (empty-node-list)\n\011\011\011  (if (descendant-member-of?\n\011\011\011       (node-list-first nl)\n\011\011\011       (node-list-rest nl))\n\011\011\011      (loop (node-list-rest nl))\n\011\011\011      (node-list-first nl)))))\n\n\011 (precitem (if (node-list-empty? preclist)\n\011\011       (empty-node-list)\n\011\011       (node-list-last (children preclist))))\n\011 (precitem-number (if (and continue? (not (node-list-empty? precitem)))\n\011\011\011      (orderedlist-listitem-number precitem)\n\011\011\011      0)))\n\n    (+ precitem-number (child-number listitem))))\n\n(define (descendant-member-of? node node-list)\n  ;; return true if node is a descedant of any member of node-list\n  (let loop ((nl node-list))\n    (if (node-list-empty? nl)\n\011#f\n\011(if (descendant-of? (node-list-first nl) node)\n\011    #t\n\011    (loop (node-list-rest nl))))))\n\n;; ======================================================================\n\n(define (orderedlist-listitem-label listitem)\n  ;; return the formatted number of listitem\n  (let* ((number  (orderedlist-listitem-number listitem))\n\011 (depth   (length (hierarchical-number-recursive\n\011\011\011   (normalize "orderedlist")\n\011\011\011   listitem)))\n\011 (numeration (inherited-attribute-string (normalize "numeration")\n\011\011\011\011\011\011 listitem))\n\011 ;; rawnum allows for numbering to alternate\n\011 (rawnum (cond\n\011\011  ((equal? numeration (normalize "arabic")) 1)\n\011\011  ((equal? numeration (normalize "loweralpha")) 2)\n\011\011  ((equal? numeration (normalize "lowerroman")) 3)\n\011\011  ((equal? numeration (normalize "upperalpha")) 4)\n\011\011  ((equal? numeration (normalize "upperroman")) 0)\n\011\011  (else (modulo depth 5)))))\n    (case rawnum\n      ((1) (format-number number "1"))\n      ((2) (format-number number "a"))\n      ((3) (format-number number "i"))\n      ((4) (format-number number "A"))\n      ((0) (format-number number "I")))))\n\n(define (orderedlist-listitem-label-recursive listitem)\n  ;; return the recursively formatted number of the listitem.\n  ;; In other words, something of the form 1.2.3 for a third level\n  ;; nested ordered list\n  (let loop ((li (parent listitem)) \n\011     (label (orderedlist-listitem-label listitem)))\n    (if (or (node-list-empty? li)\n\011    (node-list-empty? (ancestor (normalize "orderedlist") li)))\n\011label\n\011(if (and (equal? (gi li) (normalize "listitem"))\n\011\011 (equal? (gi (parent li)) (normalize "orderedlist")))\n\011    (loop (parent li)\n\011\011  (string-append \n\011\011   (orderedlist-listitem-label li)\n\011\011   (gentext-intra-label-sep li)\n\011\011   label))\n\011    (loop (parent li) label)))))\n\n(define (question-answer-label #!optional (node (current-node)))\n  (let* ((inhlabel (inherited-attribute-string (normalize "defaultlabel")\n\011\011\011\011\011       node))\n\011 (deflabel (if inhlabel inhlabel (qanda-defaultlabel)))\n\011 (label    (attribute-string (normalize "label") node))\n\011 (hnr      (hierarchical-number-recursive (normalize "qandadiv")\n\011\011\011\011\011\011  node))\n\n\011 (parsect  (ancestor-member node (section-element-list)))\n\n\011 (defnum   (if (and %qanda-inherit-numeration% \n\011\011\011    %section-autolabel%)\n\011\011       (if (node-list-empty? parsect)\n\011\011\011   (section-autolabel-prefix node)\n\011\011\011   (section-autolabel parsect))\n\011\011       ""))\n\n\011 (hnumber  (let loop ((numlist hnr) (number defnum) \n\011\011\011      (sep (if (equal? defnum "") "" ".")))\n\011\011     (if (null? numlist)\n\011\011\011 number\n\011\011\011 (loop (cdr numlist) \n\011\011\011       (string-append number\n\011\011\011\011\011      sep\n\011\011\011\011\011      (number->string (car numlist)))\n\011\011\011       "."))))\n\011 (cnumber  (child-number (parent node)))\n\011 (number   (string-append hnumber \n\011\011\011\011  (if (equal? hnumber "")\n\011\011\011\011      ""\n\011\011\011\011      ".")\n\011\011\011\011  (number->string cnumber))))\n    (cond\n     ((equal? deflabel (normalize "qanda"))\n      (gentext-element-name node))\n     ((equal? deflabel (normalize "label"))\n      label)\n     ;; Note: only questions are numbered...\n     ((and (equal? deflabel (normalize "number"))\n\011   (equal? (gi node) (normalize "question")))\n      (string-append number "."))\n     (else ""))))\n\n;; ======================================================================\n;; Calculate term lengths...\n\n(define (varlistentry-term-too-long? vle termlength)\n  (let loop ((nl (select-elements (children vle) (normalize "term")))\n\011     (too-long? #f))\n    (if (or too-long? (node-list-empty? nl))\n\011too-long?\n\011(loop (node-list-rest nl)\n\011      (> (string-length (data (node-list-first nl)))\n\011\011 termlength)))))\n\n(define (variablelist-term-too-long? termlength)\n  (let loop ((nl (select-elements (children (current-node))\n\011\011\011\011  (normalize "varlistentry")))\n\011     (too-long? #f))\n    (if (or too-long? (node-list-empty? nl))\n\011too-long?\n\011(loop (node-list-rest nl)\n\011      (varlistentry-term-too-long? (node-list-first nl) termlength)))))\n\n;; ======================================================================\n;; bibliography elements\n\n(define (biblioentry-inline-elements)\n  (list (normalize "abbrev")\n\011(normalize "affiliation")\n\011(normalize "artpagenums")\n\011(normalize "author")\n\011(normalize "authorgroup")\n\011(normalize "authorinitials")\n\011(normalize "citetitle")\n\011(normalize "collab")\n\011(normalize "confgroup")\n\011(normalize "contractnum")\n\011(normalize "contractsponsor")\n\011(normalize "contrib")\n\011(normalize "copyright")\n\011(normalize "corpauthor")\n\011(normalize "corpname")\n\011(normalize "date")\n\011(normalize "edition")\n\011(normalize "editor")\n\011(normalize "firstname")\n\011(normalize "honorific")\n\011(normalize "invpartnumber")\n\011(normalize "isbn")\n\011(normalize "issn")\n\011(normalize "issuenum")\n\011(normalize "lineage")\n\011(normalize "orgname")\n\011(normalize "othercredit")\n\011(normalize "othername")\n\011(normalize "pagenums")\n\011(normalize "productname")\n\011(normalize "productnumber")\n\011(normalize "pubdate")\n\011(normalize "publisher")\n\011(normalize "publishername")\n\011(normalize "pubsnumber")\n\011(normalize "releaseinfo")\n\011(normalize "seriesvolnums")\n\011(normalize "subtitle")\n\011(normalize "surname")\n\011(normalize "title")\n\011(normalize "titleabbrev")\n\011(normalize "volumenum")))\n\n(define (biblioentry-block-elements)\n  (list (normalize "abstract")\n\011(normalize "address")\n\011(normalize "authorblurb")\n\011(normalize "printhistory")\n\011(normalize "revhistory")\n\011(normalize "seriesinfo")))\n\n(define (biblioentry-flatten-elements)\n  (list (normalize "articleinfo")\n\011(normalize "biblioset")\n\011(normalize "bookbiblio")\n        (normalize "artheader")))\n\n;; === db31 common ======================================================\n\n(define (data-filename dataobj)\n  (let* ((entityref (attribute-string (normalize "entityref") dataobj))\n\011 (fileref   (attribute-string (normalize "fileref") dataobj))\n\011 (filename  (if fileref\n\011\011\011fileref\n\011\011\011(system-id-filename entityref)))\n\011 (ext       (file-extension filename)))\n    (if (or (not filename)\n\011    (not %graphic-default-extension%)\n\011    (member ext %graphic-extensions%))\n\011filename\n\011(string-append filename "." %graphic-default-extension%))))\n\n(define (normalized-member string string-list)\n  (if (string? string)\n      (let loop ((sl string-list))\n\011(if (null? sl)\n\011    #f\n\011    (if (string=? (normalize string) (normalize (car sl)))\n\011\011#t\n\011\011(loop (cdr sl)))))\n      #f))\n\n(define (find-displayable-object objlist notlist extlist)\n  (let loop ((nl objlist))\n    (if (node-list-empty? nl)\n\011(empty-node-list)\n\011(let* ((objdata  (node-list-filter-by-gi\n\011\011\011  (children (node-list-first nl))\n\011\011\011  (list (normalize "videodata")\n\011\011\011\011(normalize "audiodata")\n\011\011\011\011(normalize "imagedata"))))\n\011       (filename  (data-filename objdata))\n\011       (extension (file-extension filename))\n\011       (notation  (attribute-string (normalize "format") objdata)))\n\011  (if (or (normalized-member notation notlist)\n\011\011  (normalized-member extension extlist)\n\011\011  (and notation\n\011\011       (string=? notation (normalize "linespecific"))))\n\011      (node-list-first nl)\n\011      (loop (node-list-rest nl)))))))\n\n(define (select-displayable-object objlist)\n  (let ((pref (find-displayable-object objlist\n\011\011\011\011       preferred-mediaobject-notations\n\011\011\011\011       preferred-mediaobject-extensions))\n\011(ok   (find-displayable-object objlist\n\011\011\011\011       acceptable-mediaobject-notations\n\011\011\011\011       acceptable-mediaobject-extensions)))\n    (if (node-list-empty? pref)\n\011ok\n\011pref)))\n\n(define ($mediaobject$)\n  (let* ((objects (node-list-filter-by-gi\n\011\011   (children (current-node))\n\011\011   (list (normalize "videoobject")\n\011\011\011 (normalize "imageobject")\n\011\011\011 (normalize "audioobject"))))\n\011 (dobject (select-displayable-object objects))\n\011 (textobj (select-elements (children (current-node))\n\011\011\011\011   (normalize "textobject")))\n\011 (caption (select-elements (children (current-node))\n\011\011\011\011   (normalize "caption"))))\n    (make sequence\n      (if (node-list-empty? dobject)\n\011  (if (node-list-empty? textobj)\n\011      (empty-sosofo)\n\011      (process-node-list (node-list-first textobj)))\n\011  (process-node-list dobject))\n      (process-node-list caption))))\n\n;; ======================================================================\n  \n;; $Id: dbtable.dsl,v 1.1 2001/04/02 21:40:27 nwalsh Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://nwalsh.com/docbook/dsssl/\n;;\n;; This file contains table functions common to both print and HTML\n;; versions of the DocBook stylesheets.\n;;\n\n;; If **ANY** change is made to this file, you _MUST_ alter the\n;; following definition:\n\n(define %docbook-common-table-version%\n  "Modular DocBook Stylesheet Common Table Functions")\n\n;; == Table Support =====================================================\n\n;; ----------------------------------------------------------------------\n;; Functions for finding/retrieving table attributes\n\n(define (tgroup-align tgroup)\n  (attribute-string (normalize "align") tgroup))\n\n(define (tgroup-colsep tgroup)\n  (attribute-string (normalize "colsep") tgroup))\n\n(define (tgroup-rowsep tgroup)\n  (attribute-string (normalize "rowsep") tgroup))\n\n;; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n(define (find-tgroup #!optional (nd (current-node)))\n  ;; for our purposes, an entrytbl functions as a tgroup.\n  ;; ENTRYTBL IS ONLY SUPPORTED IN THE HTML BACKEND!!!\n  (if (or (equal? (gi nd) (normalize "tgroup"))\n\011  (equal? (gi nd) (normalize "entrytbl")))\n      nd\n      (if (node-list-empty? (ancestor (normalize "entrytbl") nd))\n\011  (ancestor (normalize "tgroup") nd)\n\011  (ancestor (normalize "entrytbl") nd))))\n\n(define (find-colspec colname)\n  (let* ((tgroup (find-tgroup))\n\011 (colspecs (select-elements (descendants tgroup)\n\011\011\011\011    (normalize "colspec"))))\n    (let loop ((nl colspecs))\n\011(if (node-list-empty? nl)\n\011    ;; we've run out of places to look, stop looking...\n\011    (error (string-append "Could not find COLSPEC named " colname))\n\011    (if (equal? colname\n\011\011\011(attribute-string (normalize "colname") \n\011\011\011\011\011  (node-list-first nl)))\n\011\011(node-list-first nl)\n\011\011(loop (node-list-rest nl)))))))\n\n(define (find-colspec-by-number colnum)\n  (let* ((tgroup (find-tgroup))\n\011 (colspecs (select-elements (children tgroup) (normalize "colspec"))))\n    (let loop ((nl colspecs))\n      (if (node-list-empty? nl)\n\011  ;; we've run out of places to look, stop looking...\n\011  (empty-node-list)\n\011  (if (equal? (colspec-colnum (node-list-first nl)) colnum)\n\011      (node-list-first nl)\n\011      (loop (node-list-rest nl)))))))\n\n(define (colspec-align colspec)\n  (attribute-string (normalize "align") colspec))\n\n(define (colspec-char colspec)\n  (attribute-string (normalize "char") colspec))\n\n(define (colspec-charoff colspec)\n  (let ((charoff (attribute-string (normalize "charoff") colspec)))\n    (if charoff\n\011(string->number charoff)\n\011#f)))\n\n(define (colspec-colnum colspec)\n  ;; returns the column number of the associated colspec...which is \n  ;; either the value of COLNUM or obtained by counting\n  (let* ((tgroup (find-tgroup colspec))\n\011 (colspecs (select-elements (children tgroup) (normalize "colspec"))))\n    (if (attribute-string (normalize "colnum") colspec)\n\011(string->number (attribute-string (normalize "colnum") colspec))\n\011(let loop ((nl colspecs) (curcol 1))\n\011  (let ((colnum (attribute-string (normalize "colnum") (node-list-first nl))))\n\011    (if (node-list=? (node-list-first nl) colspec)\n\011\011curcol\n\011\011(if colnum\n\011\011    (loop (node-list-rest nl) (+ (string->number colnum) 1))\n\011\011    (loop (node-list-rest nl) (+ curcol 1)))))))))\n\n(define (colspec-colname colspec)\n  (attribute-string (normalize "colname") colspec))\n\n(define (colspec-colsep colspec)\n  (attribute-string (normalize "colsep") colspec))\n\n(define (colspec-colwidth colspec)\n  (if (attribute-string (normalize "colwidth") colspec)\n      (attribute-string (normalize "colwidth") colspec)\n      "1*"))\n\n(define (colspec-rowsep colspec)\n  (attribute-string (normalize "rowsep") colspec))\n\n;; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n(define (find-spanspec spanname)\n  (let* ((tgroup (find-tgroup))\n\011 (spanspecs (select-elements (descendants tgroup) \n\011\011\011\011     (normalize (normalize "spanspec")))))\n    (let loop ((nl spanspecs))\n      (if (node-list-empty? nl)\n\011  (error (string-append "Could not find SPANSPEC named " spanname))\n\011  (if (equal? spanname \n\011\011      (attribute-string (normalize "spanname")\n\011\011\011\011\011(node-list-first nl)))\n\011      (node-list-first nl)\n\011      (loop (node-list-rest nl)))))))\n\n(define (spanspec-align spanspec)\n  (attribute-string (normalize "align") spanspec))\n\n(define (spanspec-char spanspec)\n  (attribute-string (normalize "char") spanspec))\n\n(define (spanspec-charoff spanspec)\n  (let ((charoff (attribute-string (normalize "charoff") spanspec)))\n    (if charoff\n\011(string->number charoff)\n\011#f)))\n\n(define (spanspec-colsep spanspec)\n  (attribute-string (normalize "colsep") spanspec))\n\n(define (spanspec-nameend spanspec)\n  (attribute-string (normalize "nameend") spanspec))\n\n(define (spanspec-namest spanspec)\n  (attribute-string (normalize "namest") spanspec))\n\n(define (spanspec-rowsep spanspec)\n  (attribute-string (normalize "rowsep") spanspec))\n\n(define (spanspec-spanname spanspec)\n  (attribute-string (normalize "spanname") spanspec))\n\n;; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n;; Calculate spans\n\n(define (hspan entry)\n  ;; Returns the horizontal span of an entry\n  (let* ((spanname (attribute-string (normalize "spanname") entry))\n\011 (namest   (if spanname\n\011\011       (spanspec-namest (find-spanspec spanname))\n\011\011       (attribute-string (normalize "namest") entry)))\n\011 (nameend  (if spanname\n\011\011       (spanspec-nameend (find-spanspec spanname))\n\011\011       (attribute-string (normalize "nameend") entry)))\n\011 (colst    (if namest\n\011\011       (colspec-colnum (find-colspec namest))\n\011\011       #f))\n\011 (colend   (if nameend\n\011\011       (colspec-colnum (find-colspec nameend))\n\011\011       #f)))\n    (if (and namest nameend)\n\011(+ (- colend colst) 1)\n\0111)))\n\n(define (vspan entry)\n  ;; Returns the vertical span of an entry.  Note that this is one more\n  ;; than the specified MOREROWS attribute.\n  (let* ((morerows (attribute-string (normalize "morerows") entry)))\n    (if morerows\n\011(+ (string->number morerows) 1)\n\0111)))\n\n;; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n;; Update the "overhang" list\n\n(define (adjust-overhang overhang oldoverhang entry)\n  (let* ((colst    (cell-column-number entry oldoverhang))\n\011 (span     (hspan entry)))\n    (if (> (vspan entry) 1)\n\011(list-put overhang colst (- (vspan entry) 1) span)\n\011overhang)))\n\n(define (overhang-skip overhang startcol)\n  (if (> startcol (length overhang))\n      ;; this is a _broken_ table.  should I output a debug message!?\n      startcol\n      (let loop ((overtail (list-tail overhang (- startcol 1))) (col startcol))\n\011(if (null? overtail)\n\011    col\n\011    (if (equal? (car overtail) 0)\n\011\011col\n\011\011(loop (cdr overtail) (+ col 1)))))))\n\n(define (update-overhang row oldoverhang)\n  (let loop ((overhang (decrement-list-members oldoverhang))\n\011     (entries  (node-list-filter-out-pis (children row))))\n    (if (node-list-empty? entries)\n\011overhang\n\011(loop (adjust-overhang overhang oldoverhang \n\011\011\011       (node-list-first entries))\n\011      (node-list-rest entries)))))\n\n;; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n;; Calculate information about cells\n\n(define (cell-prev-cell entry)\n  ;; Return the cell which precedes entry in the current row.\n  (let loop ((nd (ipreced entry)))\n    (if (node-list-empty? nd)\n\011nd\n\011(if (equal? (node-property 'class-name nd) 'element)\n\011    nd\n\011    (loop (ipreced nd))))))\n\n(define (cell-column-number entry overhang)\n  (let* ((entry     (ancestor-member entry (list (normalize "entry") (normalize "entrytbl"))))\n\011 (row       (ancestor (normalize "row") entry))\n\011 (preventry (cell-prev-cell entry))\n\011 (prevspan  (if (node-list-empty? preventry) 1 (hspan preventry)))\n\011 (colname   (attribute-string (normalize "colname") entry))\n\011 (namest    (attribute-string (normalize "namest") entry))\n\011 (nameend   (attribute-string (normalize "nameend") entry))\n\011 (spanname  (attribute-string (normalize "spanname") entry)))\n    (if colname\n\011(colspec-colnum (find-colspec colname))\n\011(if spanname\n\011    (colspec-colnum (find-colspec \n\011\011\011     (spanspec-namest (find-spanspec spanname))))\n\011    (if namest\n\011\011(colspec-colnum (find-colspec namest))\n\011\011(if (node-list-empty? preventry)\n\011\011    (overhang-skip overhang 1)\n\011\011    (overhang-skip overhang \n\011\011\011\011   (+ (cell-column-number preventry overhang) \n\011\011\011\011   prevspan))))))))\n\n;; ======================================================================\n  \n\n;; $Id: dbl10n.dsl,v 1.8 2004/10/09 21:36:35 petere78 Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://nwalsh.com/docbook/dsssl/\n;;\n\n;; ----------------------------- Localization -----------------------------\n\n;; If you create a new version of this file, please send it to\n;; Norman Walsh, ndw@nwalsh.com.  Please use the ISO 639 language\n;; code to identify the language.  Append a subtag as per RFC 1766,\n;; if necessary.\n\n;; The generated text for cross references to elements.  See dblink.dsl\n;; for a discussion of how substitution is performed on the %x and #x\n;; keywords.\n;;\n\n;; The following language codes from ISO 639 are recognized:\n;; af - Afrikaans                           1.71\n;; bg - Bulgarian\n;; bs - Bosnian\n;; ca - Catalan\n;; cs - Czech\n;; da - Danish (previously dk)\n;; de - German (previously dege)\n;; el - Greek\n;; en - English (previously usen)\n;; es - Spanish\n;; et - Estonian                            1.55\n;; eu - Basque                              1.74\n;; fi - Finnish\n;; fr - French\n;; hu - Hungarian                           1.55\n;; id - Indonesian                          1.55\n;; it - Italian\n;; ja - Japanese\n;; ko - Korean                              1.59\n;; nl - Dutch\n;; nn - Nnyorsk                             1.74\n;; no - Norwegian (previously bmno) ???\n;; pl - Polish\n;; pt - Portuguese\n;; pt_br - Portuguese (Brazil)\n;; ro - Romanian\n;; ru - Russian\n;; sk - Slovak\n;; sl - Slovenian                           1.55\n;; sr - Serbian                             1.70\n;; sv - Swedish (previously svse)\n;; tr - Turkish                             1.71\n;; uk - Ukranian                            1.74\n;; xh - Xhosa                               1.74\n;; zh_cn - Chinese (Continental)            1.55\n;; zh_tw - Chinese (Traditional)            1.70\n\n;; The following language codes are recognized for historical reasons:\n\n;; bmno(no) - Norwegian (Norsk Bokmal) ???\n;; dege(de) - German\n;; dk(da)   - Danish\n;; svse(sv) - Swedish\n;; usen(en) - English\n\n(define %default-language% "en")\n(define %gentext-language% #f)\n(define %gentext-use-xref-lang% #f)\n\n(define ($lang$ #!optional (target (current-node)) (xref-context #f))\n  (if %gentext-language%\n      (lang-fix %gentext-language%)\n      (if (or xref-context %gentext-use-xref-lang%)\n\011  (let loop ((here target))\n\011    (if (node-list-empty? here)\n\011\011(lang-fix %default-language%)\n\011\011(if (attribute-string (normalize "lang") here)\n\011\011    (lang-fix (attribute-string (normalize "lang") here))\n\011\011    (loop (parent here)))))\n\011  (if (inherited-attribute-string (normalize "lang"))\n\011      (lang-fix (inherited-attribute-string (normalize "lang")))\n\011      (lang-fix %default-language%)))))\n\n(define (lang-fix language)\n  ;; Lowercase the language\n  ;; Translate 'xx-yy' to 'xx_yy'\n  (let ((fixed-lang (if (> (string-index language "-") 0)\n\011\011\011(let ((pos (string-index language "-")))\n\011\011\011  (string-append\n\011\011\011   (substring language 0 pos)\n\011\011\011   "_"\n\011\011\011   (substring language (+ pos 1)\n\011\011\011\011      (string-length language))))\n\011\011\011language)))\n    (case-fold-down fixed-lang)))\n\n(define (author-string #!optional (author (current-node)))\n  (let ((lang   (if (string? author) ($lang$) ($lang$ author))))\n    (case lang\n      ;; ISO 639/ISO 3166/RFC 1766\n         (("af")    (af-author-string author)) \n         (("bg")    (bg-author-string author)) \n         (("bs")    (bs-author-string author)) \n         (("ca")    (ca-author-string author)) \n         (("cs")    (cs-author-string author)) \n         (("da")    (da-author-string author)) \n         (("de")    (de-author-string author)) \n         (("el")    (el-author-string author)) \n         (("en")    (en-author-string author)) \n         (("es")    (es-author-string author)) \n         (("et")    (et-author-string author)) \n         (("eu")    (eu-author-string author)) \n         (("fi")    (fi-author-string author)) \n         (("fr")    (fr-author-string author)) \n         (("hu")    (hu-author-string author)) \n         (("id")    (id-author-string author)) \n         (("it")    (it-author-string author)) \n         (("ja")    (ja-author-string author)) \n         (("ko")    (ko-author-string author)) \n         (("nl")    (nl-author-string author)) \n         (("nn")    (nn-author-string author)) \n         (("no")    (no-author-string author)) \n         (("pl")    (pl-author-string author)) \n         (("pt")    (pt-author-string author)) \n         (("pt_br")    (ptbr-author-string author)) \n         (("ro")    (ro-author-string author)) \n         (("ru")    (ru-author-string author)) \n         (("sk")    (sk-author-string author)) \n         (("sl")    (sl-author-string author)) \n         (("sr")    (sr-author-string author)) \n         (("sv")    (sv-author-string author)) \n         (("tr")    (tr-author-string author)) \n         (("uk")    (uk-author-string author)) \n         (("xh")    (xh-author-string author)) \n         (("zh_cn")    (zhcn-author-string author)) \n         (("zh_tw")    (zhtw-author-string author)) \n         (("bmno")    (no-author-string author)) \n         (("dege")    (de-author-string author)) \n         (("dk")    (da-author-string author)) \n         (("svse")    (sv-author-string author)) \n         (("usen")    (en-author-string author)) \n      (else (error (string-append "L10N ERROR: author-string: "\n\011\011\011\011  lang))))))\n\n(define (gentext-xref-strings target)\n  (let ((giname (if (string? target) (normalize target) (gi target)))\n\011(lang   (if (string? target) ($lang$) ($lang$ target))))\n    (case lang\n       (("af") (gentext-af-xref-strings giname)) \n       (("bg") (gentext-bg-xref-strings giname)) \n       (("bs") (gentext-bs-xref-strings giname)) \n       (("ca") (gentext-ca-xref-strings giname)) \n       (("cs") (gentext-cs-xref-strings giname)) \n       (("da") (gentext-da-xref-strings giname)) \n       (("de") (gentext-de-xref-strings giname)) \n       (("el") (gentext-el-xref-strings giname)) \n       (("en") (gentext-en-xref-strings giname)) \n       (("es") (gentext-es-xref-strings giname)) \n       (("et") (gentext-et-xref-strings giname)) \n       (("eu") (gentext-eu-xref-strings giname)) \n       (("fi") (gentext-fi-xref-strings giname)) \n       (("fr") (gentext-fr-xref-strings giname)) \n       (("hu") (gentext-hu-xref-strings giname)) \n       (("id") (gentext-id-xref-strings giname)) \n       (("it") (gentext-it-xref-strings giname)) \n       (("ja") (gentext-ja-xref-strings giname)) \n       (("ko") (gentext-ko-xref-strings giname)) \n       (("nl") (gentext-nl-xref-strings giname)) \n       (("nn") (gentext-nn-xref-strings giname)) \n       (("no") (gentext-no-xref-strings giname)) \n       (("pl") (gentext-pl-xref-strings giname)) \n       (("pt") (gentext-pt-xref-strings giname)) \n       (("pt_br") (gentext-ptbr-xref-strings giname)) \n       (("ro") (gentext-ro-xref-strings giname)) \n       (("ru") (gentext-ru-xref-strings giname)) \n       (("sk") (gentext-sk-xref-strings giname)) \n       (("sl") (gentext-sl-xref-strings giname)) \n       (("sr") (gentext-sr-xref-strings giname)) \n       (("sv") (gentext-sv-xref-strings giname)) \n       (("tr") (gentext-tr-xref-strings giname)) \n       (("uk") (gentext-uk-xref-strings giname)) \n       (("xh") (gentext-xh-xref-strings giname)) \n       (("zh_cn") (gentext-zhcn-xref-strings giname)) \n       (("zh_tw") (gentext-zhtw-xref-strings giname)) \n       (("bmno") (gentext-no-xref-strings giname)) \n       (("dege") (gentext-de-xref-strings giname)) \n       (("dk") (gentext-da-xref-strings giname)) \n       (("svse") (gentext-sv-xref-strings giname)) \n       (("usen") (gentext-en-xref-strings giname)) \n      (else (error (string-append "L10N ERROR: gentext-xref-strings: " \n\011\011\011\011  lang))))))\n\n(define (auto-xref-indirect-connector before) \n  (case ($lang$)\n     (("af") (af-auto-xref-indirect-connector before)) \n     (("bg") (bg-auto-xref-indirect-connector before)) \n     (("bs") (bs-auto-xref-indirect-connector before)) \n     (("ca") (ca-auto-xref-indirect-connector before)) \n     (("cs") (cs-auto-xref-indirect-connector before)) \n     (("da") (da-auto-xref-indirect-connector before)) \n     (("de") (de-auto-xref-indirect-connector before)) \n     (("el") (el-auto-xref-indirect-connector before)) \n     (("en") (en-auto-xref-indirect-connector before)) \n     (("es") (es-auto-xref-indirect-connector before)) \n     (("et") (et-auto-xref-indirect-connector before)) \n     (("eu") (eu-auto-xref-indirect-connector before)) \n     (("fi") (fi-auto-xref-indirect-connector before)) \n     (("fr") (fr-auto-xref-indirect-connector before)) \n     (("hu") (hu-auto-xref-indirect-connector before)) \n     (("id") (id-auto-xref-indirect-connector before)) \n     (("it") (it-auto-xref-indirect-connector before)) \n     (("ja") (ja-auto-xref-indirect-connector before)) \n     (("ko") (ko-auto-xref-indirect-connector before)) \n     (("nl") (nl-auto-xref-indirect-connector before)) \n     (("nn") (nn-auto-xref-indirect-connector before)) \n     (("no") (no-auto-xref-indirect-connector before)) \n     (("pl") (pl-auto-xref-indirect-connector before)) \n     (("pt") (pt-auto-xref-indirect-connector before)) \n     (("pt_br") (ptbr-auto-xref-indirect-connector before)) \n     (("ro") (ro-auto-xref-indirect-connector before)) \n     (("ru") (ru-auto-xref-indirect-connector before)) \n     (("sk") (sk-auto-xref-indirect-connector before)) \n     (("sl") (sl-auto-xref-indirect-connector before)) \n     (("sr") (sr-auto-xref-indirect-connector before)) \n     (("sv") (sv-auto-xref-indirect-connector before)) \n     (("tr") (tr-auto-xref-indirect-connector before)) \n     (("uk") (uk-auto-xref-indirect-connector before)) \n     (("xh") (xh-auto-xref-indirect-connector before)) \n     (("zh_cn") (zhcn-auto-xref-indirect-connector before)) \n     (("zh_tw") (zhtw-auto-xref-indirect-connector before)) \n     (("bmno") (no-auto-xref-indirect-connector before)) \n     (("dege") (de-auto-xref-indirect-connector before)) \n     (("dk") (da-auto-xref-indirect-connector before)) \n     (("svse") (sv-auto-xref-indirect-connector before)) \n     (("usen") (en-auto-xref-indirect-connector before)) \n    (else (error "L10N ERROR: auto-xref-indirect-connector"))))\n\n(define (generate-toc-in-front)\n  (case ($lang$)\n     (("af") %generate-af-toc-in-front%) \n     (("bg") %generate-bg-toc-in-front%) \n     (("bs") %generate-bs-toc-in-front%) \n     (("ca") %generate-ca-toc-in-front%) \n     (("cs") %generate-cs-toc-in-front%) \n     (("da") %generate-da-toc-in-front%) \n     (("de") %generate-de-toc-in-front%) \n     (("el") %generate-el-toc-in-front%) \n     (("en") %generate-en-toc-in-front%) \n     (("es") %generate-es-toc-in-front%) \n     (("et") %generate-et-toc-in-front%) \n     (("eu") %generate-eu-toc-in-front%) \n     (("fi") %generate-fi-toc-in-front%) \n     (("fr") %generate-fr-toc-in-front%) \n     (("hu") %generate-hu-toc-in-front%) \n     (("id") %generate-id-toc-in-front%) \n     (("it") %generate-it-toc-in-front%) \n     (("ja") %generate-ja-toc-in-front%) \n     (("ko") %generate-ko-toc-in-front%) \n     (("nl") %generate-nl-toc-in-front%) \n     (("nn") %generate-nn-toc-in-front%) \n     (("no") %generate-no-toc-in-front%) \n     (("pl") %generate-pl-toc-in-front%) \n     (("pt") %generate-pt-toc-in-front%) \n     (("pt_br") %generate-ptbr-toc-in-front%) \n     (("ro") %generate-ro-toc-in-front%) \n     (("ru") %generate-ru-toc-in-front%) \n     (("sk") %generate-sk-toc-in-front%) \n     (("sl") %generate-sl-toc-in-front%) \n     (("sr") %generate-sr-toc-in-front%) \n     (("sv") %generate-sv-toc-in-front%) \n     (("tr") %generate-tr-toc-in-front%) \n     (("uk") %generate-uk-toc-in-front%) \n     (("xh") %generate-xh-toc-in-front%) \n     (("zh_cn") %generate-zhcn-toc-in-front%) \n     (("zh_tw") %generate-zhtw-toc-in-front%) \n     (("bmno") %generate-no-toc-in-front%) \n     (("dege") %generate-de-toc-in-front%) \n     (("dk") %generate-da-toc-in-front%) \n     (("svse") %generate-sv-toc-in-front%) \n     (("usen") %generate-en-toc-in-front%) \n    (else (error "L10N ERROR: generate-toc-in-front"))))\n\n(define (gentext-element-name target)\n  (let ((giname (if (string? target) (normalize target) (gi target)))\n\011(lang   (if (string? target) ($lang$) ($lang$ target #t))))\n    (case lang\n       (("af") (gentext-af-element-name giname)) \n       (("bg") (gentext-bg-element-name giname)) \n       (("bs") (gentext-bs-element-name giname)) \n       (("ca") (gentext-ca-element-name giname)) \n       (("cs") (gentext-cs-element-name giname)) \n       (("da") (gentext-da-element-name giname)) \n       (("de") (gentext-de-element-name giname)) \n       (("el") (gentext-el-element-name giname)) \n       (("en") (gentext-en-element-name giname)) \n       (("es") (gentext-es-element-name giname)) \n       (("et") (gentext-et-element-name giname)) \n       (("eu") (gentext-eu-element-name giname)) \n       (("fi") (gentext-fi-element-name giname)) \n       (("fr") (gentext-fr-element-name giname)) \n       (("hu") (gentext-hu-element-name giname)) \n       (("id") (gentext-id-element-name giname)) \n       (("it") (gentext-it-element-name giname)) \n       (("ja") (gentext-ja-element-name giname)) \n       (("ko") (gentext-ko-element-name giname)) \n       (("nl") (gentext-nl-element-name giname)) \n       (("nn") (gentext-nn-element-name giname)) \n       (("no") (gentext-no-element-name giname)) \n       (("pl") (gentext-pl-element-name giname)) \n       (("pt") (gentext-pt-element-name giname)) \n       (("pt_br") (gentext-ptbr-element-name giname)) \n       (("ro") (gentext-ro-element-name giname)) \n       (("ru") (gentext-ru-element-name giname)) \n       (("sk") (gentext-sk-element-name giname)) \n       (("sl") (gentext-sl-element-name giname)) \n       (("sr") (gentext-sr-element-name giname)) \n       (("sv") (gentext-sv-element-name giname)) \n       (("tr") (gentext-tr-element-name giname)) \n       (("uk") (gentext-uk-element-name giname)) \n       (("xh") (gentext-xh-element-name giname)) \n       (("zh_cn") (gentext-zhcn-element-name giname)) \n       (("zh_tw") (gentext-zhtw-element-name giname)) \n       (("bmno") (gentext-no-element-name giname)) \n       (("dege") (gentext-de-element-name giname)) \n       (("dk") (gentext-da-element-name giname)) \n       (("svse") (gentext-sv-element-name giname)) \n       (("usen") (gentext-en-element-name giname)) \n      (else (error (string-append "L10N ERROR: gentext-element-name: "\n\011\011\011\011  lang\n\011\011\011\011  " ("\n\011\011\011\011  giname\n\011\011\011\011  ")"))))))\n\n(define (gentext-element-name-space target)\n  (let ((giname (if (string? target) (normalize target) (gi target)))\n\011(lang   (if (string? target) ($lang$) ($lang$ target))))\n    (case lang\n       (("af") (gentext-af-element-name-space giname)) \n       (("bg") (gentext-bg-element-name-space giname)) \n       (("bs") (gentext-bs-element-name-space giname)) \n       (("ca") (gentext-ca-element-name-space giname)) \n       (("cs") (gentext-cs-element-name-space giname)) \n       (("da") (gentext-da-element-name-space giname)) \n       (("de") (gentext-de-element-name-space giname)) \n       (("el") (gentext-el-element-name-space giname)) \n       (("en") (gentext-en-element-name-space giname)) \n       (("es") (gentext-es-element-name-space giname)) \n       (("et") (gentext-et-element-name-space giname)) \n       (("eu") (gentext-eu-element-name-space giname)) \n       (("fi") (gentext-fi-element-name-space giname)) \n       (("fr") (gentext-fr-element-name-space giname)) \n       (("hu") (gentext-hu-element-name-space giname)) \n       (("id") (gentext-id-element-name-space giname)) \n       (("it") (gentext-it-element-name-space giname)) \n       (("ja") (gentext-ja-element-name-space giname)) \n       (("ko") (gentext-ko-element-name-space giname)) \n       (("nl") (gentext-nl-element-name-space giname)) \n       (("nn") (gentext-nn-element-name-space giname)) \n       (("no") (gentext-no-element-name-space giname)) \n       (("pl") (gentext-pl-element-name-space giname)) \n       (("pt") (gentext-pt-element-name-space giname)) \n       (("pt_br") (gentext-ptbr-element-name-space giname)) \n       (("ro") (gentext-ro-element-name-space giname)) \n       (("ru") (gentext-ru-element-name-space giname)) \n       (("sk") (gentext-sk-element-name-space giname)) \n       (("sl") (gentext-sl-element-name-space giname)) \n       (("sr") (gentext-sr-element-name-space giname)) \n       (("sv") (gentext-sv-element-name-space giname)) \n       (("tr") (gentext-tr-element-name-space giname)) \n       (("uk") (gentext-uk-element-name-space giname)) \n       (("xh") (gentext-xh-element-name-space giname)) \n       (("zh_cn") (gentext-zhcn-element-name-space giname)) \n       (("zh_tw") (gentext-zhtw-element-name-space giname)) \n       (("bmno") (gentext-no-element-name-space giname)) \n       (("dege") (gentext-de-element-name-space giname)) \n       (("dk") (gentext-da-element-name-space giname)) \n       (("svse") (gentext-sv-element-name-space giname)) \n       (("usen") (gentext-en-element-name-space giname)) \n      (else (error "L10N ERROR: gentext-element-name-space")))))\n\n(define (gentext-intra-label-sep target)\n  (let ((giname (if (string? target) (normalize target) (gi target)))\n\011(lang   (if (string? target) ($lang$) ($lang$ target))))\n    (case lang\n       (("af") (gentext-af-intra-label-sep giname)) \n       (("bg") (gentext-bg-intra-label-sep giname)) \n       (("bs") (gentext-bs-intra-label-sep giname)) \n       (("ca") (gentext-ca-intra-label-sep giname)) \n       (("cs") (gentext-cs-intra-label-sep giname)) \n       (("da") (gentext-da-intra-label-sep giname)) \n       (("de") (gentext-de-intra-label-sep giname)) \n       (("el") (gentext-el-intra-label-sep giname)) \n       (("en") (gentext-en-intra-label-sep giname)) \n       (("es") (gentext-es-intra-label-sep giname)) \n       (("et") (gentext-et-intra-label-sep giname)) \n       (("eu") (gentext-eu-intra-label-sep giname)) \n       (("fi") (gentext-fi-intra-label-sep giname)) \n       (("fr") (gentext-fr-intra-label-sep giname)) \n       (("hu") (gentext-hu-intra-label-sep giname)) \n       (("id") (gentext-id-intra-label-sep giname)) \n       (("it") (gentext-it-intra-label-sep giname)) \n       (("ja") (gentext-ja-intra-label-sep giname)) \n       (("ko") (gentext-ko-intra-label-sep giname)) \n       (("nl") (gentext-nl-intra-label-sep giname)) \n       (("nn") (gentext-nn-intra-label-sep giname)) \n       (("no") (gentext-no-intra-label-sep giname)) \n       (("pl") (gentext-pl-intra-label-sep giname)) \n       (("pt") (gentext-pt-intra-label-sep giname)) \n       (("pt_br") (gentext-ptbr-intra-label-sep giname)) \n       (("ro") (gentext-ro-intra-label-sep giname)) \n       (("ru") (gentext-ru-intra-label-sep giname)) \n       (("sk") (gentext-sk-intra-label-sep giname)) \n       (("sl") (gentext-sl-intra-label-sep giname)) \n       (("sr") (gentext-sr-intra-label-sep giname)) \n       (("sv") (gentext-sv-intra-label-sep giname)) \n       (("tr") (gentext-tr-intra-label-sep giname)) \n       (("uk") (gentext-uk-intra-label-sep giname)) \n       (("xh") (gentext-xh-intra-label-sep giname)) \n       (("zh_cn") (gentext-zhcn-intra-label-sep giname)) \n       (("zh_tw") (gentext-zhtw-intra-label-sep giname)) \n       (("bmno") (gentext-no-intra-label-sep giname)) \n       (("dege") (gentext-de-intra-label-sep giname)) \n       (("dk") (gentext-da-intra-label-sep giname)) \n       (("svse") (gentext-sv-intra-label-sep giname)) \n       (("usen") (gentext-en-intra-label-sep giname)) \n      (else (error "L10N ERROR: gentext-intra-label-sep")))))\n\n(define (gentext-label-title-sep target)\n  (let ((giname (if (string? target) (normalize target) (gi target)))\n\011(lang   (if (string? target) ($lang$) ($lang$ target))))\n    (case lang\n       (("af") (gentext-af-label-title-sep giname)) \n       (("bg") (gentext-bg-label-title-sep giname)) \n       (("bs") (gentext-bs-label-title-sep giname)) \n       (("ca") (gentext-ca-label-title-sep giname)) \n       (("cs") (gentext-cs-label-title-sep giname)) \n       (("da") (gentext-da-label-title-sep giname)) \n       (("de") (gentext-de-label-title-sep giname)) \n       (("el") (gentext-el-label-title-sep giname)) \n       (("en") (gentext-en-label-title-sep giname)) \n       (("es") (gentext-es-label-title-sep giname)) \n       (("et") (gentext-et-label-title-sep giname)) \n       (("eu") (gentext-eu-label-title-sep giname)) \n       (("fi") (gentext-fi-label-title-sep giname)) \n       (("fr") (gentext-fr-label-title-sep giname)) \n       (("hu") (gentext-hu-label-title-sep giname)) \n       (("id") (gentext-id-label-title-sep giname)) \n       (("it") (gentext-it-label-title-sep giname)) \n       (("ja") (gentext-ja-label-title-sep giname)) \n       (("ko") (gentext-ko-label-title-sep giname)) \n       (("nl") (gentext-nl-label-title-sep giname)) \n       (("nn") (gentext-nn-label-title-sep giname)) \n       (("no") (gentext-no-label-title-sep giname)) \n       (("pl") (gentext-pl-label-title-sep giname)) \n       (("pt") (gentext-pt-label-title-sep giname)) \n       (("pt_br") (gentext-ptbr-label-title-sep giname)) \n       (("ro") (gentext-ro-label-title-sep giname)) \n       (("ru") (gentext-ru-label-title-sep giname)) \n       (("sk") (gentext-sk-label-title-sep giname)) \n       (("sl") (gentext-sl-label-title-sep giname)) \n       (("sr") (gentext-sr-label-title-sep giname)) \n       (("sv") (gentext-sv-label-title-sep giname)) \n       (("tr") (gentext-tr-label-title-sep giname)) \n       (("uk") (gentext-uk-label-title-sep giname)) \n       (("xh") (gentext-xh-label-title-sep giname)) \n       (("zh_cn") (gentext-zhcn-label-title-sep giname)) \n       (("zh_tw") (gentext-zhtw-label-title-sep giname)) \n       (("bmno") (gentext-no-label-title-sep giname)) \n       (("dege") (gentext-de-label-title-sep giname)) \n       (("dk") (gentext-da-label-title-sep giname)) \n       (("svse") (gentext-sv-label-title-sep giname)) \n       (("usen") (gentext-en-label-title-sep giname)) \n      (else (error "L10N ERROR: gentext-label-title-sep")))))\n\n(define (label-number-format target)\n  (let ((giname (if (string? target) (normalize target) (gi target)))\n\011(lang   (if (string? target) ($lang$) ($lang$ target))))\n    (case lang\n       (("af") (af-label-number-format target)) \n       (("bg") (bg-label-number-format target)) \n       (("bs") (bs-label-number-format target)) \n       (("ca") (ca-label-number-format target)) \n       (("cs") (cs-label-number-format target)) \n       (("da") (da-label-number-format target)) \n       (("de") (de-label-number-format target)) \n       (("el") (el-label-number-format target)) \n       (("en") (en-label-number-format target)) \n       (("es") (es-label-number-format target)) \n       (("et") (et-label-number-format target)) \n       (("eu") (eu-label-number-format target)) \n       (("fi") (fi-label-number-format target)) \n       (("fr") (fr-label-number-format target)) \n       (("hu") (hu-label-number-format target)) \n       (("id") (id-label-number-format target)) \n       (("it") (it-label-number-format target)) \n       (("ja") (ja-label-number-format target)) \n       (("ko") (ko-label-number-format target)) \n       (("nl") (nl-label-number-format target)) \n       (("nn") (nn-label-number-format target)) \n       (("no") (no-label-number-format target)) \n       (("pl") (pl-label-number-format target)) \n       (("pt") (pt-label-number-format target)) \n       (("pt_br") (ptbr-label-number-format target)) \n       (("ro") (ro-label-number-format target)) \n       (("ru") (ru-label-number-format target)) \n       (("sk") (sk-label-number-format target)) \n       (("sl") (sl-label-number-format target)) \n       (("sr") (sr-label-number-format target)) \n       (("sv") (sv-label-number-format target)) \n       (("tr") (tr-label-number-format target)) \n       (("uk") (uk-label-number-format target)) \n       (("xh") (xh-label-number-format target)) \n       (("zh_cn") (zhcn-label-number-format target)) \n       (("zh_tw") (zhtw-label-number-format target)) \n       (("bmno") (no-label-number-format target)) \n       (("dege") (de-label-number-format target)) \n       (("dk") (da-label-number-format target)) \n       (("svse") (sv-label-number-format target)) \n       (("usen") (en-label-number-format target)) \n      (else (error "L10N ERROR: label-number-format")))))\n\n(define ($lot-title$ lotgi)\n  (case ($lang$)\n     (("af") ($lot-title-af$ lotgi)) \n     (("bg") ($lot-title-bg$ lotgi)) \n     (("bs") ($lot-title-bs$ lotgi)) \n     (("ca") ($lot-title-ca$ lotgi)) \n     (("cs") ($lot-title-cs$ lotgi)) \n     (("da") ($lot-title-da$ lotgi)) \n     (("de") ($lot-title-de$ lotgi)) \n     (("el") ($lot-title-el$ lotgi)) \n     (("en") ($lot-title-en$ lotgi)) \n     (("es") ($lot-title-es$ lotgi)) \n     (("et") ($lot-title-et$ lotgi)) \n     (("eu") ($lot-title-eu$ lotgi)) \n     (("fi") ($lot-title-fi$ lotgi)) \n     (("fr") ($lot-title-fr$ lotgi)) \n     (("hu") ($lot-title-hu$ lotgi)) \n     (("id") ($lot-title-id$ lotgi)) \n     (("it") ($lot-title-it$ lotgi)) \n     (("ja") ($lot-title-ja$ lotgi)) \n     (("ko") ($lot-title-ko$ lotgi)) \n     (("nl") ($lot-title-nl$ lotgi)) \n     (("nn") ($lot-title-nn$ lotgi)) \n     (("no") ($lot-title-no$ lotgi)) \n     (("pl") ($lot-title-pl$ lotgi)) \n     (("pt") ($lot-title-pt$ lotgi)) \n     (("pt_br") ($lot-title-ptbr$ lotgi)) \n     (("ro") ($lot-title-ro$ lotgi)) \n     (("ru") ($lot-title-ru$ lotgi)) \n     (("sk") ($lot-title-sk$ lotgi)) \n     (("sl") ($lot-title-sl$ lotgi)) \n     (("sr") ($lot-title-sr$ lotgi)) \n     (("sv") ($lot-title-sv$ lotgi)) \n     (("tr") ($lot-title-tr$ lotgi)) \n     (("uk") ($lot-title-uk$ lotgi)) \n     (("xh") ($lot-title-xh$ lotgi)) \n     (("zh_cn") ($lot-title-zhcn$ lotgi)) \n     (("zh_tw") ($lot-title-zhtw$ lotgi)) \n     (("bmno") ($lot-title-no$ lotgi)) \n     (("dege") ($lot-title-de$ lotgi)) \n     (("dk") ($lot-title-da$ lotgi)) \n     (("svse") ($lot-title-sv$ lotgi)) \n     (("usen") ($lot-title-en$ lotgi)) \n    (else (error "L10N ERROR: $lot-title$"))))\n\n(define (gentext-start-quote)\n  (case ($lang$)\n     (("af") %gentext-af-start-quote%) \n     (("bg") %gentext-bg-start-quote%) \n     (("bs") %gentext-bs-start-quote%) \n     (("ca") %gentext-ca-start-quote%) \n     (("cs") %gentext-cs-start-quote%) \n     (("da") %gentext-da-start-quote%) \n     (("de") %gentext-de-start-quote%) \n     (("el") %gentext-el-start-quote%) \n     (("en") %gentext-en-start-quote%) \n     (("es") %gentext-es-start-quote%) \n     (("et") %gentext-et-start-quote%) \n     (("eu") %gentext-eu-start-quote%) \n     (("fi") %gentext-fi-start-quote%) \n     (("fr") %gentext-fr-start-quote%) \n     (("hu") %gentext-hu-start-quote%) \n     (("id") %gentext-id-start-quote%) \n     (("it") %gentext-it-start-quote%) \n     (("ja") %gentext-ja-start-quote%) \n     (("ko") %gentext-ko-start-quote%) \n     (("nl") %gentext-nl-start-quote%) \n     (("nn") %gentext-nn-start-quote%) \n     (("no") %gentext-no-start-quote%) \n     (("pl") %gentext-pl-start-quote%) \n     (("pt") %gentext-pt-start-quote%) \n     (("pt_br") %gentext-ptbr-start-quote%) \n     (("ro") %gentext-ro-start-quote%) \n     (("ru") %gentext-ru-start-quote%) \n     (("sk") %gentext-sk-start-quote%) \n     (("sl") %gentext-sl-start-quote%) \n     (("sr") %gentext-sr-start-quote%) \n     (("sv") %gentext-sv-start-quote%) \n     (("tr") %gentext-tr-start-quote%) \n     (("uk") %gentext-uk-start-quote%) \n     (("xh") %gentext-xh-start-quote%) \n     (("zh_cn") %gentext-zhcn-start-quote%) \n     (("zh_tw") %gentext-zhtw-start-quote%) \n     (("bmno") %gentext-no-start-quote%) \n     (("dege") %gentext-de-start-quote%) \n     (("dk") %gentext-da-start-quote%) \n     (("svse") %gentext-sv-start-quote%) \n     (("usen") %gentext-en-start-quote%) \n    (else (error "L10N ERROR: gentext-start-quote"))))\n\n(define (gentext-end-quote)\n  (case ($lang$)\n     (("af") %gentext-af-end-quote%) \n     (("bg") %gentext-bg-end-quote%) \n     (("bs") %gentext-bs-end-quote%) \n     (("ca") %gentext-ca-end-quote%) \n     (("cs") %gentext-cs-end-quote%) \n     (("da") %gentext-da-end-quote%) \n     (("de") %gentext-de-end-quote%) \n     (("el") %gentext-el-end-quote%) \n     (("en") %gentext-en-end-quote%) \n     (("es") %gentext-es-end-quote%) \n     (("et") %gentext-et-end-quote%) \n     (("eu") %gentext-eu-end-quote%) \n     (("fi") %gentext-fi-end-quote%) \n     (("fr") %gentext-fr-end-quote%) \n     (("hu") %gentext-hu-end-quote%) \n     (("id") %gentext-id-end-quote%) \n     (("it") %gentext-it-end-quote%) \n     (("ja") %gentext-ja-end-quote%) \n     (("ko") %gentext-ko-end-quote%) \n     (("nl") %gentext-nl-end-quote%) \n     (("nn") %gentext-nn-end-quote%) \n     (("no") %gentext-no-end-quote%) \n     (("pl") %gentext-pl-end-quote%) \n     (("pt") %gentext-pt-end-quote%) \n     (("pt_br") %gentext-ptbr-end-quote%) \n     (("ro") %gentext-ro-end-quote%) \n     (("ru") %gentext-ru-end-quote%) \n     (("sk") %gentext-sk-end-quote%) \n     (("sl") %gentext-sl-end-quote%) \n     (("sr") %gentext-sr-end-quote%) \n     (("sv") %gentext-sv-end-quote%) \n     (("tr") %gentext-tr-end-quote%) \n     (("uk") %gentext-uk-end-quote%) \n     (("xh") %gentext-xh-end-quote%) \n     (("zh_cn") %gentext-zhcn-end-quote%) \n     (("zh_tw") %gentext-zhtw-end-quote%) \n     (("bmno") %gentext-no-end-quote%) \n     (("dege") %gentext-de-end-quote%) \n     (("dk") %gentext-da-end-quote%) \n     (("svse") %gentext-sv-end-quote%) \n     (("usen") %gentext-en-end-quote%) \n    (else (error "L10N ERROR: gentext-end-quote"))))\n\n(define (gentext-start-nested-quote)\n  (case ($lang$)\n     (("af") %gentext-af-start-nested-quote%) \n     (("bg") %gentext-bg-start-nested-quote%) \n     (("bs") %gentext-bs-start-nested-quote%) \n     (("ca") %gentext-ca-start-nested-quote%) \n     (("cs") %gentext-cs-start-nested-quote%) \n     (("da") %gentext-da-start-nested-quote%) \n     (("de") %gentext-de-start-nested-quote%) \n     (("el") %gentext-el-start-nested-quote%) \n     (("en") %gentext-en-start-nested-quote%) \n     (("es") %gentext-es-start-nested-quote%) \n     (("et") %gentext-et-start-nested-quote%) \n     (("eu") %gentext-eu-start-nested-quote%) \n     (("fi") %gentext-fi-start-nested-quote%) \n     (("fr") %gentext-fr-start-nested-quote%) \n     (("hu") %gentext-hu-start-nested-quote%) \n     (("id") %gentext-id-start-nested-quote%) \n     (("it") %gentext-it-start-nested-quote%) \n     (("ja") %gentext-ja-start-nested-quote%) \n     (("ko") %gentext-ko-start-nested-quote%) \n     (("nl") %gentext-nl-start-nested-quote%) \n     (("nn") %gentext-nn-start-nested-quote%) \n     (("no") %gentext-no-start-nested-quote%) \n     (("pl") %gentext-pl-start-nested-quote%) \n     (("pt") %gentext-pt-start-nested-quote%) \n     (("pt_br") %gentext-ptbr-start-nested-quote%) \n     (("ro") %gentext-ro-start-nested-quote%) \n     (("ru") %gentext-ru-start-nested-quote%) \n     (("sk") %gentext-sk-start-nested-quote%) \n     (("sl") %gentext-sl-start-nested-quote%) \n     (("sr") %gentext-sr-start-nested-quote%) \n     (("sv") %gentext-sv-start-nested-quote%) \n     (("tr") %gentext-tr-start-nested-quote%) \n     (("uk") %gentext-uk-start-nested-quote%) \n     (("xh") %gentext-xh-start-nested-quote%) \n     (("zh_cn") %gentext-zhcn-start-nested-quote%) \n     (("zh_tw") %gentext-zhtw-start-nested-quote%) \n     (("bmno") %gentext-no-start-nested-quote%) \n     (("dege") %gentext-de-start-nested-quote%) \n     (("dk") %gentext-da-start-nested-quote%) \n     (("svse") %gentext-sv-start-nested-quote%) \n     (("usen") %gentext-en-start-nested-quote%) \n    (else (error "L10N ERROR: gentext-start-nested-quote"))))\n\n(define (gentext-end-nested-quote)\n  (case ($lang$)\n     (("af") %gentext-af-end-nested-quote%) \n     (("bg") %gentext-bg-end-nested-quote%) \n     (("bs") %gentext-bs-end-nested-quote%) \n     (("ca") %gentext-ca-end-nested-quote%) \n     (("cs") %gentext-cs-end-nested-quote%) \n     (("da") %gentext-da-end-nested-quote%) \n     (("de") %gentext-de-end-nested-quote%) \n     (("el") %gentext-el-end-nested-quote%) \n     (("en") %gentext-en-end-nested-quote%) \n     (("es") %gentext-es-end-nested-quote%) \n     (("et") %gentext-et-end-nested-quote%) \n     (("eu") %gentext-eu-end-nested-quote%) \n     (("fi") %gentext-fi-end-nested-quote%) \n     (("fr") %gentext-fr-end-nested-quote%) \n     (("hu") %gentext-hu-end-nested-quote%) \n     (("id") %gentext-id-end-nested-quote%) \n     (("it") %gentext-it-end-nested-quote%) \n     (("ja") %gentext-ja-end-nested-quote%) \n     (("ko") %gentext-ko-end-nested-quote%) \n     (("nl") %gentext-nl-end-nested-quote%) \n     (("nn") %gentext-nn-end-nested-quote%) \n     (("no") %gentext-no-end-nested-quote%) \n     (("pl") %gentext-pl-end-nested-quote%) \n     (("pt") %gentext-pt-end-nested-quote%) \n     (("pt_br") %gentext-ptbr-end-nested-quote%) \n     (("ro") %gentext-ro-end-nested-quote%) \n     (("ru") %gentext-ru-end-nested-quote%) \n     (("sk") %gentext-sk-end-nested-quote%) \n     (("sl") %gentext-sl-end-nested-quote%) \n     (("sr") %gentext-sr-end-nested-quote%) \n     (("sv") %gentext-sv-end-nested-quote%) \n     (("tr") %gentext-tr-end-nested-quote%) \n     (("uk") %gentext-uk-end-nested-quote%) \n     (("xh") %gentext-xh-end-nested-quote%) \n     (("zh_cn") %gentext-zhcn-end-nested-quote%) \n     (("zh_tw") %gentext-zhtw-end-nested-quote%) \n     (("bmno") %gentext-no-end-nested-quote%) \n     (("dege") %gentext-de-end-nested-quote%) \n     (("dk") %gentext-da-end-nested-quote%) \n     (("svse") %gentext-sv-end-nested-quote%) \n     (("usen") %gentext-en-end-nested-quote%) \n    (else (error "L10N ERROR: gentext-end-nested-quote"))))\n\n(define (gentext-by)\n  (case ($lang$)\n     (("af") %gentext-af-by%) \n     (("bg") %gentext-bg-by%) \n     (("bs") %gentext-bs-by%) \n     (("ca") %gentext-ca-by%) \n     (("cs") %gentext-cs-by%) \n     (("da") %gentext-da-by%) \n     (("de") %gentext-de-by%) \n     (("el") %gentext-el-by%) \n     (("en") %gentext-en-by%) \n     (("es") %gentext-es-by%) \n     (("et") %gentext-et-by%) \n     (("eu") %gentext-eu-by%) \n     (("fi") %gentext-fi-by%) \n     (("fr") %gentext-fr-by%) \n     (("hu") %gentext-hu-by%) \n     (("id") %gentext-id-by%) \n     (("it") %gentext-it-by%) \n     (("ja") %gentext-ja-by%) \n     (("ko") %gentext-ko-by%) \n     (("nl") %gentext-nl-by%) \n     (("nn") %gentext-nn-by%) \n     (("no") %gentext-no-by%) \n     (("pl") %gentext-pl-by%) \n     (("pt") %gentext-pt-by%) \n     (("pt_br") %gentext-ptbr-by%) \n     (("ro") %gentext-ro-by%) \n     (("ru") %gentext-ru-by%) \n     (("sk") %gentext-sk-by%) \n     (("sl") %gentext-sl-by%) \n     (("sr") %gentext-sr-by%) \n     (("sv") %gentext-sv-by%) \n     (("tr") %gentext-tr-by%) \n     (("uk") %gentext-uk-by%) \n     (("xh") %gentext-xh-by%) \n     (("zh_cn") %gentext-zhcn-by%) \n     (("zh_tw") %gentext-zhtw-by%) \n     (("bmno") %gentext-no-by%) \n     (("dege") %gentext-de-by%) \n     (("dk") %gentext-da-by%) \n     (("svse") %gentext-sv-by%) \n     (("usen") %gentext-en-by%) \n    (else (error "L10N ERROR: gentext-by"))))\n\n(define (gentext-edited-by)\n  (case ($lang$)\n     (("af") %gentext-af-edited-by%) \n     (("bg") %gentext-bg-edited-by%) \n     (("bs") %gentext-bs-edited-by%) \n     (("ca") %gentext-ca-edited-by%) \n     (("cs") %gentext-cs-edited-by%) \n     (("da") %gentext-da-edited-by%) \n     (("de") %gentext-de-edited-by%) \n     (("el") %gentext-el-edited-by%) \n     (("en") %gentext-en-edited-by%) \n     (("es") %gentext-es-edited-by%) \n     (("et") %gentext-et-edited-by%) \n     (("eu") %gentext-eu-edited-by%) \n     (("fi") %gentext-fi-edited-by%) \n     (("fr") %gentext-fr-edited-by%) \n     (("hu") %gentext-hu-edited-by%) \n     (("id") %gentext-id-edited-by%) \n     (("it") %gentext-it-edited-by%) \n     (("ja") %gentext-ja-edited-by%) \n     (("ko") %gentext-ko-edited-by%) \n     (("nl") %gentext-nl-edited-by%) \n     (("nn") %gentext-nn-edited-by%) \n     (("no") %gentext-no-edited-by%) \n     (("pl") %gentext-pl-edited-by%) \n     (("pt") %gentext-pt-edited-by%) \n     (("pt_br") %gentext-ptbr-edited-by%) \n     (("ro") %gentext-ro-edited-by%) \n     (("ru") %gentext-ru-edited-by%) \n     (("sk") %gentext-sk-edited-by%) \n     (("sl") %gentext-sl-edited-by%) \n     (("sr") %gentext-sr-edited-by%) \n     (("sv") %gentext-sv-edited-by%) \n     (("tr") %gentext-tr-edited-by%) \n     (("uk") %gentext-uk-edited-by%) \n     (("xh") %gentext-xh-edited-by%) \n     (("zh_cn") %gentext-zhcn-edited-by%) \n     (("zh_tw") %gentext-zhtw-edited-by%) \n     (("bmno") %gentext-no-edited-by%) \n     (("dege") %gentext-de-edited-by%) \n     (("dk") %gentext-da-edited-by%) \n     (("svse") %gentext-sv-edited-by%) \n     (("usen") %gentext-en-edited-by%) \n    (else (error "L10N ERROR: gentext-edited-by"))))\n\n(define (gentext-revised-by)\n  (case ($lang$)\n     (("af") %gentext-af-revised-by%) \n     (("bg") %gentext-bg-revised-by%) \n     (("bs") %gentext-bs-revised-by%) \n     (("ca") %gentext-ca-revised-by%) \n     (("cs") %gentext-cs-revised-by%) \n     (("da") %gentext-da-revised-by%) \n     (("de") %gentext-de-revised-by%) \n     (("el") %gentext-el-revised-by%) \n     (("en") %gentext-en-revised-by%) \n     (("es") %gentext-es-revised-by%) \n     (("et") %gentext-et-revised-by%) \n     (("eu") %gentext-eu-revised-by%) \n     (("fi") %gentext-fi-revised-by%) \n     (("fr") %gentext-fr-revised-by%) \n     (("hu") %gentext-hu-revised-by%) \n     (("id") %gentext-id-revised-by%) \n     (("it") %gentext-it-revised-by%) \n     (("ja") %gentext-ja-revised-by%) \n     (("ko") %gentext-ko-revised-by%) \n     (("nl") %gentext-nl-revised-by%) \n     (("nn") %gentext-nn-revised-by%) \n     (("no") %gentext-no-revised-by%) \n     (("pl") %gentext-pl-revised-by%) \n     (("pt") %gentext-pt-revised-by%) \n     (("pt_br") %gentext-ptbr-revised-by%) \n     (("ro") %gentext-ro-revised-by%) \n     (("ru") %gentext-ru-revised-by%) \n     (("sk") %gentext-sk-revised-by%) \n     (("sl") %gentext-sl-revised-by%) \n     (("sr") %gentext-sr-revised-by%) \n     (("sv") %gentext-sv-revised-by%) \n     (("tr") %gentext-tr-revised-by%) \n     (("uk") %gentext-uk-revised-by%) \n     (("xh") %gentext-xh-revised-by%) \n     (("zh_cn") %gentext-zhcn-revised-by%) \n     (("zh_tw") %gentext-zhtw-revised-by%) \n     (("bmno") %gentext-no-revised-by%) \n     (("dege") %gentext-de-revised-by%) \n     (("dk") %gentext-da-revised-by%) \n     (("svse") %gentext-sv-revised-by%) \n     (("usen") %gentext-en-revised-by%) \n    (else (error "L10N ERROR: gentext-revised-by"))))\n\n(define (gentext-page)\n  (case ($lang$)\n     (("af") %gentext-af-page%) \n     (("bg") %gentext-bg-page%) \n     (("bs") %gentext-bs-page%) \n     (("ca") %gentext-ca-page%) \n     (("cs") %gentext-cs-page%) \n     (("da") %gentext-da-page%) \n     (("de") %gentext-de-page%) \n     (("el") %gentext-el-page%) \n     (("en") %gentext-en-page%) \n     (("es") %gentext-es-page%) \n     (("et") %gentext-et-page%) \n     (("eu") %gentext-eu-page%) \n     (("fi") %gentext-fi-page%) \n     (("fr") %gentext-fr-page%) \n     (("hu") %gentext-hu-page%) \n     (("id") %gentext-id-page%) \n     (("it") %gentext-it-page%) \n     (("ja") %gentext-ja-page%) \n     (("ko") %gentext-ko-page%) \n     (("nl") %gentext-nl-page%) \n     (("nn") %gentext-nn-page%) \n     (("no") %gentext-no-page%) \n     (("pl") %gentext-pl-page%) \n     (("pt") %gentext-pt-page%) \n     (("pt_br") %gentext-ptbr-page%) \n     (("ro") %gentext-ro-page%) \n     (("ru") %gentext-ru-page%) \n     (("sk") %gentext-sk-page%) \n     (("sl") %gentext-sl-page%) \n     (("sr") %gentext-sr-page%) \n     (("sv") %gentext-sv-page%) \n     (("tr") %gentext-tr-page%) \n     (("uk") %gentext-uk-page%) \n     (("xh") %gentext-xh-page%) \n     (("zh_cn") %gentext-zhcn-page%) \n     (("zh_tw") %gentext-zhtw-page%) \n     (("bmno") %gentext-no-page%) \n     (("dege") %gentext-de-page%) \n     (("dk") %gentext-da-page%) \n     (("svse") %gentext-sv-page%) \n     (("usen") %gentext-en-page%) \n    (else (error "L10N ERROR: gentext-page"))))\n\n(define (gentext-and)\n  (case ($lang$)\n     (("af") %gentext-af-and%) \n     (("bg") %gentext-bg-and%) \n     (("bs") %gentext-bs-and%) \n     (("ca") %gentext-ca-and%) \n     (("cs") %gentext-cs-and%) \n     (("da") %gentext-da-and%) \n     (("de") %gentext-de-and%) \n     (("el") %gentext-el-and%) \n     (("en") %gentext-en-and%) \n     (("es") %gentext-es-and%) \n     (("et") %gentext-et-and%) \n     (("eu") %gentext-eu-and%) \n     (("fi") %gentext-fi-and%) \n     (("fr") %gentext-fr-and%) \n     (("hu") %gentext-hu-and%) \n     (("id") %gentext-id-and%) \n     (("it") %gentext-it-and%) \n     (("ja") %gentext-ja-and%) \n     (("ko") %gentext-ko-and%) \n     (("nl") %gentext-nl-and%) \n     (("nn") %gentext-nn-and%) \n     (("no") %gentext-no-and%) \n     (("pl") %gentext-pl-and%) \n     (("pt") %gentext-pt-and%) \n     (("pt_br") %gentext-ptbr-and%) \n     (("ro") %gentext-ro-and%) \n     (("ru") %gentext-ru-and%) \n     (("sk") %gentext-sk-and%) \n     (("sl") %gentext-sl-and%) \n     (("sr") %gentext-sr-and%) \n     (("sv") %gentext-sv-and%) \n     (("tr") %gentext-tr-and%) \n     (("uk") %gentext-uk-and%) \n     (("xh") %gentext-xh-and%) \n     (("zh_cn") %gentext-zhcn-and%) \n     (("zh_tw") %gentext-zhtw-and%) \n     (("bmno") %gentext-no-and%) \n     (("dege") %gentext-de-and%) \n     (("dk") %gentext-da-and%) \n     (("svse") %gentext-sv-and%) \n     (("usen") %gentext-en-and%) \n    (else (error "L10N ERROR: gentext-and"))))\n\n(define (gentext-listcomma)\n  (case ($lang$)\n     (("af") %gentext-af-listcomma%) \n     (("bg") %gentext-bg-listcomma%) \n     (("bs") %gentext-bs-listcomma%) \n     (("ca") %gentext-ca-listcomma%) \n     (("cs") %gentext-cs-listcomma%) \n     (("da") %gentext-da-listcomma%) \n     (("de") %gentext-de-listcomma%) \n     (("el") %gentext-el-listcomma%) \n     (("en") %gentext-en-listcomma%) \n     (("es") %gentext-es-listcomma%) \n     (("et") %gentext-et-listcomma%) \n     (("eu") %gentext-eu-listcomma%) \n     (("fi") %gentext-fi-listcomma%) \n     (("fr") %gentext-fr-listcomma%) \n     (("hu") %gentext-hu-listcomma%) \n     (("id") %gentext-id-listcomma%) \n     (("it") %gentext-it-listcomma%) \n     (("ja") %gentext-ja-listcomma%) \n     (("ko") %gentext-ko-listcomma%) \n     (("nl") %gentext-nl-listcomma%) \n     (("nn") %gentext-nn-listcomma%) \n     (("no") %gentext-no-listcomma%) \n     (("pl") %gentext-pl-listcomma%) \n     (("pt") %gentext-pt-listcomma%) \n     (("pt_br") %gentext-ptbr-listcomma%) \n     (("ro") %gentext-ro-listcomma%) \n     (("ru") %gentext-ru-listcomma%) \n     (("sk") %gentext-sk-listcomma%) \n     (("sl") %gentext-sl-listcomma%) \n     (("sr") %gentext-sr-listcomma%) \n     (("sv") %gentext-sv-listcomma%) \n     (("tr") %gentext-tr-listcomma%) \n     (("uk") %gentext-uk-listcomma%) \n     (("xh") %gentext-xh-listcomma%) \n     (("zh_cn") %gentext-zhcn-listcomma%) \n     (("zh_tw") %gentext-zhtw-listcomma%) \n     (("bmno") %gentext-no-listcomma%) \n     (("dege") %gentext-de-listcomma%) \n     (("dk") %gentext-da-listcomma%) \n     (("svse") %gentext-sv-listcomma%) \n     (("usen") %gentext-en-listcomma%) \n    (else (error "L10N ERROR: gentext-listcomma"))))\n\n(define (gentext-lastlistcomma)\n  (case ($lang$)\n     (("af") %gentext-af-lastlistcomma%) \n     (("bg") %gentext-bg-lastlistcomma%) \n     (("bs") %gentext-bs-lastlistcomma%) \n     (("ca") %gentext-ca-lastlistcomma%) \n     (("cs") %gentext-cs-lastlistcomma%) \n     (("da") %gentext-da-lastlistcomma%) \n     (("de") %gentext-de-lastlistcomma%) \n     (("el") %gentext-el-lastlistcomma%) \n     (("en") %gentext-en-lastlistcomma%) \n     (("es") %gentext-es-lastlistcomma%) \n     (("et") %gentext-et-lastlistcomma%) \n     (("eu") %gentext-eu-lastlistcomma%) \n     (("fi") %gentext-fi-lastlistcomma%) \n     (("fr") %gentext-fr-lastlistcomma%) \n     (("hu") %gentext-hu-lastlistcomma%) \n     (("id") %gentext-id-lastlistcomma%) \n     (("it") %gentext-it-lastlistcomma%) \n     (("ja") %gentext-ja-lastlistcomma%) \n     (("ko") %gentext-ko-lastlistcomma%) \n     (("nl") %gentext-nl-lastlistcomma%) \n     (("nn") %gentext-nn-lastlistcomma%) \n     (("no") %gentext-no-lastlistcomma%) \n     (("pl") %gentext-pl-lastlistcomma%) \n     (("pt") %gentext-pt-lastlistcomma%) \n     (("pt_br") %gentext-ptbr-lastlistcomma%) \n     (("ro") %gentext-ro-lastlistcomma%) \n     (("ru") %gentext-ru-lastlistcomma%) \n     (("sk") %gentext-sk-lastlistcomma%) \n     (("sl") %gentext-sl-lastlistcomma%) \n     (("sr") %gentext-sr-lastlistcomma%) \n     (("sv") %gentext-sv-lastlistcomma%) \n     (("tr") %gentext-tr-lastlistcomma%) \n     (("uk") %gentext-uk-lastlistcomma%) \n     (("xh") %gentext-xh-lastlistcomma%) \n     (("zh_cn") %gentext-zhcn-lastlistcomma%) \n     (("zh_tw") %gentext-zhtw-lastlistcomma%) \n     (("bmno") %gentext-no-lastlistcomma%) \n     (("dege") %gentext-de-lastlistcomma%) \n     (("dk") %gentext-da-lastlistcomma%) \n     (("svse") %gentext-sv-lastlistcomma%) \n     (("usen") %gentext-en-lastlistcomma%) \n    (else (error "L10N ERROR: gentext-lastlistcomma"))))\n\n(define (gentext-bibl-pages)\n  (case ($lang$)\n     (("af") %gentext-af-bibl-pages%) \n     (("bg") %gentext-bg-bibl-pages%) \n     (("bs") %gentext-bs-bibl-pages%) \n     (("ca") %gentext-ca-bibl-pages%) \n     (("cs") %gentext-cs-bibl-pages%) \n     (("da") %gentext-da-bibl-pages%) \n     (("de") %gentext-de-bibl-pages%) \n     (("el") %gentext-el-bibl-pages%) \n     (("en") %gentext-en-bibl-pages%) \n     (("es") %gentext-es-bibl-pages%) \n     (("et") %gentext-et-bibl-pages%) \n     (("eu") %gentext-eu-bibl-pages%) \n     (("fi") %gentext-fi-bibl-pages%) \n     (("fr") %gentext-fr-bibl-pages%) \n     (("hu") %gentext-hu-bibl-pages%) \n     (("id") %gentext-id-bibl-pages%) \n     (("it") %gentext-it-bibl-pages%) \n     (("ja") %gentext-ja-bibl-pages%) \n     (("ko") %gentext-ko-bibl-pages%) \n     (("nl") %gentext-nl-bibl-pages%) \n     (("nn") %gentext-nn-bibl-pages%) \n     (("no") %gentext-no-bibl-pages%) \n     (("pl") %gentext-pl-bibl-pages%) \n     (("pt") %gentext-pt-bibl-pages%) \n     (("pt_br") %gentext-ptbr-bibl-pages%) \n     (("ro") %gentext-ro-bibl-pages%) \n     (("ru") %gentext-ru-bibl-pages%) \n     (("sk") %gentext-sk-bibl-pages%) \n     (("sl") %gentext-sl-bibl-pages%) \n     (("sr") %gentext-sr-bibl-pages%) \n     (("sv") %gentext-sv-bibl-pages%) \n     (("tr") %gentext-tr-bibl-pages%) \n     (("uk") %gentext-uk-bibl-pages%) \n     (("xh") %gentext-xh-bibl-pages%) \n     (("zh_cn") %gentext-zhcn-bibl-pages%) \n     (("zh_tw") %gentext-zhtw-bibl-pages%) \n     (("bmno") %gentext-no-bibl-pages%) \n     (("dege") %gentext-de-bibl-pages%) \n     (("dk") %gentext-da-bibl-pages%) \n     (("svse") %gentext-sv-bibl-pages%) \n     (("usen") %gentext-en-bibl-pages%) \n    (else (error "L10N ERROR: gentext-bibl-pages"))))\n\n(define (gentext-endnotes)\n  (case ($lang$)\n     (("af") %gentext-af-endnotes%) \n     (("bg") %gentext-bg-endnotes%) \n     (("bs") %gentext-bs-endnotes%) \n     (("ca") %gentext-ca-endnotes%) \n     (("cs") %gentext-cs-endnotes%) \n     (("da") %gentext-da-endnotes%) \n     (("de") %gentext-de-endnotes%) \n     (("el") %gentext-el-endnotes%) \n     (("en") %gentext-en-endnotes%) \n     (("es") %gentext-es-endnotes%) \n     (("et") %gentext-et-endnotes%) \n     (("eu") %gentext-eu-endnotes%) \n     (("fi") %gentext-fi-endnotes%) \n     (("fr") %gentext-fr-endnotes%) \n     (("hu") %gentext-hu-endnotes%) \n     (("id") %gentext-id-endnotes%) \n     (("it") %gentext-it-endnotes%) \n     (("ja") %gentext-ja-endnotes%) \n     (("ko") %gentext-ko-endnotes%) \n     (("nl") %gentext-nl-endnotes%) \n     (("nn") %gentext-nn-endnotes%) \n     (("no") %gentext-no-endnotes%) \n     (("pl") %gentext-pl-endnotes%) \n     (("pt") %gentext-pt-endnotes%) \n     (("pt_br") %gentext-ptbr-endnotes%) \n     (("ro") %gentext-ro-endnotes%) \n     (("ru") %gentext-ru-endnotes%) \n     (("sk") %gentext-sk-endnotes%) \n     (("sl") %gentext-sl-endnotes%) \n     (("sr") %gentext-sr-endnotes%) \n     (("sv") %gentext-sv-endnotes%) \n     (("tr") %gentext-tr-endnotes%) \n     (("uk") %gentext-uk-endnotes%) \n     (("xh") %gentext-xh-endnotes%) \n     (("zh_cn") %gentext-zhcn-endnotes%) \n     (("zh_tw") %gentext-zhtw-endnotes%) \n     (("bmno") %gentext-no-endnotes%) \n     (("dege") %gentext-de-endnotes%) \n     (("dk") %gentext-da-endnotes%) \n     (("svse") %gentext-sv-endnotes%) \n     (("usen") %gentext-en-endnotes%) \n    (else (error "L10N ERROR: gentext-endnotes"))))\n\n(define (gentext-table-endnotes)\n  (case ($lang$)\n     (("af") %gentext-af-table-endnotes%) \n     (("bg") %gentext-bg-table-endnotes%) \n     (("bs") %gentext-bs-table-endnotes%) \n     (("ca") %gentext-ca-table-endnotes%) \n     (("cs") %gentext-cs-table-endnotes%) \n     (("da") %gentext-da-table-endnotes%) \n     (("de") %gentext-de-table-endnotes%) \n     (("el") %gentext-el-table-endnotes%) \n     (("en") %gentext-en-table-endnotes%) \n     (("es") %gentext-es-table-endnotes%) \n     (("et") %gentext-et-table-endnotes%) \n     (("eu") %gentext-eu-table-endnotes%) \n     (("fi") %gentext-fi-table-endnotes%) \n     (("fr") %gentext-fr-table-endnotes%) \n     (("hu") %gentext-hu-table-endnotes%) \n     (("id") %gentext-id-table-endnotes%) \n     (("it") %gentext-it-table-endnotes%) \n     (("ja") %gentext-ja-table-endnotes%) \n     (("ko") %gentext-ko-table-endnotes%) \n     (("nl") %gentext-nl-table-endnotes%) \n     (("nn") %gentext-nn-table-endnotes%) \n     (("no") %gentext-no-table-endnotes%) \n     (("pl") %gentext-pl-table-endnotes%) \n     (("pt") %gentext-pt-table-endnotes%) \n     (("pt_br") %gentext-ptbr-table-endnotes%) \n     (("ro") %gentext-ro-table-endnotes%) \n     (("ru") %gentext-ru-table-endnotes%) \n     (("sk") %gentext-sk-table-endnotes%) \n     (("sl") %gentext-sl-table-endnotes%) \n     (("sr") %gentext-sr-table-endnotes%) \n     (("sv") %gentext-sv-table-endnotes%) \n     (("tr") %gentext-tr-table-endnotes%) \n     (("uk") %gentext-uk-table-endnotes%) \n     (("xh") %gentext-xh-table-endnotes%) \n     (("zh_cn") %gentext-zhcn-table-endnotes%) \n     (("zh_tw") %gentext-zhtw-table-endnotes%) \n     (("bmno") %gentext-no-table-endnotes%) \n     (("dege") %gentext-de-table-endnotes%) \n     (("dk") %gentext-da-table-endnotes%) \n     (("svse") %gentext-sv-table-endnotes%) \n     (("usen") %gentext-en-table-endnotes%) \n    (else (error "L10N ERROR: gentext-table-endnotes"))))\n\n(define (gentext-index-see)\n  (case ($lang$)\n     (("af") %gentext-af-index-see%) \n     (("bg") %gentext-bg-index-see%) \n     (("bs") %gentext-bs-index-see%) \n     (("ca") %gentext-ca-index-see%) \n     (("cs") %gentext-cs-index-see%) \n     (("da") %gentext-da-index-see%) \n     (("de") %gentext-de-index-see%) \n     (("el") %gentext-el-index-see%) \n     (("en") %gentext-en-index-see%) \n     (("es") %gentext-es-index-see%) \n     (("et") %gentext-et-index-see%) \n     (("eu") %gentext-eu-index-see%) \n     (("fi") %gentext-fi-index-see%) \n     (("fr") %gentext-fr-index-see%) \n     (("hu") %gentext-hu-index-see%) \n     (("id") %gentext-id-index-see%) \n     (("it") %gentext-it-index-see%) \n     (("ja") %gentext-ja-index-see%) \n     (("ko") %gentext-ko-index-see%) \n     (("nl") %gentext-nl-index-see%) \n     (("nn") %gentext-nn-index-see%) \n     (("no") %gentext-no-index-see%) \n     (("pl") %gentext-pl-index-see%) \n     (("pt") %gentext-pt-index-see%) \n     (("pt_br") %gentext-ptbr-index-see%) \n     (("ro") %gentext-ro-index-see%) \n     (("ru") %gentext-ru-index-see%) \n     (("sk") %gentext-sk-index-see%) \n     (("sl") %gentext-sl-index-see%) \n     (("sr") %gentext-sr-index-see%) \n     (("sv") %gentext-sv-index-see%) \n     (("tr") %gentext-tr-index-see%) \n     (("uk") %gentext-uk-index-see%) \n     (("xh") %gentext-xh-index-see%) \n     (("zh_cn") %gentext-zhcn-index-see%) \n     (("zh_tw") %gentext-zhtw-index-see%) \n     (("bmno") %gentext-no-index-see%) \n     (("dege") %gentext-de-index-see%) \n     (("dk") %gentext-da-index-see%) \n     (("svse") %gentext-sv-index-see%) \n     (("usen") %gentext-en-index-see%) \n    (else (error "L10N ERROR: gentext-index-see"))))\n\n(define (gentext-index-seealso)\n  (case ($lang$)\n     (("af") %gentext-af-index-seealso%) \n     (("bg") %gentext-bg-index-seealso%) \n     (("bs") %gentext-bs-index-seealso%) \n     (("ca") %gentext-ca-index-seealso%) \n     (("cs") %gentext-cs-index-seealso%) \n     (("da") %gentext-da-index-seealso%) \n     (("de") %gentext-de-index-seealso%) \n     (("el") %gentext-el-index-seealso%) \n     (("en") %gentext-en-index-seealso%) \n     (("es") %gentext-es-index-seealso%) \n     (("et") %gentext-et-index-seealso%) \n     (("eu") %gentext-eu-index-seealso%) \n     (("fi") %gentext-fi-index-seealso%) \n     (("fr") %gentext-fr-index-seealso%) \n     (("hu") %gentext-hu-index-seealso%) \n     (("id") %gentext-id-index-seealso%) \n     (("it") %gentext-it-index-seealso%) \n     (("ja") %gentext-ja-index-seealso%) \n     (("ko") %gentext-ko-index-seealso%) \n     (("nl") %gentext-nl-index-seealso%) \n     (("nn") %gentext-nn-index-seealso%) \n     (("no") %gentext-no-index-seealso%) \n     (("pl") %gentext-pl-index-seealso%) \n     (("pt") %gentext-pt-index-seealso%) \n     (("pt_br") %gentext-ptbr-index-seealso%) \n     (("ro") %gentext-ro-index-seealso%) \n     (("ru") %gentext-ru-index-seealso%) \n     (("sk") %gentext-sk-index-seealso%) \n     (("sl") %gentext-sl-index-seealso%) \n     (("sr") %gentext-sr-index-seealso%) \n     (("sv") %gentext-sv-index-seealso%) \n     (("tr") %gentext-tr-index-seealso%) \n     (("uk") %gentext-uk-index-seealso%) \n     (("xh") %gentext-xh-index-seealso%) \n     (("zh_cn") %gentext-zhcn-index-seealso%) \n     (("zh_tw") %gentext-zhtw-index-seealso%) \n     (("bmno") %gentext-no-index-seealso%) \n     (("dege") %gentext-de-index-seealso%) \n     (("dk") %gentext-da-index-seealso%) \n     (("svse") %gentext-sv-index-seealso%) \n     (("usen") %gentext-en-index-seealso%) \n    (else (error "L10N ERROR: gentext-index-seealso"))))\n\n(define (gentext-nav-prev prev) \n  (case ($lang$)\n     (("af") (gentext-af-nav-prev prev)) \n     (("bg") (gentext-bg-nav-prev prev)) \n     (("bs") (gentext-bs-nav-prev prev)) \n     (("ca") (gentext-ca-nav-prev prev)) \n     (("cs") (gentext-cs-nav-prev prev)) \n     (("da") (gentext-da-nav-prev prev)) \n     (("de") (gentext-de-nav-prev prev)) \n     (("el") (gentext-el-nav-prev prev)) \n     (("en") (gentext-en-nav-prev prev)) \n     (("es") (gentext-es-nav-prev prev)) \n     (("et") (gentext-et-nav-prev prev)) \n     (("eu") (gentext-eu-nav-prev prev)) \n     (("fi") (gentext-fi-nav-prev prev)) \n     (("fr") (gentext-fr-nav-prev prev)) \n     (("hu") (gentext-hu-nav-prev prev)) \n     (("id") (gentext-id-nav-prev prev)) \n     (("it") (gentext-it-nav-prev prev)) \n     (("ja") (gentext-ja-nav-prev prev)) \n     (("ko") (gentext-ko-nav-prev prev)) \n     (("nl") (gentext-nl-nav-prev prev)) \n     (("nn") (gentext-nn-nav-prev prev)) \n     (("no") (gentext-no-nav-prev prev)) \n     (("pl") (gentext-pl-nav-prev prev)) \n     (("pt") (gentext-pt-nav-prev prev)) \n     (("pt_br") (gentext-ptbr-nav-prev prev)) \n     (("ro") (gentext-ro-nav-prev prev)) \n     (("ru") (gentext-ru-nav-prev prev)) \n     (("sk") (gentext-sk-nav-prev prev)) \n     (("sl") (gentext-sl-nav-prev prev)) \n     (("sr") (gentext-sr-nav-prev prev)) \n     (("sv") (gentext-sv-nav-prev prev)) \n     (("tr") (gentext-tr-nav-prev prev)) \n     (("uk") (gentext-uk-nav-prev prev)) \n     (("xh") (gentext-xh-nav-prev prev)) \n     (("zh_cn") (gentext-zhcn-nav-prev prev)) \n     (("zh_tw") (gentext-zhtw-nav-prev prev)) \n     (("bmno") (gentext-no-nav-prev prev)) \n     (("dege") (gentext-de-nav-prev prev)) \n     (("dk") (gentext-da-nav-prev prev)) \n     (("svse") (gentext-sv-nav-prev prev)) \n     (("usen") (gentext-en-nav-prev prev)) \n    (else (error "L10N ERROR: gentext-nav-prev"))))\n\n(define (gentext-nav-prev-sibling prevsib) \n  (case ($lang$)\n     (("af") (gentext-af-nav-prev-sibling prevsib)) \n     (("bg") (gentext-bg-nav-prev-sibling prevsib)) \n     (("bs") (gentext-bs-nav-prev-sibling prevsib)) \n     (("ca") (gentext-ca-nav-prev-sibling prevsib)) \n     (("cs") (gentext-cs-nav-prev-sibling prevsib)) \n     (("da") (gentext-da-nav-prev-sibling prevsib)) \n     (("de") (gentext-de-nav-prev-sibling prevsib)) \n     (("el") (gentext-el-nav-prev-sibling prevsib)) \n     (("en") (gentext-en-nav-prev-sibling prevsib)) \n     (("es") (gentext-es-nav-prev-sibling prevsib)) \n     (("et") (gentext-et-nav-prev-sibling prevsib)) \n     (("eu") (gentext-eu-nav-prev-sibling prevsib)) \n     (("fi") (gentext-fi-nav-prev-sibling prevsib)) \n     (("fr") (gentext-fr-nav-prev-sibling prevsib)) \n     (("hu") (gentext-hu-nav-prev-sibling prevsib)) \n     (("id") (gentext-id-nav-prev-sibling prevsib)) \n     (("it") (gentext-it-nav-prev-sibling prevsib)) \n     (("ja") (gentext-ja-nav-prev-sibling prevsib)) \n     (("ko") (gentext-ko-nav-prev-sibling prevsib)) \n     (("nl") (gentext-nl-nav-prev-sibling prevsib)) \n     (("nn") (gentext-nn-nav-prev-sibling prevsib)) \n     (("no") (gentext-no-nav-prev-sibling prevsib)) \n     (("pl") (gentext-pl-nav-prev-sibling prevsib)) \n     (("pt") (gentext-pt-nav-prev-sibling prevsib)) \n     (("pt_br") (gentext-ptbr-nav-prev-sibling prevsib)) \n     (("ro") (gentext-ro-nav-prev-sibling prevsib)) \n     (("ru") (gentext-ru-nav-prev-sibling prevsib)) \n     (("sk") (gentext-sk-nav-prev-sibling prevsib)) \n     (("sl") (gentext-sl-nav-prev-sibling prevsib)) \n     (("sr") (gentext-sr-nav-prev-sibling prevsib)) \n     (("sv") (gentext-sv-nav-prev-sibling prevsib)) \n     (("tr") (gentext-tr-nav-prev-sibling prevsib)) \n     (("uk") (gentext-uk-nav-prev-sibling prevsib)) \n     (("xh") (gentext-xh-nav-prev-sibling prevsib)) \n     (("zh_cn") (gentext-zhcn-nav-prev-sibling prevsib)) \n     (("zh_tw") (gentext-zhtw-nav-prev-sibling prevsib)) \n     (("bmno") (gentext-no-nav-prev-sibling prevsib)) \n     (("dege") (gentext-de-nav-prev-sibling prevsib)) \n     (("dk") (gentext-da-nav-prev-sibling prevsib)) \n     (("svse") (gentext-sv-nav-prev-sibling prevsib)) \n     (("usen") (gentext-en-nav-prev-sibling prevsib)) \n    (else (error "L10N ERROR: gentext-nav-prev-sibling "))))\n\n(define (gentext-nav-next-sibling nextsib)\n  (case ($lang$)\n     (("af") (gentext-af-nav-next-sibling nextsib)) \n     (("bg") (gentext-bg-nav-next-sibling nextsib)) \n     (("bs") (gentext-bs-nav-next-sibling nextsib)) \n     (("ca") (gentext-ca-nav-next-sibling nextsib)) \n     (("cs") (gentext-cs-nav-next-sibling nextsib)) \n     (("da") (gentext-da-nav-next-sibling nextsib)) \n     (("de") (gentext-de-nav-next-sibling nextsib)) \n     (("el") (gentext-el-nav-next-sibling nextsib)) \n     (("en") (gentext-en-nav-next-sibling nextsib)) \n     (("es") (gentext-es-nav-next-sibling nextsib)) \n     (("et") (gentext-et-nav-next-sibling nextsib)) \n     (("eu") (gentext-eu-nav-next-sibling nextsib)) \n     (("fi") (gentext-fi-nav-next-sibling nextsib)) \n     (("fr") (gentext-fr-nav-next-sibling nextsib)) \n     (("hu") (gentext-hu-nav-next-sibling nextsib)) \n     (("id") (gentext-id-nav-next-sibling nextsib)) \n     (("it") (gentext-it-nav-next-sibling nextsib)) \n     (("ja") (gentext-ja-nav-next-sibling nextsib)) \n     (("ko") (gentext-ko-nav-next-sibling nextsib)) \n     (("nl") (gentext-nl-nav-next-sibling nextsib)) \n     (("nn") (gentext-nn-nav-next-sibling nextsib)) \n     (("no") (gentext-no-nav-next-sibling nextsib)) \n     (("pl") (gentext-pl-nav-next-sibling nextsib)) \n     (("pt") (gentext-pt-nav-next-sibling nextsib)) \n     (("pt_br") (gentext-ptbr-nav-next-sibling nextsib)) \n     (("ro") (gentext-ro-nav-next-sibling nextsib)) \n     (("ru") (gentext-ru-nav-next-sibling nextsib)) \n     (("sk") (gentext-sk-nav-next-sibling nextsib)) \n     (("sl") (gentext-sl-nav-next-sibling nextsib)) \n     (("sr") (gentext-sr-nav-next-sibling nextsib)) \n     (("sv") (gentext-sv-nav-next-sibling nextsib)) \n     (("tr") (gentext-tr-nav-next-sibling nextsib)) \n     (("uk") (gentext-uk-nav-next-sibling nextsib)) \n     (("xh") (gentext-xh-nav-next-sibling nextsib)) \n     (("zh_cn") (gentext-zhcn-nav-next-sibling nextsib)) \n     (("zh_tw") (gentext-zhtw-nav-next-sibling nextsib)) \n     (("bmno") (gentext-no-nav-next-sibling nextsib)) \n     (("dege") (gentext-de-nav-next-sibling nextsib)) \n     (("dk") (gentext-da-nav-next-sibling nextsib)) \n     (("svse") (gentext-sv-nav-next-sibling nextsib)) \n     (("usen") (gentext-en-nav-next-sibling nextsib)) \n    (else (error "L10N ERROR: gentext-nav-next-sibling"))))\n\n(define (gentext-nav-next next)\n  (case ($lang$)\n     (("af") (gentext-af-nav-next next)) \n     (("bg") (gentext-bg-nav-next next)) \n     (("bs") (gentext-bs-nav-next next)) \n     (("ca") (gentext-ca-nav-next next)) \n     (("cs") (gentext-cs-nav-next next)) \n     (("da") (gentext-da-nav-next next)) \n     (("de") (gentext-de-nav-next next)) \n     (("el") (gentext-el-nav-next next)) \n     (("en") (gentext-en-nav-next next)) \n     (("es") (gentext-es-nav-next next)) \n     (("et") (gentext-et-nav-next next)) \n     (("eu") (gentext-eu-nav-next next)) \n     (("fi") (gentext-fi-nav-next next)) \n     (("fr") (gentext-fr-nav-next next)) \n     (("hu") (gentext-hu-nav-next next)) \n     (("id") (gentext-id-nav-next next)) \n     (("it") (gentext-it-nav-next next)) \n     (("ja") (gentext-ja-nav-next next)) \n     (("ko") (gentext-ko-nav-next next)) \n     (("nl") (gentext-nl-nav-next next)) \n     (("nn") (gentext-nn-nav-next next)) \n     (("no") (gentext-no-nav-next next)) \n     (("pl") (gentext-pl-nav-next next)) \n     (("pt") (gentext-pt-nav-next next)) \n     (("pt_br") (gentext-ptbr-nav-next next)) \n     (("ro") (gentext-ro-nav-next next)) \n     (("ru") (gentext-ru-nav-next next)) \n     (("sk") (gentext-sk-nav-next next)) \n     (("sl") (gentext-sl-nav-next next)) \n     (("sr") (gentext-sr-nav-next next)) \n     (("sv") (gentext-sv-nav-next next)) \n     (("tr") (gentext-tr-nav-next next)) \n     (("uk") (gentext-uk-nav-next next)) \n     (("xh") (gentext-xh-nav-next next)) \n     (("zh_cn") (gentext-zhcn-nav-next next)) \n     (("zh_tw") (gentext-zhtw-nav-next next)) \n     (("bmno") (gentext-no-nav-next next)) \n     (("dege") (gentext-de-nav-next next)) \n     (("dk") (gentext-da-nav-next next)) \n     (("svse") (gentext-sv-nav-next next)) \n     (("usen") (gentext-en-nav-next next)) \n    (else (error "L10N ERROR: gentext-nav-next"))))\n\n(define (gentext-nav-up up)\n  (case ($lang$)\n     (("af") (gentext-af-nav-up up)) \n     (("bg") (gentext-bg-nav-up up)) \n     (("bs") (gentext-bs-nav-up up)) \n     (("ca") (gentext-ca-nav-up up)) \n     (("cs") (gentext-cs-nav-up up)) \n     (("da") (gentext-da-nav-up up)) \n     (("de") (gentext-de-nav-up up)) \n     (("el") (gentext-el-nav-up up)) \n     (("en") (gentext-en-nav-up up)) \n     (("es") (gentext-es-nav-up up)) \n     (("et") (gentext-et-nav-up up)) \n     (("eu") (gentext-eu-nav-up up)) \n     (("fi") (gentext-fi-nav-up up)) \n     (("fr") (gentext-fr-nav-up up)) \n     (("hu") (gentext-hu-nav-up up)) \n     (("id") (gentext-id-nav-up up)) \n     (("it") (gentext-it-nav-up up)) \n     (("ja") (gentext-ja-nav-up up)) \n     (("ko") (gentext-ko-nav-up up)) \n     (("nl") (gentext-nl-nav-up up)) \n     (("nn") (gentext-nn-nav-up up)) \n     (("no") (gentext-no-nav-up up)) \n     (("pl") (gentext-pl-nav-up up)) \n     (("pt") (gentext-pt-nav-up up)) \n     (("pt_br") (gentext-ptbr-nav-up up)) \n     (("ro") (gentext-ro-nav-up up)) \n     (("ru") (gentext-ru-nav-up up)) \n     (("sk") (gentext-sk-nav-up up)) \n     (("sl") (gentext-sl-nav-up up)) \n     (("sr") (gentext-sr-nav-up up)) \n     (("sv") (gentext-sv-nav-up up)) \n     (("tr") (gentext-tr-nav-up up)) \n     (("uk") (gentext-uk-nav-up up)) \n     (("xh") (gentext-xh-nav-up up)) \n     (("zh_cn") (gentext-zhcn-nav-up up)) \n     (("zh_tw") (gentext-zhtw-nav-up up)) \n     (("bmno") (gentext-no-nav-up up)) \n     (("dege") (gentext-de-nav-up up)) \n     (("dk") (gentext-da-nav-up up)) \n     (("svse") (gentext-sv-nav-up up)) \n     (("usen") (gentext-en-nav-up up)) \n    (else (error "L10N ERROR: gentext-nav-up"))))\n\n(define (gentext-nav-home home)\n  (case ($lang$)\n     (("af") (gentext-af-nav-home home)) \n     (("bg") (gentext-bg-nav-home home)) \n     (("bs") (gentext-bs-nav-home home)) \n     (("ca") (gentext-ca-nav-home home)) \n     (("cs") (gentext-cs-nav-home home)) \n     (("da") (gentext-da-nav-home home)) \n     (("de") (gentext-de-nav-home home)) \n     (("el") (gentext-el-nav-home home)) \n     (("en") (gentext-en-nav-home home)) \n     (("es") (gentext-es-nav-home home)) \n     (("et") (gentext-et-nav-home home)) \n     (("eu") (gentext-eu-nav-home home)) \n     (("fi") (gentext-fi-nav-home home)) \n     (("fr") (gentext-fr-nav-home home)) \n     (("hu") (gentext-hu-nav-home home)) \n     (("id") (gentext-id-nav-home home)) \n     (("it") (gentext-it-nav-home home)) \n     (("ja") (gentext-ja-nav-home home)) \n     (("ko") (gentext-ko-nav-home home)) \n     (("nl") (gentext-nl-nav-home home)) \n     (("nn") (gentext-nn-nav-home home)) \n     (("no") (gentext-no-nav-home home)) \n     (("pl") (gentext-pl-nav-home home)) \n     (("pt") (gentext-pt-nav-home home)) \n     (("pt_br") (gentext-ptbr-nav-home home)) \n     (("ro") (gentext-ro-nav-home home)) \n     (("ru") (gentext-ru-nav-home home)) \n     (("sk") (gentext-sk-nav-home home)) \n     (("sl") (gentext-sl-nav-home home)) \n     (("sr") (gentext-sr-nav-home home)) \n     (("sv") (gentext-sv-nav-home home)) \n     (("tr") (gentext-tr-nav-home home)) \n     (("uk") (gentext-uk-nav-home home)) \n     (("xh") (gentext-xh-nav-home home)) \n     (("zh_cn") (gentext-zhcn-nav-home home)) \n     (("zh_tw") (gentext-zhtw-nav-home home)) \n     (("bmno") (gentext-no-nav-home home)) \n     (("dege") (gentext-de-nav-home home)) \n     (("dk") (gentext-da-nav-home home)) \n     (("svse") (gentext-sv-nav-home home)) \n     (("usen") (gentext-en-nav-home home)) \n    (else (error "L10N ERROR: gentext-nav-home"))))\n    \n\n;; $Id: dbadmon.dsl,v 1.5 2004/10/10 14:18:40 petere78 Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ============================ ADMONITIONS =============================\n\n(define ($graphical-admonition$)\n  (let* ((adm       (current-node))\n\011 (title     (select-elements (children adm) \n\011\011\011\011     (normalize "title")))\n\011 (title?    (not (node-list-empty? title)))\n\011 (adm-title (if title?\n\011\011\011(with-mode title-sosofo-mode\n\011\011\011  (process-node-list (node-list-first title)))\n\011\011\011(literal (gentext-element-name adm))))\n\011 (graphic   (make external-graphic\n\011\011      display?: #f\n\011\011      entity-system-id: ($admon-graphic$)))\n\011 (f-child   (node-list-first (children (current-node))))\n\011 (r-child   (node-list-rest (children (current-node)))))\n    (make display-group\n      space-before: %block-sep%\n      space-after: %block-sep%\n      start-indent: (+ (inherited-start-indent) ($admon-graphic-width$))\n      font-family-name: %admon-font-family%\n      font-size: (- %bf-size% 1pt)\n      font-weight: 'medium\n      font-posture: 'upright\n      line-spacing: (* (- %bf-size% 1pt) %line-spacing-factor%)\n      (if title?\n\011  (make display-group\n\011    (make paragraph\n\011      first-line-start-indent: (- ($admon-graphic-width$))\n\011      keep-with-next?: #t\n\011      (make line-field\n\011\011field-width: ($admon-graphic-width$)\n\011\011graphic)\n\011      (make sequence\n\011\011font-family-name: %title-font-family%\n\011\011font-weight: 'bold\n\011\011adm-title))\n\011    (process-children))\n\011  (make display-group\n\011    (make paragraph\n\011      first-line-start-indent: (- ($admon-graphic-width$))\n\011      (make line-field\n\011\011field-width: ($admon-graphic-width$)\n\011\011graphic)\n\011      (process-node-list (children f-child)))\n\011    (process-node-list r-child))))))\n\n(define ($admonition$)\n  (if %admon-graphics%\n      ($graphical-admonition$)\n      (make display-group\n\011space-before: %block-sep%\n\011space-after: %block-sep%\n\011start-indent: (if %admon-graphics%\n\011\011\011  (inherited-start-indent)\n\011\011\011  (+ (inherited-start-indent) (* (ILSTEP) 2)))\n\011font-size: (- %bf-size% 1pt)\n\011font-weight: 'medium\n\011font-posture: 'upright\n\011font-family-name: %admon-font-family%\n\011line-spacing: (* (- %bf-size% 1pt) %line-spacing-factor%)\n\011(process-children))))\n\n(define ($admonpara$)\n  (let* ((title     (select-elements \n\011\011     (children (parent (current-node))) (normalize "title")))\n\011 (has-title (not (node-list-empty? title)))\n\011 (adm-title (if has-title \n\011\011\011(make sequence\n\011\011\011  (with-mode title-sosofo-mode\n\011\011\011    (process-node-list (node-list-first title)))\n\011\011\011  (literal (gentext-label-title-sep \n\011\011\011\011    (gi (parent (current-node))))))\n\011\011\011(literal\n\011\011\011 (gentext-element-name \n\011\011\011  (parent (current-node)))\n\011\011\011 (gentext-label-title-sep \n\011\011\011  (gi (parent (current-node))))))))\n    (make paragraph\n      space-before: %para-sep%\n      space-after: %para-sep%\n      (if (and (not %admon-graphics%) (= (child-number) 1))\n\011  (make sequence\n\011    font-family-name: %title-font-family%\n\011    font-weight: 'bold\n\011    adm-title)\n\011  (empty-sosofo))\n      (process-children-trim))))\n\n(element important ($admonition$))\n(element (important title) (empty-sosofo))\n(element (important para) ($admonpara$))\n(element (important simpara) ($admonpara$))\n\n;; Note: note element handler commented out - using custom handler in dbprod.dsl\n;;(element note ($admonition$))\n;;(element (note title) (empty-sosofo))\n;;(element (note para) ($admonpara$))\n;;(element (note simpara) ($admonpara$))\n\n(element tip ($admonition$))\n(element (tip title) (empty-sosofo))\n(element (tip para) ($admonpara$))\n(element (tip simpara) ($admonpara$))\n\n;; perils are given special treatment by generating a centered title\n;;   and throwing a box around them\n;; note that the paragraph indents are set by the box characteristics\n;;\n(define ($peril$)\n  (let* ((title     (select-elements \n\011\011     (children (current-node)) (normalize "title")))\n\011 (has-title (not (node-list-empty? title)))\n\011 (adm-title (if has-title \n\011\011\011(make sequence\n\011\011\011  (with-mode title-sosofo-mode\n\011\011\011    (process-node-list (node-list-first title))))\n\011\011\011(literal\n\011\011\011 (gentext-element-name \n\011\011\011  (current-node)))))\n\011 (hs (HSIZE 2)))\n  (if %admon-graphics%\n      ($graphical-admonition$)\n      (make display-group\n\011space-before: %block-sep%\n\011space-after: %block-sep%\n\011font-family-name: %admon-font-family%\n\011font-size: (- %bf-size% 1pt)\n\011font-weight: 'medium\n\011font-posture: 'upright\n\011line-spacing: (* (- %bf-size% 1pt) %line-spacing-factor%)\n\011(make box\n\011  display?: #t\n\011  box-type: 'border\n\011  line-thickness: 2pt\n\011  start-indent: (+ (inherited-start-indent) (* 2 (ILSTEP)) 2pt)\n\011  end-indent: (inherited-end-indent)\n\011  (make paragraph\n\011    space-before: %para-sep%\n\011    space-after: %para-sep%\n\011    start-indent: 1em\n\011    end-indent: 1em\n\011    font-family-name: %title-font-family%\n\011    font-weight: 'bold\n\011    font-size: hs\n\011    line-spacing: (* hs %line-spacing-factor%)\n\011    quadding: 'center\n\011    keep-with-next?: #t\n\011    adm-title)\n\011  (process-children))))))\n\n(element caution ($peril$))\n(element (caution title) (empty-sosofo))\n\n(element warning ($peril$))\n(element (warning title) (empty-sosofo))\n   \n;; $Id: dbautoc.dsl,v 1.4 2003/01/15 08:24:23 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ========================== TABLE OF CONTENTS =========================\n\n(define %toc-indent% 2pi)\n(define %toc-spacing-factor% 0.4)\n\n;; Returns the depth of auto TOC that should be made at the nd-level\n(define (toc-depth nd)\n  (if (string=? (gi nd) (normalize "book"))\n      7\n      1))\n\n(define (format-page-number)\n  (current-node-page-number-sosofo))\n\n;; Prints the TOC title if first? is true, otherwise does nothing\n(define (toc-title first?)\n  (let ((hsize (if (or (equal? (gi (current-node)) (normalize "article"))\n\011\011       (equal? (gi (current-node)) (normalize "part")))\n\011\011   (HSIZE 3)\n\011\011   (HSIZE 4))))\n    (if first?\n\011(make paragraph\n\011  font-family-name: %title-font-family%\n\011  font-weight: 'bold\n\011  font-size: hsize\n\011  line-spacing: (* hsize %line-spacing-factor%)\n\011  space-before: (* hsize %head-before-factor%)\n\011  space-after: (* hsize %head-after-factor%)\n\011  start-indent: 0pt\n\011  first-line-start-indent: 0pt\n\011  quadding: %component-title-quadding%\n\011  heading-level: (if %generate-heading-level% 1 0)\n\011  keep-with-next?: #t\n\011  (literal (gentext-element-name (normalize "toc"))))\n\011(empty-sosofo))))\n\n;; Prints the TOC title if first? is true, otherwise does nothing\n(define (lot-title first? lotgi)\n  (if first?\n      (make paragraph\n\011font-family-name: %title-font-family%\n\011font-weight: 'bold\n\011font-size: (HSIZE 4)\n\011line-spacing: (* (HSIZE 4) %line-spacing-factor%)\n\011space-before: (* (HSIZE 4) %head-before-factor%)\n\011space-after: (* (HSIZE 4) %head-after-factor%)\n\011start-indent: 0pt\n\011first-line-start-indent: 0pt\n\011quadding: %component-title-quadding%\n\011heading-level: (if %generate-heading-level% 1 0)\n\011keep-with-next?: #t\n\011(literal ($lot-title$ lotgi)))\n      (empty-sosofo)))\n\n;; Print the TOC entry for tocentry  \n(define ($toc-entry$ tocentry level)\n  (make paragraph\n    start-indent: (+ %body-start-indent%\n\011\011     (* %toc-indent% level))\n    first-line-start-indent: (* -1 %toc-indent%)\n    font-weight: (if (= level 1) 'bold 'medium)\n    space-before: (if (= level 1) (* %toc-spacing-factor% 6pt) 0pt)\n    space-after: (if (= level 1) (* %toc-spacing-factor% 6pt) 0pt)\n    keep-with-next?: (if (= level 1) #t #f)\n    quadding: 'start\n    (make link\n      destination: (node-list-address tocentry)\n      (make sequence\n\011(if (equal? (element-label tocentry) "")\n\011    (empty-sosofo)\n\011    (make sequence\n\011      (element-label-sosofo tocentry)\n\011      (literal (gentext-label-title-sep (gi tocentry)))))\n\011(element-title-sosofo tocentry)))\n    (if (and (= level 1)\n\011     ;; ??? %chapter-title-page-separate%\n\011     %page-number-restart%)\n\011(empty-sosofo)    ;; Don't need the leader etc then\n\011(make sequence\n\011  (make leader (literal "."))\n\011  (make link\n\011    destination: (node-list-address tocentry)\n\011    (make sequence\n\011      (if %page-number-restart%\n\011\011  (literal\n\011\011   (string-append\n\011\011    (if (= level 1)\n\011\011\011(element-label tocentry #t)\n\011\011\011(substring (element-label tocentry #t)\n\011\011\011\011   0 (string-index (element-label tocentry #t) ".")))\n\011\011    (gentext-intra-label-sep "_pagenumber")))\n\011\011  (empty-sosofo))\n\011      (with-mode toc-page-number-mode\n\011\011(process-node-list tocentry))))))))\n\n;; Build a TOC starting at nd reaching down depth levels.\n;; The optional arguments are used on recursive calls to build-toc\n;; and shouldn't be set by the initial caller...\n;;\n(define (build-toc nd depth #!optional (first? #t) (level 1))\n  (let* ((toclist (toc-list-filter\n\011\011   (node-list-filter-by-gi (children nd)\n\011\011\011\011\011   (append (division-element-list)\n\011\011\011\011\011\011   (component-element-list)\n\011\011\011\011\011\011   (section-element-list))))))\n    (if (or (<= depth 0)\n\011    (node-list-empty? toclist))\n\011(empty-sosofo)\n\011(make sequence\n\011  (toc-title first?)\n\011  (let loop ((nl toclist))\n\011    (if (node-list-empty? nl)\n\011\011(empty-sosofo)\n\011\011(sosofo-append\n\011\011  ($toc-entry$ (node-list-first nl) level)\n\011\011  (build-toc (node-list-first nl) (- depth 1) #f (+ level 1))\n\011\011  (loop (node-list-rest nl)))))))))\n\n;; Print the LOT entry\n(define ($lot-entry$ tocentry)\n  (make paragraph\n    start-indent: (+ %body-start-indent% %toc-indent%)\n    first-line-start-indent: (* -1 %toc-indent%)\n    font-weight: 'medium\n    space-before: 0pt\n    space-after: 0pt\n    quadding: 'start\n    (make link\n      destination: (node-list-address tocentry)\n      (make sequence\n\011(if (equal? (element-label tocentry) "")\n\011    (empty-sosofo)\n\011    (make sequence\n\011      (element-label-sosofo tocentry #t)\n\011      (literal (gentext-label-title-sep (gi tocentry)))))\n\011(element-title-sosofo tocentry)))\n    (make leader (literal "."))\n    (make link\n      destination: (node-list-address tocentry)\n      (make sequence\n\011(if %page-number-restart%\n\011    (make sequence\n\011     (literal (substring (element-label tocentry #t)\n\011\011\0110 (string-index (element-label tocentry #t) "-")))\n\011     (literal (gentext-intra-label-sep "_pagenumber")))\n\011    (empty-sosofo))\n\011(with-mode toc-page-number-mode\n\011  (process-node-list tocentry))))))\n\n;; Build a LOT starting at nd for all the lotgi's it contains.\n;; The optional arguments are used on recursive calls to build-toc\n;; and shouldn't be set by the initial caller...\n;;\n(define (build-lot nd lotgi #!optional (first? #t))\n  (let* ((lotlist (select-elements (descendants nd)\n\011\011\011\011   (normalize lotgi))))\n    (if (node-list-empty? lotlist)\n\011(empty-sosofo)\n\011(make sequence\n\011  (lot-title first? lotgi)\n\011  (let loop ((nl lotlist))\n\011    (if (node-list-empty? nl)\n\011\011(empty-sosofo)\n\011\011(make sequence\n\011\011  (if (string=? (gi (node-list-first nl)) lotgi)\n\011\011      ($lot-entry$ (node-list-first nl))\n\011\011      (empty-sosofo))\n\011\011  (build-lot (node-list-first nl) lotgi #f)\n\011\011  (loop (node-list-rest nl)))))))))\n\n(mode toc-page-number-mode\n  (default\n    (format-page-number)))\n   \n;; $Id: dbbibl.dsl,v 1.2 2002/06/09 12:04:09 nwalsh Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://nwalsh.com/docbook/dsssl/\n;;\n\n;; ......................... BIBLIOGRAPHY PARAMS .........................\n\n;; these should be in dbparam...\n(define %biblsep% ", ")\n(define %biblend% ".")\n\n(define %biblioentry-in-entry-order% #t)\n\n;; .................... BIBLIOGRAPHY and BIBLIODIV ......................\n\n(define (bibliography-content)\n  ;; Note that the code below works for both the case where the bibliography\n  ;; has BIBLIODIVs and the case where it doesn't, by the slightly subtle\n  ;; fact that if it does, then allentries will be (empty-node-list).\n  (let* ((allbibcontent (children (current-node)))\n\011 (prebibcontent (node-list-filter-by-not-gi \n\011\011\011 allbibcontent\n\011\011\011 (list (normalize "biblioentry")\n\011\011\011       (normalize "bibliomixed"))))\n\011 (allentries    (node-list-filter-by-gi \n\011\011\011 allbibcontent\n\011\011\011 (list (normalize "biblioentry")\n\011\011\011       (normalize "bibliomixed"))))\n\011 (entries       (if biblio-filter-used\n\011\011\011    (biblio-filter allentries)\n\011\011\011    allentries)))\n    (make sequence\n      (process-node-list prebibcontent)\n      (process-node-list entries))))\n\n(element (book bibliography)\n  (make simple-page-sequence\n    page-n-columns: %page-n-columns%\n    page-number-restart?: (or %page-number-restart% \n\011\011\011      (book-start?) \n\011\011\011      (first-chapter?))\n    page-number-format: ($page-number-format$)\n    use: default-text-style\n    left-header:   ($left-header$)\n    center-header: ($center-header$)\n    right-header:  ($right-header$)\n    left-footer:   ($left-footer$)\n    center-footer: ($center-footer$)\n    right-footer:  ($right-footer$)\n    start-indent: %body-start-indent%\n    input-whitespace-treatment: 'collapse\n    quadding: %default-quadding%\n    (make sequence\n      ($component-title$)\n      (bibliography-content))\n    (make-endnotes)))\n\n(element bibliography\n  ;; A bibliography that's inside something else...\n  (let* ((sect   (ancestor-member (current-node) \n\011\011\011\011  (append (section-element-list)\n\011\011\011\011\011  (component-element-list))))\n\011 (hlevel (+ (SECTLEVEL sect) 1))\n\011 (hs     (HSIZE (- 4 hlevel))))\n    (make sequence\n      (make paragraph\n\011font-family-name: %title-font-family%\n\011font-weight:  (if (< hlevel 5) 'bold 'medium)\n\011font-posture: (if (< hlevel 5) 'upright 'italic)\n\011font-size: hs\n\011line-spacing: (* hs %line-spacing-factor%)\n\011space-before: (* hs %head-before-factor%)\n\011space-after:  (* hs %head-after-factor%)\n\011start-indent: (if (or (>= hlevel 3)\n\011\011\011      (member (gi) (list (normalize "refsect1") \n\011\011\011\011\011\011 (normalize "refsect2") \n\011\011\011\011\011\011 (normalize "refsect3"))))\n\011\011\011  %body-start-indent%\n\011\011\011  0pt)\n\011first-line-start-indent: 0pt\n\011quadding: %section-title-quadding%\n\011keep-with-next?: #t\n\011heading-level: (if %generate-heading-level% (+ hlevel 1) 0)\n\011(element-title-sosofo (current-node)))\n      (bibliography-content))))\n\n(element (bibliography title) (empty-sosofo))\n\n(element bibliodiv\n  (let* ((allentries (node-list-filter-by-gi (children (current-node))\n\011\011\011\011\011     (list (normalize "biblioentry")\n\011\011\011\011\011\011   (normalize "bibliomixed"))))\n\011 (entries (if biblio-filter-used\n\011\011      (biblio-filter allentries)\n\011\011      allentries)))\n    (if (and biblio-filter-used (node-list-empty? entries))\n\011(empty-sosofo)\n\011(make display-group\n\011  space-before: %block-sep%\n\011  space-after: %block-sep%\n\011  start-indent: %body-start-indent%\n\011  (make sequence\n\011    ($section-title$)\n\011    (process-node-list entries))))))\n\n(element (bibliodiv title) (empty-sosofo))\n\n;; ..................... BIBLIOGRAPHY ENTRIES .........................\n\n(define (biblioentry-inline-sep node rest)\n  ;; Output the character that should separate inline node from rest\n  (cond \n   ((and (equal? (gi node) (normalize "title"))\n\011 (equal? (gi (node-list-first rest)) (normalize "subtitle")))\n    (make sequence\n      font-posture: 'italic\n      (literal ": ")))\n   (else\n    (literal %biblsep%))))\n\n(define (biblioentry-inline-end blocks)\n  ;; Output the character that should occur at the end of inline\n  (literal %biblend%))\n\n(define (biblioentry-block-sep node rest)\n  ;; Output the character that should separate block node from rest\n  (empty-sosofo))\n\n(define (biblioentry-block-end)\n  ;; Output the character that should occur at the end of block\n  (empty-sosofo))\n\n(element biblioentry\n  (let* ((expanded-children   (expand-children \n\011\011\011       (children (current-node))\n\011\011\011       (biblioentry-flatten-elements)))\n\011 (all-inline-children (if %biblioentry-in-entry-order%\n\011\011\011\011  (titlepage-gi-list-by-nodelist\n\011\011\011\011   (biblioentry-inline-elements)\n\011\011\011\011   expanded-children)\n\011\011\011\011  (titlepage-gi-list-by-elements\n\011\011\011\011   (biblioentry-inline-elements)\n\011\011\011\011   expanded-children)))\n\011 (block-children      (if %biblioentry-in-entry-order%\n\011\011\011\011  (titlepage-gi-list-by-nodelist\n\011\011\011\011   (biblioentry-block-elements)\n\011\011\011\011   expanded-children)\n\011\011\011\011  (titlepage-gi-list-by-elements\n\011\011\011\011   (biblioentry-block-elements)\n\011\011\011\011   expanded-children)))\n\011 (leading-abbrev      (if (equal? (normalize "abbrev")\n\011\011\011\011\011  (gi (node-list-first \n\011\011\011\011\011       all-inline-children)))\n\011\011\011\011  (node-list-first all-inline-children)\n\011\011\011\011  (empty-node-list)))\n\011 (inline-children     (if (node-list-empty? leading-abbrev)\n\011\011\011\011  all-inline-children\n\011\011\011\011  (node-list-rest all-inline-children)))\n\011 (has-leading-abbrev? (not (node-list-empty? leading-abbrev)))\n\011 (xreflabel           (if (or has-leading-abbrev? biblio-number)\n\011\011\011\011  #f\n\011\011\011\011  (attribute-string (normalize "xreflabel")))))\n    (make display-group\n      (make paragraph\n\011space-before: %para-sep%\n\011space-after: %para-sep%\n\011start-indent: (+ (inherited-start-indent) 2pi)\n\011first-line-start-indent: -2pi\n\n\011(if (or biblio-number xreflabel has-leading-abbrev?)\n\011    (make sequence\n\011      (literal "[")\n\n\011      (if biblio-number \n\011\011  (literal (number->string (bibentry-number (current-node))))\n\011\011  (empty-sosofo))\n\011\n\011      (if xreflabel\n\011\011  (literal xreflabel)\n\011\011  (empty-sosofo))\n\011\n\011      (if has-leading-abbrev?\n\011\011  (with-mode biblioentry-inline-mode \n\011\011    (process-node-list leading-abbrev))\n\011\011  (empty-sosofo))\n\n\011      (literal "]\\no-break-space;"))\n\011    (empty-sosofo))\n\011\n\011(let loop ((nl inline-children))\n\011  (if (node-list-empty? nl)\n\011      (empty-sosofo)\n\011      (make sequence\n\011\011(with-mode biblioentry-inline-mode\n\011\011  (process-node-list (node-list-first nl)))\n\011\011(if (node-list-empty? (node-list-rest nl))\n\011\011    (biblioentry-inline-end block-children)\n\011\011    (biblioentry-inline-sep (node-list-first nl)\n\011\011\011\011\011  (node-list-rest nl)))\n\011\011(loop (node-list-rest nl))))))\n\n      (make display-group\n\011start-indent: (+ (inherited-start-indent) 2pi)\n\011(let loop ((nl block-children))\n\011  (if (node-list-empty? nl)\n\011      (empty-sosofo)\n\011      (make sequence\n\011\011(with-mode biblioentry-block-mode\n\011\011  (process-node-list (node-list-first nl)))\n\011\011(if (node-list-empty? (node-list-rest nl))\n\011\011    (biblioentry-block-end)\n\011\011    (biblioentry-block-sep (node-list-first nl)\n\011\011\011\011\011   (node-list-rest nl)))\n\011\011(loop (node-list-rest nl)))))))))\n\n(mode biblioentry-inline-mode\n  (element abbrev\n    (make sequence\n      (process-children)))\n\n  (element affiliation\n    (let ((inline-children (node-list-filter-by-not-gi \n\011\011\011    (children (current-node))\n\011\011\011    (list (normalize "address")))))\n      (let loop ((nl inline-children))\n\011(if (node-list-empty? nl)\n\011    (empty-sosofo)\n\011    (make sequence\n\011      (process-node-list (node-list-first nl))\n\011      (if (node-list-empty? (node-list-rest nl))\n\011\011  (empty-sosofo)\n\011\011  (literal ", "))\n\011      (loop (node-list-rest nl)))))))\n\n  (element artpagenums\n    (make sequence\n      (process-children)))\n\n  (element author\n    (literal (author-list-string)))\n\n  (element authorgroup\n    (process-children))\n\n  (element authorinitials\n    (make sequence\n      (process-children)))\n\n  (element collab\n    (let* ((nl (children (current-node)))\n\011   (collabname (node-list-first nl))\n\011   (affil (node-list-rest nl)))\n      (make sequence\n\011(process-node-list collabname)\n\011(if (node-list-empty? affil)\n\011    (empty-sosofo)\n\011    (let loop ((nl affil))\n\011      (if (node-list-empty? nl)\n\011\011  (empty-sosofo)\n\011\011  (make sequence\n\011\011    (literal ", ")\n\011\011    (process-node-list (node-list-first nl))\n\011\011    (loop (node-list-rest nl)))))))))\n\n  (element (collab collabname)\n    (process-children))\n\n  (element confgroup\n    (let ((inline-children (node-list-filter-by-not-gi \n\011\011\011    (children (current-node))\n\011\011\011    (list (normalize "address")))))\n      (let loop ((nl inline-children))\n\011(if (node-list-empty? nl)\n\011    (empty-sosofo)\n\011    (make sequence\n\011      (process-node-list (node-list-first nl))\n\011      (if (node-list-empty? (node-list-rest nl))\n\011\011  (empty-sosofo)\n\011\011  (literal ", "))\n\011      (loop (node-list-rest nl)))))))\n\n  (element contractnum\n    (process-children))\n\n  (element contractsponsor\n    (process-children))\n\n  (element contrib\n    (process-children))\n\n  (element copyright\n    ;; Just print the year(s)\n    (let ((years (select-elements (children (current-node))\n\011\011\011\011  (normalize "year"))))\n      (process-node-list years)))\n\n  (element (copyright year)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling? (current-node)))\n\011  (literal ", ")\n\011  (empty-sosofo))))\n\n  (element corpauthor\n    (make sequence\n      (process-children)))\n\n  (element corpname\n    (make sequence\n      (process-children)))\n\n  (element date\n    (make sequence\n      (process-children)))\n\n  (element edition\n    (make sequence\n      (process-children)))\n\n  (element editor\n    (make sequence\n      (literal (gentext-edited-by))\n      (literal " ")\n      (literal (author-list-string))))\n\n  (element firstname\n    (make sequence\n      (process-children)))\n\n  (element honorific\n    (make sequence\n      (process-children)))\n\n  (element invpartnumber\n    (make sequence\n      (process-children)))\n\n  (element isbn\n    (make sequence\n      (process-children)))\n\n  (element issn\n    (make sequence\n      (process-children)))\n\n  (element issuenum\n    (make sequence\n      (process-children)))\n\n  (element lineage\n    (make sequence\n      (process-children)))\n\n  (element orgname\n    (make sequence\n      (process-children)))\n\n  (element othercredit\n    (literal (author-list-string)))\n\n  (element othername\n    (make sequence\n      (process-children)))\n\n  (element pagenums\n    (make sequence\n      (process-children)))\n\n  (element productname\n    (make sequence\n      ($charseq$)\n; this is actually a problem since "trade" is the default value for\n; the class attribute. we can put this back in in DocBook 5.0, when\n; class becomes #IMPLIED\n;      (if (equal? (attribute-string "class") (normalize "trade"))\n;\011  (literal "\\trade-mark-sign;")\n;\011  (empty-sosofo))\n      ))\n  \n  (element productnumber\n    (make sequence\n      (process-children)))\n\n  (element pubdate\n    (make sequence\n      (process-children)))\n\n  (element publisher\n    (let ((pubname (select-elements (children (current-node))\n\011\011\011\011    (normalize "publishername")))\n\011  (cities  (select-elements (descendants (current-node))\n\011\011\011\011    (normalize "city"))))\n    (make sequence\n      (process-node-list pubname)\n      (if (node-list-empty? cities)\n\011  (empty-sosofo)\n\011  (literal ", "))\n      (process-node-list cities))))\n\n  (element publishername\n    (make sequence\n      (process-children)))\n\n  (element (publisher address city)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling? (current-node)))\n\011  (literal ", ")\n\011  (empty-sosofo))))\n\n  (element pubsnumber\n    (make sequence\n      (process-children)))\n\n  (element releaseinfo\n    (make sequence\n      (process-children)))\n\n  (element seriesvolnums\n    (make sequence\n      (process-children)))\n\n  (element subtitle\n    (make sequence\n      font-posture: 'italic\n      (process-children)))\n\n  (element surname\n    (make sequence\n      (process-children)))\n\n  (element title\n    (make sequence\n      font-posture: 'italic\n      (process-children)))\n\n  (element titleabbrev\n    (make sequence\n      (process-children)))\n\n  (element volumenum\n    (make sequence\n      (process-children)))\n\n  (element (bibliomixed title) \n      (make sequence\n\011font-posture: 'italic\n\011(process-children)))\n\n  \n  (element (bibliomixed subtitle) \n    (make sequence\n      font-posture: 'italic\n      (process-children)))\n\n  (element (biblioset title)\n    (let ((rel (case-fold-up \n\011\011(inherited-attribute-string (normalize "relation")))))\n      (cond\n       ((equal? rel "ARTICLE") (make sequence\n\011\011\011\011 (literal (gentext-start-quote))\n\011\011\011\011 (process-children)\n\011\011\011\011 (literal (gentext-end-quote))))\n       (else (make sequence\n\011       font-posture: 'italic\n\011       (process-children))))))\n\n  (element (bibliomset title)\n    (let ((rel (case-fold-up \n\011\011(inherited-attribute-string (normalize "relation")))))\n      (cond\n       ((equal? rel "ARTICLE") (make sequence\n\011\011\011\011 (literal (gentext-start-quote))\n\011\011\011\011 (process-children)\n\011\011\011\011 (literal (gentext-end-quote))))\n       (else        (make sequence\n\011\011      font-posture: 'italic\n\011\011      (process-children))))))\n)\n\n(mode biblioentry-block-mode\n  (element abstract\n    (make display-group\n      (process-children)))\n\n  (element (abstract title)\n    (make paragraph\n      font-weight: 'bold\n      (process-children)))\n\n  (element address\n    ($linespecific-display$ %indent-address-lines% %number-address-lines%))\n\n  (element authorblurb\n    (make display-group\n      (process-children)))\n\n  (element printhistory\n    (make display-group\n      (process-children)))\n\n  (element revhistory\n    (make sequence\n      (make paragraph\n\011font-weight: 'bold\n\011(literal (gentext-element-name (current-node))))\n      (make table\n\011before-row-border: #f\n\011(make table-column\n\011  column-number: 1\n\011  width: (/ (- %body-width% (inherited-start-indent)) 3))\n\011(make table-column\n\011  column-number: 2\n\011  width: (/ (- %body-width% (inherited-start-indent)) 3))\n\011(make table-column\n\011  column-number: 3\n\011  width: (/ (- %body-width% (inherited-start-indent)) 3))\n\011(process-children))))\n\n  (element (revhistory revision)\n    (let ((revnumber (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "revnumber")))\n\011  (revdate   (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "date")))\n\011  (revauthor (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "authorinitials")))\n\011  (revremark (node-list-filter-by-gi\n\011\011      (descendants (current-node))\n\011\011      (list (normalize "revremark")\n\011\011\011    (normalize "revdescription")))))\n      (make sequence\n\011(make table-row\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    (if (not (node-list-empty? revnumber))\n\011\011(make paragraph\n\011\011  (make sequence\n\011\011    (literal (gentext-element-name-space (current-node)))\n\011\011    (process-node-list revnumber)))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 2\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    (if (not (node-list-empty? revdate))\n\011      (make paragraph\n\011\011(process-node-list revdate))\n\011      (empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 3\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    (if (not (node-list-empty? revauthor))\n\011\011(make paragraph\n\011\011  (make sequence\n\011\011    (literal (gentext-revised-by))\n\011\011    (process-node-list revauthor)))\n\011\011(empty-sosofo))))\n\011(make table-row\n\011  cell-after-row-border: #f\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 3\n\011    n-rows-spanned: 1\n\011    (if (not (node-list-empty? revremark))\n\011\011(make paragraph\n\011\011  space-after: %block-sep%\n\011\011  (process-node-list revremark))\n\011\011(empty-sosofo)))))))\n\n  (element (revision revnumber) (process-children-trim))\n  (element (revision date) (process-children-trim))\n  (element (revision authorinitials) (process-children-trim))\n  (element (revision revremark) (process-children-trim))\n  (element (revision revdescription) (process-children))\n\n  (element seriesinfo\n    ;; This is a nearly biblioentry recursively...\n    (let* ((expanded-children   (expand-children \n\011\011\011\011 (children (current-node))\n\011\011\011\011 (biblioentry-flatten-elements)))\n\011   (all-inline-children (if %biblioentry-in-entry-order%\n\011\011\011\011    (titlepage-gi-list-by-nodelist\n\011\011\011\011     (biblioentry-inline-elements)\n\011\011\011\011     expanded-children)\n\011\011\011\011    (titlepage-gi-list-by-elements\n\011\011\011\011     (biblioentry-inline-elements)\n\011\011\011\011     expanded-children)))\n\011   (block-children      (if %biblioentry-in-entry-order%\n\011\011\011\011    (titlepage-gi-list-by-nodelist\n\011\011\011\011     (biblioentry-block-elements)\n\011\011\011\011     expanded-children)\n\011\011\011\011    (titlepage-gi-list-by-elements\n\011\011\011\011     (biblioentry-block-elements)\n\011\011\011\011     expanded-children)))\n\011   (inline-children     all-inline-children))\n      (make display-group\n\011(make paragraph\n\011  space-before: %para-sep%\n\011  space-after: %para-sep%\n\011  start-indent: (+ (inherited-start-indent) 2pi)\n\011  first-line-start-indent: -2pi\n\011  \n\011  (let loop ((nl inline-children))\n\011    (if (node-list-empty? nl)\n\011\011(empty-sosofo)\n\011\011(make sequence\n\011\011  (with-mode biblioentry-inline-mode\n\011\011    (process-node-list (node-list-first nl)))\n\011\011  (if (node-list-empty? (node-list-rest nl))\n\011\011      (biblioentry-inline-end block-children)\n\011\011      (biblioentry-inline-sep (node-list-first nl)\n\011\011\011\011\011      (node-list-rest nl)))\n\011\011  (loop (node-list-rest nl))))))\n\011\n\011(make display-group\n\011  start-indent: (+ (inherited-start-indent) 2pi)\n\011  (let loop ((nl block-children))\n\011    (if (node-list-empty? nl)\n\011\011(empty-sosofo)\n\011\011(make sequence\n\011\011  (with-mode biblioentry-block-mode\n\011\011    (process-node-list (node-list-first nl)))\n\011\011  (if (node-list-empty? (node-list-rest nl))\n\011\011      (biblioentry-block-end)\n\011\011      (biblioentry-block-sep (node-list-first nl)\n\011\011\011\011\011     (node-list-rest nl)))\n\011\011  (loop (node-list-rest nl)))))))))\n)\n\n(element bibliomixed \n  (let* ((all-inline-children (children (current-node)))\n\011 (leading-abbrev      (if (equal? (normalize "abbrev")\n\011\011\011\011\011  (gi (node-list-first \n\011\011\011\011\011       all-inline-children)))\n\011\011\011\011  (node-list-first all-inline-children)\n\011\011\011\011  (empty-node-list)))\n\011 (inline-children     (if (node-list-empty? leading-abbrev)\n\011\011\011\011  all-inline-children\n\011\011\011\011  (node-list-rest all-inline-children)))\n\011 (has-leading-abbrev? (not (node-list-empty? leading-abbrev)))\n\011 (xreflabel           (if (or has-leading-abbrev? biblio-number)\n\011\011\011\011  #f\n\011\011\011\011  (attribute-string (normalize "xreflabel")))))\n    (make paragraph\n      space-before: %para-sep%\n      space-after: %para-sep%\n      start-indent: (+ (inherited-start-indent) 2pi)\n      first-line-start-indent: -2pi\n\n      (if (or biblio-number xreflabel has-leading-abbrev?)\n\011  (make sequence\n\011    (literal "[")\n\n\011    (if biblio-number \n\011\011(literal (number->string (bibentry-number (current-node))))\n\011\011(empty-sosofo))\n\011    \n\011    (if xreflabel\n\011\011(literal xreflabel)\n\011\011(empty-sosofo))\n\011    \n\011    (if has-leading-abbrev?\n\011\011(with-mode biblioentry-inline-mode \n\011\011  (process-node-list leading-abbrev))\n\011\011(empty-sosofo))\n\011    \n\011    (literal "]\\no-break-space;"))\n\011  (empty-sosofo))\n\n      (with-mode biblioentry-inline-mode\n\011(process-children)))))\n\n;; ....................... BIBLIOGRAPHY ELEMENTS .......................\n\n;; These are element construction rules for bibliography elements that \n;; may occur outside of a BIBLIOENTRY or BIBLIOMIXED.\n\n(element bibliomisc (process-children))\n(element bibliomset (process-children))\n(element biblioset (process-children))\n(element bookbiblio (process-children))\n\n(element street ($charseq$))\n(element pob ($charseq$))\n(element postcode ($charseq$))\n(element city ($charseq$))\n(element state ($charseq$))\n(element country ($charseq$))\n(element phone ($charseq$))\n(element fax ($charseq$))\n(element otheraddr ($charseq$))\n(element affiliation ($charseq$))\n(element shortaffil ($charseq$))\n(element jobtitle ($charseq$))\n(element orgdiv ($charseq$))\n(element artpagenums ($charseq$))\n\n(element author\n  (make sequence\n    (literal (author-list-string))))\n\n(element authorgroup (process-children))\n\n(element collab (process-children))\n(element collabname ($charseq$))\n(element authorinitials ($charseq$))\n(element confgroup (process-children))\n(element confdates ($charseq$))\n(element conftitle ($charseq$))\n(element confnum ($charseq$))\n(element confsponsor ($charseq$))\n(element contractnum ($charseq$))\n(element contractsponsor ($charseq$))\n\n(element copyright\n  (make paragraph\n    (make sequence\n      (literal (gentext-element-name (current-node)))\n      (literal "\\no-break-space;")\n      (literal (dingbat "copyright"))\n      (literal "\\no-break-space;")\n      (process-children-trim))))\n\n(element year\n  (make sequence\n    (process-children)\n    (if (not (last-sibling? (current-node)))\n\011(literal ", ")\n\011(literal " "))))\n\n(element holder ($charseq$))\n\n(element corpauthor\n  (make sequence\n    (literal (author-list-string))))\n\n(element corpname ($charseq$))\n(element date ($charseq$))\n(element edition ($charseq$))\n(element editor ($charseq$))\n(element isbn ($charseq$))\n(element issn ($charseq$))\n(element invpartnumber ($charseq$))\n(element issuenum ($charseq$))\n\n(element legalnotice ($semiformal-object$))\n(element (legalnotice title) (empty-sosofo))\n\n(element modespec (empty-sosofo))\n\n(element orgname ($charseq$))\n\n(element othercredit\n  (make sequence\n    (literal (author-list-string))))\n\n(element pagenums ($charseq$))\n(element contrib ($charseq$))\n\n(element firstname ($charseq$))\n(element honorific ($charseq$))\n(element lineage ($charseq$))\n(element othername ($charseq$))\n(element surname ($charseq$))\n\n(element printhistory (empty-sosofo))\n\n(element productname\n  (make sequence\n    ($charseq$)\n; this is actually a problem since "trade" is the default value for\n; the class attribute. we can put this back in in DocBook 5.0, when\n; class becomes #IMPLIED\n;    (if (equal? (attribute-string "class") (normalize "trade"))\n;\011(literal "\\trade-mark-sign;")\n;\011(empty-sosofo))\n))\n\n(element productnumber ($charseq$))\n(element pubdate ($charseq$))\n(element publisher (process-children))\n(element publishername ($charseq$))\n(element pubsnumber ($charseq$))\n(element releaseinfo (empty-sosofo))\n(element revision ($charseq$))\n(element revnumber ($charseq$))\n(element revremark ($charseq$))\n(element revdescription ($block-container$))\n(element seriesvolnums ($charseq$))\n(element volumenum ($charseq$))\n\n;; The (element (bookinfo revhistory)) construction rule is in dbinfo.dsl\n;; It calls $book-revhistory$...\n(define ($book-revhistory$)\n  (make sequence\n    (make paragraph\n      use: title-style\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      space-before: (* (HSIZE 3) %head-before-factor%)\n      space-after: (* (HSIZE 1) %head-before-factor%)\n      (literal (gentext-element-name (current-node))))\n    (make table\n      before-row-border: #f\n      (process-children))))\n\n(element (revhistory revision)\n  (let ((revnumber (select-elements (descendants (current-node))\n\011\011\011\011    (normalize "revnumber")))\n\011(revdate   (select-elements (descendants (current-node))\n\011\011\011\011    (normalize "date")))\n\011(revauthor (select-elements (descendants (current-node))\n\011\011\011\011    (normalize "authorinitials")))\n\011(revremark (node-list-filter-by-gi\n\011\011    (descendants (current-node))\n\011\011    (list (normalize "revremark")\n\011\011\011  (normalize "revdescription")))))\n    (make sequence\n      (make table-row\n\011(make table-cell\n\011  column-number: 1\n\011  n-columns-spanned: 1\n\011  n-rows-spanned: 1\n\011  (if (not (node-list-empty? revnumber))\n\011      (make paragraph\n\011\011(make sequence\n\011\011  (literal (gentext-element-name-space (current-node)))\n\011\011  (process-node-list revnumber)))\n\011      (empty-sosofo)))\n\011(make table-cell\n\011  column-number: 2\n\011  n-columns-spanned: 1\n\011  n-rows-spanned: 1\n\011  (if (not (node-list-empty? revdate))\n\011      (make paragraph\n\011\011(process-node-list revdate))\n\011      (empty-sosofo)))\n\011(make table-cell\n\011  column-number: 3\n\011  n-columns-spanned: 1\n\011  n-rows-spanned: 1\n\011  (if (not (node-list-empty? revauthor))\n\011      (make paragraph\n\011\011(make sequence\n\011\011  (literal (gentext-revised-by))\n\011\011  (process-node-list revauthor)))\n\011      (empty-sosofo))))\n      (make table-row\n\011cell-after-row-border: #f\n\011(make table-cell\n\011  column-number: 1\n\011  n-columns-spanned: 3\n\011  n-rows-spanned: 1\n\011  (if (not (node-list-empty? revremark))\n\011      (make paragraph\n\011\011space-after: %block-sep%\n\011\011(process-node-list revremark))\n\011      (empty-sosofo)))))))\n\n(element (revision revnumber) (process-children-trim))\n(element (revision date) (process-children-trim))\n(element (revision authorinitials) (process-children-trim))\n(element (revision revremark) (process-children-trim))\n(element (revision revdescription) (process-children))\n    \n;; $Id: dbblock.dsl,v 1.13 2004/09/14 09:49:58 petere78 Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n(element revhistory ($book-revhistory$))\n\n(element highlights ($block-container$))\n\n(element (para blockquote)\n  (let* ((attrib       (select-elements (children (current-node))\n\011\011\011\011\011(normalize "attribution")))\n\011 (paras        (node-list-filter-by-not-gi\n\011\011\011(children (current-node))\n\011\011\011(list (normalize "attribution")))))\n    (make sequence\n      (make paragraph\n\011first-line-start-indent: 0pt ;; workaround a bug/feature?\n\011;; W/o the preceding line, the first-line-start-indent of the enclosing\n\011;; paragraph will apply to the paragraphs in this blockquote which is\n\011;; probably not wanted..\n\011font-size: (* %bf-size% %smaller-size-factor%)\n\011line-spacing: (* %bf-size% %line-spacing-factor%\n\011\011\011 %smaller-size-factor%)\n\011space-before: %para-sep%\n        start-indent: (+ (inherited-start-indent) %blockquote-start-indent%)\n        end-indent: %blockquote-end-indent%\n\011(process-node-list paras))\n      (if (node-list-empty? attrib)\n\011  (empty-sosofo)\n\011  (make paragraph\n\011    font-size: (* %bf-size% %smaller-size-factor%)\n\011    line-spacing: (* %bf-size% %line-spacing-factor%\n\011\011\011   %smaller-size-factor%)\n\011    space-before: 0pt\n\011    end-indent: 1em\n\011    quadding: 'end\n\011    (make sequence\n\011      (literal "\\em-dash;")\n\011      (process-node-list attrib)))))))\n\n(element blockquote\n  (let* ((attrib       (select-elements (children (current-node))\n\011\011\011\011\011(normalize "attribution")))\n\011 (paras        (node-list-filter-by-not-gi\n\011\011\011(children (current-node))\n\011\011\011(list (normalize "attribution")))))\n    (make sequence\n      (make paragraph\n\011font-size: (* %bf-size% %smaller-size-factor%)\n\011line-spacing: (* %bf-size% %line-spacing-factor%\n\011\011\011 %smaller-size-factor%)\n\011space-before: %para-sep%\n        start-indent: (+ (inherited-start-indent) %blockquote-start-indent%)\n        end-indent: %blockquote-end-indent%\n\011(process-node-list paras))\n      (if (node-list-empty? attrib)\n\011  (empty-sosofo)\n\011  (make paragraph\n\011    font-size: (* %bf-size% %smaller-size-factor%)\n\011    line-spacing: (* %bf-size% %line-spacing-factor%\n\011\011\011     %smaller-size-factor%)\n\011    space-before: 0pt\n\011    end-indent: 1em\n\011    quadding: 'end\n\011    (make sequence\n\011      (literal "\\em-dash;")\n\011      (process-node-list attrib)))))))\n\n(element (blockquote para)\n  (if (absolute-last-sibling? (current-node))\n      (make paragraph\n\011space-before: %para-sep%\n\011space-after: 0pt\n \011quadding: %default-quadding%\n\011(process-children-trim))\n      ($paragraph$)))\n\n(element epigraph\n  (let* ((addln-indent %epigraph-start-indent%)\n\011 (attrib       (select-elements (children (current-node))\n\011\011\011\011\011(normalize "attribution")))\n\011 (paras        (node-list-filter-by-not-gi\n\011\011\011(children (current-node))\n\011\011\011(list (normalize "attribution")))))\n    (make display-group\n      start-indent: (+ %body-start-indent% addln-indent)\n      end-indent: %epigraph-end-indent%\n      font-posture: 'italic\n      (process-node-list paras)\n      (if (node-list-empty? attrib)\n\011  (empty-sosofo)\n\011  (make paragraph\n\011    space-before: 0pt\n\011    quadding: 'end\n\011    (process-node-list attrib))))))\n\n(element attribution\n  ($charseq$))\n\n(element (epigraph para)\n  (if (absolute-last-sibling? (current-node))\n      (make paragraph\n\011space-before: %para-sep%\n\011space-after: 0pt\n \011quadding: %default-quadding%\n\011(process-children-trim))\n      ($paragraph$)))\n\n(element para ($paragraph$))\n(element simpara ($paragraph$))\n\n(element formalpara ($para-container$))\n\n(element (formalpara title) ($runinhead$))\n(element (formalpara para) (make sequence (process-children-trim)))\n\n(element sidebar \n  (make box\n    display?: #t\n    box-type: 'border\n    line-thickness: 1pt\n    start-indent: (inherited-start-indent)\n    end-indent: (inherited-end-indent)\n    (if (node-list-empty? (select-elements (children (current-node))\n\011\011\011\011\011   (normalize "title")))\n\011(make display-group\n\011  start-indent: 2pt\n\011  end-indent: 2pt\n\011  space-before: %block-sep%\n\011  space-after: %block-sep%\n\011  (process-children))\n\011(make display-group\n\011  start-indent: 2pt\n\011  end-indent: 2pt\n\011  space-before: 0pt\n\011  space-after: %block-sep%\n\011  (make sequence\n\011    (let* ((object (current-node))\n\011\011   (title  (select-elements (children object) \n\011\011\011\011\011    (normalize "title")))\n\011\011   (nsep   (gentext-label-title-sep (gi object))))\n\011      (make paragraph\n\011\011font-weight: 'bold\n\011\011space-before: %block-sep%\n\011\011space-after: %para-sep%\n\011\011keep-with-next?: #t\n\011\011(literal (gentext-element-name object))\n\011\011(if (string=? (element-label object) "")\n\011\011    (literal nsep)\n\011\011    (literal " " (element-label object) nsep))\n\011\011(process-node-list (children title))))\n\011    (process-children))))))\n\n(element (sidebar title) (empty-sosofo))\n\n(element abstract \n  (make display-group\n    space-before: %block-sep%\n    space-after: %block-sep%\n    start-indent: %body-start-indent%\n    (process-children)))\n\n(element authorblurb ($block-container$))\n\n(element ackno ($paragraph$))\n\n(define ($inline-object$)\n  (process-children))\n\n(define ($informal-object$ #!optional (rule-before? #f) (rule-after? #f))\n  (make display-group\n    start-indent: (+ %block-start-indent% (inherited-start-indent))\n    space-before: %block-sep%\n    space-after: %block-sep%\n    (if rule-before?\n\011(make rule\n\011  orientation: 'horizontal\n\011  line-thickness: %object-rule-thickness%\n\011  display-alignment: 'center\n\011  space-after: (/ %block-sep% 2)\n\011  keep-with-next?: #t)\n\011(empty-sosofo))\n    (process-children)\n    (if rule-after?\n\011(make rule\n\011  orientation: 'horizontal\n\011  line-thickness: %object-rule-thickness%\n\011  display-alignment: 'center\n\011  space-before: (/ %block-sep% 2)\n\011  keep-with-previous?: #t)\n\011(empty-sosofo))))\n\n(define (object-title-after #!optional (node (current-node))) \n  (if (member (gi node) ($object-titles-after$))\n      #t\n      #f))\n\n(define (float-object node)\n  ;; you could redefine this to make only figures float, or only tables,\n  ;; or whatever...\n  #t)\n\n(define (named-formal-objects)\n  (list (normalize "figure")\n\011(normalize "table")\n\011(normalize "example")\n\011(normalize "equation")))\n\n(define ($formal-object$ #!optional (rule-before? #f) (rule-after? #f))\n  (let* ((object-sosofo (make paragraph\n\011\011\011  space-before: 0pt\n\011\011\011  space-after: 0pt\n\011\011\011  start-indent: (+ %block-start-indent% \n\011\011\011\011\011   (inherited-start-indent))\n\011\011\011  keep-with-next?: (object-title-after)\n\011\011\011  (process-children)))\n\011 (title-sosofo  (with-mode formal-object-title-mode\n\011\011\011  (process-node-list \n\011\011\011   (select-elements (children (current-node))\n\011\011\011\011\011    (normalize "title")))))\n\011 (sosofo        (make display-group\n\011\011\011  space-before: %block-sep%\n\011\011\011  space-after: %block-sep%\n\011\011\011  (if rule-before?\n\011\011\011      (make rule\n\011\011\011\011orientation: 'horizontal\n\011\011\011\011line-thickness: %object-rule-thickness%\n\011\011\011\011display-alignment: 'center\n\011\011\011\011space-after: (/ %block-sep% 2)\n\011\011\011\011keep-with-next?: #t)\n\011\011\011      (empty-sosofo))\n\011\011\011  (if (object-title-after)\n\011\011\011    (make sequence\n\011\011\011      object-sosofo\n\011\011\011      title-sosofo)\n\011\011\011    (make sequence\n\011\011\011      title-sosofo\n\011\011\011      object-sosofo))\n\011\011\011  (if rule-after?\n\011\011\011      (make rule\n\011\011\011\011orientation: 'horizontal\n\011\011\011\011line-thickness: %object-rule-thickness%\n\011\011\011\011display-alignment: 'center\n\011\011\011\011space-before: (/ %block-sep% 2)\n\011\011\011\011keep-with-previous?: #t)\n\011\011\011      (empty-sosofo)))))\n    (if (and (equal? (print-backend) 'tex)\n\011     formal-object-float\n\011     (float-object (current-node)))\n\011(make page-float\n\011  sosofo)\n\011sosofo)))\n\n(define ($semiformal-object$)\n  (if (node-list-empty? (select-elements (children (current-node))\n\011\011\011\011\011 (normalize "title")))\n      ($informal-object$)\n      ($formal-object$)))\n\n(define (figure-global-number nd)\n  ;; Count all figures in the document before this one\n  (let ((all-figures (select-elements (descendants (sgml-root-element))\n\011\011\011\011       (normalize "figure"))))\n    (let loop ((figs all-figures) (count 1))\n      (if (node-list-empty? figs)\n\011  "0"\n\011  (if (node-list=? nd (node-list-first figs))\n\011      (number->string count)\n\011      (loop (node-list-rest figs) (+ count 1)))))))\n\n(mode formal-object-title-mode\n  (element title\n    (let* ((object (parent (current-node)))\n\011   (nsep   (gentext-label-title-sep (gi object)))\n\011   (label  (if (equal? (gi object) (normalize "figure"))\n\011\011       (figure-global-number object)\n\011\011       (element-label object))))\n      (make paragraph\n\011font-weight: %formal-object-title-font-weight%\n\011quadding: 'center\n\011space-before: (if (object-title-after (parent (current-node)))\n\011\011\011  %para-sep%\n\011\011\011  0pt)\n\011space-after: (if (object-title-after (parent (current-node)))\n\011\011\011 0pt\n\011\011\011 %para-sep%)\n\011start-indent: (+ %block-start-indent% (inherited-start-indent))\n\011keep-with-next?: (not (object-title-after (parent (current-node))))\n\011(if (member (gi object) (named-formal-objects))\n\011    (make sequence\n\011      (literal (gentext-element-name object))\n\011      (if (string=? label "")\n\011\011  (literal nsep)\n\011\011  (literal " " label nsep)))\n\011    (empty-sosofo))\n\011(process-children))))\n)\n\n(element example\n  ($formal-object$ %example-rules% %example-rules%))\n\n(element (example title) (empty-sosofo)) ; don't show caption below example\n\n;; Note: informalexample handler commented out - using custom handler in dbprod.dsl\n;;(element informalexample\n;;  ($informal-object$ %informalexample-rules% %informalexample-rules%))\n\n(element informalfigure\n  ($informal-object$ %informalfigure-rules% %informalfigure-rules%))\n\n(element (figure title) (empty-sosofo)) ; don't show caption below figure\n\n(element figure\n  ;; FIXME: this is a bit crude...\n  (let* ((mediaobj (select-elements (children (current-node))\n\011\011\011\011    (normalize "mediaobject")))\n\011 (imageobj (select-elements (children mediaobj)\n\011\011\011\011    (normalize "imageobject")))\n\011 (image    (select-elements (children imageobj)\n\011\011\011\011    (normalize "imagedata")))\n\011 (graphic  (select-elements (children (current-node))\n\011\011\011\011    (normalize "graphic")))\n\011 (align    (if (node-list-empty? image)\n\011\011       (if (node-list-empty? graphic)\n\011\011\011   #f\n\011\011\011   (attribute-string (normalize "align")\n\011\011\011\011\011     (node-list-first graphic)))\n\011\011       (attribute-string (normalize "align") (node-list-first image))))\n\011 (dalign  (cond ((equal? align (normalize "center"))\n\011\011\011 'center)\n\011\011\011((equal? align (normalize "right"))\n\011\011\011 'end)\n\011\011\011(else\n\011\011\011 'start))))\n    (if align\n\011(make display-group\n\011  quadding: dalign\n\011  ($formal-object$ %figure-rules% %figure-rules%))\n\011($formal-object$ %figure-rules% %figure-rules%))))\n\n(element informaltable \n  ($informal-object$ %informaltable-rules% %informaltable-rules%))\n\n(element table \n  ;; can't be a "formal-object" because it requires special handling for\n  ;; the PGWIDE attribute\n  (let* ((nsep   (gentext-label-title-sep (gi)))\n\011 (pgwide (attribute-string (normalize "pgwide")))\n\011 (indent (lambda () (if (not (equal? pgwide "1"))\n\011\011\011\011(+ %block-start-indent% \n\011\011\011\011   (inherited-start-indent))\n\011\011\011\011%cals-pgwide-start-indent%)))\n\011 (rule-before? %table-rules%)\n\011 (rule-after? %table-rules%)\n\011 (title-sosofo (make paragraph\n\011\011\011 font-weight: %table-title-font-weight%\n\011\011\011 space-before: (if (object-title-after)\n\011\011\011\011\011   %para-sep%\n\011\011\011\011\011   0pt)\n\011\011\011 space-after: (if (object-title-after)\n\011\011\011\011\011  0pt\n\011\011\011\011\011  %para-sep%)\n\011\011\011 start-indent: (indent)\n\011\011\011  keep-with-next?: (not (object-title-after))\n\011\011\011  (literal (gentext-element-name (current-node)))\n\011\011\011  (if (string=? (element-label) "")\n\011\011\011      (literal nsep)\n\011\011\011      (literal " " (element-label) nsep))\n\011\011\011  (element-title-sosofo)))\n\011  (table-sosofo (make display-group\n\011\011\011  font-weight: 'bold\n\011\011\011  space-before: 0pt\n\011\011\011  space-after: 0pt\n\011\011\011  start-indent: (indent)\n\011\011\011  keep-with-next?: (object-title-after)\n\011\011\011  (process-children)))\n\011  (table (make display-group\n\011\011   start-indent: (+ %block-start-indent%\n\011\011\011\011    (inherited-start-indent))\n\011\011   space-before: %block-sep%\n\011\011   space-after: %block-sep%\n\011\011   (if rule-before?\n\011\011       (make rule\n\011\011\011 orientation: 'horizontal\n\011\011\011 line-thickness: %object-rule-thickness%\n\011\011\011 display-alignment: 'center\n\011\011\011 space-after: (/ %block-sep% 2)\n\011\011\011 keep-with-next?: #t)\n\011\011       (empty-sosofo))\n\011\011   (if (object-title-after)\n\011\011       (make sequence\n\011\011\011 table-sosofo\n\011\011\011 title-sosofo)\n\011\011       (make sequence\n\011\011\011 title-sosofo\n\011\011\011 table-sosofo))\n\011\011   (if rule-after?\n\011\011       (make rule\n\011\011\011 orientation: 'horizontal\n\011\011\011 line-thickness: %object-rule-thickness%\n\011\011\011 display-alignment: 'center\n\011\011\011 space-before: (/ %block-sep% 2)\n\011\011\011 keep-with-previous?: #t)\n\011\011       (empty-sosofo)))))\n    (if (and (equal? (print-backend) 'tex)\n\011     formal-object-float\n\011     (float-object (current-node)))\n\011(make page-float\n\011  table)\n\011table)))\n\n(element (table title) (empty-sosofo))\n\n(element comment\n  (if %show-comments%\n      (make paragraph\n\011start-indent: 0pt\n\011first-line-start-indent: -10pt\n\011font-posture: 'italic\n\011font-size: (* (inherited-font-size) 0.9)\n\011(make sequence\n\011  (make line-field \n\011    field-width: 10pt\n\011    quadding: 'end\n\011    (literal "*"))\n\011  (process-children)))\n      (empty-sosofo)))\n\n;; In DocBook V4.0 comment became remark\n(element remark\n  (if %show-comments%\n      (make paragraph\n\011start-indent: 0pt\n\011first-line-start-indent: -10pt\n\011font-posture: 'italic\n\011font-size: (* (inherited-font-size) 0.9)\n\011(make sequence\n\011  (make line-field \n\011    field-width: 10pt\n\011    quadding: 'end\n\011    (literal "*"))\n\011  (process-children)))\n      (empty-sosofo)))\n\n;; ======================================================================\n;; Handle footnotes in the body...\n\n(define %footnote-field-width% 1.6em)\n(define %footnote-number-restarts% #t)\n(define %footnote-endnote-break% #f)\n\n(define (count-footnote? footnote)\n  ;; don't count footnotes in comments (unless you're showing comments)\n  ;; or footnotes in tables which are handled locally in the table\n  ;; or footnotes for empty ulinks which don't need a footnote\n  (if (or (and (has-ancestor-member? footnote (list (normalize "comment")))\n\011       (not %show-comments%))\n\011  (has-ancestor-member? footnote (list (normalize "tgroup")))\n          (and (has-ancestor-member? footnote (list (normalize "ulink")))\n               (node-list-empty? (children footnote))\n               %footnote-ulinks%))\n      #f\n      #t))\n\n(define (footnote-number footnote)\n  ;; This is more complex than it at first appears because footnotes \n  ;; can be in Comments which may be suppressed.\n  (let* ((root-list (if %footnote-number-restarts%\n\011\011\011    (component-element-list)\n\011\011\011    (list (normalize "book"))))\n\011 (footnotes (if %footnote-ulinks%\n\011\011\011(component-list-descendant-node-list\n\011\011\011 footnote\n\011\011\011 (list (normalize "ulink") (normalize "footnote"))\n\011\011\011 root-list)\n\011\011\011(component-descendant-node-list\n\011\011\011 footnote\n\011\011\011 root-list)))\n\011 (fn-number (let loop ((nl footnotes) (num 1))\n\011\011      (if (node-list-empty? nl)\n\011\011\011  0\n\011\011\011  (if (node-list=? (node-list-first nl) footnote)\n\011\011\011      num\n\011\011\011      (if (count-footnote? (node-list-first nl))\n\011\011\011\011  (loop (node-list-rest nl) (+ num 1))\n\011\011\011\011  (loop (node-list-rest nl) num)))))))\n    (format-number fn-number "1")))\n\011      \n(element footnote \n  (if (and (equal? (print-backend) 'tex) bop-footnotes)\n      (make sequence\n\011($ss-seq$ + (literal (footnote-number (current-node))))\n\011(make page-footnote (process-children)))\n      ($ss-seq$ + (literal (footnote-number (current-node))))))\n\n(element (footnote para)\n  ;; Note: this can only get called if the backend is 'tex\n  ;; If the backend is anything else, footnote never calls process\n  ;; children except in endnote-mode, so this doesn't get called.\n  (let ((fnnum\011(footnote-number (parent (current-node)))))\n    (if (= (child-number) 1)\n\011(make paragraph\n\011  use: default-text-style\n\011  font-size: (* %footnote-size-factor% %bf-size%)\n\011  quadding: %default-quadding%\n\011  line-spacing: (* (* %footnote-size-factor% %bf-size%)\n\011\011\011   %line-spacing-factor%)\n\011  space-before: %para-sep%\n\011  space-after: %para-sep%\n\011  start-indent: %footnote-field-width%\n\011  first-line-start-indent: (- %footnote-field-width%)\n\011  lines: 'wrap\011\011\011; doesn't seem to work\n\011  (make line-field\n\011    field-width: %footnote-field-width%\n\011    (literal fnnum \n\011\011     (gentext-label-title-sep (normalize "footnote"))))\n\011  (process-children-trim))\n\011(make paragraph\n\011  use: default-text-style\n\011  font-size: (* %footnote-size-factor% %bf-size%)\n\011  quadding: %default-quadding%\n\011  line-spacing: (* (* %footnote-size-factor% %bf-size%)\n\011\011\011   %line-spacing-factor%)\n\011  space-before: %para-sep%\n\011  space-after: %para-sep%\n\011  start-indent: %footnote-field-width%\n\011  lines: 'wrap\011\011\011; doesn't seem to work\n\011  (process-children-trim)))))\n\n(define (non-table-footnotes footnotenl)\n  (let loop ((nl footnotenl) (result (empty-node-list)))\n    (if (node-list-empty? nl)\n\011result\n\011(if (has-ancestor-member? (node-list-first nl) \n\011\011\011\011  (list (normalize "tgroup")))\n\011    (loop (node-list-rest nl) \n\011\011  result)\n\011    (loop (node-list-rest nl)\n\011\011  (node-list result (node-list-first nl)))))))\n\n(define (make-endnote-header)\n  (let ((headsize (if (equal? (gi) (normalize "refentry"))\n\011\011      (HSIZE 2)\n\011\011      (HSIZE 3)))\n\011(indent   (lambda () (if (equal? (gi) (normalize "refentry"))\n\011\011\011\011 %body-start-indent%\n\011\011\011\011 0pt))))\n    (make paragraph\n      break-before: %footnote-endnote-break%\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      font-size: headsize\n      line-spacing: (* headsize %line-spacing-factor%)\n      space-before: (* headsize %head-before-factor%)\n      space-after: (* headsize %head-after-factor%)\n      start-indent: (indent)\n      quadding: 'start\n      keep-with-next?: #t\n      (literal (gentext-endnotes)))))\n\n(define (make-endnotes #!optional (node (current-node)))\n  (let* ((allfootnotes (if %footnote-ulinks%\n\011\011\011   (node-list-filter-by-gi\n\011\011\011    (descendants node)\n\011\011\011    (list (normalize "footnote") (normalize "ulink")))\n\011\011\011   (select-elements (descendants node) \n\011\011\011\011\011    (normalize "footnote"))))\n\011 (footnotes    (let loop ((nl (non-table-footnotes allfootnotes))\n\011\011\011\011  (fnlist (empty-node-list)))\n\011\011\011 (if (node-list-empty? nl)\n\011\011\011     fnlist\n\011\011\011     (if (count-footnote? (node-list-first nl))\n\011\011\011\011 (loop (node-list-rest nl) \n\011\011\011\011       (node-list fnlist (node-list-first nl)))\n\011\011\011\011 (loop (node-list-rest nl)\n\011\011\011\011       fnlist))))))\n    (if (or (node-list-empty? footnotes) \n\011    (and (equal? (print-backend) 'tex)\n\011\011 bop-footnotes))\n\011(empty-sosofo)\n\011(if (or (equal? (gi node) (normalize "reference"))\n\011\011(equal? (gi node) (normalize "part")))\n\011    (empty-sosofo) ;; Each RefEntry/Component does its own...\n\011    (make sequence\n\011      (make-endnote-header)\n\011      (with-mode endnote-mode\n\011\011(process-node-list footnotes)))))))\n\n(mode endnote-mode\n  (element footnote\n    (make sequence\n      start-indent: %body-start-indent%\n      (process-children)))\n\n  (element (footnote para)\n    (let ((fnnum  (footnote-number (parent (current-node)))))\n      (if (= (child-number) 1)\n\011  (make paragraph\n; I'm not sure this really makes sense in the endnote case...\n;\011    font-size: (* %footnote-size-factor% %bf-size%)\n;\011    line-spacing: (* (* %footnote-size-factor% %bf-size%)\n;\011\011\011     %line-spacing-factor%)\n\011    space-before: %para-sep%\n\011    start-indent: (+ (inherited-start-indent) %footnote-field-width%)\n\011    first-line-start-indent: (- %footnote-field-width%)\n\011    (make line-field\n\011      field-width: %footnote-field-width%\n\011      (literal fnnum \n\011\011       (gentext-label-title-sep (normalize "footnote"))))\n\011    (process-children-trim))\n\011  (make paragraph\n\011    font-size: (* %footnote-size-factor% %bf-size%)\n\011    line-spacing: (* (* %footnote-size-factor% %bf-size%)\n\011\011\011     %line-spacing-factor%)\n\011    start-indent: (+ (inherited-start-indent) %footnote-field-width%)\n\011    space-before: %para-sep%\n\011    (process-children-trim)))))\n\n  (element ulink\n    (if %footnote-ulinks%\n\011(let ((fnnum  (footnote-number (current-node))))\n\011  (make paragraph\n;\011    font-size: (* %footnote-size-factor% %bf-size%)\n;\011    line-spacing: (* (* %footnote-size-factor% %bf-size%)\n;\011\011\011     %line-spacing-factor%)\n\011    space-before: %para-sep%\n\011    start-indent: (+ (inherited-start-indent) %footnote-field-width%)\n\011    first-line-start-indent: (- %footnote-field-width%)\n\011    (make line-field\n\011      field-width: %footnote-field-width%\n\011      (literal fnnum \n\011\011       (gentext-label-title-sep (normalize "footnote"))))\n\011    (literal (attribute-string "url"))))\n\011(next-match))))\n\n;; ======================================================================\n;; Handle table footnotes\n\n(define (table-footnote-number footnote)\n  (format-number (component-child-number footnote \n\011\011\011\011\011 ($table-element-list$)) "a"))\n\n(element (entry footnote)\n  ($ss-seq$ + (literal (table-footnote-number (current-node)))))\n\n(element (entry para footnote)\n  ($ss-seq$ + (literal (table-footnote-number (current-node)))))\n\n(define (make-table-endnote-header)\n  (make paragraph\n    font-family-name: %body-font-family%\n    font-weight: 'medium\n    font-size: %bf-size%\n    start-indent: 0pt\n    quadding: 'start\n    (literal (gentext-table-endnotes))))\n\n(define (make-table-endnotes)\n  (let* ((footnotes (select-elements (descendants (current-node)) \n\011\011\011\011     (normalize "footnote")))\n\011 (headsize (HSIZE 3))\n\011 (tgroup (ancestor-member (current-node) (list (normalize "tgroup"))))\n\011 (cols   (string->number (attribute-string (normalize "cols") tgroup))))\n    (if (node-list-empty? footnotes) \n\011(empty-sosofo)\n\011(make table-row\n\011  (make table-cell\n\011    n-columns-spanned: cols\n\011    cell-before-row-margin: %cals-cell-before-row-margin%\n\011    cell-after-row-margin: %cals-cell-after-row-margin%\n\011    cell-before-column-margin: %cals-cell-before-column-margin%\n\011    cell-after-column-margin: %cals-cell-after-column-margin%\n\011    start-indent: %cals-cell-content-start-indent%\n\011    end-indent: %cals-cell-content-end-indent%\n\011    (make-table-endnote-header)\n\011    (with-mode table-footnote-mode\n\011      (process-node-list footnotes)))))))\n\n(mode table-footnote-mode\n  (element footnote\n    (make display-group\n      font-family-name: %body-font-family%\n      font-weight: 'medium\n      font-size: %bf-size%\n      start-indent: 0pt\n      quadding: 'start\n      (process-children)))\n\n  (element (footnote para)\n    (let ((fnnum (table-footnote-number (parent (current-node)))))\n      (if (= (child-number) 1)\n\011  (make paragraph\n\011    start-indent: %footnote-field-width%\n\011    first-line-start-indent: (- %footnote-field-width%)\n\011    (make line-field\n\011      field-width: %footnote-field-width%\n\011      (literal fnnum \n\011\011       (gentext-label-title-sep (normalize "footnote"))))\n\011    (process-children-trim))\n\011  (make paragraph\n\011    start-indent: %footnote-field-width%\n\011    (process-children-trim))))))\n\n   \n;; $Id: dbcallou.dsl,v 1.4 2004/10/10 14:04:48 petere78 Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; The support provided below is a little primitive because there's no way\n;; to do line-addressing in Jade.\n;;\n;; CO's are supported with the CO element or, in SCREENCO and \n;; PROGRAMLISTINGCO only, AREAs.\n;;\n;; Notes on the use of AREAs:\n;;\n;; - Processing is very slow. Jade loops through each AREA for\n;;   every column on every line.\n;; - Only the LINECOLUMN units are supported, and they are #IMPLIED\n;; - If a COORDS only specifies a line, the %callout-default-col% will\n;;   be used for the column.\n;; - If the column is beyond the end of the line, that will work OK, but\n;;   if more than one callout has to get placed beyond the end of the same\n;;   line, that doesn't work so well.\n;; - Embedded tabs foul up the column counting.\n;; - Embedded markup fouls up the column counting.\n;; - Embedded markup with embedded line breaks fouls up the line counting.\n;; - The callout bugs occur immediately before the LINE COLUMN specified.\n;; - You can't point to an AREASET, that doesn't make any sense\n;;   since it would imply a one-to-many link\n;;\n;; There's still no support for a stylesheet drawing the callouts on a\n;; GRAPHIC, and I don't think there ever will be.\n;;\n\n(element areaspec (empty-sosofo))\n(element area (empty-sosofo))\n(element areaset (empty-sosofo))\n\n(element co\n  ($callout-mark$ (current-node)))\n\n(element programlistingco ($informal-object$))\n(element screenco ($informal-object$))\n(element graphicco ($informal-object$))\n\n(element (screenco screen) \n  ($callout-verbatim-display$ %indent-screen-lines% %number-screen-lines%))\n\n(element (programlistingco programlisting) \n  ($callout-verbatim-display$ %indent-programlisting-lines%\n\011\011\011      %number-programlisting-lines%))\n\n;; ----------------------------------------------------------------------\n\n(define ($callout-bug$ conumber)\n  (if (and conumber %callout-fancy-bug%)\n      (case conumber\n\011((1) (literal "\\dingbat-negative-circled-sans-serif-digit-one;"))\n\011((2) (literal "\\dingbat-negative-circled-sans-serif-digit-two;"))\n\011((3) (literal "\\dingbat-negative-circled-sans-serif-digit-three;"))\n\011((4) (literal "\\dingbat-negative-circled-sans-serif-digit-four;"))\n\011((5) (literal "\\dingbat-negative-circled-sans-serif-digit-five;"))\n\011((6) (literal "\\dingbat-negative-circled-sans-serif-digit-six;"))\n\011((7) (literal "\\dingbat-negative-circled-sans-serif-digit-seven;"))\n\011((8) (literal "\\dingbat-negative-circled-sans-serif-digit-eight;"))\n\011((9) (literal "\\dingbat-negative-circled-sans-serif-digit-nine;"))\n\011(else (make sequence\n\011\011font-weight: 'bold\n\011\011(literal "(" (format-number conumber "1") ")"))))\n      (make sequence\n\011font-weight: 'bold\n\011(if conumber\n\011    (literal "(" (format-number conumber "1") ")")\n\011    (literal "(??)")))))\n\n(define ($callout-mark$ co)\n  ;; Print the callout mark for co\n  (if (equal? (gi co) (normalize "co"))\n      ($callout-bug$ (if (node-list-empty? co)\n\011\011\011 #f\n\011\011\011 (child-number co)))\n      (let ((areanum (if (node-list-empty? co)\n\011\011\011 #f\n\011\011\011 (if (equal? (gi (parent co)) (normalize "areaset"))\n\011\011\011     (absolute-child-number (parent co))\n\011\011\011     (absolute-child-number co)))))\n\011($callout-bug$ (if (node-list-empty? co)\n\011\011\011   #f\n\011\011\011   areanum)))))\n\n(define ($look-for-callout$ line col #!optional (eol? #f))\n  ;; Look to see if a callout should be printed at line col, and print\n  ;; it if it should\n  (let* ((areaspec (select-elements (children (parent (current-node)))\n\011\011\011\011    (normalize "areaspec")))\n\011 (areas    (expand-children (children areaspec) \n\011\011\011\011    (list (normalize "areaset")))))\n    (let loop ((areanl areas))\n      (if (node-list-empty? areanl)\n\011  (empty-sosofo)\n\011  (make sequence\n\011    (if ($callout-area-match$ (node-list-first areanl) line col eol?)\n\011\011($callout-area-format$ (node-list-first areanl) line col eol?)\n\011\011(empty-sosofo))\n\011    (loop (node-list-rest areanl)))))))\n\n(define ($callout-area-match$ area line col eol?)\n  ;; Does AREA area match line col?\n  (let* ((coordlist (split (attribute-string (normalize "coords") area)))\n\011 (aline (string->number (car coordlist)))\n\011 (acol  (if (null? (cdr coordlist))\n\011\011    #f\n\011\011    (string->number (car (cdr coordlist)))))\n\011 (units (if (inherited-attribute-string (normalize "units") area)\n\011\011    (inherited-attribute-string (normalize "units") area)\n\011\011    (normalize "linecolumn"))))\n    (and (equal? units (normalize "linecolumn"))\n\011 (or\n\011  (and (equal? line aline)\n\011       (equal? col acol))\n\011  (and (equal? line aline)\n\011       eol? \n\011       (or (not acol) (> acol col)))))))\n\n(define ($callout-area-format$ area line col eol?)\n  ;; Format AREA area at the appropriate place\n  (let* ((coordlist (split (attribute-string (normalize "coords") area)))\n\011 (aline (string->number (car coordlist)))\n\011 (acol  (if (null? (cdr coordlist))\n\011\011    #f\n\011\011    (string->number (car (cdr coordlist))))))\n    (if (and (equal? line aline)\n\011     eol? \n\011     (or (not acol) (> acol col)))\n\011(make sequence\n\011  (let loop ((atcol col))\n\011    (if (>= atcol (if acol acol %callout-default-col%))\n\011\011(empty-sosofo)\n\011\011(make sequence\n\011\011  (literal "\\no-break-space;")\n\011\011  (loop (+ atcol 1)))))\n\011  ($callout-mark$ area))\n\011($callout-mark$ area))))\n\n(define ($callout-linespecific-content$ indent line-numbers?)\n  ;; Print linespecific content in a callout with line numbers\n  (make sequence\n    ($line-start$ indent line-numbers? 1)\n    (let loop ((kl (children (current-node)))\n\011       (linecount 1)\n\011       (colcount 1)\n\011       (res (empty-sosofo)))\n      (if (node-list-empty? kl)\n\011  (sosofo-append res\n\011\011\011 ($look-for-callout$ linecount colcount #t)\n\011\011\011 (empty-sosofo))\n\011  (loop\n\011   (node-list-rest kl)\n\011   (if (char=? (node-property 'char (node-list-first kl)\n\011\011\011\011      default: #\\U-0000) #\\U-000D)\n\011       (+ linecount 1)\n\011       linecount)\n\011   (if (char=? (node-property 'char (node-list-first kl)\n\011\011\011\011      default: #\\U-0000) #\\U-000D)\n\011       1\n\011       (if (char=? (node-property 'char (node-list-first kl)\n\011\011\011\011\011  default: #\\U-0000) #\\U-0000)\n\011\011   colcount\n\011\011   (+ colcount 1)))\n\011   (let ((c (node-list-first kl)))\n\011     (if (char=? (node-property 'char c default: #\\U-0000)\n\011\011\011 #\\U-000D)\n\011\011 (sosofo-append res\n\011\011\011\011($look-for-callout$ linecount colcount #t)\n\011\011\011\011(process-node-list c)\n\011\011\011\011($line-start$ indent\n\011\011\011\011\011      line-numbers?\n\011\011\011\011\011      (+ linecount 1)))\n\011\011 (sosofo-append res\n\011\011\011\011($look-for-callout$ linecount colcount)\n\011\011\011\011(process-node-list c)))))))))\n\n(define ($callout-verbatim-display$ indent line-numbers?)\n  (let* ((width-in-chars (if (attribute-string "width")\n\011\011\011     (string->number (attribute-string "width"))\n\011\011\011     %verbatim-default-width%))\n\011 (fsize (lambda () (if (or (attribute-string (normalize "width"))\n\011\011\011\011   (not %verbatim-size-factor%))\n\011\011\011       (/ (/ (- %text-width% (inherited-start-indent))\n\011\011\011\011     width-in-chars) \n\011\011\011\011  0.7)\n\011\011\011       (* (inherited-font-size) \n\011\011\011\011  %verbatim-size-factor%))))\n\011 (vspace-before (if (INBLOCK?)\n\011\011\011    0pt\n\011\011\011    (if (INLIST?)\n\011\011\011\011%para-sep%\n\011\011\011\011%block-sep%)))\n\011 (vspace-after (if (INBLOCK?)\n\011\011\011   0pt\n\011\011\011   (if (INLIST?)\n\011\011\011       0pt\n\011\011\011       %block-sep%))))\n    (make paragraph\n      use: verbatim-style\n      space-before: (if (and (string=? (gi (parent)) (normalize "entry"))\n \011\011\011     (absolute-first-sibling?))\n\011\011\0110pt\n\011\011\011vspace-before)\n      space-after:  (if (and (string=? (gi (parent)) (normalize "entry"))\n \011\011\011     (absolute-last-sibling?))\n\011\011\0110pt\n\011\011\011vspace-after)\n      font-size: (fsize)\n      line-spacing: (* (fsize) %line-spacing-factor%)\n      start-indent: (if (INBLOCK?)\n\011\011\011(inherited-start-indent)\n\011\011\011(+ %block-start-indent% (inherited-start-indent)))\n      quadding: 'start\n      ($callout-linespecific-content$ indent line-numbers?))))\n\n;; EOF dbcallout.dsl\n  \n;; $Id: dbcompon.dsl,v 1.5 2003/04/29 06:33:10 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://nwalsh.com/docbook/dsssl/\n;;\n\n;; ============================= COMPONENTS =============================\n;;\n;; in docbook, components are containers at the chapter/appendix level\n\n(define ($title-header-footer-element$)\n  (let* ((firstchild (node-list-first (children (current-node))))\n\011 (metainfo   (if (node-list-empty? firstchild)\n\011\011\011 (empty-node-list)\n\011\011\011 (if (member (gi firstchild) (info-element-list))\n\011\011\011     firstchild\n\011\011\011     (empty-node-list))))\n\011 (metatitle  (select-elements (children metainfo) (normalize "title")))\n\011 (metatabb   (select-elements (children metainfo) (normalize "titleabbrev")))\n\011 (title      (select-elements (children (current-node)) \n\011\011\011\011      (normalize "title")))\n\011 (titleabb   (select-elements (children (current-node)) \n\011\011\011\011      (normalize "titleabbrev"))))\n    (if (node-list-empty? metatabb)\n\011(if (node-list-empty? titleabb)\n\011    (if (node-list-empty? metatitle)\n\011\011title\n\011\011metatitle)\n\011    titleabb)\n\011metatabb)))\n  \n(define ($refentry-header-footer-element$)\n  (let* ((refdescriptor (node-list-first \n\011\011\011 (select-elements \n\011\011\011  (descendants (current-node)) (normalize "refdescriptor"))))\n\011 (refname       (node-list-first \n\011\011\011 (select-elements \n\011\011\011  (descendants (current-node)) (normalize "refname"))))\n         (refentrytitle (node-list-first \n\011\011\011 (select-elements \n\011\011\011  (descendants (current-node)) (normalize "refentrytitle")))))\n    (if (node-list-empty? refentrytitle)\n\011(if (node-list-empty? refdescriptor)\n\011    refname\n\011    refdescriptor)\n\011refentrytitle)))\n\n(define ($title-header-footer$)\n  (let* ((title (if (equal? (gi) (normalize "refentry"))\n\011\011   ($refentry-header-footer-element$)\n\011\011   ($title-header-footer-element$))))\n    (make sequence\n      font-posture: 'italic\n      (with-mode hf-mode \n\011(process-node-list title)))))\n\n(define ($page-number-header-footer$) \n  (let ((component (ancestor-member (current-node) \n\011\011\011\011    (append (division-element-list)\n\011\011\011\011\011    (component-element-list)))))\n    (make sequence\n      font-posture: 'italic\n      (literal \n       (gentext-page)\n       (if %page-number-restart%\n\011   (if (or (equal? (gi component) (normalize "chapter"))\n\011\011   (equal? (gi component) (normalize "appendix")))\n\011       (string-append\n\011\011(element-label component #t)\n\011\011(gentext-intra-label-sep "_pagenumber"))\n\011       "")\n\011   ""))\n      (page-number-sosofo))))\n\n(define (first-page-inner-header gi)\n  (empty-sosofo))\n\n(define (first-page-center-header gi)\n  (empty-sosofo))\n\n(define (first-page-outer-header gi)\n  (empty-sosofo))\n\n(define (page-inner-header gi)\n  (empty-sosofo))\n\n(define (page-center-header gi)\n  (empty-sosofo))\n\n(define (page-outer-header gi)\n  (cond\n   ((equal? (normalize gi) (normalize "dedication")) (empty-sosofo))\n   ((equal? (normalize gi) (normalize "lot")) (empty-sosofo))\n   ((equal? (normalize gi) (normalize "part")) (empty-sosofo))\n   ((equal? (normalize gi) (normalize "toc")) (empty-sosofo))\n   (else ($title-header-footer$))))\n\n(define (first-page-inner-footer gi)\n  (empty-sosofo))\n\n(define (first-page-center-footer gi)\n  (empty-sosofo))\n\n(define (first-page-outer-footer gi)\n  (cond\n   ((equal? (normalize gi) (normalize "dedication")) (empty-sosofo))\n   ((equal? (normalize gi) (normalize "part")) (empty-sosofo))\n   (else ($page-number-header-footer$))))\n\n(define (page-inner-footer gi)\n  (empty-sosofo))\n\n(define (page-center-footer gi)\n  (empty-sosofo))\n\n(define (page-outer-footer gi)\n  ($page-number-header-footer$))\n\n(define ($page-number-format$ #!optional (gi (gi)))\n  (cond\n   ((equal? (normalize gi) (normalize "toc")) "i")\n   ((equal? (normalize gi) (normalize "lot")) "i")\n   ((equal? (normalize gi) (normalize "preface")) "i")\n   (else "1")))\n\n(define ($left-header$ #!optional (gi (gi)))\n  (if-first-page\n   (if (equal? %writing-mode% 'left-to-right)\n       (first-page-inner-header gi)\n       (first-page-outer-header gi))\n   (if %two-side%\n       (if-front-page\n\011(if (equal? %writing-mode% 'left-to-right)\n\011    (page-inner-header gi)\n\011    (page-outer-header gi))\n\011(if (equal? %writing-mode% 'left-to-right)\n\011    (page-outer-header gi)\n\011    (page-inner-header gi)))\n       (if (equal? %writing-mode% 'left-to-right)\n\011   (page-inner-header gi)\n\011   (page-outer-header gi)))))\n\n(define ($center-header$ #!optional (gi (gi)))\n  (if-first-page\n   (first-page-center-header gi)\n   (page-center-header gi)))\n\n(define ($right-header$ #!optional (gi (gi)))\n  (if-first-page\n   (if (equal? %writing-mode% 'left-to-right)\n       (first-page-outer-header gi)\n       (first-page-inner-header gi))\n   (if %two-side%\n       (if-front-page\n\011(if (equal? %writing-mode% 'left-to-right)\n\011    (page-outer-header gi)\n\011    (page-inner-header gi))\n\011(if (equal? %writing-mode% 'left-to-right)\n\011    (page-inner-header gi)\n\011    (page-outer-header gi)))\n       (if (equal? %writing-mode% 'left-to-right)\n\011   (page-outer-header gi)\n\011   (page-inner-header gi)))))\n\n(define ($left-footer$ #!optional (gi (gi)))\n  (if-first-page\n   (if (equal? %writing-mode% 'left-to-right)\n       (first-page-inner-footer gi)\n       (first-page-outer-footer gi))\n   (if %two-side%\n       (if-front-page\n\011(if (equal? %writing-mode% 'left-to-right)\n\011    (page-inner-footer gi)\n\011    (page-outer-footer gi))\n\011(if (equal? %writing-mode% 'left-to-right)\n\011    (page-outer-footer gi)\n\011    (page-inner-footer gi)))\n       (if (equal? %writing-mode% 'left-to-right)\n\011   (page-inner-footer gi)\n\011   (page-outer-footer gi)))))\n\n(define ($center-footer$ #!optional (gi (gi)))\n  (if-first-page\n   (first-page-center-footer gi)\n   (page-center-footer gi)))\n\n(define ($right-footer$ #!optional (gi (gi)))\n  (if-first-page\n   (if (equal? %writing-mode% 'left-to-right)\n       (first-page-outer-footer gi)\n       (first-page-inner-footer gi))\n   (if %two-side%\n       (if-front-page\n\011(if (equal? %writing-mode% 'left-to-right)\n\011    (page-outer-footer gi)\n\011    (page-inner-footer gi))\n\011(if (equal? %writing-mode% 'left-to-right)\n\011    (page-inner-footer gi)\n\011    (page-outer-footer gi)))\n       (if (equal? %writing-mode% 'left-to-right)\n\011   (page-outer-footer gi)\n\011   (page-inner-footer gi)))))\n\n(define ($component$)\n  ;; Changed from simple-page-sequence to display-group to avoid page breaks\n  ;; This allows chapters to flow continuously like in the ISO PDF\n  (make display-group\n    space-before: (* (HSIZE 4) %head-before-factor%)\n    space-after: %block-sep%\n    start-indent: %body-start-indent%\n    (make sequence\n      ($component-title$)\n      (process-children))))\n\n(define ($component-title$)\n  (let* ((info (cond\n\011\011((equal? (gi) (normalize "appendix"))\n\011\011 (select-elements (children (current-node)) (normalize "docinfo")))\n\011\011((equal? (gi) (normalize "article"))\n\011\011 (node-list-filter-by-gi (children (current-node))\n\011\011\011\011\011 (list (normalize "artheader")\n\011\011\011\011\011       (normalize "articleinfo"))))\n\011\011((equal? (gi) (normalize "bibliography"))\n\011\011 (select-elements (children (current-node)) (normalize "docinfo")))\n\011\011((equal? (gi) (normalize "chapter"))\n\011\011 (select-elements (children (current-node)) (normalize "docinfo")))\n\011\011((equal? (gi) (normalize "dedication")) \n\011\011 (empty-node-list))\n\011\011((equal? (gi) (normalize "glossary"))\n\011\011 (select-elements (children (current-node)) (normalize "docinfo")))\n\011\011((equal? (gi) (normalize "index"))\n\011\011 (select-elements (children (current-node)) (normalize "docinfo")))\n\011\011((equal? (gi) (normalize "preface"))\n\011\011 (select-elements (children (current-node)) (normalize "docinfo")))\n\011\011((equal? (gi) (normalize "reference"))\n\011\011 (select-elements (children (current-node)) (normalize "docinfo")))\n\011\011((equal? (gi) (normalize "setindex"))\n\011\011 (select-elements (children (current-node)) (normalize "docinfo")))\n\011\011(else\n\011\011 (empty-node-list))))\n\011 (exp-children (if (node-list-empty? info)\n\011\011\011   (empty-node-list)\n\011\011\011   (expand-children (children info) \n\011\011\011\011\011    (list (normalize "bookbiblio") \n\011\011\011\011\011\011  (normalize "bibliomisc")\n\011\011\011\011\011\011  (normalize "biblioset")))))\n\011 (parent-titles (select-elements (children (current-node)) (normalize "title")))\n\011 (titles\011(if (node-list-empty? parent-titles)\n\011\011\011    (select-elements exp-children (normalize "title"))\n\011\011\011    parent-titles))\n\011 (parent-subttl (select-elements (children (current-node)) (normalize "subtitle")))\011    \n\011 (subtitles\011(if (node-list-empty? parent-subttl)\n\011\011\011    (select-elements exp-children (normalize "subtitle"))\n\011\011\011    parent-subttl)))\n    (make sequence\n      (make paragraph\n\011font-family-name: %title-font-family%\n\011font-weight: 'bold\n\011font-size: (HSIZE 4)\n\011line-spacing: (* (HSIZE 4) %line-spacing-factor%)\n\011space-before: (* (HSIZE 4) %head-before-factor%)\n\011start-indent: 0pt\n\011first-line-start-indent: 0pt\n\011quadding: %component-title-quadding%\n\011heading-level: (if %generate-heading-level% 1 0)\n\011keep-with-next?: #t\n\n\011(if (string=? (element-label) "")\n\011    (empty-sosofo)\n\011    ;; Just output bare number without "Chapter" prefix (ISO style)\n\011    (literal (element-label)\n\011\011     (gentext-label-title-sep (gi))))\n\n\011(if (node-list-empty? titles)\n\011    (element-title-sosofo) ;; get a default!\n\011    (with-mode component-title-mode\n\011      (make sequence\n\011\011(process-node-list titles)))))\n\n      (make paragraph\n\011font-family-name: %title-font-family%\n\011font-weight: 'bold\n\011font-posture: 'italic\n\011font-size: (HSIZE 3)\n\011line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011space-before: (* 0.5 (* (HSIZE 3) %head-before-factor%))\n\011space-after: (* (HSIZE 4) %head-after-factor%)\n\011start-indent: 0pt\n\011first-line-start-indent: 0pt\n\011quadding: %component-subtitle-quadding%\n\011keep-with-next?: #t\n\n\011(with-mode component-title-mode\n\011  (make sequence\n\011    (process-node-list subtitles)))))))\n\n(mode component-title-mode\n  (element title\n    (process-children))\n\n  (element subtitle\n    (process-children))\n)\n\n;; this is how we prevent the title in the header from acquiring the\n;;   display treatment that it receives in the body of the document\n;;\n(mode hf-mode\n  (element title\n    (let* ((component (ancestor-member (current-node) \n\011\011\011\011       (component-element-list)))\n\011   (chaporapp (or (equal? (gi component) (normalize "chapter"))\n\011\011\011  (equal? (gi component) (normalize "appendix")))))\n      (if %chap-app-running-heads%\n\011  (make sequence\n\011    (if (and chaporapp\n\011\011     %chapter-autolabel%\n\011\011     (or %chap-app-running-head-autolabel%\n\011\011\011 (attribute-string (normalize "label") component)))\n\011\011(literal (gentext-element-name-space component)\n\011\011\011 (element-label component)\n\011\011\011 (gentext-label-title-sep (gi component)))\n\011\011(empty-sosofo))\n\011    (process-children-trim))\n\011  (empty-sosofo))))\n\n  (element titleabbrev\n    (if %chap-app-running-heads%\n\011(make sequence\n\011  (if (or (have-ancestor? (normalize "chapter"))\n\011\011  (have-ancestor? (normalize "appendix")))\n\011      (literal (gentext-element-name-space (parent))\n\011\011       (element-label (parent))\n\011\011       (gentext-label-title-sep (gi (parent))))\n\011      (empty-sosofo))\n\011  (process-children-trim))\n\011(empty-sosofo)))\n\n  (element refentrytitle\n    (if %chap-app-running-heads%\n\011(process-children-trim)\n\011(empty-sosofo)))\n\n  (element refdescriptor\n    (if %chap-app-running-heads%\n\011(process-children-trim)\n\011(empty-sosofo)))\n\n  (element refname\n    (if %chap-app-running-heads%\n\011(process-children-trim)\n\011(empty-sosofo)))\n\n  ;; Graphics aren't allowed in headers and footers...\n  (element graphic\n    (empty-sosofo))\n\n  (element inlinegraphic\n    (empty-sosofo))\n)\n\n(element appendix ($component$))\n(element (article appendix) ($section$)) ;; this is a special case\n(element (appendix title) (empty-sosofo))\n\n(element chapter ($component$))\n(element (chapter title) (empty-sosofo))\n\n(element preface ($component$))\n(element (preface title) (empty-sosofo))\n\n(element colophon ($component$))\n\n;; Dedication is empty except in a special mode so that it can be\n;; reordered (made to come before the TOCs)\n(element dedication (empty-sosofo))\n(mode dedication-page-mode\n  (element dedication ($component$))\n  (element (dedication title) (empty-sosofo))\n)\n\n;; Articles are like components, except that if they may have much\n;; more formal title pages (created with article-titlepage).\n;;\n(element article\n  (let* ((info (node-list-filter-by-gi (children (current-node))\n\011\011\011\011       (list (normalize "artheader")\n\011\011\011\011\011     (normalize "articleinfo"))))\n\011 (nl   (titlepage-info-elements (current-node) info))\n\011 (article-titlepage (if %generate-article-titlepage-on-separate-page%\n\011\011\011\011(make sequence\n\011\011\011\011  (if (article-titlepage-content? nl 'recto)\n\011\011\011\011      (make simple-page-sequence\n\011\011\011\011\011page-n-columns: %page-n-columns%\n\011\011\011\011\011use: default-text-style\n\011\011\011\011\011quadding: %default-quadding%\n\011\011\011\011\011(article-titlepage nl 'recto))\n\011\011\011\011      (empty-sosofo))\n\011\011\011\011  (if (article-titlepage-content? nl 'verso)\n\011\011\011\011      (make simple-page-sequence\n\011\011\011\011\011page-n-columns: %page-n-columns%\n\011\011\011\011\011use: default-text-style\n\011\011\011\011\011quadding: %default-quadding%\n\011\011\011\011\011(article-titlepage nl 'verso))\n\011\011\011\011      (empty-sosofo)))\n\011\011\011\011(make sequence\n\011\011\011\011  (article-titlepage nl 'recto)\n\011\011\011\011  (article-titlepage nl 'verso)))))\n    (make sequence\n\n      ;; make the titlepage first if its on a separate page\n      (if (and %generate-article-titlepage% \n\011       %generate-article-titlepage-on-separate-page%)\n\011  article-titlepage\n\011  (empty-sosofo))\n\n      ;; make the TOC on a separate page if requested and it's not\n      ;; already on the title page and it's supposed to be in front\n      (if (and %generate-article-toc% \n\011       (not %generate-article-toc-on-titlepage%)\n\011       %generate-article-titlepage-on-separate-page%\n\011       (generate-toc-in-front))\n\011  (make simple-page-sequence\n\011    page-n-columns: %page-n-columns%\n            ;; FIXME: page restarting here and below is ill-considered\n\011    page-number-restart?: %article-page-number-restart%\n\011    page-number-format: ($page-number-format$ (normalize "toc"))\n\011    left-header:   ($left-header$ (normalize "toc"))\n\011    center-header: ($center-header$ (normalize "toc"))\n\011    right-header:  ($right-header$ (normalize "toc"))\n\011    left-footer:   ($left-footer$ (normalize "toc"))\n\011    center-footer: ($center-footer$ (normalize "toc"))\n\011    right-footer:  ($right-footer$ (normalize "toc"))\n\011    input-whitespace-treatment: 'collapse\n\011    use: default-text-style\n\011    quadding: %default-quadding%\n\011    (build-toc (current-node)\n\011\011       (toc-depth (current-node))))\n\011  (empty-sosofo))\n\n      ;; start a new page for the article itself\n      (make simple-page-sequence\n\011page-n-columns: %page-n-columns%\n\011page-number-restart?: (or %article-page-number-restart% \n\011\011\011\011  (book-start?))\n\011page-number-format: ($page-number-format$)\n\011use: default-text-style\n\011left-header:   ($left-header$)\n\011center-header: ($center-header$)\n\011right-header:  ($right-header$)\n\011left-footer:   ($left-footer$)\n\011center-footer: ($center-footer$)\n\011right-footer:  ($right-footer$)\n\011start-indent: %body-start-indent%\n\011input-whitespace-treatment: 'collapse\n\011quadding: %default-quadding%\n\n\011;; ... and include the titlepage if there is one and it's not\n\011;; already generated on a separate page\n\011(if (and %generate-article-titlepage% \n\011\011 (not %generate-article-titlepage-on-separate-page%))\n\011    article-titlepage\n\011    (empty-sosofo))\n\n\011;; ... and include the TOC if it is in front and not already\n\011;; generated\n\011(if (and %generate-article-toc% \n\011\011 (generate-toc-in-front)\n\011\011 (not %generate-article-toc-on-titlepage%)\n\011\011 (not %generate-article-titlepage-on-separate-page%))\n\011    (make display-group\n\011      space-after: (* (HSIZE 3) %head-after-factor%)\n\011      (build-toc (current-node)\n\011\011\011 (toc-depth (current-node))))\n\011    (empty-sosofo))\n\n\011;; .. and the contents of the article\n\011(process-children)\n\n        ;; ... and the endnotes\n\011(make-endnotes)\n\n\011;; ... and the TOC if it is supposed to be on the back and not\n\011;; on the titlepage nor on a separate pagee\n\011(if (and %generate-article-toc% \n\011\011 (not (generate-toc-in-front))\n\011\011 (not %generate-article-toc-on-titlepage%)\n\011\011 (not %generate-article-titlepage-on-separate-page%))\n\011    (make display-group\n\011      space-after: (* (HSIZE 3) %head-after-factor%)\n\011      (build-toc (current-node)\n\011\011\011 (toc-depth (current-node))))\n\011    (empty-sosofo)))\n\n      ;; finally, produce the TOC if it is supposed to be at the end\n      ;; and on its own page\n      (if (and %generate-article-toc% \n\011       (not %generate-article-toc-on-titlepage%)\n\011       %generate-article-titlepage-on-separate-page%\n\011       (not (generate-toc-in-front)))\n\011  (make simple-page-sequence\n\011    page-n-columns: %page-n-columns%\n\011    use: default-text-style\n\011    quadding: %default-quadding%\n\011    (build-toc (current-node)\n\011\011       (toc-depth (current-node))))\n\011  (empty-sosofo)))))\n\n(element (article title) (empty-sosofo))\n\n  \n;; $Id: dbdivis.dsl,v 1.5 2003/12/05 05:00:05 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ============================= DIVISIONS ==============================\n\n(element set\n  (let* ((setinfo  (select-elements (children (current-node)) \n\011\011\011\011    (normalize "setinfo")))\n\011 (nl       (titlepage-info-elements (current-node) setinfo)))\n    (make sequence\n      (if %generate-set-titlepage%\n\011  (make simple-page-sequence\n\011    page-n-columns: %titlepage-n-columns%\n\011    input-whitespace-treatment: 'collapse\n\011    use: default-text-style\n\011    (set-titlepage nl 'recto)\n\011    (make display-group\n\011      break-before: 'page\n\011      (set-titlepage nl 'verso)))\n\011  (empty-sosofo))\n      \n      (if (not (generate-toc-in-front))\n\011  (process-children)\n\011  (empty-sosofo))\n\n      (if %generate-set-toc%\n\011  (make simple-page-sequence\n\011    page-n-columns: %page-n-columns%\n\011    page-number-format: ($page-number-format$ (normalize "toc"))\n\011    use: default-text-style\n\011    left-header:   ($left-header$ (normalize "toc"))\n\011    center-header: ($center-header$ (normalize "toc"))\n\011    right-header:  ($right-header$ (normalize "toc"))\n\011    left-footer:   ($left-footer$ (normalize "toc"))\n\011    center-footer: ($center-footer$ (normalize "toc"))\n\011    right-footer:  ($right-footer$ (normalize "toc"))\n\011    input-whitespace-treatment: 'collapse\n\011    (build-toc (current-node)\n\011\011       (toc-depth (current-node))))\n\011  (empty-sosofo))\n\011    \n      (if (generate-toc-in-front)\n\011  (process-children)\n\011  (empty-sosofo)))))\n\n(element (set title) (empty-sosofo))\n\n(element book \n  (let* ((bookinfo  (select-elements (children (current-node)) \n\011\011\011\011     (normalize "bookinfo")))\n\011 (dedication (select-elements (children (current-node)) \n\011\011\011\011      (normalize "dedication")))\n\011 (nl        (titlepage-info-elements (current-node) bookinfo)))\n    (make sequence\n      (if %generate-book-titlepage%\n\011  (make simple-page-sequence\n\011    page-n-columns: %titlepage-n-columns%\n\011    input-whitespace-treatment: 'collapse\n\011    use: default-text-style\n\011    (book-titlepage nl 'recto)\n\011    (make display-group\n\011      break-before: 'page\n\011      (book-titlepage nl 'verso)))\n\011  (empty-sosofo))\n\n      (if (node-list-empty? dedication)\n\011  (empty-sosofo)\n\011  (with-mode dedication-page-mode\n\011    (process-node-list dedication)))\n\n      (if (not (generate-toc-in-front))\n\011  ;; Wrap main content in simple-page-sequence for headers/footers\n\011  ;; but let chapters flow continuously without page breaks\n\011  (make simple-page-sequence\n\011    page-n-columns: %page-n-columns%\n\011    page-number-restart?: %page-number-restart%\n\011    page-number-format: ($page-number-format$)\n\011    use: default-text-style\n\011    left-header:   ($left-header$)\n\011    center-header: ($center-header$)\n\011    right-header:  ($right-header$)\n\011    left-footer:   ($left-footer$)\n\011    center-footer: ($center-footer$)\n\011    right-footer:  ($right-footer$)\n\011    input-whitespace-treatment: 'collapse\n\011    quadding: %default-quadding%\n\011    (process-children))\n\011  (empty-sosofo))\n\n      (if %generate-book-toc%\n\011  (make simple-page-sequence\n\011    page-n-columns: %page-n-columns%\n\011    page-number-format: ($page-number-format$ (normalize "toc"))\n\011    use: default-text-style\n\011    left-header:   ($left-header$ (normalize "toc"))\n\011    center-header: ($center-header$ (normalize "toc"))\n\011    right-header:  ($right-header$ (normalize "toc"))\n\011    left-footer:   ($left-footer$ (normalize "toc"))\n\011    center-footer: ($center-footer$ (normalize "toc"))\n\011    right-footer:  ($right-footer$ (normalize "toc"))\n\011    input-whitespace-treatment: 'collapse\n\011    (build-toc (current-node)\n\011\011       (toc-depth (current-node))))\n\011  (empty-sosofo))\n\011    \n      (let loop ((gilist ($generate-book-lot-list$)))\n\011(if (null? gilist)\n\011    (empty-sosofo)\n\011    (if (not (node-list-empty? \n\011\011      (select-elements (descendants (current-node))\n\011\011\011\011       (car gilist))))\n\011\011(make simple-page-sequence\n\011\011  page-n-columns: %page-n-columns%\n\011\011  page-number-format: ($page-number-format$ (normalize "lot"))\n\011\011  use: default-text-style\n\011\011  left-header:   ($left-header$ (normalize "lot"))\n\011\011  center-header: ($center-header$ (normalize "lot"))\n\011\011  right-header:  ($right-header$ (normalize "lot"))\n\011\011  left-footer:   ($left-footer$ (normalize "lot"))\n\011\011  center-footer: ($center-footer$ (normalize "lot"))\n\011\011  right-footer:  ($right-footer$ (normalize "lot"))\n\011\011  input-whitespace-treatment: 'collapse\n\011\011  (build-lot (current-node) (car gilist)))\n\011\011(loop (cdr gilist)))))\n\n      (if (generate-toc-in-front)\n\011  ;; Wrap main content in simple-page-sequence for headers/footers\n\011  ;; but let chapters flow continuously without page breaks\n\011  (make simple-page-sequence\n\011    page-n-columns: %page-n-columns%\n\011    page-number-restart?: %page-number-restart%\n\011    page-number-format: ($page-number-format$)\n\011    use: default-text-style\n\011    left-header:   ($left-header$)\n\011    center-header: ($center-header$)\n\011    right-header:  ($right-header$)\n\011    left-footer:   ($left-footer$)\n\011    center-footer: ($center-footer$)\n\011    right-footer:  ($right-footer$)\n\011    input-whitespace-treatment: 'collapse\n\011    quadding: %default-quadding%\n\011    (process-children))\n\011  (empty-sosofo)))))\n\n(element (book title) (empty-sosofo))\n\n(element part\n  (let* ((partinfo  (select-elements (children (current-node)) \n\011\011\011\011     (normalize "docinfo")))\n\011 (partintro (select-elements (children (current-node)) \n\011\011\011\011     (normalize "partintro")))\n\n\011 (nl        (titlepage-info-elements \n\011\011     (current-node) \n\011\011     partinfo\n\011\011     (if %generate-partintro-on-titlepage%\n\011\011\011 partintro\n\011\011\011 (empty-node-list)))))\n    (make sequence\n      (if %generate-part-titlepage%\n\011  (make simple-page-sequence\n\011    page-n-columns: %titlepage-n-columns%\n\011    input-whitespace-treatment: 'collapse\n\011    use: default-text-style\n\011    (part-titlepage nl 'recto)\n\011    (make display-group\n\011      break-before: 'page\n\011      (part-titlepage nl 'verso)))\n\011  (empty-sosofo))\n\n      (if (not (generate-toc-in-front))\n          (process-children)\n\011  (empty-sosofo))\n\n      ;; generate a part TOC on a separate page\n      (if (and %generate-part-toc%\n\011       (not %generate-part-toc-on-titlepage%))\n\011  (make simple-page-sequence\n\011    page-n-columns: %page-n-columns%\n\011    page-number-format: ($page-number-format$ (normalize "toc"))\n\011    use: default-text-style\n\011    left-header:   ($left-header$ (normalize "toc"))\n\011    center-header: ($center-header$ (normalize "toc"))\n\011    right-header:  ($right-header$ (normalize "toc"))\n\011    left-footer:   ($left-footer$ (normalize "toc"))\n\011    center-footer: ($center-footer$ (normalize "toc"))\n\011    right-footer:  ($right-footer$ (normalize "toc"))\n\011    input-whitespace-treatment: 'collapse\n\011    (build-toc (current-node)\n\011\011       (toc-depth (current-node))))\n\011  (empty-sosofo))\n\n      ;; this seems wrong relative to generate-toc-in-front,\n      ;; goes *after* the content ??!\n      (if (and (not (node-list-empty? partintro))\n\011       (not %generate-partintro-on-titlepage%))\n\011  ($process-partintro$ partintro #t)\n\011  (empty-sosofo))\n      \n      (if (generate-toc-in-front)\n\011  (process-children)\n\011  (empty-sosofo)))))\n\n(element (part title) (empty-sosofo))\n\n(element partintro (empty-sosofo))\n\n(element (partintro title) \n  (let* ((hlevel 1)\n\011 (hs (HSIZE (- 4 hlevel))))\n    (make paragraph\n      font-family-name: %title-font-family%\n      font-weight:  (if (< hlevel 5) 'bold 'medium)\n      font-posture: (if (< hlevel 5) 'upright 'italic)\n      font-size: hs\n      line-spacing: (* hs %line-spacing-factor%)\n      space-before: (* hs %head-before-factor%)\n      space-after:  (* hs %head-after-factor%)\n      start-indent: 0pt\n      first-line-start-indent: 0pt\n      quadding: %section-title-quadding%\n      keep-with-next?: #t\n      heading-level: (if %generate-heading-level% (+ hlevel 1) 0)\n      (element-title-sosofo (parent (current-node))))))\n\n(define ($process-partintro$ partintro make-page-seq?)\n  (if make-page-seq?\n      (make simple-page-sequence\n\011page-n-columns: %page-n-columns%\n\011page-number-restart?: (or %page-number-restart% \n\011\011\011\011  (book-start?) \n\011\011\011\011  (first-chapter?))\n\011page-number-format: ($page-number-format$)\n\011use: default-text-style\n\011left-header:   ($left-header$)\n\011center-header: ($center-header$)\n\011right-header:  ($right-header$)\n\011left-footer:   ($left-footer$)\n\011center-footer: ($center-footer$)\n\011right-footer:  ($right-footer$)\n\011start-indent: %body-start-indent%\n\011input-whitespace-treatment: 'collapse\n\011quadding: %default-quadding%\n\011(make sequence\n\011  (process-node-list (children partintro))\n\011  (make-endnotes partintro)))\n      (make sequence\n\011start-indent: %body-start-indent%\n\011(process-node-list (children partintro))\n\011(make-endnotes partintro))))\n\n   \n;; $Id: dbgloss.dsl,v 1.4 2003/01/15 08:24:23 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ========================= GLOSSARY ELEMENTS ==========================\n\n(element glossary ($component$))\n(element (article glossary) ($section$)) ;; this is a special case\n(element (glossary title) (empty-sosofo))\n\n(element glossdiv ($section$))\n(element (glossdiv title) (empty-sosofo))\n\n(element glosslist ($block-container$))\n(element glossentry  (process-children))\n\n;; a glossentry glossterm\n(element (glossentry glossterm) ($lowtitle$ 3 2))\n(element (glossdiv glossentry glossterm) ($lowtitle$ 3 3))\n(element (glossentry acronym) (empty-sosofo))\n(element (glossentry abbrev) (empty-sosofo))\n(element glossdef ($indent-para-container$))\n\n(element glosssee ($italic-seq$))\n\n(element (glossentry glosssee)\n  (let ((otherterm (attribute-string (normalize "otherterm"))))\n    (make paragraph\n      space-before: %para-sep%\n      space-after: %para-sep%\n      start-indent: (+ (inherited-start-indent) (* (ILSTEP) 2))\n      quadding: %default-quadding%\n      ($italic-seq$ (literal (gentext-element-name (current-node))\n\011\011\011     (gentext-label-title-sep (gi))))\n      (if otherterm\n\011  (make link \n\011    destination: (node-list-address (element-with-id otherterm))\n\011    (with-mode otherterm\n\011      (process-element-with-id otherterm)))\n\011  (process-children)))))\n\n;; When we hit the first GLOSSSEEALSO, process all of them as a node-list\n(element glossseealso\n  (if (first-sibling?)\n      (make paragraph\n\011($italic-seq$ (literal (gentext-element-name (current-node))\n\011\011\011       (gentext-label-title-sep (gi))))\n\011(with-mode glossseealso\n\011  (process-node-list\n\011   (select-elements (children (parent)) '(glossseealso))))\n\011(literal "."))\n      (empty-sosofo)))\n\n(mode glossseealso\n\n  (element glossseealso\n    (let ((otherterm (attribute-string (normalize "otherterm"))))\n      (make sequence\n\011(if (first-sibling?)\n\011    (empty-sosofo)\n\011    ($italic-seq$ (literal ", ")))\n\n\011(if otherterm ;; but this should be required...\n\011    (make link \n\011      destination: (node-list-address (element-with-id otherterm))\n\011      (with-mode otherterm\n\011\011(process-element-with-id otherterm)))\n\011    (process-children)))))\n\n)\n\n;; This is referenced within the GLOSSSEE and GLOSSSEEALSO element\n;; construction expressions.  The OTHERTERM attributes on GLOSSSEE and\n;; GLOSSSEEALSO (should) refer to GLOSSENTRY elements but we're only\n;; interested in the text within the GLOSSTERM.  Discard the revision\n;; history and the definition from the referenced term.\n(mode otherterm\n  (element glossentry\n    (process-children))\n  (element glossterm\n    (process-children))\n  (element glossdef\n    (empty-sosofo))\n  (element revhistory\n    (empty-sosofo))\n  (element glosssee\n    (empty-sosofo))\n  (element (glossentry acronym)\n    (empty-sosofo))\n  (element (glossentry abbrev)\n    (empty-sosofo)))\n\n;; an inline gloss term\n(element glossterm\n  (let* ((linkend   (attribute-string (normalize "linkend"))))\n    (if linkend\n\011(make link \n\011  destination: (node-list-address (element-with-id linkend))\n\011  ($italic-seq$))\n\011($italic-seq$))))\n\n;; a first glossterm\n(element firstterm\n  (let* ((linkend (attribute-string (normalize "linkend")))\n\011 (sosofo  (if linkend\n\011\011      (make link \n\011\011\011destination: (node-list-address\n\011\011\011\011      (element-with-id linkend))\n\011\011\011($italic-seq$))\n\011\011      ($italic-seq$))))\n    (if firstterm-bold\n\011(make sequence\n\011  font-weight: 'bold\n\011  sosofo)\n\011sosofo)))\n   \n;; $Id: dbgraph.dsl,v 1.3 2003/03/25 19:53:55 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ==================== GRAPHICS ====================\n\n;; NOTE: display #f doesn't seem to work right in the RTF back end...\n\n(define (graphic-file filename)\n  (let ((ext (file-extension filename)))\n    (if (or (not filename)\n\011    (not %graphic-default-extension%)\n\011    (member ext %graphic-extensions%))\n\011filename\n\011(string-append filename "." %graphic-default-extension%))))\n\n(define ($graphic$ fileref \n\011\011   #!optional (display #f) (format #f) (scale #f) (align #f))\n  (let ((graphic-format (if format format ""))\n\011(graphic-scale  (if scale (/  (string->number scale) 100) 1))\n\011(graphic-align  (cond ((equal? align (normalize "center"))\n\011\011\011       'center)\n\011\011\011      ((equal? align (normalize "right"))\n\011\011\011       'end)\n\011\011\011      (else\n\011\011\011       'start))))\n    (make external-graphic\n      entity-system-id: (graphic-file fileref)\n      notation-system-id: graphic-format\n      scale: graphic-scale\n      display?: display\n      display-alignment: graphic-align)))\n\n(define ($img$ #!optional (nd (current-node)) (display #f))\n  ;; This function now supports an extension to DocBook.  It's\n  ;; either a clever trick or an ugly hack, depending on your\n  ;; point of view, but it'll hold us until XLink is finalized\n  ;; and we can extend DocBook the "right" way.\n  ;;\n  ;; If the entity passed to GRAPHIC has the FORMAT\n  ;; "LINESPECIFIC", either because that's what's specified or\n  ;; because it's the notation of the supplied ENTITYREF, then\n  ;; the text of the entity is inserted literally (via Jade's\n  ;; read-entity external procedure).\n  ;;\n  (let* ((fileref   (attribute-string (normalize "fileref") nd))\n\011 (entityref (attribute-string (normalize "entityref") nd))\n\011 (format    (if (attribute-string (normalize "format") nd)\n\011\011\011(attribute-string (normalize "format") nd)\n\011\011\011(if entityref\n\011\011\011    (entity-notation entityref)\n\011\011\011    #f)))\n\011 (align     (attribute-string (normalize "align") nd))\n\011 (scale     (attribute-string (normalize "scale") nd)))\n    (if (or fileref entityref)\n\011(if (equal? format (normalize "linespecific"))\n\011    (if fileref\n\011\011(include-file fileref)\n\011\011(include-file (entity-generated-system-id entityref)))\n\011    (if fileref\n\011\011($graphic$ fileref display format scale align)\n\011\011($graphic$ (entity-generated-system-id entityref)\n\011\011\011   display format scale align)))\n\011(empty-sosofo))))\n\n(element graphic\n  (make paragraph\n    space-before: %block-sep%\n    space-after: %block-sep%\n    ($img$ (current-node) #t)))\n\n(element inlinegraphic ($img$))\n\n\n;; ======================================================================\n;; MediaObject and friends...\n\n(define preferred-mediaobject-notations\n  (list "EPS" "PS" "JPG" "JPEG" "PNG" "linespecific"))\n\n(define preferred-mediaobject-extensions\n  (list "eps" "ps" "jpg" "jpeg" "png"))\n\n(define acceptable-mediaobject-notations\n  (list "GIF" "GIF87a" "GIF89a" "BMP" "WMF"))\n\n(define acceptable-mediaobject-extensions\n  (list "gif" "bmp" "wmf"))\n\n(element mediaobject\n  (make paragraph\n    ($mediaobject$)))\n\n(element inlinemediaobject\n  (make sequence\n    ($mediaobject$)))\n\n(element mediaobjectco\n  (error "MediaObjectCO is not supported yet."))\n\n(element imageobjectco\n  (error "ImageObjectCO is not supported yet."))\n\n(element objectinfo\n  (empty-sosofo))\n\n(element videoobject\n  (process-children))\n\n(element videodata\n  (empty-sosofo))\n\n(element audioobject\n  (process-children))\n\n(element audiodata\n  (empty-sosofo))\n\n(element imageobject\n  (process-children))\n\n(element imagedata\n  (if (have-ancestor? (normalize "mediaobject"))\n      ($img$ (current-node) #t)\n      ($img$ (current-node) #f)))\n\n(element textobject\n  (make display-group\n    (process-children)))\n\n(element caption\n  (process-children))\n   \n;; $Id: dbindex.dsl,v 1.4 2003/01/15 08:24:23 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ................... INDEX TERMS (EMBEDDED MARKERS) ...................\n\n(element indexterm\n  ;; This is different than (empty-sosofo) alone because the backend\n  ;; will hang an anchor off the empty sequence.  This allows the index\n  ;; to point to the indexterm (but only if the indexterm has an ID).\n  (make sequence (empty-sosofo)))\n\n(element primary (empty-sosofo))\n(element secondary (empty-sosofo))\n(element tertiary (empty-sosofo))\n(element see (empty-sosofo))\n(element seealso (empty-sosofo))\n\n;; =========================== INDEX ELEMENTS ===========================\n\n(element setindex ($component$))\n(element (setindex title) (empty-sosofo))\n\n(element index\n  (make simple-page-sequence\n    page-number-restart?: (or %page-number-restart% \n\011\011\011      (book-start?) \n\011\011\011      (first-chapter?))\n    page-number-format: ($page-number-format$)\n    use: default-text-style\n    left-header:   ($left-header$)\n    center-header: ($center-header$)\n    right-header:  ($right-header$)\n    left-footer:   ($left-footer$)\n    center-footer: ($center-footer$)\n    right-footer:  ($right-footer$)\n    start-indent: %body-start-indent%\n    input-whitespace-treatment: 'collapse\n    quadding: %default-quadding%\n    page-n-columns: 2\n    (make sequence\n      ($component-title$)\n      (process-children))\n    (make-endnotes)))\n\n;; this is a special case. this prevents the index from causing an error but\n;; will make the index a single column. c'est la vie.\n(element (article index) ($section$))\n\n(element (index title) (empty-sosofo))\n\n(element indexdiv ($section$))\n(element (indexdiv title) (empty-sosofo))\n\n(element indexentry (process-children))\n\n(element primaryie\n  (make paragraph\n    font-size: (* (inherited-font-size) %smaller-size-factor%)\n    (process-children)))\n\n(element secondaryie\n  (make paragraph\n    font-size: (* (inherited-font-size) %smaller-size-factor%)\n    start-indent: (+ (inherited-start-indent) 1em)\n    (process-children)))\n\n(element tertiaryie\n  (make paragraph\n    font-size: (* (inherited-font-size) %smaller-size-factor%)\n    start-indent: (+ (inherited-start-indent) 2em)\n    (process-children)))\n\n(define (find-indexterm id)\n  ;; If you have a lot of indexterms that don't have IDs, this could \n  ;; be incredibly slow.  So don't do that.\n  (let* ((idtarget (element-with-id id)))\n    (if (node-list-empty? idtarget)\n\011(let loop ((idnodes (select-elements (descendants (sgml-root-element))\n\011\011\011\011\011     (normalize "indexterm"))))\n\011  (if (node-list-empty? idnodes)\n\011      (empty-node-list)\n\011      (if (equal? id (string-append "AEN" \n\011\011\011\011\011    (number->string \n\011\011\011\011\011     (all-element-number \n\011\011\011\011\011      (node-list-first idnodes)))))\n\011\011  (node-list-first idnodes)\n\011\011  (loop (node-list-rest idnodes)))))\n\011idtarget)))\n\n(define (indexentry-link nd)\n  (let* ((id        (attribute-string (normalize "role") nd))\n\011 (target    (find-indexterm id))\n\011 (preferred (not (node-list-empty?\n\011\011\011  (select-elements (children (current-node))\n\011\011\011\011\011   (normalize "emphasis")))))\n\011 (sosofo    (if (node-list-empty? target) \n\011\011\011(literal "?")\n\011\011\011(make link\n\011\011\011  destination: (node-list-address target)\n\011\011\011  (with-mode toc-page-number-mode\n\011\011\011    (process-node-list target))))))\n    (if preferred\n\011(make sequence\n\011  font-weight: 'bold\n\011  sosofo)\n\011sosofo)))\n\n(element (primaryie ulink)\n  (indexentry-link (current-node)))\n\n(element (secondaryie ulink)\n  (indexentry-link (current-node)))\n\n(element (tertiaryie ulink)\n  (indexentry-link (current-node)))\n\n(element seeie\n  (let ((indent (cond ((node-list-empty? \n\011\011\011(select-elements\n\011\011\011 (children (parent (current-node)))\n\011\011\011 (normalize "secondaryie")))\n\011\011       1em)\n\011\011      ((node-list-empty? \n\011\011\011(select-elements\n\011\011\011 (children (parent (current-node)))\n\011\011\011 (normalize "tertiaryie")))\n\011\011       2em)\n\011\011      (else 3em))))\n    (make paragraph\n      font-size: (* (inherited-font-size) %smaller-size-factor%)\n      start-indent: (+ (inherited-start-indent) indent)\n      (literal "(" (gentext-index-see) " ")\n      (process-children)\n      (literal ")"))))\n\n(element seealsoie\n  (let ((indent (cond ((node-list-empty? \n\011\011\011(select-elements\n\011\011\011 (children (parent (current-node)))\n\011\011\011 (normalize "secondaryie")))\n\011\011       1em)\n\011\011      ((node-list-empty? \n\011\011\011(select-elements\n\011\011\011 (children (parent (current-node)))\n\011\011\011 (normalize "tertiaryie")))\n\011\011       2em)\n\011\011      (else 3em))))\n    (make paragraph\n      font-size: (* (inherited-font-size) %smaller-size-factor%)\n      start-indent: (+ (inherited-start-indent) indent)\n      (literal "(" (gentext-index-seealso) " ")\n      (process-children)\n      (literal ")"))))\n   \n;; $Id: dbinfo.dsl,v 1.3 2003/01/15 08:24:23 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ................................ INFO ................................\n\n;; Rather than make the *INFO containers empty-sosofos, we make them\n;; process-children and then make all of the elements they may contain\n;; empty in this context.  The advantage here is that we can then\n;; more easily override some of them in stylesheets that use this one.\n\n(element setinfo (empty-sosofo))\n\n(element (setinfo abbrev) (empty-sosofo))\n(element (setinfo abstract) (empty-sosofo))\n(element (setinfo address) (empty-sosofo))\n(element (setinfo affiliation) (empty-sosofo))\n(element (setinfo artpagenums) (empty-sosofo))\n(element (setinfo author) (empty-sosofo))\n(element (setinfo authorblurb) (empty-sosofo))\n(element (setinfo authorgroup) (empty-sosofo))\n(element (setinfo authorinitials) (empty-sosofo))\n(element (setinfo bibliomisc) (empty-sosofo))\n(element (setinfo biblioset) (empty-sosofo))\n(element (setinfo collab) (empty-sosofo))\n(element (setinfo confgroup) (empty-sosofo))\n(element (setinfo contractnum) (empty-sosofo))\n(element (setinfo contractsponsor) (empty-sosofo))\n(element (setinfo contrib) (empty-sosofo))\n(element (setinfo copyright) (empty-sosofo))\n(element (setinfo corpauthor) (empty-sosofo))\n(element (setinfo corpname) (empty-sosofo))\n(element (setinfo date) (empty-sosofo))\n(element (setinfo edition) (empty-sosofo))\n(element (setinfo editor) (empty-sosofo))\n(element (setinfo firstname) (empty-sosofo))\n(element (setinfo graphic) (empty-sosofo))\n(element (setinfo honorific) (empty-sosofo))\n(element (setinfo invpartnumber) (empty-sosofo))\n(element (setinfo isbn) (empty-sosofo))\n(element (setinfo issn) (empty-sosofo))\n(element (setinfo issuenum) (empty-sosofo))\n(element (setinfo itermset) (empty-sosofo))\n(element (setinfo keywordset) (empty-sosofo))\n(element (setinfo legalnotice) (empty-sosofo))\n(element (setinfo lineage) (empty-sosofo))\n(element (setinfo modespec) (empty-sosofo))\n(element (setinfo orgname) (empty-sosofo))\n(element (setinfo othercredit) (empty-sosofo))\n(element (setinfo othername) (empty-sosofo))\n(element (setinfo pagenums) (empty-sosofo))\n(element (setinfo printhistory) (empty-sosofo))\n(element (setinfo productname) (empty-sosofo))\n(element (setinfo productnumber) (empty-sosofo))\n(element (setinfo pubdate) (empty-sosofo))\n(element (setinfo publisher) (empty-sosofo))\n(element (setinfo publishername) (empty-sosofo))\n(element (setinfo pubsnumber) (empty-sosofo))\n(element (setinfo releaseinfo) (empty-sosofo))\n(element (setinfo revhistory) (empty-sosofo))\n(element (setinfo seriesvolnums) (empty-sosofo))\n(element (setinfo subjectset) (empty-sosofo))\n(element (setinfo subtitle) (empty-sosofo))\n(element (setinfo surname) (empty-sosofo))\n(element (setinfo title) (empty-sosofo))\n(element (setinfo titleabbrev) (empty-sosofo))\n(element (setinfo volumenum) (empty-sosofo))\n\n;; BookInfo is handled differently in dbdivis.dsl by using a\n;; special mode...\n\n(element bookinfo (empty-sosofo))\n\n(element (bookinfo abbrev) (process-children))\n(element (bookinfo abstract) (process-children))\n(element (bookinfo address) (process-children))\n(element (bookinfo affiliation) (process-children))\n(element (bookinfo artpagenums) (process-children))\n(element (bookinfo author) (process-children))\n(element (bookinfo authorblurb) (process-children))\n(element (bookinfo authorgroup) (process-children))\n(element (bookinfo authorinitials) (process-children))\n(element (bookinfo bibliomisc) (process-children))\n(element (bookinfo biblioset) (process-children))\n(element (bookinfo bookbiblio) (process-children))\n(element (bookinfo collab) (process-children))\n(element (bookinfo confgroup) (process-children))\n(element (bookinfo contractnum) (process-children))\n(element (bookinfo contractsponsor) (process-children))\n(element (bookinfo contrib) (process-children))\n;; (element (bookinfo copyright) (process-children)) ;; the default is good\n(element (bookinfo corpauthor) (process-children))\n(element (bookinfo corpname) (process-children))\n(element (bookinfo date) (process-children))\n(element (bookinfo edition) (process-children))\n(element (bookinfo editor) (process-children))\n(element (bookinfo firstname) (process-children))\n(element (bookinfo graphic) (process-children))\n(element (bookinfo honorific) (process-children))\n(element (bookinfo invpartnumber) (process-children))\n(element (bookinfo isbn) (process-children))\n(element (bookinfo issn) (process-children))\n(element (bookinfo issuenum) (process-children))\n(element (bookinfo itermset) (process-children))\n(element (bookinfo keywordset) (process-children))\n(element (bookinfo legalnotice) ($semiformal-object$))\n(element (bookinfo lineage) (process-children))\n(element (bookinfo modespec) (process-children))\n(element (bookinfo orgname) (process-children))\n(element (bookinfo othercredit) (process-children))\n(element (bookinfo othername) (process-children))\n(element (bookinfo pagenums) (process-children))\n(element (bookinfo printhistory) (process-children))\n(element (bookinfo productname) (process-children))\n(element (bookinfo productnumber) (process-children))\n(element (bookinfo pubdate) (process-children))\n(element (bookinfo publisher) (process-children))\n(element (bookinfo publishername) (process-children))\n(element (bookinfo pubsnumber) (process-children))\n(element (bookinfo releaseinfo) (process-children))\n(element (bookinfo revhistory) ($book-revhistory$))\n(element (bookinfo seriesvolnums) (process-children))\n(element (bookinfo subjectset) (process-children))\n(element (bookinfo subtitle) (process-children))\n(element (bookinfo surname) (process-children))\n(element (bookinfo title) (process-children))\n(element (bookinfo titleabbrev) (process-children))\n(element (bookinfo volumenum) (process-children))\n\n(element docinfo (empty-sosofo))\n\n(element (docinfo abbrev) (empty-sosofo))\n(element (docinfo abstract) (empty-sosofo))\n(element (docinfo address) (empty-sosofo))\n(element (docinfo affiliation) (empty-sosofo))\n(element (docinfo artpagenums) (empty-sosofo))\n(element (docinfo author) (empty-sosofo))\n(element (docinfo authorblurb) (empty-sosofo))\n(element (docinfo authorgroup) (empty-sosofo))\n(element (docinfo authorinitials) (empty-sosofo))\n(element (docinfo bibliomisc) (empty-sosofo))\n(element (docinfo biblioset) (empty-sosofo))\n(element (docinfo collab) (empty-sosofo))\n(element (docinfo confgroup) (empty-sosofo))\n(element (docinfo contractnum) (empty-sosofo))\n(element (docinfo contractsponsor) (empty-sosofo))\n(element (docinfo contrib) (empty-sosofo))\n(element (docinfo copyright) (empty-sosofo))\n(element (docinfo corpauthor) (empty-sosofo))\n(element (docinfo corpname) (empty-sosofo))\n(element (docinfo date) (empty-sosofo))\n(element (docinfo edition) (empty-sosofo))\n(element (docinfo editor) (empty-sosofo))\n(element (docinfo firstname) (empty-sosofo))\n(element (docinfo graphic) (empty-sosofo))\n(element (docinfo honorific) (empty-sosofo))\n(element (docinfo invpartnumber) (empty-sosofo))\n(element (docinfo isbn) (empty-sosofo))\n(element (docinfo issn) (empty-sosofo))\n(element (docinfo issuenum) (empty-sosofo))\n(element (docinfo itermset) (empty-sosofo))\n(element (docinfo keywordset) (empty-sosofo))\n(element (docinfo legalnotice) (empty-sosofo))\n(element (docinfo lineage) (empty-sosofo))\n(element (docinfo modespec) (empty-sosofo))\n(element (docinfo orgname) (empty-sosofo))\n(element (docinfo othercredit) (empty-sosofo))\n(element (docinfo othername) (empty-sosofo))\n(element (docinfo pagenums) (empty-sosofo))\n(element (docinfo printhistory) (empty-sosofo))\n(element (docinfo productname) (empty-sosofo))\n(element (docinfo productnumber) (empty-sosofo))\n(element (docinfo pubdate) (empty-sosofo))\n(element (docinfo publisher) (empty-sosofo))\n(element (docinfo publishername) (empty-sosofo))\n(element (docinfo pubsnumber) (empty-sosofo))\n(element (docinfo releaseinfo) (empty-sosofo))\n(element (docinfo revhistory) (empty-sosofo))\n(element (docinfo seriesvolnums) (empty-sosofo))\n(element (docinfo subjectset) (empty-sosofo))\n(element (docinfo subtitle) (empty-sosofo))\n(element (docinfo surname) (empty-sosofo))\n(element (docinfo title) (empty-sosofo))\n(element (docinfo titleabbrev) (empty-sosofo))\n(element (docinfo volumenum) (empty-sosofo))\n\n(element sect1info (process-children))\n\n(element (sect1info abbrev) (empty-sosofo))\n(element (sect1info abstract) (empty-sosofo))\n(element (sect1info address) (empty-sosofo))\n(element (sect1info affiliation) (empty-sosofo))\n(element (sect1info artpagenums) (empty-sosofo))\n(element (sect1info author) (empty-sosofo))\n(element (sect1info authorblurb) (empty-sosofo))\n(element (sect1info authorgroup) (empty-sosofo))\n(element (sect1info authorinitials) (empty-sosofo))\n(element (sect1info bibliomisc) (empty-sosofo))\n(element (sect1info biblioset) (empty-sosofo))\n(element (sect1info collab) (empty-sosofo))\n(element (sect1info confgroup) (empty-sosofo))\n(element (sect1info contractnum) (empty-sosofo))\n(element (sect1info contractsponsor) (empty-sosofo))\n(element (sect1info contrib) (empty-sosofo))\n(element (sect1info copyright) (empty-sosofo))\n(element (sect1info corpauthor) (empty-sosofo))\n(element (sect1info corpname) (empty-sosofo))\n(element (sect1info date) (empty-sosofo))\n(element (sect1info edition) (empty-sosofo))\n(element (sect1info editor) (empty-sosofo))\n(element (sect1info firstname) (empty-sosofo))\n(element (sect1info graphic) (empty-sosofo))\n(element (sect1info honorific) (empty-sosofo))\n(element (sect1info invpartnumber) (empty-sosofo))\n(element (sect1info isbn) (empty-sosofo))\n(element (sect1info issn) (empty-sosofo))\n(element (sect1info issuenum) (empty-sosofo))\n(element (sect1info itermset) (empty-sosofo))\n(element (sect1info keywordset) (empty-sosofo))\n(element (sect1info legalnotice) (empty-sosofo))\n(element (sect1info lineage) (empty-sosofo))\n(element (sect1info modespec) (empty-sosofo))\n(element (sect1info orgname) (empty-sosofo))\n(element (sect1info othercredit) (empty-sosofo))\n(element (sect1info othername) (empty-sosofo))\n(element (sect1info pagenums) (empty-sosofo))\n(element (sect1info printhistory) (empty-sosofo))\n(element (sect1info productname) (empty-sosofo))\n(element (sect1info productnumber) (empty-sosofo))\n(element (sect1info pubdate) (empty-sosofo))\n(element (sect1info publisher) (empty-sosofo))\n(element (sect1info publishername) (empty-sosofo))\n(element (sect1info pubsnumber) (empty-sosofo))\n(element (sect1info releaseinfo) (empty-sosofo))\n(element (sect1info revhistory) (empty-sosofo))\n(element (sect1info seriesvolnums) (empty-sosofo))\n(element (sect1info subjectset) (empty-sosofo))\n(element (sect1info subtitle) (empty-sosofo))\n(element (sect1info surname) (empty-sosofo))\n(element (sect1info title) (empty-sosofo))\n(element (sect1info titleabbrev) (empty-sosofo))\n(element (sect1info volumenum) (empty-sosofo))\n\n(element sect2info (process-children))\n\n(element (sect2info abbrev) (empty-sosofo))\n(element (sect2info abstract) (empty-sosofo))\n(element (sect2info address) (empty-sosofo))\n(element (sect2info affiliation) (empty-sosofo))\n(element (sect2info artpagenums) (empty-sosofo))\n(element (sect2info author) (empty-sosofo))\n(element (sect2info authorblurb) (empty-sosofo))\n(element (sect2info authorgroup) (empty-sosofo))\n(element (sect2info authorinitials) (empty-sosofo))\n(element (sect2info bibliomisc) (empty-sosofo))\n(element (sect2info biblioset) (empty-sosofo))\n(element (sect2info collab) (empty-sosofo))\n(element (sect2info confgroup) (empty-sosofo))\n(element (sect2info contractnum) (empty-sosofo))\n(element (sect2info contractsponsor) (empty-sosofo))\n(element (sect2info contrib) (empty-sosofo))\n(element (sect2info copyright) (empty-sosofo))\n(element (sect2info corpauthor) (empty-sosofo))\n(element (sect2info corpname) (empty-sosofo))\n(element (sect2info date) (empty-sosofo))\n(element (sect2info edition) (empty-sosofo))\n(element (sect2info editor) (empty-sosofo))\n(element (sect2info firstname) (empty-sosofo))\n(element (sect2info graphic) (empty-sosofo))\n(element (sect2info honorific) (empty-sosofo))\n(element (sect2info invpartnumber) (empty-sosofo))\n(element (sect2info isbn) (empty-sosofo))\n(element (sect2info issn) (empty-sosofo))\n(element (sect2info issuenum) (empty-sosofo))\n(element (sect2info itermset) (empty-sosofo))\n(element (sect2info keywordset) (empty-sosofo))\n(element (sect2info legalnotice) (empty-sosofo))\n(element (sect2info lineage) (empty-sosofo))\n(element (sect2info modespec) (empty-sosofo))\n(element (sect2info orgname) (empty-sosofo))\n(element (sect2info othercredit) (empty-sosofo))\n(element (sect2info othername) (empty-sosofo))\n(element (sect2info pagenums) (empty-sosofo))\n(element (sect2info printhistory) (empty-sosofo))\n(element (sect2info productname) (empty-sosofo))\n(element (sect2info productnumber) (empty-sosofo))\n(element (sect2info pubdate) (empty-sosofo))\n(element (sect2info publisher) (empty-sosofo))\n(element (sect2info publishername) (empty-sosofo))\n(element (sect2info pubsnumber) (empty-sosofo))\n(element (sect2info releaseinfo) (empty-sosofo))\n(element (sect2info revhistory) (empty-sosofo))\n(element (sect2info seriesvolnums) (empty-sosofo))\n(element (sect2info subjectset) (empty-sosofo))\n(element (sect2info subtitle) (empty-sosofo))\n(element (sect2info surname) (empty-sosofo))\n(element (sect2info title) (empty-sosofo))\n(element (sect2info titleabbrev) (empty-sosofo))\n(element (sect2info volumenum) (empty-sosofo))\n\n(element sect3info (process-children))\n\n(element (sect3info abbrev) (empty-sosofo))\n(element (sect3info abstract) (empty-sosofo))\n(element (sect3info address) (empty-sosofo))\n(element (sect3info affiliation) (empty-sosofo))\n(element (sect3info artpagenums) (empty-sosofo))\n(element (sect3info author) (empty-sosofo))\n(element (sect3info authorblurb) (empty-sosofo))\n(element (sect3info authorgroup) (empty-sosofo))\n(element (sect3info authorinitials) (empty-sosofo))\n(element (sect3info bibliomisc) (empty-sosofo))\n(element (sect3info biblioset) (empty-sosofo))\n(element (sect3info collab) (empty-sosofo))\n(element (sect3info confgroup) (empty-sosofo))\n(element (sect3info contractnum) (empty-sosofo))\n(element (sect3info contractsponsor) (empty-sosofo))\n(element (sect3info contrib) (empty-sosofo))\n(element (sect3info copyright) (empty-sosofo))\n(element (sect3info corpauthor) (empty-sosofo))\n(element (sect3info corpname) (empty-sosofo))\n(element (sect3info date) (empty-sosofo))\n(element (sect3info edition) (empty-sosofo))\n(element (sect3info editor) (empty-sosofo))\n(element (sect3info firstname) (empty-sosofo))\n(element (sect3info graphic) (empty-sosofo))\n(element (sect3info honorific) (empty-sosofo))\n(element (sect3info invpartnumber) (empty-sosofo))\n(element (sect3info isbn) (empty-sosofo))\n(element (sect3info issn) (empty-sosofo))\n(element (sect3info issuenum) (empty-sosofo))\n(element (sect3info itermset) (empty-sosofo))\n(element (sect3info keywordset) (empty-sosofo))\n(element (sect3info legalnotice) (empty-sosofo))\n(element (sect3info lineage) (empty-sosofo))\n(element (sect3info modespec) (empty-sosofo))\n(element (sect3info orgname) (empty-sosofo))\n(element (sect3info othercredit) (empty-sosofo))\n(element (sect3info othername) (empty-sosofo))\n(element (sect3info pagenums) (empty-sosofo))\n(element (sect3info printhistory) (empty-sosofo))\n(element (sect3info productname) (empty-sosofo))\n(element (sect3info productnumber) (empty-sosofo))\n(element (sect3info pubdate) (empty-sosofo))\n(element (sect3info publisher) (empty-sosofo))\n(element (sect3info publishername) (empty-sosofo))\n(element (sect3info pubsnumber) (empty-sosofo))\n(element (sect3info releaseinfo) (empty-sosofo))\n(element (sect3info revhistory) (empty-sosofo))\n(element (sect3info seriesvolnums) (empty-sosofo))\n(element (sect3info subjectset) (empty-sosofo))\n(element (sect3info subtitle) (empty-sosofo))\n(element (sect3info surname) (empty-sosofo))\n(element (sect3info title) (empty-sosofo))\n(element (sect3info titleabbrev) (empty-sosofo))\n(element (sect3info volumenum) (empty-sosofo))\n\n(element sect4info (process-children))\n\n(element (sect4info abbrev) (empty-sosofo))\n(element (sect4info abstract) (empty-sosofo))\n(element (sect4info address) (empty-sosofo))\n(element (sect4info affiliation) (empty-sosofo))\n(element (sect4info artpagenums) (empty-sosofo))\n(element (sect4info author) (empty-sosofo))\n(element (sect4info authorblurb) (empty-sosofo))\n(element (sect4info authorgroup) (empty-sosofo))\n(element (sect4info authorinitials) (empty-sosofo))\n(element (sect4info bibliomisc) (empty-sosofo))\n(element (sect4info biblioset) (empty-sosofo))\n(element (sect4info collab) (empty-sosofo))\n(element (sect4info confgroup) (empty-sosofo))\n(element (sect4info contractnum) (empty-sosofo))\n(element (sect4info contractsponsor) (empty-sosofo))\n(element (sect4info contrib) (empty-sosofo))\n(element (sect4info copyright) (empty-sosofo))\n(element (sect4info corpauthor) (empty-sosofo))\n(element (sect4info corpname) (empty-sosofo))\n(element (sect4info date) (empty-sosofo))\n(element (sect4info edition) (empty-sosofo))\n(element (sect4info editor) (empty-sosofo))\n(element (sect4info firstname) (empty-sosofo))\n(element (sect4info graphic) (empty-sosofo))\n(element (sect4info honorific) (empty-sosofo))\n(element (sect4info invpartnumber) (empty-sosofo))\n(element (sect4info isbn) (empty-sosofo))\n(element (sect4info issn) (empty-sosofo))\n(element (sect4info issuenum) (empty-sosofo))\n(element (sect4info itermset) (empty-sosofo))\n(element (sect4info keywordset) (empty-sosofo))\n(element (sect4info legalnotice) (empty-sosofo))\n(element (sect4info lineage) (empty-sosofo))\n(element (sect4info modespec) (empty-sosofo))\n(element (sect4info orgname) (empty-sosofo))\n(element (sect4info othercredit) (empty-sosofo))\n(element (sect4info othername) (empty-sosofo))\n(element (sect4info pagenums) (empty-sosofo))\n(element (sect4info printhistory) (empty-sosofo))\n(element (sect4info productname) (empty-sosofo))\n(element (sect4info productnumber) (empty-sosofo))\n(element (sect4info pubdate) (empty-sosofo))\n(element (sect4info publisher) (empty-sosofo))\n(element (sect4info publishername) (empty-sosofo))\n(element (sect4info pubsnumber) (empty-sosofo))\n(element (sect4info releaseinfo) (empty-sosofo))\n(element (sect4info revhistory) (empty-sosofo))\n(element (sect4info seriesvolnums) (empty-sosofo))\n(element (sect4info subjectset) (empty-sosofo))\n(element (sect4info subtitle) (empty-sosofo))\n(element (sect4info surname) (empty-sosofo))\n(element (sect4info title) (empty-sosofo))\n(element (sect4info titleabbrev) (empty-sosofo))\n(element (sect4info volumenum) (empty-sosofo))\n\n(element sect5info (process-children))\n\n(element (sect5info abbrev) (empty-sosofo))\n(element (sect5info abstract) (empty-sosofo))\n(element (sect5info address) (empty-sosofo))\n(element (sect5info affiliation) (empty-sosofo))\n(element (sect5info artpagenums) (empty-sosofo))\n(element (sect5info author) (empty-sosofo))\n(element (sect5info authorblurb) (empty-sosofo))\n(element (sect5info authorgroup) (empty-sosofo))\n(element (sect5info authorinitials) (empty-sosofo))\n(element (sect5info bibliomisc) (empty-sosofo))\n(element (sect5info biblioset) (empty-sosofo))\n(element (sect5info collab) (empty-sosofo))\n(element (sect5info confgroup) (empty-sosofo))\n(element (sect5info contractnum) (empty-sosofo))\n(element (sect5info contractsponsor) (empty-sosofo))\n(element (sect5info contrib) (empty-sosofo))\n(element (sect5info copyright) (empty-sosofo))\n(element (sect5info corpauthor) (empty-sosofo))\n(element (sect5info corpname) (empty-sosofo))\n(element (sect5info date) (empty-sosofo))\n(element (sect5info edition) (empty-sosofo))\n(element (sect5info editor) (empty-sosofo))\n(element (sect5info firstname) (empty-sosofo))\n(element (sect5info graphic) (empty-sosofo))\n(element (sect5info honorific) (empty-sosofo))\n(element (sect5info invpartnumber) (empty-sosofo))\n(element (sect5info isbn) (empty-sosofo))\n(element (sect5info issn) (empty-sosofo))\n(element (sect5info issuenum) (empty-sosofo))\n(element (sect5info itermset) (empty-sosofo))\n(element (sect5info keywordset) (empty-sosofo))\n(element (sect5info legalnotice) (empty-sosofo))\n(element (sect5info lineage) (empty-sosofo))\n(element (sect5info modespec) (empty-sosofo))\n(element (sect5info orgname) (empty-sosofo))\n(element (sect5info othercredit) (empty-sosofo))\n(element (sect5info othername) (empty-sosofo))\n(element (sect5info pagenums) (empty-sosofo))\n(element (sect5info printhistory) (empty-sosofo))\n(element (sect5info productname) (empty-sosofo))\n(element (sect5info productnumber) (empty-sosofo))\n(element (sect5info pubdate) (empty-sosofo))\n(element (sect5info publisher) (empty-sosofo))\n(element (sect5info publishername) (empty-sosofo))\n(element (sect5info pubsnumber) (empty-sosofo))\n(element (sect5info releaseinfo) (empty-sosofo))\n(element (sect5info revhistory) (empty-sosofo))\n(element (sect5info seriesvolnums) (empty-sosofo))\n(element (sect5info subjectset) (empty-sosofo))\n(element (sect5info subtitle) (empty-sosofo))\n(element (sect5info surname) (empty-sosofo))\n(element (sect5info title) (empty-sosofo))\n(element (sect5info titleabbrev) (empty-sosofo))\n(element (sect5info volumenum) (empty-sosofo))\n\n(element refsect1info (process-children))\n\n(element (refsect1info abbrev) (empty-sosofo))\n(element (refsect1info abstract) (empty-sosofo))\n(element (refsect1info address) (empty-sosofo))\n(element (refsect1info affiliation) (empty-sosofo))\n(element (refsect1info artpagenums) (empty-sosofo))\n(element (refsect1info author) (empty-sosofo))\n(element (refsect1info authorblurb) (empty-sosofo))\n(element (refsect1info authorgroup) (empty-sosofo))\n(element (refsect1info authorinitials) (empty-sosofo))\n(element (refsect1info bibliomisc) (empty-sosofo))\n(element (refsect1info biblioset) (empty-sosofo))\n(element (refsect1info collab) (empty-sosofo))\n(element (refsect1info confgroup) (empty-sosofo))\n(element (refsect1info contractnum) (empty-sosofo))\n(element (refsect1info contractsponsor) (empty-sosofo))\n(element (refsect1info contrib) (empty-sosofo))\n(element (refsect1info copyright) (empty-sosofo))\n(element (refsect1info corpauthor) (empty-sosofo))\n(element (refsect1info corpname) (empty-sosofo))\n(element (refsect1info date) (empty-sosofo))\n(element (refsect1info edition) (empty-sosofo))\n(element (refsect1info editor) (empty-sosofo))\n(element (refsect1info firstname) (empty-sosofo))\n(element (refsect1info graphic) (empty-sosofo))\n(element (refsect1info honorific) (empty-sosofo))\n(element (refsect1info invpartnumber) (empty-sosofo))\n(element (refsect1info isbn) (empty-sosofo))\n(element (refsect1info issn) (empty-sosofo))\n(element (refsect1info issuenum) (empty-sosofo))\n(element (refsect1info itermset) (empty-sosofo))\n(element (refsect1info keywordset) (empty-sosofo))\n(element (refsect1info legalnotice) (empty-sosofo))\n(element (refsect1info lineage) (empty-sosofo))\n(element (refsect1info modespec) (empty-sosofo))\n(element (refsect1info orgname) (empty-sosofo))\n(element (refsect1info othercredit) (empty-sosofo))\n(element (refsect1info othername) (empty-sosofo))\n(element (refsect1info pagenums) (empty-sosofo))\n(element (refsect1info printhistory) (empty-sosofo))\n(element (refsect1info productname) (empty-sosofo))\n(element (refsect1info productnumber) (empty-sosofo))\n(element (refsect1info pubdate) (empty-sosofo))\n(element (refsect1info publisher) (empty-sosofo))\n(element (refsect1info publishername) (empty-sosofo))\n(element (refsect1info pubsnumber) (empty-sosofo))\n(element (refsect1info releaseinfo) (empty-sosofo))\n(element (refsect1info revhistory) (empty-sosofo))\n(element (refsect1info seriesvolnums) (empty-sosofo))\n(element (refsect1info subjectset) (empty-sosofo))\n(element (refsect1info subtitle) (empty-sosofo))\n(element (refsect1info surname) (empty-sosofo))\n(element (refsect1info title) (empty-sosofo))\n(element (refsect1info titleabbrev) (empty-sosofo))\n(element (refsect1info volumenum) (empty-sosofo))\n\n(element refsect2info (process-children))\n\n(element (refsect2info abbrev) (empty-sosofo))\n(element (refsect2info abstract) (empty-sosofo))\n(element (refsect2info address) (empty-sosofo))\n(element (refsect2info affiliation) (empty-sosofo))\n(element (refsect2info artpagenums) (empty-sosofo))\n(element (refsect2info author) (empty-sosofo))\n(element (refsect2info authorblurb) (empty-sosofo))\n(element (refsect2info authorgroup) (empty-sosofo))\n(element (refsect2info authorinitials) (empty-sosofo))\n(element (refsect2info bibliomisc) (empty-sosofo))\n(element (refsect2info biblioset) (empty-sosofo))\n(element (refsect2info collab) (empty-sosofo))\n(element (refsect2info confgroup) (empty-sosofo))\n(element (refsect2info contractnum) (empty-sosofo))\n(element (refsect2info contractsponsor) (empty-sosofo))\n(element (refsect2info contrib) (empty-sosofo))\n(element (refsect2info copyright) (empty-sosofo))\n(element (refsect2info corpauthor) (empty-sosofo))\n(element (refsect2info corpname) (empty-sosofo))\n(element (refsect2info date) (empty-sosofo))\n(element (refsect2info edition) (empty-sosofo))\n(element (refsect2info editor) (empty-sosofo))\n(element (refsect2info firstname) (empty-sosofo))\n(element (refsect2info graphic) (empty-sosofo))\n(element (refsect2info honorific) (empty-sosofo))\n(element (refsect2info invpartnumber) (empty-sosofo))\n(element (refsect2info isbn) (empty-sosofo))\n(element (refsect2info issn) (empty-sosofo))\n(element (refsect2info issuenum) (empty-sosofo))\n(element (refsect2info itermset) (empty-sosofo))\n(element (refsect2info keywordset) (empty-sosofo))\n(element (refsect2info legalnotice) (empty-sosofo))\n(element (refsect2info lineage) (empty-sosofo))\n(element (refsect2info modespec) (empty-sosofo))\n(element (refsect2info orgname) (empty-sosofo))\n(element (refsect2info othercredit) (empty-sosofo))\n(element (refsect2info othername) (empty-sosofo))\n(element (refsect2info pagenums) (empty-sosofo))\n(element (refsect2info printhistory) (empty-sosofo))\n(element (refsect2info productname) (empty-sosofo))\n(element (refsect2info productnumber) (empty-sosofo))\n(element (refsect2info pubdate) (empty-sosofo))\n(element (refsect2info publisher) (empty-sosofo))\n(element (refsect2info publishername) (empty-sosofo))\n(element (refsect2info pubsnumber) (empty-sosofo))\n(element (refsect2info releaseinfo) (empty-sosofo))\n(element (refsect2info revhistory) (empty-sosofo))\n(element (refsect2info seriesvolnums) (empty-sosofo))\n(element (refsect2info subjectset) (empty-sosofo))\n(element (refsect2info subtitle) (empty-sosofo))\n(element (refsect2info surname) (empty-sosofo))\n(element (refsect2info title) (empty-sosofo))\n(element (refsect2info titleabbrev) (empty-sosofo))\n(element (refsect2info volumenum) (empty-sosofo))\n\n(element refsect3info (process-children))\n\n(element (refsect3info abbrev) (empty-sosofo))\n(element (refsect3info abstract) (empty-sosofo))\n(element (refsect3info address) (empty-sosofo))\n(element (refsect3info affiliation) (empty-sosofo))\n(element (refsect3info artpagenums) (empty-sosofo))\n(element (refsect3info author) (empty-sosofo))\n(element (refsect3info authorblurb) (empty-sosofo))\n(element (refsect3info authorgroup) (empty-sosofo))\n(element (refsect3info authorinitials) (empty-sosofo))\n(element (refsect3info bibliomisc) (empty-sosofo))\n(element (refsect3info biblioset) (empty-sosofo))\n(element (refsect3info collab) (empty-sosofo))\n(element (refsect3info confgroup) (empty-sosofo))\n(element (refsect3info contractnum) (empty-sosofo))\n(element (refsect3info contractsponsor) (empty-sosofo))\n(element (refsect3info contrib) (empty-sosofo))\n(element (refsect3info copyright) (empty-sosofo))\n(element (refsect3info corpauthor) (empty-sosofo))\n(element (refsect3info corpname) (empty-sosofo))\n(element (refsect3info date) (empty-sosofo))\n(element (refsect3info edition) (empty-sosofo))\n(element (refsect3info editor) (empty-sosofo))\n(element (refsect3info firstname) (empty-sosofo))\n(element (refsect3info graphic) (empty-sosofo))\n(element (refsect3info honorific) (empty-sosofo))\n(element (refsect3info invpartnumber) (empty-sosofo))\n(element (refsect3info isbn) (empty-sosofo))\n(element (refsect3info issn) (empty-sosofo))\n(element (refsect3info issuenum) (empty-sosofo))\n(element (refsect3info itermset) (empty-sosofo))\n(element (refsect3info keywordset) (empty-sosofo))\n(element (refsect3info legalnotice) (empty-sosofo))\n(element (refsect3info lineage) (empty-sosofo))\n(element (refsect3info modespec) (empty-sosofo))\n(element (refsect3info orgname) (empty-sosofo))\n(element (refsect3info othercredit) (empty-sosofo))\n(element (refsect3info othername) (empty-sosofo))\n(element (refsect3info pagenums) (empty-sosofo))\n(element (refsect3info printhistory) (empty-sosofo))\n(element (refsect3info productname) (empty-sosofo))\n(element (refsect3info productnumber) (empty-sosofo))\n(element (refsect3info pubdate) (empty-sosofo))\n(element (refsect3info publisher) (empty-sosofo))\n(element (refsect3info publishername) (empty-sosofo))\n(element (refsect3info pubsnumber) (empty-sosofo))\n(element (refsect3info releaseinfo) (empty-sosofo))\n(element (refsect3info revhistory) (empty-sosofo))\n(element (refsect3info seriesvolnums) (empty-sosofo))\n(element (refsect3info subjectset) (empty-sosofo))\n(element (refsect3info subtitle) (empty-sosofo))\n(element (refsect3info surname) (empty-sosofo))\n(element (refsect3info title) (empty-sosofo))\n(element (refsect3info titleabbrev) (empty-sosofo))\n(element (refsect3info volumenum) (empty-sosofo))\n\n(element seriesinfo (process-children))\n\n(element (seriesinfo abbrev) (empty-sosofo))\n(element (seriesinfo abstract) (empty-sosofo))\n(element (seriesinfo address) (empty-sosofo))\n(element (seriesinfo affiliation) (empty-sosofo))\n(element (seriesinfo artpagenums) (empty-sosofo))\n(element (seriesinfo author) (empty-sosofo))\n(element (seriesinfo authorblurb) (empty-sosofo))\n(element (seriesinfo authorgroup) (empty-sosofo))\n(element (seriesinfo authorinitials) (empty-sosofo))\n(element (seriesinfo bibliomisc) (empty-sosofo))\n(element (seriesinfo biblioset) (empty-sosofo))\n(element (seriesinfo collab) (empty-sosofo))\n(element (seriesinfo confgroup) (empty-sosofo))\n(element (seriesinfo contractnum) (empty-sosofo))\n(element (seriesinfo contractsponsor) (empty-sosofo))\n(element (seriesinfo contrib) (empty-sosofo))\n(element (seriesinfo copyright) (empty-sosofo))\n(element (seriesinfo corpauthor) (empty-sosofo))\n(element (seriesinfo corpname) (empty-sosofo))\n(element (seriesinfo date) (empty-sosofo))\n(element (seriesinfo edition) (empty-sosofo))\n(element (seriesinfo editor) (empty-sosofo))\n(element (seriesinfo firstname) (empty-sosofo))\n(element (seriesinfo honorific) (empty-sosofo))\n(element (seriesinfo invpartnumber) (empty-sosofo))\n(element (seriesinfo isbn) (empty-sosofo))\n(element (seriesinfo issn) (empty-sosofo))\n(element (seriesinfo issuenum) (empty-sosofo))\n(element (seriesinfo lineage) (empty-sosofo))\n(element (seriesinfo orgname) (empty-sosofo))\n(element (seriesinfo othercredit) (empty-sosofo))\n(element (seriesinfo othername) (empty-sosofo))\n(element (seriesinfo pagenums) (empty-sosofo))\n(element (seriesinfo printhistory) (empty-sosofo))\n(element (seriesinfo productname) (empty-sosofo))\n(element (seriesinfo productnumber) (empty-sosofo))\n(element (seriesinfo pubdate) (empty-sosofo))\n(element (seriesinfo publisher) (empty-sosofo))\n(element (seriesinfo publishername) (empty-sosofo))\n(element (seriesinfo pubsnumber) (empty-sosofo))\n(element (seriesinfo releaseinfo) (empty-sosofo))\n(element (seriesinfo revhistory) (empty-sosofo))\n(element (seriesinfo seriesvolnums) (empty-sosofo))\n(element (seriesinfo subtitle) (empty-sosofo))\n(element (seriesinfo surname) (empty-sosofo))\n(element (seriesinfo title) (empty-sosofo))\n(element (seriesinfo titleabbrev) (empty-sosofo))\n(element (seriesinfo volumenum) (empty-sosofo))\n\n(element artheader (empty-sosofo))\n\n(element (artheader abbrev) (empty-sosofo))\n(element (artheader abstract) (empty-sosofo))\n(element (artheader address) (empty-sosofo))\n(element (artheader affiliation) (empty-sosofo))\n(element (artheader artpagenums) (empty-sosofo))\n(element (artheader author) (empty-sosofo))\n(element (artheader authorblurb) (empty-sosofo))\n(element (artheader authorgroup) (empty-sosofo))\n(element (artheader authorinitials) (empty-sosofo))\n(element (artheader bibliomisc) (empty-sosofo))\n(element (artheader biblioset) (empty-sosofo))\n(element (artheader bookbiblio) (empty-sosofo))\n(element (artheader collab) (empty-sosofo))\n(element (artheader confgroup) (empty-sosofo))\n(element (artheader contractnum) (empty-sosofo))\n(element (artheader contractsponsor) (empty-sosofo))\n(element (artheader contrib) (empty-sosofo))\n(element (artheader copyright) (empty-sosofo))\n(element (artheader corpauthor) (empty-sosofo))\n(element (artheader corpname) (empty-sosofo))\n(element (artheader date) (empty-sosofo))\n(element (artheader edition) (empty-sosofo))\n(element (artheader editor) (empty-sosofo))\n(element (artheader firstname) (empty-sosofo))\n(element (artheader honorific) (empty-sosofo))\n(element (artheader invpartnumber) (empty-sosofo))\n(element (artheader isbn) (empty-sosofo))\n(element (artheader issn) (empty-sosofo))\n(element (artheader issuenum) (empty-sosofo))\n(element (artheader keywordset) (empty-sosofo))\n(element (artheader lineage) (empty-sosofo))\n(element (artheader orgname) (empty-sosofo))\n(element (artheader othercredit) (empty-sosofo))\n(element (artheader othername) (empty-sosofo))\n(element (artheader pagenums) (empty-sosofo))\n(element (artheader printhistory) (empty-sosofo))\n(element (artheader productname) (empty-sosofo))\n(element (artheader productnumber) (empty-sosofo))\n(element (artheader pubdate) (empty-sosofo))\n(element (artheader publisher) (empty-sosofo))\n(element (artheader publishername) (empty-sosofo))\n(element (artheader pubsnumber) (empty-sosofo))\n(element (artheader releaseinfo) (empty-sosofo))\n(element (artheader revhistory) (empty-sosofo))\n(element (artheader seriesvolnums) (empty-sosofo))\n(element (artheader subtitle) (empty-sosofo))\n(element (artheader surname) (empty-sosofo))\n(element (artheader title) (empty-sosofo))\n(element (artheader titleabbrev) (empty-sosofo))\n(element (artheader volumenum) (empty-sosofo))\n\n(element articleinfo (empty-sosofo))\n\n(element (articleinfo abbrev) (empty-sosofo))\n(element (articleinfo abstract) (empty-sosofo))\n(element (articleinfo address) (empty-sosofo))\n(element (articleinfo affiliation) (empty-sosofo))\n(element (articleinfo artpagenums) (empty-sosofo))\n(element (articleinfo author) (empty-sosofo))\n(element (articleinfo authorblurb) (empty-sosofo))\n(element (articleinfo authorgroup) (empty-sosofo))\n(element (articleinfo authorinitials) (empty-sosofo))\n(element (articleinfo bibliomisc) (empty-sosofo))\n(element (articleinfo biblioset) (empty-sosofo))\n(element (articleinfo bookbiblio) (empty-sosofo))\n(element (articleinfo collab) (empty-sosofo))\n(element (articleinfo confgroup) (empty-sosofo))\n(element (articleinfo contractnum) (empty-sosofo))\n(element (articleinfo contractsponsor) (empty-sosofo))\n(element (articleinfo contrib) (empty-sosofo))\n(element (articleinfo copyright) (empty-sosofo))\n(element (articleinfo corpauthor) (empty-sosofo))\n(element (articleinfo corpname) (empty-sosofo))\n(element (articleinfo date) (empty-sosofo))\n(element (articleinfo edition) (empty-sosofo))\n(element (articleinfo editor) (empty-sosofo))\n(element (articleinfo firstname) (empty-sosofo))\n(element (articleinfo honorific) (empty-sosofo))\n(element (articleinfo invpartnumber) (empty-sosofo))\n(element (articleinfo isbn) (empty-sosofo))\n(element (articleinfo issn) (empty-sosofo))\n(element (articleinfo issuenum) (empty-sosofo))\n(element (articleinfo lineage) (empty-sosofo))\n(element (articleinfo orgname) (empty-sosofo))\n(element (articleinfo othercredit) (empty-sosofo))\n(element (articleinfo othername) (empty-sosofo))\n(element (articleinfo pagenums) (empty-sosofo))\n(element (articleinfo printhistory) (empty-sosofo))\n(element (articleinfo productname) (empty-sosofo))\n(element (articleinfo productnumber) (empty-sosofo))\n(element (articleinfo pubdate) (empty-sosofo))\n(element (articleinfo publisher) (empty-sosofo))\n(element (articleinfo publishername) (empty-sosofo))\n(element (articleinfo pubsnumber) (empty-sosofo))\n(element (articleinfo releaseinfo) (empty-sosofo))\n(element (articleinfo revhistory) (empty-sosofo))\n(element (articleinfo seriesvolnums) (empty-sosofo))\n(element (articleinfo subtitle) (empty-sosofo))\n(element (articleinfo surname) (empty-sosofo))\n(element (articleinfo title) (empty-sosofo))\n(element (articleinfo titleabbrev) (empty-sosofo))\n(element (articleinfo volumenum) (empty-sosofo))\n\n(element refsynopsisdivinfo (process-children))\n\n(element (refsynopsisdivinfo graphic) (empty-sosofo))\n(element (refsynopsisdivinfo legalnotice) (empty-sosofo))\n(element (refsynopsisdivinfo modespec) (empty-sosofo))\n(element (refsynopsisdivinfo subjectset) (empty-sosofo))\n(element (refsynopsisdivinfo keywordset) (empty-sosofo))\n(element (refsynopsisdivinfo itermset) (empty-sosofo))\n(element (refsynopsisdivinfo abbrev) (empty-sosofo))\n(element (refsynopsisdivinfo abstract) (empty-sosofo))\n(element (refsynopsisdivinfo address) (empty-sosofo))\n(element (refsynopsisdivinfo artpagenums) (empty-sosofo))\n(element (refsynopsisdivinfo author) (empty-sosofo))\n(element (refsynopsisdivinfo authorgroup) (empty-sosofo))\n(element (refsynopsisdivinfo authorinitials) (empty-sosofo))\n(element (refsynopsisdivinfo bibliomisc) (empty-sosofo))\n(element (refsynopsisdivinfo biblioset) (empty-sosofo))\n(element (refsynopsisdivinfo collab) (empty-sosofo))\n(element (refsynopsisdivinfo confgroup) (empty-sosofo))\n(element (refsynopsisdivinfo contractnum) (empty-sosofo))\n(element (refsynopsisdivinfo contractsponsor) (empty-sosofo))\n(element (refsynopsisdivinfo copyright) (empty-sosofo))\n(element (refsynopsisdivinfo corpauthor) (empty-sosofo))\n(element (refsynopsisdivinfo corpname) (empty-sosofo))\n(element (refsynopsisdivinfo date) (empty-sosofo))\n(element (refsynopsisdivinfo edition) (empty-sosofo))\n(element (refsynopsisdivinfo editor) (empty-sosofo))\n(element (refsynopsisdivinfo invpartnumber) (empty-sosofo))\n(element (refsynopsisdivinfo isbn) (empty-sosofo))\n(element (refsynopsisdivinfo issn) (empty-sosofo))\n(element (refsynopsisdivinfo issuenum) (empty-sosofo))\n(element (refsynopsisdivinfo orgname) (empty-sosofo))\n(element (refsynopsisdivinfo othercredit) (empty-sosofo))\n(element (refsynopsisdivinfo pagenums) (empty-sosofo))\n(element (refsynopsisdivinfo printhistory) (empty-sosofo))\n(element (refsynopsisdivinfo productname) (empty-sosofo))\n(element (refsynopsisdivinfo productnumber) (empty-sosofo))\n(element (refsynopsisdivinfo pubdate) (empty-sosofo))\n(element (refsynopsisdivinfo publisher) (empty-sosofo))\n(element (refsynopsisdivinfo publishername) (empty-sosofo))\n(element (refsynopsisdivinfo pubsnumber) (empty-sosofo))\n(element (refsynopsisdivinfo releaseinfo) (empty-sosofo))\n(element (refsynopsisdivinfo revhistory) (empty-sosofo))\n(element (refsynopsisdivinfo seriesvolnums) (empty-sosofo))\n(element (refsynopsisdivinfo subtitle) (empty-sosofo))\n(element (refsynopsisdivinfo title) (empty-sosofo))\n(element (refsynopsisdivinfo titleabbrev) (empty-sosofo))\n(element (refsynopsisdivinfo volumenum) (empty-sosofo))\n(element (refsynopsisdivinfo honorific) (empty-sosofo))\n(element (refsynopsisdivinfo firstname) (empty-sosofo))\n(element (refsynopsisdivinfo surname) (empty-sosofo))\n(element (refsynopsisdivinfo lineage) (empty-sosofo))\n(element (refsynopsisdivinfo othername) (empty-sosofo))\n(element (refsynopsisdivinfo affiliation) (empty-sosofo))\n(element (refsynopsisdivinfo authorblurb) (empty-sosofo))\n(element (refsynopsisdivinfo contrib) (empty-sosofo))\n\n(element prefaceinfo (empty-sosofo))\n\n(element (prefaceinfo abbrev) (empty-sosofo))\n(element (prefaceinfo abstract) (empty-sosofo))\n(element (prefaceinfo address) (empty-sosofo))\n(element (prefaceinfo affiliation) (empty-sosofo))\n(element (prefaceinfo artpagenums) (empty-sosofo))\n(element (prefaceinfo author) (empty-sosofo))\n(element (prefaceinfo authorblurb) (empty-sosofo))\n(element (prefaceinfo authorgroup) (empty-sosofo))\n(element (prefaceinfo authorinitials) (empty-sosofo))\n(element (prefaceinfo bibliomisc) (empty-sosofo))\n(element (prefaceinfo biblioset) (empty-sosofo))\n(element (prefaceinfo bookbiblio) (empty-sosofo))\n(element (prefaceinfo collab) (empty-sosofo))\n(element (prefaceinfo confgroup) (empty-sosofo))\n(element (prefaceinfo contractnum) (empty-sosofo))\n(element (prefaceinfo contractsponsor) (empty-sosofo))\n(element (prefaceinfo contrib) (empty-sosofo))\n(element (prefaceinfo copyright) (empty-sosofo))\n(element (prefaceinfo corpauthor) (empty-sosofo))\n(element (prefaceinfo corpname) (empty-sosofo))\n(element (prefaceinfo date) (empty-sosofo))\n(element (prefaceinfo edition) (empty-sosofo))\n(element (prefaceinfo editor) (empty-sosofo))\n(element (prefaceinfo firstname) (empty-sosofo))\n(element (prefaceinfo honorific) (empty-sosofo))\n(element (prefaceinfo invpartnumber) (empty-sosofo))\n(element (prefaceinfo isbn) (empty-sosofo))\n(element (prefaceinfo issn) (empty-sosofo))\n(element (prefaceinfo issuenum) (empty-sosofo))\n(element (prefaceinfo lineage) (empty-sosofo))\n(element (prefaceinfo orgname) (empty-sosofo))\n(element (prefaceinfo othercredit) (empty-sosofo))\n(element (prefaceinfo othername) (empty-sosofo))\n(element (prefaceinfo pagenums) (empty-sosofo))\n(element (prefaceinfo printhistory) (empty-sosofo))\n(element (prefaceinfo productname) (empty-sosofo))\n(element (prefaceinfo productnumber) (empty-sosofo))\n(element (prefaceinfo pubdate) (empty-sosofo))\n(element (prefaceinfo publisher) (empty-sosofo))\n(element (prefaceinfo publishername) (empty-sosofo))\n(element (prefaceinfo pubsnumber) (empty-sosofo))\n(element (prefaceinfo releaseinfo) (empty-sosofo))\n(element (prefaceinfo revhistory) (empty-sosofo))\n(element (prefaceinfo seriesvolnums) (empty-sosofo))\n(element (prefaceinfo subtitle) (empty-sosofo))\n(element (prefaceinfo surname) (empty-sosofo))\n(element (prefaceinfo title) (empty-sosofo))\n(element (prefaceinfo titleabbrev) (empty-sosofo))\n(element (prefaceinfo volumenum) (empty-sosofo))\n\n(element chapterinfo (empty-sosofo))\n\n(element (chapterinfo abbrev) (empty-sosofo))\n(element (chapterinfo abstract) (empty-sosofo))\n(element (chapterinfo address) (empty-sosofo))\n(element (chapterinfo affiliation) (empty-sosofo))\n(element (chapterinfo artpagenums) (empty-sosofo))\n(element (chapterinfo author) (empty-sosofo))\n(element (chapterinfo authorblurb) (empty-sosofo))\n(element (chapterinfo authorgroup) (empty-sosofo))\n(element (chapterinfo authorinitials) (empty-sosofo))\n(element (chapterinfo bibliomisc) (empty-sosofo))\n(element (chapterinfo biblioset) (empty-sosofo))\n(element (chapterinfo bookbiblio) (empty-sosofo))\n(element (chapterinfo collab) (empty-sosofo))\n(element (chapterinfo confgroup) (empty-sosofo))\n(element (chapterinfo contractnum) (empty-sosofo))\n(element (chapterinfo contractsponsor) (empty-sosofo))\n(element (chapterinfo contrib) (empty-sosofo))\n(element (chapterinfo copyright) (empty-sosofo))\n(element (chapterinfo corpauthor) (empty-sosofo))\n(element (chapterinfo corpname) (empty-sosofo))\n(element (chapterinfo date) (empty-sosofo))\n(element (chapterinfo edition) (empty-sosofo))\n(element (chapterinfo editor) (empty-sosofo))\n(element (chapterinfo firstname) (empty-sosofo))\n(element (chapterinfo honorific) (empty-sosofo))\n(element (chapterinfo invpartnumber) (empty-sosofo))\n(element (chapterinfo isbn) (empty-sosofo))\n(element (chapterinfo issn) (empty-sosofo))\n(element (chapterinfo issuenum) (empty-sosofo))\n(element (chapterinfo lineage) (empty-sosofo))\n(element (chapterinfo orgname) (empty-sosofo))\n(element (chapterinfo othercredit) (empty-sosofo))\n(element (chapterinfo othername) (empty-sosofo))\n(element (chapterinfo pagenums) (empty-sosofo))\n(element (chapterinfo printhistory) (empty-sosofo))\n(element (chapterinfo productname) (empty-sosofo))\n(element (chapterinfo productnumber) (empty-sosofo))\n(element (chapterinfo pubdate) (empty-sosofo))\n(element (chapterinfo publisher) (empty-sosofo))\n(element (chapterinfo publishername) (empty-sosofo))\n(element (chapterinfo pubsnumber) (empty-sosofo))\n(element (chapterinfo releaseinfo) (empty-sosofo))\n(element (chapterinfo revhistory) (empty-sosofo))\n(element (chapterinfo seriesvolnums) (empty-sosofo))\n(element (chapterinfo subtitle) (empty-sosofo))\n(element (chapterinfo surname) (empty-sosofo))\n(element (chapterinfo title) (empty-sosofo))\n(element (chapterinfo titleabbrev) (empty-sosofo))\n(element (chapterinfo volumenum) (empty-sosofo))\n\n(element appendixinfo (empty-sosofo))\n\n(element (appendixinfo abbrev) (empty-sosofo))\n(element (appendixinfo abstract) (empty-sosofo))\n(element (appendixinfo address) (empty-sosofo))\n(element (appendixinfo affiliation) (empty-sosofo))\n(element (appendixinfo artpagenums) (empty-sosofo))\n(element (appendixinfo author) (empty-sosofo))\n(element (appendixinfo authorblurb) (empty-sosofo))\n(element (appendixinfo authorgroup) (empty-sosofo))\n(element (appendixinfo authorinitials) (empty-sosofo))\n(element (appendixinfo bibliomisc) (empty-sosofo))\n(element (appendixinfo biblioset) (empty-sosofo))\n(element (appendixinfo bookbiblio) (empty-sosofo))\n(element (appendixinfo collab) (empty-sosofo))\n(element (appendixinfo confgroup) (empty-sosofo))\n(element (appendixinfo contractnum) (empty-sosofo))\n(element (appendixinfo contractsponsor) (empty-sosofo))\n(element (appendixinfo contrib) (empty-sosofo))\n(element (appendixinfo copyright) (empty-sosofo))\n(element (appendixinfo corpauthor) (empty-sosofo))\n(element (appendixinfo corpname) (empty-sosofo))\n(element (appendixinfo date) (empty-sosofo))\n(element (appendixinfo edition) (empty-sosofo))\n(element (appendixinfo editor) (empty-sosofo))\n(element (appendixinfo firstname) (empty-sosofo))\n(element (appendixinfo honorific) (empty-sosofo))\n(element (appendixinfo invpartnumber) (empty-sosofo))\n(element (appendixinfo isbn) (empty-sosofo))\n(element (appendixinfo issn) (empty-sosofo))\n(element (appendixinfo issuenum) (empty-sosofo))\n(element (appendixinfo lineage) (empty-sosofo))\n(element (appendixinfo orgname) (empty-sosofo))\n(element (appendixinfo othercredit) (empty-sosofo))\n(element (appendixinfo othername) (empty-sosofo))\n(element (appendixinfo pagenums) (empty-sosofo))\n(element (appendixinfo printhistory) (empty-sosofo))\n(element (appendixinfo productname) (empty-sosofo))\n(element (appendixinfo productnumber) (empty-sosofo))\n(element (appendixinfo pubdate) (empty-sosofo))\n(element (appendixinfo publisher) (empty-sosofo))\n(element (appendixinfo publishername) (empty-sosofo))\n(element (appendixinfo pubsnumber) (empty-sosofo))\n(element (appendixinfo releaseinfo) (empty-sosofo))\n(element (appendixinfo revhistory) (empty-sosofo))\n(element (appendixinfo seriesvolnums) (empty-sosofo))\n(element (appendixinfo subtitle) (empty-sosofo))\n(element (appendixinfo surname) (empty-sosofo))\n(element (appendixinfo title) (empty-sosofo))\n(element (appendixinfo titleabbrev) (empty-sosofo))\n(element (appendixinfo volumenum) (empty-sosofo))\n    \n;; $Id: dbinline.dsl,v 1.7 2003/03/25 19:53:56 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ============================== INLINES ===============================\n\n(element abbrev ($charseq$))\n(element accel ($score-seq$ 'after))\n(element acronym ($charseq$))\n(element action ($charseq$))\n(element application ($charseq$))\n(element classname ($mono-seq$))\n(element constant ($mono-seq$))\n(element command ($bold-seq$))\n(element computeroutput ($mono-seq$))\n(element database ($charseq$))\n(element email\n  (make sequence (literal "<") ($mono-seq$) (literal ">")))\n(element uri ($mono-seq$))\n(element envar ($charseq$))\n(element errorcode ($charseq$))\n(element errorname ($charseq$))\n(element errortype ($charseq$))\n(element filename ($mono-seq$))\n(element function ($mono-seq$))\n(element guibutton ($guilabel-seq$))\n(element guiicon ($guilabel-seq$))\n(element guilabel ($guilabel-seq$))\n(element guimenu ($guilabel-seq$))\n(element guimenuitem ($guilabel-seq$))\n(element guisubmenu ($guilabel-seq$))\n(element hardware ($charseq$))\n(element interface ($charseq$))\n(element interfacedefinition ($charseq$))\n(element keycap ($bold-seq$))\n(element keycode ($charseq$))\n\n(element keycombo \n  (let* ((action (attribute-string (normalize "action")))\n\011 (joinchar \n\011  (cond\n\011   ((equal? action (normalize "seq")) " ")          ;; space\n\011   ((equal? action (normalize "simul")) "+")        ;; +\n\011   ((equal? action (normalize "press")) "-")        ;; ? I don't know\n\011   ((equal? action (normalize "click")) "-")        ;; ? what to do\n\011   ((equal? action (normalize "double-click")) "-") ;; ? about the rest\n\011   ((equal? action (normalize "other")) "-")        ;; ? of these\n\011   (else "-"))))\n    (let loop ((nl (children (current-node))) (count 1))\n      (if (node-list-empty? nl)\n\011  (empty-sosofo)\n\011  (if (equal? count 1)\n\011      (make sequence\n\011\011(process-node-list (node-list-first nl))\n\011\011(loop (node-list-rest nl) (+ count 1)))\n\011      (make sequence\n\011\011(literal joinchar)\n\011\011(process-node-list (node-list-first nl))\n\011\011(loop (node-list-rest nl) (+ count 1))))))))\n\n(element keysym ($charseq$))\n(element literal ($mono-seq$))\n(element code ($mono-seq$))\n(element medialabel ($italic-seq$))\n\n(element menuchoice\n  (let* ((shortcut (select-elements (children (current-node)) \n\011\011\011\011    (normalize "shortcut")))\n\011 (items    (node-list-filter-by-not-gi\n\011\011    (children (current-node))\n\011\011    (list (normalize "shortcut")))))\n    (make sequence\n      (let loop ((nl items) (first? #t))\n\011(if (node-list-empty? nl)\n\011    (empty-sosofo)\n\011    (make sequence\n\011      (if first?\n\011\011  (process-node-list (node-list-first nl))\n\011\011  (make sequence\n\011\011    (if (or (equal? (gi (node-list-first nl))\n\011\011\011\011    (normalize "guimenuitem"))\n\011\011\011    (equal? (gi (node-list-first nl))\n\011\011\011\011    (normalize "guisubmenu")))\n\011\011\011(literal "\\rightwards-arrow;")\n\011\011\011(literal "+"))\n\011\011    (process-node-list (node-list-first nl))))\n\011      (loop (node-list-rest nl) #f))))\n      (if (node-list-empty? shortcut)\n\011  (empty-sosofo)\n\011  (make sequence\n\011    (literal " (")\n\011    (process-node-list shortcut)\n\011    (literal ")"))))))\n\n(element methodname ($mono-seq$))\n(element shortcut ($bold-seq$))\n(element mousebutton ($charseq$))\n(element option ($mono-seq$))\n\n(element optional \n  (make sequence \n    (literal %arg-choice-opt-open-str%)\n    ($charseq$)\n    (literal %arg-choice-opt-close-str%)))\n\n(element parameter ($italic-mono-seq$))\n(element property ($charseq$))\n(element prompt ($mono-seq$))\n(element replaceable ($italic-seq$))\n;; Special case: replaceable inside programlisting should use Courier Italic (monospace italic)\n(element (programlisting replaceable)\n  ($italic-mono-seq$))\n;; Special case: subscripts/superscripts inside programlisting/replaceable should use Times upright\n;; not monospace italic\n(element (programlisting replaceable subscript)\n  (make sequence\n    font-family-name: %body-font-family%\n    font-posture: 'upright\n    ($ss-seq$ -)))\n(element (programlisting replaceable superscript)\n  (make sequence\n    font-family-name: %body-font-family%\n    font-posture: 'upright\n    ($ss-seq$ +)))\n;; Special case: replaceable inside code (inline) should use monospace italic\n(element (code replaceable)\n  ($italic-mono-seq$))\n;; Special case: subscripts/superscripts inside code/replaceable should use Times upright\n;; not monospace italic\n(element (code replaceable subscript)\n  (make sequence\n    font-family-name: %body-font-family%\n    font-posture: 'upright\n    ($ss-seq$ -)))\n(element (code replaceable superscript)\n  (make sequence\n    font-family-name: %body-font-family%\n    font-posture: 'upright\n    ($ss-seq$ +)))\n;; Special case: phrase role="emphasis" inside code (inline) should use Times Italic (body font italic)\n;; to differentiate from replaceable which uses Courier italic\n(element (code phrase)\n  (if (and (attribute-string (normalize "role"))\n           (equal? (attribute-string (normalize "role")) "emphasis"))\n      (make sequence\n        font-family-name: %body-font-family%\n        font-posture: 'italic\n        (process-children))\n      ($charseq$)))  ; Default phrase handling for other roles\n;; Special case: phrase role="emphasis" inside programlisting should use Times Italic (body font italic)\n;; to differentiate from replaceable which uses Courier italic\n(element (programlisting phrase)\n  (if (and (attribute-string (normalize "role"))\n           (equal? (attribute-string (normalize "role")) "emphasis"))\n      (make sequence\n        font-family-name: %body-font-family%\n        font-posture: 'italic\n        (process-children))\n      ($charseq$)))  ; Default phrase handling for other roles\n(element returnvalue ($charseq$))\n(element structfield ($italic-mono-seq$))\n(element structname ($charseq$))\n(element symbol ($charseq$))\n(element systemitem ($charseq$))\n(element token ($charseq$))\n(element type ($charseq$))\n(element userinput ($bold-mono-seq$))\n(element varname ($mono-seq$))\n\n(element citation \n  (if biblio-citation-check\n      (let* ((bgraphies (select-elements (descendants (sgml-root-element))\n\011\011\011\011\011 (normalize "bibliography")))\n\011     (bchildren1 (expand-children bgraphies\n\011\011\011\011\011  (list (normalize "bibliography"))))\n\011     (bchildren2 (expand-children bchildren1\n\011\011\011\011\011  (list (normalize "bibliodiv"))))\n\011     (bibentries (node-list-filter-by-gi \n\011\011\011  bchildren2\n\011\011\011  (list (normalize "biblioentry")\n\011\011\011\011(normalize "bibliomixed")))))\n\011(let loop ((bibs bibentries))\n\011  (if (node-list-empty? bibs)\n\011      (make sequence\n\011\011(error (string-append "Cannot find citation: " \n\011\011\011\011\011   (data (current-node))))\n\011\011(literal "[") ($charseq$) (literal "]"))\n\011      (if (citation-matches-target? (current-node) \n\011\011\011\011\011    (node-list-first bibs))\n\011\011  (make link \n\011\011    destination: (node-list-address (node-list-first bibs))\n\011\011    (literal "[") ($charseq$) (literal "]"))\n\011\011  (loop (node-list-rest bibs))))))\n      (make sequence \n\011(literal "[") ($charseq$) (literal "]"))))\n\n(element citerefentry \n  (if %refentry-xref-italic%\n      ($italic-seq$)\n      ($charseq$)))\n\n(element citetitle\n  (if (equal? (attribute-string (normalize "pubwork")) "article")\n      (make sequence\n\011(literal (gentext-start-quote))\n\011(process-children)\n\011(literal (gentext-end-quote)))\n      ($italic-seq$)))\n\n(element emphasis\n  (if (and (attribute-string (normalize "role"))\n\011   (or (equal? (attribute-string (normalize "role")) "strong")\n\011       (equal? (attribute-string (normalize "role")) "bold")))\n      ($bold-seq$)  ; Use bold for strong emphasis\n      ($italic-seq$)))\n\n(element foreignphrase ($italic-seq$))\n(element markup ($charseq$))\n(element phrase ($charseq$))\n\n(element quote\n  (let* ((hnr   (hierarchical-number-recursive (normalize "quote") \n\011\011\011\011\011       (current-node)))\n\011 (depth (length hnr)))\n    (if (equal? (modulo depth 2) 1)\n\011(make sequence\n\011  (literal (gentext-start-nested-quote))\n\011  (process-children)\n\011  (literal (gentext-end-nested-quote)))\n\011(make sequence\n\011  (literal (gentext-start-quote))\n\011  (process-children)\n\011  (literal (gentext-end-quote))))))\n\n(element sgmltag\n  (let ((class (if (attribute-string (normalize "class"))\n\011\011   (attribute-string (normalize "class"))\n\011\011   (normalize "element"))))\n    (cond\n      ((equal? class (normalize "attribute")) ($mono-seq$))\n      ((equal? class (normalize "attvalue")) ($mono-seq$))\n      ((equal? class (normalize "element")) ($mono-seq$))\n      ((equal? class (normalize "emptytag")) ($mono-seq$ (make sequence \n\011\011\011\011  (literal "<") \n\011\011\011\011  (process-children)\n\011\011\011\011  (literal "/>"))))\n      ((equal? class (normalize "endtag")) ($mono-seq$ (make sequence \n\011\011\011       (literal "</") \n\011\011\011       (process-children)\n\011\011\011       (literal ">"))))\n      ((equal? class (normalize "genentity")) ($mono-seq$ (make sequence\n\011\011\011\011    (literal "&")\n\011\011\011\011    (process-children)\n\011\011\011\011    (literal ";"))))\n      ((equal? class (normalize "numcharref")) ($mono-seq$ (make sequence\n\011\011\011\011     (literal "&#")\n\011\011\011\011     (process-children)\n\011\011\011\011     (literal ";"))))\n      ((equal? class (normalize "paramentity")) ($mono-seq$ (make sequence\n\011\011\011\011      (literal "%")\n\011\011\011\011      (process-children)\n\011\011\011\011      (literal ";"))))\n      ((equal? class (normalize "pi")) ($mono-seq$ (make sequence \n\011\011\011    (literal "<?")\n\011\011\011    (process-children)\n\011\011\011    (literal ">"))))\n      ((equal? class (normalize "starttag")) ($mono-seq$ (make sequence \n\011\011\011\011  (literal "<") \n\011\011\011\011  (process-children)\n\011\011\011\011  (literal ">"))))\n      ((equal? class (normalize "sgmlcomment")) ($mono-seq$ (make sequence \n\011\011\011\011     (literal "<!--")\n\011\011\011\011     (process-children)\n\011\011\011\011     (literal "-->"))))\n      ((equal? class (normalize "xmlpi")) ($mono-seq$ (make sequence \n\011\011\011    (literal "<?")\n\011\011\011    (process-children)\n\011\011\011    (literal "?>"))))\n      (else ($charseq$)))))\n\n(element trademark \n  (make sequence\n    ($charseq$)\n    (cond\n     ((equal? (attribute-string "class") (normalize "copyright"))\n      (literal "\\copyright-sign;"))\n     ((equal? (attribute-string "class") (normalize "registered"))\n      (literal "\\registered-sign;"))\n     ((equal? (attribute-string "class") (normalize "service"))\n      ($ss-seq$ + (literal "SM")))\n     (else\n      (literal "\\trade-mark-sign;")))))\n\n(element wordasword ($italic-seq$))\n\n(element lineannotation\n  (make sequence\n    font-family-name: %body-font-family%\n    font-posture: 'italic\n    (process-children)))\n\n(define ($ss-seq$ plus-or-minus #!optional (sosofo (process-children)))\n  (make sequence\n\011font-size:\n\011  (* (inherited-font-size) %ss-size-factor%)\n\011position-point-shift:\n\011  (plus-or-minus (* (inherited-font-size) %ss-shift-factor%))\n\011sosofo))\n\n(element superscript ($ss-seq$ +))\n(element subscript ($ss-seq$ -))\n  \n;; $Id: dblink.dsl,v 1.6 2003/01/15 08:24:23 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ========================= LINKS AND ANCHORS ==========================\n\n(element link\n  ;; No warnings about missing targets.  Jade will do that for us, and\n  ;; this way we can use -wno-idref if we really don't care.\n  (let* ((endterm   (attribute-string (normalize "endterm")))\n\011 (linkend   (attribute-string (normalize "linkend")))\n\011 (target    (element-with-id linkend))\n\011 (etarget   (if endterm \n\011\011\011(element-with-id endterm)\n\011\011\011(empty-node-list)))\n\011 (link-cont (if endterm\n\011\011\011(if (node-list-empty? etarget)\n\011\011\011    (literal \n\011\011\011     (string-append "LINK CONTENT ENDTERM '"\n\011\011\011\011\011    endterm\n\011\011\011\011\011    "' MISSING"))\n\011\011\011    (with-mode xref-endterm-mode\n\011\011\011      (process-node-list etarget)))\n\011\011\011(process-children))))\n    (if (node-list-empty? target)\n\011link-cont\n\011(make link \n\011  destination: (node-list-address target)\n\011  link-cont))))\n\n(element ulink \n  (make sequence\n    (if (node-list-empty? (children (current-node)))\n\011(literal (attribute-string (normalize "url")))\n\011(make sequence\n\011  ($charseq$)\n \011  (if (not (equal? (attribute-string (normalize "url"))\n \011\011\011   (data-of (current-node))))\n \011      (if %footnote-ulinks%\n \011\011  (if (and (equal? (print-backend) 'tex) bop-footnotes)\n \011\011      (make sequence\n \011\011\011($ss-seq$ + (literal (footnote-number (current-node))))\n \011\011\011(make page-footnote\n \011\011\011  (make paragraph\n \011\011\011    font-family-name: %body-font-family%\n \011\011\011    font-size: (* %footnote-size-factor% %bf-size%)\n \011\011\011    font-posture: 'upright\n \011\011\011    quadding: %default-quadding%\n \011\011\011    line-spacing: (* (* %footnote-size-factor% %bf-size%)\n \011\011\011\011\011     %line-spacing-factor%)\n \011\011\011    space-before: %para-sep%\n \011\011\011    space-after: %para-sep%\n \011\011\011    start-indent: %footnote-field-width%\n \011\011\011    first-line-start-indent: (- %footnote-field-width%)\n \011\011\011    (make line-field\n \011\011\011      field-width: %footnote-field-width%\n \011\011\011      (literal (footnote-number (current-node))\n \011\011\011\011       (gentext-label-title-sep (normalize "footnote"))))\n \011\011\011    (literal (attribute-string (normalize "url"))))))\n \011\011      ($ss-seq$ + (literal (footnote-number (current-node)))))\n \011\011  (if %show-ulinks%\n \011\011      (make sequence\n \011\011\011(literal " (")\n \011\011\011(literal (attribute-string (normalize "url")))\n \011\011\011(literal ")"))\n \011\011      (empty-sosofo)))\n \011      (empty-sosofo))))))\n\n(element footnoteref \n  (process-element-with-id (attribute-string (normalize "linkend"))))\n\n(element anchor\n  ;; This is different than (empty-sosofo) alone because the backend\n  ;; will hang an anchor off the empty sequence.\n  (make sequence (empty-sosofo)))\n\n(element beginpage (empty-sosofo))\n\n;; ======================================================================\n\n(define (olink-link)\n  ;; This is an olink without a TARGETDOCENT, treat it as a link within\n  ;; the same document.\n  (let* ((localinfo (attribute-string (normalize "localinfo")))\n\011 (target    (element-with-id localinfo))\n\011 (linkmode  (attribute-string (normalize "linkmode")))\n\011 (modespec  (if linkmode (element-with-id linkmode) (empty-node-list)))\n\011 (xreflabel (if (node-list-empty? modespec)\n\011\011\011#f\n\011\011\011(attribute-string (normalize "xreflabel") modespec)))\n\011 (linktext  (strip (data-of (current-node)))))\n    (if (node-list-empty? target)\n\011(make sequence\n\011  (error (string-append "OLink to missing ID '" localinfo "'"))\n\011  (if (and (equal? linktext "") xreflabel)\n\011      (literal xreflabel)\n\011      (process-children)))\n\011(if (equal? linktext "")\n\011    (if xreflabel\n\011\011(xref-general target xreflabel)\n\011\011(xref-general target))\n\011    (process-children)))))\n\n(define (olink-simple)\n  ;; Assumptions: \n  ;; - The TARGETDOCENT is identified by a public ID\n  ;; - If the element has no content, the title extracted by\n  ;;   (olink-resource-title) should be used\n  ;; - The (olink-resource-title) function can deduce the title from\n  ;;   the pubid and the sysid\n  (let* ((target   (attribute-string (normalize "targetdocent")))\n\011 (pubid    (entity-public-id target))\n\011 (sysid    (system-id-filename target))\n\011 (title    (olink-resource-title pubid sysid))\n\011 (linktext (strip (data-of (current-node)))))\n    (if (equal? linktext "")\n\011(make sequence\n\011  font-posture: 'italic\n\011  (literal title))\n\011(process-children))))\n\n(define (olink-outline-xref olroot target linktext)\n  (let* ((name  (attribute-string (normalize "name") target))\n\011 (label (attribute-string (normalize "label") target))\n\011 (title (select-elements (children target) (normalize "ttl")))\n\011 (substitute (list\n\011\011      (list "%g" (if name (literal name) (literal "")))\n\011\011      (list "%n" (if label (literal label) (literal "")))\n\011\011      (list "%t" (with-mode olink-title-mode\n\011\011\011\011   (process-node-list title)))))\n\011 (tlist   (match-split-list linktext (assoc-objs substitute))))\n    (string-list-sosofo tlist substitute)))\n\n(define (olink-outline)\n  (let* ((target    (attribute-string (normalize "targetdocent")))\n\011 (linkmode  (attribute-string (normalize "linkmode")))\n\011 (localinfo (attribute-string (normalize "localinfo")))\n\011 (modespec  (if linkmode (element-with-id linkmode) (empty-node-list)))\n\011 (xreflabel (if (node-list-empty? modespec) \n\011\011\011""\n\011\011\011(attribute-string (normalize "xreflabel") modespec)))\n\011 (pubid     (entity-public-id target))\n\011 (sysid     (system-id-filename target))\n\011 (basename  (trim-string sysid '(".sgm" ".xml" ".sgml")))\n\011 (olinkfile (string-append basename %olink-outline-ext%))\n\011 (olinkdoc  (sgml-parse olinkfile))\n\011 (olinkroot (node-property 'document-element olinkdoc))\n\011 (olnode    (if localinfo\n\011\011\011(element-with-id localinfo olinkroot)\n\011\011\011olinkroot))\n\011 (linktext (strip (data-of (current-node)))))\n    (if (equal? linktext "")\n\011(olink-outline-xref olinkroot olnode xreflabel)\n\011(process-children))))\n\n(element olink\n  (if (not (attribute-string (normalize "targetdocent")))\n      (olink-link)\n      (if (attribute-string (normalize "linkmode"))\n\011  (olink-outline)\n\011  (olink-simple))))\n\n(mode olink-title-mode\n  (default (process-children))\n\n  (element ttl\n    (make sequence\n      font-posture: 'italic\n      (process-children)))\n\n  (element it\n    (make sequence\n      font-posture: 'upright\n      (process-children)))\n\n  (element tt\n    (make sequence\n      font-family-name: %mono-font-family%\n      (process-children)))\n\n  (element sub \n    ($ss-seq$ -))\n\n  (element sup \n    ($ss-seq$ +))\n)\n\n;; ======================================================================\n\n(element xref\n  (let* ((endterm (attribute-string (normalize "endterm")))\n\011 (linkend (attribute-string (normalize "linkend")))\n\011 (target  (element-with-id linkend))\n\011 (xreflabel (if (node-list-empty? target)\n\011\011\011#f\n\011\011\011(attribute-string (normalize "xreflabel") target))))\n    (if (node-list-empty? target)\n\011(error (string-append "XRef LinkEnd to missing ID '" linkend "'"))\n\011(if xreflabel\n\011    (make link \n\011      destination: (node-list-address target)\n\011      (literal xreflabel))\n\011    (if endterm\n\011\011(if (node-list-empty? (element-with-id endterm))\n\011\011    (error (string-append "XRef EndTerm to missing ID '" \n\011\011\011\011\011  endterm "'"))\n\011\011    (make link \n\011\011      destination: (node-list-address (element-with-id endterm))\n\011\011      (with-mode xref-endterm-mode \n\011\011\011(process-element-with-id endterm))))\n\011\011(cond\n\011\011 ((or (equal? (gi target) (normalize "biblioentry"))\n\011\011      (equal? (gi target) (normalize "bibliomixed")))\n\011\011  ;; xref to the bibliography is a special case\n\011\011  (xref-biblioentry target))\n\011\011 ((equal? (gi target) (normalize "co"))\n\011\011  ;; callouts are a special case\n\011\011  (xref-callout target))\n\011\011 ((equal? (gi target) (normalize "listitem"))\n\011\011  (xref-listitem target))\n\011\011 ((equal? (gi target) (normalize "varlistentry"))\n\011\011  (xref-varlistentry target))\n\011\011 ((equal? (gi target) (normalize "question"))\n\011\011  (xref-question target))\n\011\011 ((equal? (gi target) (normalize "answer"))\n\011\011  (xref-answer target))\n\011\011 ((equal? (gi target) (normalize "refentry"))\n\011\011  (xref-refentry target))\n\011\011 ((equal? (gi target) (normalize "refnamediv"))\n\011\011  ;; and refnamedivs\n\011\011  (xref-refnamediv target))\n\011\011 ((equal? (gi target) (normalize "glossentry"))\n\011\011  ;; as are glossentrys\n\011\011  (xref-glossentry target))\n\011\011 ((equal? (gi target) (normalize "author"))\n\011\011  ;; and authors\n\011\011  (xref-author target))\n\011\011 ((equal? (gi target) (normalize "authorgroup"))\n\011\011  ;; and authorgroups\n\011\011  (xref-authorgroup target))\n\011\011 (else \n\011\011  (xref-general target))))))))\n\n(define (xref-general target #!optional (xref-string #f))\n  ;; This function is used by both XREF and OLINK (when no TARGETDOCENT\n  ;; is specified).  The only case where xref-string is supplied is\n  ;; on OLINK.\n  (let ((label (attribute-string (normalize "xreflabel") target)))\n    (make link \n      destination: (node-list-address target)\n      (if xref-string\n\011  (auto-xref target xref-string)\n\011  (if label\n\011      (xreflabel-sosofo label)\n\011      (auto-xref target))))))\n\n(define (xref-refentry target)\n;; refmeta/refentrytitle, refmeta/manvolnum, refnamediv/refdescriptor, \n;; refnamediv/refname\n  (let* ((refmeta    (select-elements (children target)\n\011\011\011\011      (normalize "refmeta")))\n\011 (refnamediv (select-elements (children target)\n\011\011\011\011      (normalize "refnamediv")))\n\011 (rfetitle   (select-elements (children refmeta) \n\011\011\011\011      (normalize "refentrytitle")))\n\011 (manvolnum  (select-elements (children refmeta)\n\011\011\011\011      (normalize "manvolnum")))\n\011 (refdescrip (select-elements (children refnamediv)\n\011\011\011\011      (normalize "refdescriptor")))\n\011 (refname    (select-elements (children refnamediv)\n\011\011\011\011      (normalize "refname")))\n\n\011 (title      (if (node-list-empty? rfetitle)\n\011\011\011 (if (node-list-empty? refdescrip)\n\011\011\011     (node-list-first refname)\n\011\011\011     (node-list-first refdescrip))\n\011\011\011 (node-list-first rfetitle))))\n  (make link \n    destination: (node-list-address target)\n\n    (make sequence\n      font-posture: (if %refentry-xref-italic% \n\011\011\011'italic\n\011\011\011(inherited-font-posture))\n\n      (process-node-list (children title))\n      (if (and %refentry-xref-manvolnum%\n\011       (not (node-list-empty? manvolnum)))\n\011  (process-node-list manvolnum)\n\011  (empty-sosofo))))))\n\n(define (xref-refnamediv target)\n  (let* ((refname    (select-elements (children target)\n\011\011\011\011      (normalize "refname")))\n\n\011 (title      (node-list-first refname)))\n    (make link\n      destination: (node-list-address target)\n\n      (make sequence\n\011font-posture: (if %refentry-xref-italic%\n\011\011\011  'italic\n\011\011\011  (inherited-font-posture))\n\n\011(process-node-list (children title))))))\n\n(define (xref-varlistentry target)\n  (let ((terms (select-elements (children target)\n\011\011\011\011(normalize "term"))))\n    (make link \n      destination: (node-list-address target)\n      (with-mode xref-varlistentry-mode\n\011(process-node-list (node-list-first terms))))))\n\n(define (xref-glossentry target)\n  (let ((glossterms (select-elements (children target)\n\011\011\011\011     (normalize "glossterm"))))\n    (make link \n      destination: (node-list-address target)\n      (with-mode xref-glossentry-mode\n\011(process-node-list (node-list-first glossterms))))))\n\n(define (xref-author target)\n  (make link \n    destination: (node-list-address target)\n    (literal (author-string target))))\n\n(define (xref-authorgroup target)\n  ;; it's a quirk of author-list-string that it needs to point to\n  ;; one of the authors in the authorgroup, not the authorgroup.\n  ;; go figure.\n  (make link \n    destination: (node-list-address target)\n    (let loop ((author (select-elements (children target)\n\011\011\011\011\011(normalize "author"))))\n      (if (node-list-empty? author)\n\011  (empty-sosofo)\n\011  (make sequence\n\011    (literal (author-list-string (node-list-first author)))\n\011    (loop (node-list-rest author)))))))\n\n(define (xref-biblioentry target)\n  (let* ((abbrev (node-list-first \n\011\011  (node-list-filter-out-pis (children target))))\n\011 (label  (attribute-string (normalize "xreflabel") target)))\n    (make link \n      destination: (node-list-address target)\n\n      (if biblio-xref-title\n\011  (let* ((citetitles (select-elements (descendants target)\n\011\011\011\011\011     (normalize "citetitle")))\n\011\011 (titles     (select-elements (descendants target)\n\011\011\011\011\011     (normalize "title")))\n\011\011 (title      (if (node-list-empty? citetitles)\n\011\011\011\011 (node-list-first titles)\n\011\011\011\011 (node-list-first citetitles))))\n\011    (with-mode xref-title-mode\n\011      (process-node-list title)))\n\011  (if biblio-number\n\011      (make sequence\n\011\011(literal "[" (number->string (bibentry-number target)) "]"))\n\011      (if label\n\011\011  (make sequence\n\011\011    (literal "[" label "]"))\n\011\011  (if (equal? (gi abbrev) (normalize "abbrev"))\n\011\011      (make sequence\n\011\011\011(process-node-list abbrev))\n\011\011      (make sequence\n\011\011\011(literal "[" \n\011\011\011\011 (attribute-string (normalize "id") target)\n\011\011\011\011 "]")))))))))\n\n(define (xref-callout target)\n  (make link \n    destination: (node-list-address target)\n    ($callout-mark$ target)))\n\n(define (xref-listitem target)\n  (if (equal? (gi (parent target)) (normalize "orderedlist"))\n      (make link \n\011destination: (node-list-address target)\n\011(literal (orderedlist-listitem-label-recursive target)))\n      (error \n       (string-append "XRef to LISTITEM only supported in ORDEREDLISTs"))))\n\n\n(define (xref-question target)\n  (make link\n    destination: (node-list-address target)\n    (make sequence\n      (literal (gentext-element-name target))\n      (literal (gentext-label-title-sep target))\n      (literal (question-answer-label target)))))\n\n(define (xref-answer target)\n  (xref-question target))\n\n(mode xref-endterm-mode\n  (default\n    (make sequence\n      font-posture: 'italic\n      (process-children-trim))))\n\n(define (xreflabel-sosofo xreflabel)\n  (make sequence\n    font-posture: 'italic\n    (literal xreflabel)))\n\n;; ======================================================================\n\n;; Returns the title of the element as a sosofo, italicized for xref.\n;;\n(define (element-title-xref-sosofo nd)\n  (make sequence\n    font-posture: 'italic\n    (element-title-sosofo nd)))\n\n(mode xref-title-mode\n  (element title\n    (make sequence\n      font-posture: 'italic\n      (process-children-trim)))\n\n  (element citetitle\n    (make sequence\n      font-posture: 'italic\n      (process-children-trim)))\n\n  (element refname\n    (process-children-trim))\n\n  (element refentrytitle\n    (process-children-trim))\n)\n\n(mode xref-varlistentry-mode\n  (element term\n    ($italic-seq$)))\n\n(mode xref-glossentry-mode\n  (element glossterm\n    ($italic-seq$)))\n\n;; ======================================================================\n\n(define (element-page-number-sosofo target)\n  (with-mode pageno-mode\n\011(process-node-list target)))\n\n(mode pageno-mode\n  (default\n    (current-node-page-number-sosofo)))\n\n;; ======================================================================\n\n    \n;; $Id: dblists.dsl,v 1.7 2003/02/17 02:42:44 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; =============================== LISTS ================================\n\n(define (BULLTREAT bullfcn ilevel override mark)\n  (cond\n   (override (bullfcn override ilevel))\n   (mark (bullfcn mark ilevel))\n   ;; Use en-dash for second level, bullets for third level and deeper\n   ((= ilevel 2) (bullfcn "endash" ilevel))\n   ((> ilevel 2) (bullfcn "bullet" ilevel))\n   (else (bullfcn "bullet" ilevel))))\n\n(define (BULLSTR m lvl)\n  ;; Return en-dash directly for nested lists, use dingbat for others\n  (if (equal? m "endash")\n      "\\en-dash;"\n      (dingbat m)))\n\n(define (BULLSHIFT m lvl)\n  (let ((md (case-fold-down m)))\n    (case md\n\011  (("bullet") 0.0em)\n\011  (("box") (if (= lvl 1) 0.0em 0.1em))\n\011  (("checkbox") (if (= lvl 1) 0.0em 0.1em))\n\011  (("check") 0.0em)\n\011  (("checkedbox") 0.0em)\n\011  (("dash") 0.0em)\n\011  (("endash") 0.0em)\n\011  (("none") 0.0em)\n\011  (else 0.0em))))\n\n(define (MSIZE m lvl f1 f2)\n  (if (= lvl 1)\n      (* %bf-size% f1)\n      (* %bf-size% f2)))\n\n(define (BULLSIZE m lvl)\n  (let ((md (case-fold-down m)))\n    (case md\n\011  (("bullet") (MSIZE m lvl 0.8 0.72))\n\011  (("box") (MSIZE m lvl 0.9 0.72))\n\011  (("checkbox") (MSIZE m lvl 0.9 0.72))\n\011  (("check") (MSIZE m lvl 1.0 1.0))\n\011  (("checkedbox") (MSIZE m lvl 1.0 1.0))\n\011  (("dash") (MSIZE m lvl 1.0 1.0))\n\011  (("endash") (MSIZE m lvl 0.85 0.85))\n\011  (("none") (MSIZE m lvl 1.0 1.0))\n\011  (else (MSIZE m lvl 1.0 1.0)))))\n\n(define (OLSTEP) 0.6em)\n;;  (case\n;;   (modulo (length (hierarchical-number-recursive (normalize "orderedlist"))) 4)\n;;\011((1) 1.4em)\n;;\011((2) 1.4em)\n;;\011((3) 1.4em)\n;;\011((0) 1.4em)))\n\n;; Adjusted indentation to align continuation lines with text after marker\n;; This provides the hanging indent for list item continuation lines\n;; 0.6em for ordered lists (just enough for "a) ")\n;; 1.3em for itemized lists (accounts for em dash/bullet + space + alignment)\n(define (ILSTEP) 1.3em)\n\n(define (COSTEP) 0.6em)\n\n;; Improve spacing on lists, remove extra space before..\n;; Suggested by Adam Di Carlo, adam@onshore.com\n(define ($list$)\n   (make display-group\n     start-indent: (if (INBLOCK?)\n\011\011       (inherited-start-indent)\n\011\011       (+ %block-start-indent% (inherited-start-indent)))\n     space-after:  (if (INLIST?) %para-sep% %block-sep%)))\n\n(element itemizedlist ($list$))\n\n(element (itemizedlist title)\n  (make paragraph\n    use: title-style\n    (process-children)))\n\n(define (generic-list-item indent-step line-field)\n  (let* ((itemcontent (children (current-node)))\n         (first-child (node-list-first itemcontent))\n         (spacing (inherited-attribute-string (normalize "spacing"))))\n    (make display-group\n      start-indent: (+ (inherited-start-indent) indent-step)\n      (make paragraph\n        use: (cond\n              ((equal? (gi first-child) (normalize "programlisting"))\n               verbatim-style)\n              ((equal? (gi first-child) (normalize "screen"))\n               verbatim-style)\n              ((equal? (gi first-child) (normalize "synopsis"))\n               verbatim-style)\n              ((equal? (gi first-child) (normalize "literallayout"))\n               linespecific-style)\n              ((equal? (gi first-child) (normalize "address"))\n               linespecific-style)\n              (else\n               nop-style))\n        space-before: (if (equal? (normalize "compact") spacing)\n                          0pt\n                          %para-sep%)\n        first-line-start-indent: (- indent-step)\n        (make sequence\n          line-field)\n\011(with-mode listitem-content-mode\n\011  (process-node-list first-child)))\n      (process-node-list (node-list-rest itemcontent)))))\n\n(define (process-listitem-content)\n  (if (absolute-first-sibling?) \n      (make sequence\n\011(process-children-trim))\n      (next-match)))\n\n(mode listitem-content-mode\n  (element (listitem programlisting) (process-listitem-content))\n  (element (listitem screen) (process-listitem-content))\n  (element (listitem synopsis) (process-listitem-content))\n  (element (listitem funcsynopsis) (process-listitem-content))\n  (element (listitem literallayout) (process-listitem-content))\n  (element (listitem address) (process-listitem-content))\n  (element (listitem para) (process-listitem-content))\n  (element (listitem formalpara) (process-listitem-content))\n  (element (listitem simpara) (process-listitem-content))\n)\n\n(element (itemizedlist listitem)\n  (let ((ilevel (length (hierarchical-number-recursive (normalize "itemizedlist"))))\n\011(override (inherited-attribute-string (normalize "override")))\n\011;; Use attribute-string (not inherited) so nested lists can have their own bullet style\n\011(mark (attribute-string (normalize "mark") (parent (current-node)))))\n    (generic-list-item\n     (ILSTEP)\n     ;; Use simple literal instead of line-field to avoid RTF tab character\n     (if (or (and override\n\011\011  (equal? (normalize override) (normalize "none")))\n\011     (and (not override)\n\011\011  (equal? (normalize mark) (normalize "none"))))\n\011 (make sequence\n\011   font-size: (BULLTREAT BULLSIZE ilevel override mark)\n\011   position-point-shift: (BULLTREAT BULLSHIFT ilevel override mark)\n\011   (literal "\\no-break-space;"))\n\011 (make sequence\n\011   font-size: (BULLTREAT BULLSIZE ilevel override mark)\n\011   position-point-shift: (BULLTREAT BULLSHIFT ilevel override mark)\n\011   (literal (BULLTREAT BULLSTR ilevel override mark) " "))))))\n\n(element orderedlist ($list$))\n\n(element (orderedlist title)\n  (make paragraph\n    use: title-style\n    (process-children)))\n\n(element (orderedlist listitem)\n  (let* ((listitems (select-elements (children (parent (current-node)))\n\011\011\011\011     (normalize "listitem")))\n\011 (itemnumber (orderedlist-listitem-number (current-node)))\n\011 (displaynum (if (string=? (inherited-attribute-string\n\011\011\011\011    (normalize "inheritnum"))\n\011\011\011\011   (normalize "inherit"))\n\011\011\011 (let loop ((nd (current-node)) (inum ""))\n\011\011\011   (if (node-list-empty? nd)\n\011\011\011       inum\n\011\011\011       (if (and (equal? (gi nd)\n\011\011\011\011\011\011(normalize "listitem"))\n\011\011\011\011\011(equal? (gi (parent nd))\n\011\011\011\011\011\011(normalize "orderedlist")))\n\011\011\011\011   (loop (parent nd)\n\011\011\011\011\011 (string-append\n\011\011\011\011\011  (number-with-numeration\n\011\011\011\011\011   nd\n\011\011\011\011\011   (inherited-attribute-string\n\011\011\011\011\011    (normalize "numeration") nd)\n\011\011\011\011\011   (orderedlist-listitem-number nd))\n\011\011\011\011\011  (if (string=? inum "")\n\011\011\011\011\011      ""\n\011\011\011\011\011      ".")\n\011\011\011\011\011  inum))\n\011\011\011\011   (loop (parent nd) inum))))\n\011\011\011 (number-with-numeration\n\011\011\011  (current-node)\n\011\011\011  (inherited-attribute-string (normalize "numeration"))\n\011\011\011  (orderedlist-listitem-number (current-node)))))\n\011 (listcount (+ (node-list-length listitems) itemnumber))\n\011 (factor    (cond\n\011\011     ((> listcount 999) 4)\n\011\011     ((> listcount 99) 3)\n\011\011     ((> listcount 9) 2)\n\011\011     (else 2)))\n\011 (numeration (inherited-attribute-string (normalize "numeration")))\n\011 (separator (if (equal? numeration (normalize "loweralpha"))\n\011\011\011" "\n\011\011\011(string-append (gentext-label-title-sep (normalize "orderedlist")) " "))))\n    (generic-list-item\n     (* (OLSTEP) factor)\n     ;; Use simple literal instead of line-field to avoid RTF tab character\n     (literal displaynum separator))))\n\n(define (number-with-numeration node numeration number)\n  (let* ((depth (length (hierarchical-number-recursive (normalize "orderedlist") node)))\n\011 (rawnum (cond\n\011\011  ((equal? numeration (normalize "arabic")) 1)\n\011\011  ((equal? numeration (normalize "loweralpha")) 2)\n\011\011  ((equal? numeration (normalize "lowerroman")) 3)\n\011\011  ((equal? numeration (normalize "upperalpha")) 4)\n\011\011  ((equal? numeration (normalize "upperroman")) 0)\n\011\011  (else (modulo depth 5))))\n\011 (num (case rawnum\n\011\011((1) (format-number number "1"))\n\011\011((2) (format-number number "a"))\n\011\011((3) (format-number number "i"))\n\011\011((4) (format-number number "A"))\n\011\011((0) (format-number number "I")))))\n    (cond\n     ((> depth 5) (string-append "(" num ")"))\n     ((equal? numeration (normalize "loweralpha")) (string-append num ")"))\n     (else num))))\n  \n(element variablelist\n  (let* ((termlength (if (attribute-string (normalize "termlength"))\n\011\011\011 (string->number \n\011\011\011  (attribute-string (normalize "termlength")))\n\011\011\011 %default-variablelist-termlength%))\n\011 (maxlen     (if (> termlength %default-variablelist-termlength%)\n\011\011\011    termlength\n\011\011\011    %default-variablelist-termlength%))\n\011 (too-long?  (variablelist-term-too-long? termlength)))\n    (make display-group\n      start-indent: (if (INBLOCK?)\n\011\011\011(inherited-start-indent)\n\011\011\011(+ %block-start-indent% (inherited-start-indent)))\n      space-before: (if (INLIST?) %para-sep% %block-sep%)\n      space-after:  (if (INLIST?) %para-sep% %block-sep%)\n\n      (if (and (or (and termlength (not too-long?))\n\011\011   %always-format-variablelist-as-table%)\n\011       (or %may-format-variablelist-as-table%\n\011\011   %always-format-variablelist-as-table%))\n\011  (make table\n\011    space-before: (if (INLIST?) %para-sep% %block-sep%)\n\011    space-after:  (if (INLIST?) %para-sep% %block-sep%)\n\011    start-indent: (if (INBLOCK?)\n\011\011\011      (inherited-start-indent)\n\011\011\011      (+ %block-start-indent% \n\011\011\011\011 (inherited-start-indent)))\n\n;; Calculate the width of the column containing the terms...\n;;\n;; maxlen       in        (inherited-font-size)     72pt\n;;        x ---------- x ----------------------- x ------ = width\n;;           12 chars              10pt              in\n;;\n\011    (make table-column\n\011      column-number: 1\n\011      width: (* (* (/ maxlen 12) (/ (inherited-font-size) 10pt)) 72pt))\n\011    (with-mode variablelist-table\n\011      (process-children)))\n\011  (process-children)))))\n\n(element varlistentry (process-children))\n\n(element (varlistentry term)\n    (make paragraph\n\011  space-before: (if (first-sibling?)\n\011\011\011    %block-sep%\n\011\011\011    0pt)\n\011  keep-with-next?: #t\n\011  first-line-start-indent: 0pt\n\011  start-indent: (inherited-start-indent)\n\011  (process-children)))\n\n(element (varlistentry listitem)\n  (let ((vle-indent 2em)) ; this ought to be in dbparam!\n    (generic-list-item \n     vle-indent\n     (make line-field\n       field-width: vle-indent\n       (literal "\\no-break-space;")))))\n\n(mode variablelist-table\n  (element varlistentry\n    (let* ((terms      (select-elements (children (current-node))\n\011\011\011\011\011(normalize "term")))\n\011   (listitem   (select-elements (children (current-node))\n\011\011\011\011\011(normalize "listitem")))\n\011   (termlen    (if (attribute-string (normalize "termlength")\n\011\011\011\011\011     (parent (current-node)))\n\011\011\011   (string->number (attribute-string\n\011\011\011\011\011    (normalize "termlength")\n\011\011\011\011\011    (parent (current-node))))\n\011\011\011   %default-variablelist-termlength%))\n\011   (too-long? (varlistentry-term-too-long? (current-node) termlen)))\n      (if too-long?\n\011  (make sequence\n\011    (make table-row\n\011      cell-before-row-margin: %para-sep%\n\n\011      (make table-cell\n\011\011column-number: 1\n\011\011n-columns-spanned: 2\n\011\011n-rows-spanned: 1\n\011\011(process-node-list terms)))\n\011    (make table-row\n\011      (make table-cell\n\011\011column-number: 1\n\011\011n-columns-spanned: 1\n\011\011n-rows-spanned: 1\n\011\011;; where terms would have gone\n\011\011(empty-sosofo))\n\011      (make table-cell\n\011\011column-number: 2\n\011\011n-columns-spanned: 1\n\011\011n-rows-spanned: 1\n\011\011(process-node-list listitem))))\n\011  (make table-row\n\011    cell-before-row-margin: %para-sep%\n\n\011    (make table-cell\n\011      column-number: 1\n\011      n-columns-spanned: 1\n\011      n-rows-spanned: 1\n\011      (process-node-list terms))\n\011    (make table-cell\n\011      column-number: 2\n\011      n-columns-spanned: 1\n\011      n-rows-spanned: 1\n\011      (process-node-list listitem))))))\n  \n  (element (varlistentry term)\n    (make sequence\n      (process-children-trim)\n      (if (not (last-sibling?))\n\011  (literal ", ")\n\011  (empty-sosofo))))\n\n  (element (varlistentry listitem)\n    (make display-group\n      start-indent: 0pt\n      (process-children)))\n\n  ;; Suggested by Nick NICHOLAS, nicholas@uci.edu\n  (element (variablelist title)\n    (make table-row\n      cell-before-row-margin: %para-sep%\n      (make table-cell\n\011column-number: 1\n\011n-columns-spanned: 2\n\011n-rows-spanned: 1\n\011(make paragraph\n\011  use: title-style\n\011  start-indent: 0pt\n\011  (process-children)))))\n\n)\n\n(define (simplelist-table majororder cols members)\n  (let* ((termcount (node-list-length members))\n\011 (rows (quotient (+ termcount (- cols 1)) cols)))\n    (make table\n      space-before: %para-sep%\n      space-after: %para-sep%\n      start-indent: (+ (inherited-start-indent) (ILSTEP))\n      (if %simplelist-column-width%\n\011  (let colloop ((colnum 1))\n\011    (if (> colnum cols)\n\011\011(empty-sosofo)\n\011\011(make sequence\n\011\011  (make table-column\n\011\011    width: %simplelist-column-width%)\n\011\011  (colloop (+ colnum 1)))))\n\011  (empty-sosofo))\n      (let rowloop ((rownum 1))\n\011(if (> rownum rows)\n\011    (empty-sosofo)\n\011    (make sequence\n\011      (simplelist-row rownum majororder rows cols members)\n\011      (rowloop (+ rownum 1))))))))\n\n(define (simplelist-row rownum majororder rows cols members)\n  (make table-row\n    (let colloop ((colnum 1))\n      (if (> colnum cols)\n\011  (empty-sosofo)\n\011  (make sequence\n\011    (simplelist-entry rownum colnum majororder rows cols members)\n\011    (colloop (+ colnum 1)))))))\n\n(define (simplelist-entry rownum colnum majororder rows cols members)\n  (let ((membernum (if (equal? majororder 'row)\n\011\011       (+ (* (- rownum 1) cols) colnum)\n\011\011       (+ (* (- colnum 1) rows) rownum))))\n    (let loop ((nl members) (count membernum))\n      (if (<= count 1)\n\011  (make table-cell\n\011    column-number: colnum\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n;; removed to avoid dependency between dblists and dbtable\n;;\011    cell-before-row-margin: %cals-cell-before-row-margin%\n;;\011    cell-after-row-margin: %cals-cell-after-row-margin%\n;;\011    cell-before-column-margin: %cals-cell-before-column-margin%\n;;\011    cell-after-column-margin: %cals-cell-after-column-margin%\n;;\011    start-indent: %cals-cell-content-start-indent%\n;;\011    end-indent: %cals-cell-content-end-indent%\n;; Standard para spacing between simplelist items\n\011    cell-before-row-margin: (/ %para-sep% 2)\n\011    cell-after-row-margin: (/ %para-sep% 2)\n\011    cell-before-column-margin: 3pt\n\011    cell-after-column-margin: 3pt\n\011    start-indent: 0pt\n\011    end-indent: 0pt\n\011    quadding: 'start\n\011    (if (node-list-empty? nl)\n\011\011(literal "\\no-break-space;")\n\011\011(process-node-list (node-list-first nl))))\n\011  (loop (node-list-rest nl) (- count 1))))))\n\n(element (entry simplelist) \n  ;; This is to avoid possibly putting tables inside tables, which don't\n  ;; work in some backends (e.g. RTF)\n  (make paragraph\n    (process-children)))\n\n(element (entry simplelist member)\n  ;; This is to avoid possibly putting tables inside tables, which don't\n  ;; work in some backends (e.g. RTF)\n  (let ((type (inherited-attribute-string (normalize "type"))))\n    (if (equal? type (normalize "inline"))\n\011(next-match)\n\011(make sequence\n\011  (if (equal? (child-number) 1)\n\011      (empty-sosofo)\n\011      (make paragraph-break))\n\011  (process-children)))))\n\n(element simplelist\n  (let ((type (attribute-string (normalize "type")))\n\011(cols (if (attribute-string (normalize "columns"))\n\011\011  (if (> (string->number (attribute-string (normalize "columns"))) 0)\n\011\011      (string->number (attribute-string (normalize "columns")))\n\011\011      1)\n\011\011  1))\n\011(members (select-elements (children (current-node)) (normalize "member"))))\n    (cond\n       ((equal? type (normalize "inline")) \n\011(process-children))\n       ((equal? type (normalize "vert"))\n\011(simplelist-table 'column cols members))\n       ((equal? type (normalize "horiz"))\n\011(simplelist-table 'row    cols members)))))\n\n(element member\n  (let ((type (inherited-attribute-string (normalize "type"))))\n    (if (equal? type (normalize "inline"))\n\011(make sequence\n\011  (process-children)\n\011  (if (not (last-sibling?))\n\011      (literal ", ")\n\011      (literal "")))\n\011(make paragraph\n\011  quadding: 'start\n\011  (process-children)))))\n\n(element segmentedlist (process-children))\n(element (segmentedlist title) ($lowtitle$ 2 4))\n\n(element segtitle (empty-sosofo))\n(mode seglist-in-seg\n  (element segtitle\n    (make sequence\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      (process-children))))\n\n(element seglistitem ($paragraph$))\n(element seg \n  (let* ((seg-num (child-number (current-node)))\n\011 (seglist (parent (parent (current-node))))\n\011 (segtitle (nth-node (select-elements \n\011\011\011 (descendants seglist) (normalize "segtitle")) seg-num)))\n\n    ;; Note: segtitle is only going to be the right thing in a well formed\n    ;; SegmentedList.  If there are too many Segs or too few SegTitles,\n    ;; you'll get something odd...maybe an error\n\n    (with-mode seglist-in-seg\n      (make paragraph\n\011(make sequence\n\011  font-family-name: %title-font-family%\n\011  font-weight: 'bold\n\011  (sosofo-append (process-node-list segtitle))\n\011  (literal ": "))\n\011(process-children)))))\n\n(element calloutlist ($list$))\n(element (calloutlist title) ($lowtitle$ 2 4))\n\n(element callout\n  (let* ((calloutcontent (children (current-node)))\n\011 (arearefs (inherited-attribute-string (normalize "arearefs")))\n\011 (idlist (split arearefs)))\n    (make sequence\n      start-indent: (+ (inherited-start-indent) (COSTEP))\n      (make paragraph\n\011space-before: %para-sep%\n\011first-line-start-indent: (- (COSTEP))\n\011(make line-field\n\011  field-width: (COSTEP)\n\011  (let loop ((ids idlist))\n\011    (if (null? ids)\n\011\011(empty-sosofo)\n\011\011(make sequence\n\011\011  ($callout-mark$ (element-with-id (car ids)))\n\011\011  (loop (cdr ids))))))\n\011(process-node-list (children (node-list-first calloutcontent))))\n\n      (process-node-list (node-list-rest calloutcontent)))))\n   \n;; $Id: dblot.dsl,v 1.2 2003/01/15 08:24:23 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; need test cases to do toc/lot; do these later\n\n(element toc (empty-sosofo))\n(element (toc title) (empty-sosofo))\n(element tocfront ($paragraph$))\n(element tocentry ($paragraph$))\n(element tocpart (process-children))\n(element tocchap (process-children))\n(element toclevel1 (process-children))\n(element toclevel2 (process-children))\n(element toclevel3 (process-children))\n(element toclevel4 (process-children))\n(element toclevel5 (process-children))\n(element tocback ($paragraph$))\n(element lot (empty-sosofo))\n(element (lot title) (empty-sosofo))\n(element lotentry ($paragraph$))\n\n     \n;; $Id: dbmath.dsl,v 1.2 2003/01/15 08:24:23 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n(define %equation-autolabel% #f)\n\n(element equation\n  ;; derived from $semiformal-object$\n  (if (node-list-empty? (select-elements (children (current-node))\n\011\011\011\011\011 (normalize "title")))\n      ($informal-object$ %informalequation-rules% %informalequation-rules%)\n      ($formal-object$ %informalequation-rules% %informalequation-rules%)))\n\n(element (equation title) (empty-sosofo))\n(element (equation alt) (empty-sosofo))\n(element (equation graphic) \n  (make paragraph\n    space-before: 0pt\n    space-after: 0pt\n    ($img$ (current-node) #t)))\n\n(element informalequation\n  ;; Derived from informal-object\n  (let ((rule-before? %informalequation-rules%)\n\011(rule-after? %informalequation-rules%))\n    (if %equation-autolabel%\n\011(make display-group\n\011  space-before: %block-sep%\n\011  space-after:  %block-sep%\n\011  start-indent: (+ %block-start-indent% \n\011\011\011   (inherited-start-indent))\n\011  keep-with-next?: (object-title-after)\n\n\011  (if rule-before?\n\011      (make rule\n\011\011orientation: 'horizontal\n\011\011line-thickness: %object-rule-thickness%\n\011\011display-alignment: 'center\n\011\011space-after: (/ %block-sep% 2)\n\011\011keep-with-next?: #t)\n\011      (empty-sosofo))\n\n\011  (make table\n\011    (make table-column\n\011      column-number: 1\n\011      width: (- %text-width% \n\011\011\011(+ (inherited-start-indent) \n\011\011\011   (inherited-end-indent) \n\011\011\011   1in)))\n\011    (make table-column\n\011      column-number: 2\n\011      width: 1in)\n\011    (make table-row\n\011      (make table-cell\n\011\011cell-row-alignment: 'center\n\011\011start-indent: 0pt\n\011\011end-indent: 0pt\n\011\011(process-children))\n\011      (make table-cell\n\011\011cell-row-alignment: 'center\n\011\011quadding: 'end\n\011\011start-indent: 0pt\n\011\011end-indent: 0pt\n\011\011(make paragraph\n\011\011  (literal "(" (element-label (current-node)) ")")))))\n\n\011  (if rule-after?\n\011      (make rule\n\011\011orientation: 'horizontal\n\011\011line-thickness: %object-rule-thickness%\n\011\011display-alignment: 'center\n\011\011space-before: (/ %block-sep% 2)\n\011\011keep-with-previous?: #t)\n\011      (empty-sosofo)))\n\011($informal-object$ rule-before? rule-after?))))\n\n(element (informalequation alt) (empty-sosofo))\n(element (informalequation graphic) \n  (make paragraph\n    space-before: 0pt\n    space-after: 0pt\n    quadding: 'end\n    ($img$ (current-node) #t)))\n\n(element inlineequation ($inline-object$))\n(element (inlineequation alt) (empty-sosofo))\n(element (inlineequation graphic) \n  (make sequence\n    ($img$ (current-node) #f)))\n\n    \n;; $Id: dbmsgset.dsl,v 1.2 2003/01/15 08:24:23 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ======================== ERROR MESSAGES (ETC.) =======================\n\n(element msgset (process-children))\n\n(element msgentry ($informal-object$))\n\n(element simplemsgentry ($informal-object$))\n\n(element msg\n  (make display-group\n\011font-weight: 'bold\n\011font-family-name: %mono-font-family%\n\011(process-children)))\n\n(element msgmain (process-children))\n\n(element msgsub\n  (make display-group\n\011start-indent: (+ (inherited-start-indent) (ILSTEP))\n\011(process-children)))\n\n(element msgrel (empty-sosofo))\n\n(element msgtext (process-children))\n\n(element msginfo ($indent-para-container$))\n\n(define ($genhead-para$ headtext)\n  (make paragraph\n\011space-before: %para-sep%\n\011space-after: %para-sep%\n\011(make sequence\n\011      font-weight: 'bold\n\011      (literal\n\011        (string-append headtext ": ")))\n\011(process-children)))\n\n(element msglevel ($genhead-para$ (gentext-element-name (current-node))))\n(element msgorig ($genhead-para$ (gentext-element-name (current-node))))\n(element msgaud ($genhead-para$ (gentext-element-name (current-node))))\n\n(element msgexplan ($indent-para-container$))\n(element (msgexplan title) ($runinhead$))\n(element (msgexplan para) (make sequence (process-children)))\n\n  \n;; $Id: dbprint.dsl,v 1.6 2004/10/09 19:46:33 petere78 Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n(define (HSIZE n)\n  (let ((m (if (< n 0) 0 n)))\n    (* %bf-size%\n       (expt %hsize-bump-factor% m))))\n\n(define (print-backend)\n  (cond \n   (tex-backend 'tex)\n   (mif-backend 'mif)\n   (rtf-backend 'rtf)\n   (else default-backend)))\n\n;; ====================== COMMON STYLE TEMPLATES =======================\n\n(define ($block-container$)\n  (make display-group\n\011space-before: %block-sep%\n\011space-after: %block-sep%\n\011start-indent: %body-start-indent%\n\011(process-children)))\n\n(define (is-first-para #!optional (para (current-node)))\n  ;; A paragraph is the first paragraph if it is preceded by a title\n  ;; (or bridgehead) and the only elements that intervene between the\n  ;; title and the paragraph are *info elements, indexterms, and beginpage.\n  ;;\n  (let loop ((nd (ipreced para)))\n    (if (node-list-empty? nd)\n\011;; We've run out of nodes. We still might be the first paragraph\n\011;; preceded by a title if the parent element has an implied\n\011;; title.\n\011(if (equal? (element-title-string (parent para)) "")\n\011    #f  ;; nope\n\011    #t) ;; yep\n\011(if (or (equal? (gi nd) (normalize "title"))\n\011\011(equal? (gi nd) (normalize "titleabbrev"))\n\011\011(equal? (gi nd) (normalize "bridgehead")))\n\011    #t\n\011    (if (or (not (equal? (node-property 'class-name nd) 'element))\n\011\011    (member (gi nd) (info-element-list)))\n\011\011(loop (ipreced nd))\n\011\011#f)))))\n\n(define (dsssl-language-code #!optional (node (current-node)))\n  (let* ((lang     ($lang$))\n\011 (langcode (if (> (string-index lang "_") 0)\n\011\011       (substring lang 0 (string-index lang "_"))\n\011\011       lang)))\n    (string->symbol (case-fold-up langcode))))\n\n(define (dsssl-country-code #!optional (node (current-node)))\n  (let* ((lang     ($lang$))\n\011 (ctrycode (if (> (string-index lang "_") 0)\n\011\011       (substring lang\n\011\011\011\011  (+ (string-index lang "_") 1)\n\011\011\011\011  (string-length lang))\n\011\011       #f)))\n    (if ctrycode\n\011(string->symbol (case-fold-up ctrycode))\n\011#f)))\n\n(define ($paragraph$)\n  (if (or (equal? (print-backend) 'tex)\n\011  (equal? (print-backend) #f))\n      ;; avoid using country: characteristic because of a JadeTeX bug...\n      (make paragraph\n\011first-line-start-indent: (if (is-first-para)\n\011\011\011\011     %para-indent-firstpara%\n\011\011\011\011     %para-indent%)\n\011space-before: %para-sep%\n\011space-after: (if (INLIST?)\n\011\011\011 0pt\n\011\011\011 %para-sep%)\n\011quadding: %default-quadding%\n\011hyphenate?: %hyphenation%\n\011language: (dsssl-language-code)\n\011(process-children-trim))\n      (make paragraph\n\011first-line-start-indent: (if (is-first-para)\n\011\011\011\011     %para-indent-firstpara%\n\011\011\011\011     %para-indent%)\n\011space-before: %para-sep%\n\011space-after: (if (INLIST?)\n\011\011\011 0pt\n\011\011\011 %para-sep%)\n\011quadding: %default-quadding%\n\011hyphenate?: %hyphenation%\n\011language: (dsssl-language-code)\n\011country: (dsssl-country-code)\n\011(process-children-trim))))\n\n(define ($para-container$)\n  (make paragraph\n\011space-before: %para-sep%\n\011space-after: %para-sep%\n\011start-indent: (if (member (current-node) (outer-parent-list))\n\011\011\011  %body-start-indent%\n\011\011\011  (inherited-start-indent))\n\011(process-children-trim)))\n\n(define ($indent-para-container$)\n  (make paragraph\n\011space-before: %para-sep%\n\011space-after: %para-sep%\n\011start-indent: (+ (inherited-start-indent) (* (ILSTEP) 2))\n\011quadding: %default-quadding%\n\011(process-children-trim)))\n\n(define nop-style\n  ;; a nop for use:\n  (style\n      font-family-name: (inherited-font-family-name)\n      font-weight: (inherited-font-weight)\n      font-size: (inherited-font-size)))\n\n(define default-text-style\n  (style\n   font-size: %bf-size%\n   font-weight: 'medium\n   font-posture: 'upright\n   font-family-name: %body-font-family%\n   line-spacing: (* %bf-size% %line-spacing-factor%)))\n\n(define ($bold-seq$ #!optional (sosofo (process-children)))\n  (make sequence\n    font-weight: 'bold\n    sosofo))\n\n(define ($italic-seq$ #!optional (sosofo (process-children)))\n  (make sequence\n    font-posture: 'italic\n    sosofo))\n\n(define ($bold-italic-seq$ #!optional (sosofo (process-children)))\n  (make sequence\n    font-weight: 'bold\n    font-posture: 'italic\n    sosofo))\n\n(define ($mono-seq$ #!optional (sosofo (process-children)))\n  (let ((%factor% (if %verbatim-size-factor% \n\011\011      %verbatim-size-factor% \n\011\011      1.0)))\n    (make sequence\n      font-family-name: %mono-font-family%\n      font-size: (* (inherited-font-size) %factor%)\n      sosofo)))\n\n(define ($italic-mono-seq$ #!optional (sosofo (process-children)))\n  (let ((%factor% (if %verbatim-size-factor% \n\011\011      %verbatim-size-factor% \n\011\011      1.0)))\n    (make sequence\n      font-family-name: %mono-font-family%\n      font-size: (* (inherited-font-size) %factor%)\n      font-posture: 'italic\n      sosofo)))\n\n(define ($bold-mono-seq$ #!optional (sosofo (process-children)))\n  (let ((%factor% (if %verbatim-size-factor% \n\011\011      %verbatim-size-factor% \n\011\011      1.0)))\n    (make sequence\n      font-family-name: %mono-font-family%\n      font-size: (* (inherited-font-size) %factor%)\n      font-weight: 'bold\n      sosofo)))\n\n(define ($score-seq$ stype #!optional (sosofo (process-children)))\n  (make score\n    type: stype\n    sosofo))\n\n(define ($charseq$ #!optional (sosofo (process-children)))\n  (make sequence\n    sosofo))\n\n(define ($guilabel-seq$ #!optional (sosofo (process-children)))\n  (make sequence\n    font-family-name: %guilabel-font-family%\n    sosofo))\n\n;; Stolen from a posting by James on dssslist\n(define *small-caps*\n  (letrec ((signature (* #o375 256))\n\011   (make-afii\n\011    (lambda (n)\n\011      (glyph-id (string-append "ISO/IEC 10036/RA//Glyphs::"\n\011\011\011\011       (number->string n)))))\n\011   (gen\n\011    (lambda (from count)\n\011      (if (= count 0)\n\011\011  '()\n\011\011  (cons (cons (make-afii from)\n\011\011\011      (make-afii (+ from signature)))\n\011\011\011(gen (+ 1 from)\n\011\011\011     (- count 1)))))))\n    (glyph-subst-table (gen #o141 26))))\n\n   \n;; $Id: dbprocdr.dsl,v 1.2 2003/01/15 08:24:23 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ============================= PROCEDURES =============================\n\n(define (PROCSTEP ilvl)\n  (if (> ilvl 1) 2.0em 1.8em))\n\n(element procedure\n  (if (node-list-empty? (select-elements (children (current-node)) (normalize "title")))\n      ($informal-object$)\n      ($formal-object$)))\n\n(element (procedure title) (empty-sosofo))\n\n(element substeps\n  (make display-group\n\011space-before: %para-sep%\n\011space-after: %para-sep%\n\011start-indent: (+ (inherited-start-indent) (PROCSTEP 2))))\n\n(element step\n  (let ((stepcontent (children (current-node)))\n\011(ilevel (length (hierarchical-number-recursive (normalize "step")))))\n    (make sequence\n      start-indent: (+ (inherited-start-indent) (PROCSTEP ilevel))\n\n      (make paragraph\n\011space-before: %para-sep%\n\011first-line-start-indent: (- (PROCSTEP ilevel))\n\011(make line-field\n\011  field-width: (PROCSTEP ilevel)\n\011  (literal ($proc-step-number$ (current-node))))\n\011(process-node-list (children (node-list-first stepcontent))))\n      (process-node-list (node-list-rest stepcontent)))))\n  \n;; $Id: dbqanda.dsl,v 1.1 2003/03/25 19:53:56 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ============================== QANDASET ==============================\n\n(define (qanda-defaultlabel)\n  (normalize "number"))\n\n(element qandaset\n  (let ((title (select-elements (children (current-node)) \n\011\011\011\011(normalize "title"))))\n    (make display-group\n      (process-node-list title)\n      (process-qanda))))\n\n(element (qandaset title)\n  (let* ((enclsect (ancestor-member (current-node)\n\011\011\011\011    (list (normalize "section")\n\011\011\011\011\011  (normalize "simplesect")\n\011\011\011\011\011  (normalize "sect5")\n\011\011\011\011\011  (normalize "sect4")\n\011\011\011\011\011  (normalize "sect3")\n\011\011\011\011\011  (normalize "sect2")\n\011\011\011\011\011  (normalize "sect1")\n\011\011\011\011\011  (normalize "refsect3")\n\011\011\011\011\011  (normalize "refsect2")\n\011\011\011\011\011  (normalize "refsect1"))))\n\011 (sectlvl (SECTLEVEL enclsect))\n\011 (hs      (HSIZE (- 4 (+ sectlvl 1)))))\n    (make paragraph\n      font-family-name: %title-font-family%\n      font-weight:  (if (< sectlvl 5) 'bold 'medium)\n      font-posture: (if (< sectlvl 5) 'upright 'italic)\n      font-size: hs\n      line-spacing: (* hs %line-spacing-factor%)\n      space-before: (* hs %head-before-factor%)\n      space-after: (* hs %head-after-factor%)\n      start-indent: %body-start-indent%\n      first-line-start-indent: 0pt\n      quadding: %section-title-quadding%\n      keep-with-next?: #t\n      (process-children))))\n\n(element qandadiv\n  (let ((title (select-elements (children (current-node)) \n\011\011\011\011(normalize "title"))))\n    (make sequence\n      (process-node-list title)\n      (make display-group\n\011start-indent: (+ (inherited-start-indent) 2pi)\n\011(process-qanda)))))\n\n(element (qandadiv title)\n  (let* ((hnr     (hierarchical-number-recursive (normalize "qandadiv")\n\011\011\011\011\011\011 (current-node)))\n\011 (number  (let loop ((numlist hnr) (number "") (sep ""))\n\011\011    (if (null? numlist)\n\011\011\011number\n\011\011\011(loop (cdr numlist) \n\011\011\011      (string-append number\n\011\011\011\011\011     sep\n\011\011\011\011\011     (number->string (car numlist)))\n\011\011\011      ".")))))\n    (make paragraph\n      font-weight: 'bold\n      space-after: %block-sep%\n      (literal number ". ")\n      (process-children))))\n\n(define (process-qanda #!optional (node (current-node)))\n  (let* ((preamble (node-list-filter-by-not-gi \n\011\011    (children node)\n\011\011    (list (normalize "title")\n\011\011\011  (normalize "qandadiv") \n\011\011\011  (normalize "qandaentry"))))\n\011 (divs     (node-list-filter-by-gi (children node)\n\011\011\011\011\011   (list (normalize "qandadiv"))))\n\011 (entries  (node-list-filter-by-gi (children node)\n\011\011\011\011\011   (list (normalize "qandaentry"))))\n\011 (inhlabel (inherited-attribute-string (normalize "defaultlabel")))\n\011 (deflabel (if inhlabel inhlabel (qanda-defaultlabel))))\n    (make sequence\n      (process-node-list preamble)\n      (process-node-list divs)\n      (process-node-list entries))))\n\n(element qandaentry\n  (process-children))\n\n(element question\n  (let* ((chlist   (children (current-node)))\n         (firstch  (node-list-first chlist))\n         (restch   (node-list-rest chlist))\n\011 (label    (question-answer-label (current-node))))\n    (make sequence\n      (make paragraph\n\011space-after: (/ %para-sep% 2)\n\011keep-with-next?: #t\n\011(make sequence\n\011  (make sequence\n\011    font-weight: 'bold\n\011    (if (string=? label "")\n\011\011(empty-sosofo)\n\011\011(literal label " ")))\n\011  (process-node-list (children firstch)))\n      (process-node-list restch)))))\n\n(element answer\n  (let* ((chlist   (children (current-node)))\n\011 (firstch  (node-list-first chlist))\n\011 (restch   (node-list-rest chlist))\n\011 (label    (question-answer-label (current-node))))\n    (make display-group\n      space-after: %block-sep%\n      (make paragraph\n\011(make sequence\n\011  (make sequence\n\011    font-weight: 'bold\n\011    (if (string=? label "")\n\011\011(empty-sosofo)\n\011\011(literal label " ")))\n\011  (process-node-list (children firstch))))\n      (process-node-list restch))))\n   \n;; $Id: dbrfntry.dsl,v 1.3 2003/01/15 08:24:23 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; =========================== REFERENCE PAGES ==========================\n\n;;(element reference ($component$))\n\n(element reference\n  (let* ((refinfo  (select-elements (children (current-node)) \n\011\011\011\011    (normalize "docinfo")))\n\011 (refintro (select-elements (children (current-node)) \n\011\011\011\011    (normalize "partintro")))\n\011 (nl       (titlepage-info-elements \n\011\011    (current-node)\n\011\011    refinfo\n\011\011    (if %generate-partintro-on-titlepage%\n\011\011\011refintro\n\011\011\011(empty-node-list)))))\n    (make sequence\n      (if %generate-reference-titlepage%\n\011  (make sequence\n\011    (reference-titlepage nl 'recto)\n\011    (reference-titlepage nl 'verso))\n\011  (empty-sosofo))\n\n      (if (not (generate-toc-in-front))\n\011  (process-children)\n\011  (empty-sosofo))\n      \n      (if (and %generate-reference-toc%\n\011       (not %generate-reference-toc-on-titlepage%))\n\011  (make simple-page-sequence\n\011    page-n-columns: %page-n-columns%\n\011    page-number-restart?: #t\n\011    page-number-format: ($page-number-format$ (normalize "toc"))\n\011    use: default-text-style\n\011    left-header:   ($left-header$ (normalize "toc"))\n\011    center-header: ($center-header$ (normalize "toc"))\n\011    right-header:  ($right-header$ (normalize "toc"))\n\011    left-footer:   ($left-footer$ (normalize "toc"))\n\011    center-footer: ($center-footer$ (normalize "toc"))\n\011    right-footer:  ($right-footer$ (normalize "toc"))\n\011    input-whitespace-treatment: 'collapse\n\011    (build-toc (current-node)\n\011\011       (toc-depth (current-node))))\n\011  (empty-sosofo))\n\n      (if (and (not (node-list-empty? refintro))\n\011       (not %generate-partintro-on-titlepage%))\n\011  ($process-partintro$ refintro #t)\n\011  (empty-sosofo))\n\n      (if (generate-toc-in-front)\n\011  (if %refentry-new-page%\n\011      (process-children)\n\011      (make simple-page-sequence\n\011\011page-n-columns: %page-n-columns%\n\011\011page-number-format: ($page-number-format$)\n\011\011use: default-text-style\n\011\011left-header:   ($left-header$)\n\011\011center-header: ($center-header$)\n\011\011right-header:  ($right-header$)\n\011\011left-footer:   ($left-footer$)\n\011\011center-footer: ($center-footer$)\n\011\011right-footer:  ($right-footer$)\n\011\011input-whitespace-treatment: 'collapse\n\011\011quadding: %default-quadding%\n\011\011(process-children)))\n\011  (empty-sosofo)))))\n\n;; If each RefEntry begins on a new page, this title is going to wind\n;; up on its own page, too, so make it a divtitlepage instead.  Otherwise,\n;; just let it be a component title.\n(element (reference title) (empty-sosofo))\n;;  (if %refentry-new-page%\n;;      ($divtitlepage$)\n;;      (empty-sosofo)))\n\n(element refentry \n  (make display-group\n    keep: %refentry-keep%\n    (if (or %refentry-new-page%\n\011    (node-list=? (current-node) (sgml-root-element)))\n\011(make simple-page-sequence\n\011  page-n-columns: %page-n-columns%\n\011  page-number-format: ($page-number-format$)\n\011  use: default-text-style\n\011  left-header:   ($left-header$)\n\011  center-header: ($center-header$)\n\011  right-header:  ($right-header$)\n\011  left-footer:   ($left-footer$)\n\011  center-footer: ($center-footer$)\n\011  right-footer:  ($right-footer$)\n\011  input-whitespace-treatment: 'collapse\n\011  quadding: %default-quadding%\n\011  ($refentry-title$)\n\011  (process-children))\n\011(make sequence\n\011  ($refentry-title$)\n\011  ($block-container$)))\n    (make-endnotes)))\n\n(define ($refentry-title$)\n  (let* ((refmeta       (select-elements (children (current-node))\n\011\011\011\011\011 (normalize "refmeta")))\n\011 (refentrytitle (select-elements (children refmeta)\n\011\011\011\011\011 (normalize "refentrytitle")))\n\011 (refnamediv    (select-elements (children (current-node))\n\011\011\011\011\011 (normalize "refnamediv")))\n\011 (refdescriptor (select-elements (children refnamediv)\n\011\011\011\011\011 (normalize "refdescriptor")))\n\011 (refname       (select-elements (children refnamediv)\n\011\011\011\011\011 (normalize "refname")))\n\011 (title         (if (node-list-empty? refentrytitle)\n\011\011\011    (if (node-list-empty? refdescriptor)\n\011\011\011\011(node-list-first refname)\n\011\011\011\011refdescriptor)\n\011\011\011    refentrytitle))\n\011 (slevel (SECTLEVEL)) ;; the true level in the section hierarchy\n\011 (hlevel (if (> slevel 2) 2 slevel)) ;; limit to sect2 equiv.\n\011 (hs (HSIZE (- 4 hlevel))))\n    (make paragraph\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      font-size: hs\n      line-spacing: (* hs %line-spacing-factor%)\n      space-before: (* hs %head-before-factor%)\n      space-after: (* hs %head-after-factor%)\n      start-indent: %body-start-indent%\n      first-line-start-indent: (- %body-start-indent%)\n      quadding: 'start\n      heading-level: (if %generate-heading-level% 2 0)\n      keep-with-next?: #t\n      (process-node-list (children title)))))\n;; nwalsh, this is wrong, 29 July 1999\n;      (if %refentry-function%\n;\011  (sosofo-append\n;\011   (literal "\\no-break-space;")\n;\011   (process-first-descendant (normalize "manvolnum")))\n;\011  (empty-sosofo)))))\n\n(element refmeta (empty-sosofo)) ;; handled by $refentry-title$\n\n(element manvolnum \n  (if %refentry-xref-manvolnum%\n      (sosofo-append\n       (literal "(")\n       (process-children)\n       (literal ")"))\n      (empty-sosofo)))\n\n(element refmiscinfo (empty-sosofo))\n\n(element refentrytitle ($charseq$))\n\n(element refnamediv\n  (make paragraph\n\011space-before: %para-sep%\n\011start-indent: %body-start-indent%\n\011quadding: 'start\n\011(process-children)))\n\n(element refname\n  (make sequence\n    (if (and %refentry-generate-name% (first-sibling? (current-node)))\n \011($lowtitlewithsosofo$ 1 3 (literal (gentext-element-name \n\011\011\011\011\011    (current-node))))\n \011(empty-sosofo))\n    (make sequence\n\011  font-weight: 'medium\n\011  font-family-name: %refentry-name-font-family%\n\011  (process-children)\n \011  (if (last-sibling? (current-node))\n \011      (empty-sosofo)\n\011      (literal (gentext-intra-label-sep (gi (current-node))))))))\n\n(element refpurpose\n  (make sequence\n        font-family-name: %body-font-family%\n    (make sequence\n      (literal " \\em-dash ")\n      (process-children))\n    (make paragraph-break)))\n\011\n(element refdescriptor (empty-sosofo))\n\n(element refclass\n  (let ((role (attribute-string "role")))\n    (make paragraph\n\011  space-before: %para-sep%\n\011  start-indent: %body-start-indent%\n\011  quadding: 'start\n\011  (make sequence\n\011\011font-weight: 'bold\n\011\011(literal\n\011\011  (if role\n\011\011      (string-append role ": ")\n\011\011      "")))\n\011  (process-children-trim))))\n\n(element refsynopsisdiv ($section$))\n\n(element (refsynopsisdiv title) (empty-sosofo))\n\n(element refsect1 ($section$))\n(element (refsect1 title) (empty-sosofo))\n(element refsect2 ($section$))\n(element (refsect2 title) (empty-sosofo))\n(element refsect3 ($section$))\n(element (refsect3 title) (empty-sosofo))\n\n\n  \n;; $Id: dbsect.dsl,v 1.6 2003/03/25 19:53:57 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ============================== SECTIONS ==============================\n\n(define (SECTLEVEL #!optional (sect (current-node)))\n  (section-level-by-node #f sect))\n\n;; BRIDGEHEAD isn't a proper section, but appears to be a section title\n(element bridgehead\n  (let* ((renderas (attribute-string "renderas"))\n\011 ;; the apparent section level\n\011 (hlevel\n\011  ;; if not real section level, then get the apparent level\n\011  ;; from "renderas"\n\011  (if renderas\n\011      (section-level-by-gi #f (normalize renderas))\n\011      ;; else use the real level\n\011      (SECTLEVEL)))\n\011 (hs (HSIZE (- 5 hlevel))))\011\n    (make paragraph\n      font-family-name: %title-font-family%\n      font-weight:  (if (< hlevel 5) 'bold 'medium)\n      font-posture: (if (< hlevel 5) 'upright 'italic)\n      font-size: hs\n      line-spacing: (* hs %line-spacing-factor%)\n      space-before: (* hs %head-before-factor%)\n      space-after: (* hs %head-after-factor%)\n      start-indent: (if (< hlevel 3)\n\011\011\0110pt\n\011\011\011%body-start-indent%)\n      first-line-start-indent: 0pt\n      quadding: %section-title-quadding%\n      keep-with-next?: #t\n      (process-children))))\n\n(define ($section$)\n  (if (node-list=? (current-node) (sgml-root-element))\n      (make simple-page-sequence\n\011page-n-columns: %page-n-columns%\n\011page-number-restart?: (or %page-number-restart% \n\011\011\011\011  (book-start?) \n\011\011\011\011  (first-chapter?))\n\011page-number-format: ($page-number-format$)\n\011use: default-text-style\n\011left-header:   ($left-header$)\n\011center-header: ($center-header$)\n\011right-header:  ($right-header$)\n\011left-footer:   ($left-footer$)\n\011center-footer: ($center-footer$)\n\011right-footer:  ($right-footer$)\n\011start-indent: %body-start-indent%\n\011input-whitespace-treatment: 'collapse\n\011quadding: %default-quadding%\n\011(make sequence\n\011  ($section-title$)\n\011  (process-children)))\n      (make display-group\n\011space-before: %block-sep%\n\011space-after: %block-sep%\n\011start-indent: %body-start-indent%\n\011(make sequence\n\011  ($section-title$)\n\011  (process-children)))))\n\n(define ($section-title$)\n  (let* ((sect (current-node))\n\011 (info (info-element))\n\011 (exp-children (if (node-list-empty? info)\n\011\011\011   (empty-node-list)\n\011\011\011   (expand-children (children info) \n\011\011\011\011\011    (list (normalize "bookbiblio") \n\011\011\011\011\011\011  (normalize "bibliomisc")\n\011\011\011\011\011\011  (normalize "biblioset")))))\n\011 (parent-titles (select-elements (children sect) (normalize "title")))\n\011 (info-titles   (select-elements exp-children (normalize "title")))\n\011 (titles        (if (node-list-empty? parent-titles)\n\011\011\011    info-titles\n\011\011\011    parent-titles))\n\011 (subtitles     (select-elements exp-children (normalize "subtitle")))\n\011 (renderas (inherited-attribute-string (normalize "renderas") sect))\n\011 ;; the apparent section level\n\011 (hlevel\n\011  ;; if not real section level, then get the apparent level\n\011  ;; from "renderas"\n\011  (if renderas\n\011      (section-level-by-gi #f (normalize renderas))\n\011      ;; else use the real level\n\011      (SECTLEVEL)))\n\011 (hs (HSIZE (- 5 hlevel))))\n    (make sequence\n      (make paragraph\n\011font-family-name: %title-font-family%\n\011font-weight:  (if (< hlevel 5) 'bold 'medium)\n\011font-posture: (if (< hlevel 5) 'upright 'italic)\n\011font-size: hs\n\011line-spacing: (* hs %line-spacing-factor%)\n\011space-before: (* hs %head-before-factor%)\n\011space-after: (if (node-list-empty? subtitles)\n\011\011\011 (* hs %head-after-factor%)\n\011\011\011 0pt)\n\011start-indent: (if (or (>= hlevel 3)\n\011\011\011      (member (gi) (list (normalize "refsynopsisdiv") \n\011\011\011\011\011\011 (normalize "refsect1") \n\011\011\011\011\011\011 (normalize "refsect2") \n\011\011\011\011\011\011 (normalize "refsect3"))))\n\011\011\011  %body-start-indent%\n\011\011\011  0pt)\n\011first-line-start-indent: 0pt\n\011quadding: %section-title-quadding%\n\011keep-with-next?: #t\n\011heading-level: (if %generate-heading-level% hlevel 0)\n\011;; SimpleSects are never AUTO numbered...they aren't hierarchical\n\011(if (string=? (element-label (current-node)) "")\n\011    (empty-sosofo)\n\011    (literal (element-label (current-node)) \n\011\011     (gentext-label-title-sep (gi sect))))\n\011(element-title-sosofo (current-node)))\n      (with-mode section-title-mode\n\011(process-node-list subtitles))\n      ($proc-section-info$ info))))\n\n(mode section-title-mode\n  (element subtitle\n    (let* ((sect (parent (parent (current-node)))) ;; parent=>sect*info\n\011   (renderas (inherited-attribute-string "renderas" sect))\n\011   ;; the apparent section level\n\011   (hlevel\n\011    ;; if not real section level, then get the apparent level\n\011    ;; from "renderas"\n\011    (if renderas\n\011\011(section-level-by-gi #f (normalize renderas))\n\011\011;; else use the real level\n\011\011(SECTLEVEL)))\n\011   (hs (HSIZE (- 4 hlevel))))       ;; one smaller than the title...\n      (make paragraph\n\011font-family-name: %title-font-family%\n\011font-weight:  (if (< hlevel 5) 'bold 'medium)\n\011font-posture: (if (< hlevel 5) 'upright 'italic)\n\011font-size: hs\n\011line-spacing: (* hs %line-spacing-factor%)\n\011space-before: 0pt\n\011space-after: (* hs %head-after-factor%)\n\011start-indent:\n\011(if (< hlevel 3)\n\011    0pt\n\011    %body-start-indent%)\n\011first-line-start-indent: 0pt\n\011quadding: %section-subtitle-quadding%\n\011keep-with-next?: #t\n\011(process-children))))\n)\n\n(define ($proc-section-info$ info)\n  (cond ((equal? (gi) (normalize "sect1"))\n\011 ($sect1-info$ info))\n\011((equal? (gi) (normalize "sect2"))\n\011 ($sect2-info$ info))\n\011((equal? (gi) (normalize "sect3"))\n\011 ($sect3-info$ info))\n\011((equal? (gi) (normalize "sect4"))\n\011 ($sect4-info$ info))\n\011((equal? (gi) (normalize "sect5"))\n\011 ($sect5-info$ info))\n\011((equal? (gi) (normalize "section"))\n\011 ($section-info$ info))\n\011((equal? (gi) (normalize "refsect1"))\n\011 ($refsect1-info$ info))\n\011((equal? (gi) (normalize "refsect2"))\n\011 ($refsect2-info$ info))\n\011((equal? (gi) (normalize "refsect3"))\n\011 ($refsect3-info$ info))\n\011(else (empty-sosofo))))\n\n(define ($sect1-info$ info) (empty-sosofo))\n(define ($sect2-info$ info) (empty-sosofo))\n(define ($sect3-info$ info) (empty-sosofo))\n(define ($sect4-info$ info) (empty-sosofo))\n(define ($sect5-info$ info) (empty-sosofo))\n(define ($section-info$ info) (empty-sosofo))\n(define ($refsect1-info$ info) (empty-sosofo))\n(define ($refsect2-info$ info) (empty-sosofo))\n(define ($refsect3-info$ info) (empty-sosofo))\n\n(element section ($section$))\n(element (section title) (empty-sosofo))\n\n(element sect1 ($section$))\n(element (sect1 title) (empty-sosofo))\n\n(element sect2 ($section$))\n(element (sect2 title) (empty-sosofo))\n\n(element sect3 ($section$))\n(element (sect3 title) (empty-sosofo))\n\n(element sect4 ($section$))\n(element (sect4 title) (empty-sosofo))\n\n(element sect5 ($section$))\n(element (sect5 title) (empty-sosofo))\n\n(element simplesect ($section$))\n(element (simplesect title) (empty-sosofo))\n\n    \n;; $Id: dbsynop.dsl,v 1.3 2003/01/15 08:24:23 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ========================= SYNTAX DEFINITIONS =========================\n\n(element synopsis ($verbatim-display$ %indent-synopsis-lines%\n\011\011\011\011      %number-synopsis-lines%))\n\n(element cmdsynopsis\n  ;; Can't be an $informal-object$ because it needs the paragraph\n  ;; wrapper around process-children\n  (make display-group\n    start-indent: (+ %block-start-indent% (inherited-start-indent))\n    space-before: %block-sep%\n    space-after: %block-sep%\n    (make paragraph\n      (process-children))))\n\n;; Support for ARG provided by James Bostock, augmented by norm\n;;\n\n(element (cmdsynopsis command)\n  (make sequence\n    (if (first-sibling? (current-node))\n\011(empty-sosofo)\n\011(make paragraph-break))\n    (next-match)\n    (literal " ")))\n\n(element group\n  (let ((choice  (attribute-string (normalize "choice")))\n\011(rep     (attribute-string (normalize "rep")))\n\011(sepchar (if (inherited-attribute-string (normalize "sepchar"))\n\011\011     (inherited-attribute-string (normalize "sepchar"))\n\011\011     " ")))\n    (make sequence\n      (if (equal? (absolute-child-number (current-node)) 1)\n\011  (empty-sosofo)\n\011  (literal sepchar))\n      (cond\n       ((equal? choice (normalize "plain")) (literal %arg-choice-plain-open-str%))\n       ((equal? choice (normalize "req")) (literal %arg-choice-req-open-str%))\n       ((equal? choice (normalize "opt")) (literal %arg-choice-opt-open-str%))\n       (else (literal %arg-choice-def-open-str%)))\n      (process-children)\n      (cond\n       ((equal? choice (normalize "plain")) (literal %arg-choice-plain-close-str%))\n       ((equal? choice (normalize "req")) (literal %arg-choice-req-close-str%))\n       ((equal? choice (normalize "opt")) (literal %arg-choice-opt-close-str%))\n       (else (literal %arg-choice-def-close-str%)))\n      (cond\n       ((equal? rep (normalize "repeat")) (literal %arg-rep-repeat-str%))\n       ((equal? rep (normalize "norepeat")) (literal %arg-rep-norepeat-str%))\n       (else (literal %arg-rep-def-str%))))))\n\n(element arg\n  (let ((choice  (attribute-string (normalize "choice")))\n\011(rep     (attribute-string (normalize "rep")))\n\011(sepchar (if (inherited-attribute-string (normalize "sepchar"))\n\011\011     (inherited-attribute-string (normalize "sepchar"))\n\011\011     " ")))\n    (make sequence\n      (if (equal? (absolute-child-number (current-node)) 1)\n\011  (empty-sosofo)\n\011  (literal sepchar))\n      (cond\n       ((equal? choice (normalize "plain")) (literal %arg-choice-plain-open-str%))\n       ((equal? choice (normalize "req")) (literal %arg-choice-req-open-str%))\n       ((equal? choice (normalize "opt")) (literal %arg-choice-opt-open-str%))\n       (else (literal %arg-choice-def-open-str%)))\n      (process-children)\n      (cond\n       ((equal? rep (normalize "repeat")) (literal %arg-rep-repeat-str%))\n       ((equal? rep (normalize "norepeat")) (literal %arg-rep-norepeat-str%))\n       (else (literal %arg-rep-def-str%)))\n      (cond\n       ((equal? choice (normalize "plain")) (literal %arg-choice-plain-close-str%))\n       ((equal? choice (normalize "req")) (literal %arg-choice-req-close-str%))\n       ((equal? choice (normalize "opt")) (literal %arg-choice-opt-close-str%))\n       (else (literal %arg-choice-def-close-str%))))))\n\n(element (group arg)\n  (let ((choice (attribute-string (normalize "choice")))\n\011(rep (attribute-string (normalize "rep"))))\n    (make sequence\n      (if (not (first-sibling? (current-node)))\n\011  (literal %arg-or-sep%)\n\011  (empty-sosofo))\n      (process-children))))\n\n(element sbr \n  (make paragraph-break))\n\n;; ----------------------------------------------------------------------\n;; Syntax highlighting...\n\n(define (funcsynopsis-function #!optional (sosofo (process-children)))\n  (make sequence\n    font-weight: 'bold\n    sosofo))\n\n(define (paramdef-parameter #!optional (sosofo (process-children)))\n  (make sequence\n    font-posture: 'italic\n    sosofo))\n\n;; ----------------------------------------------------------------------\n\n(element synopfragmentref \n  (let* ((target (element-with-id (attribute-string (normalize "linkend"))))\n\011 (snum   (child-number target)))\n    (make sequence\n      font-posture: 'italic\n      (make link \n\011destination: (node-list-address target)\n\011(make sequence\n\011  font-posture: 'upright\n\011  ($callout-bug$ snum)))\n      (process-children))))\n\n(element synopfragment\n  (let ((snum (child-number (current-node))))\n    (make paragraph\n      ($callout-bug$ snum)\n      (literal " ")\n      (process-children))))\n\n(element funcsynopsis \n  (let* ((width-in-chars (if (attribute-string "width")\n\011\011\011     (string->number (attribute-string "width"))\n\011\011\011     %verbatim-default-width%))\n\011 (fsize (lambda () (if (or (attribute-string (normalize "width"))\n\011\011\011\011   (not %verbatim-size-factor%))\n\011\011\011       (/ (/ (- %text-width% (inherited-start-indent))\n\011\011\011\011     width-in-chars) \n\011\011\011\011  0.7)\n\011\011\011       (* (inherited-font-size) \n\011\011\011\011  %verbatim-size-factor%)))))\n    ;; This used to be a sequence, but that caused the start-indent to be\n    ;; wrong when it was the first element of a RefSect.  Making it a\n    ;; paragraph makes the bug go away and doesn't seem to have any ill\n    ;; effects.  Need to investigate further...\n    (make paragraph\n      font-family-name: %mono-font-family%\n      font-size: (fsize)\n      font-weight: 'medium\n      font-posture: 'upright\n      line-spacing: (* (fsize) %line-spacing-factor%)\n      ($informal-object$))))\n\n(element funcsynopsisinfo \n  ;; Fake out the font-size so that when verbatim-display calculates the\n  ;; verbatim-size-factor it doesn't get squared.  This will fail if the\n  ;; "correct" size isn't bfsize, but what can I do?\n  (make sequence\n    font-size: %bf-size%\n    ($verbatim-display$ %indent-funcsynopsisinfo-lines%\n\011\011\011%number-funcsynopsisinfo-lines%)))\n\n(element funcprototype \n  (let ((paramdefs (select-elements (children (current-node))\n\011\011\011\011    (normalize "paramdef"))))\n    (make sequence\n      (make paragraph\n\011font-family-name: %mono-font-family%\n\011(process-children))\n      (if (equal? %funcsynopsis-style% 'kr)\n\011  (with-mode kr-funcsynopsis-mode\n\011    (process-node-list paramdefs))\n\011  (empty-sosofo)))))\n\n(element funcdef (process-children))\n(element (funcdef function) \n  (if %funcsynopsis-decoration%\n      (funcsynopsis-function)\n      (process-children)))\n\n(element void \n  (if (equal? %funcsynopsis-style% 'ansi)\n      (literal "(void);")\n      (literal "();")))\n\n(element varargs (literal "(...);"))\n\n(element paramdef\n  (let ((param (select-elements (children (current-node)) (normalize "parameter"))))\n    (make sequence\n      (if (equal? (child-number (current-node)) 1)\n\011  (literal "(")\n\011  (empty-sosofo))\n      (if (equal? %funcsynopsis-style% 'ansi)\n\011  (process-children)\n\011  (process-node-list param))\n      (if (equal? (gi (ifollow (current-node))) (normalize "paramdef"))\n\011  (literal ", ")\n\011  (literal ");")))))\n  \n(element (paramdef parameter)\n  (make sequence\n    (if %funcsynopsis-decoration%\n      (paramdef-parameter)\n      (process-children))\n    (if (equal? (gi (ifollow (current-node))) (normalize "parameter"))\n\011(literal ", ")\n\011(empty-sosofo))))\n\n(element funcparams \n  (make sequence \n    (literal "(")\n    (process-children)\n    (literal ")")))\n\n(mode kr-funcsynopsis-mode\n  (element paramdef\n    (make sequence\n      (make paragraph\n\011font-family-name: %mono-font-family%\n\011start-indent: (+ (inherited-start-indent) %kr-funcsynopsis-indent%)\n\011(make sequence\n\011  (process-children) \n\011  (literal ";"))))))\n   \n;; $Id: dbefsyn.dsl,v 1.4 2003/01/15 08:24:23 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n;; ============================ CLASS SYNOPSIS =============================\n\n(define %indent-classsynopsisinfo-lines% #f)\n(define %number-classsynopsisinfo-lines% #f)\n\n(define %default-classsynopsis-language% "java")\n\n(element classsynopsis\n  (let ((language (if (attribute-string (normalize "language"))\n\011\011      (attribute-string (normalize "language"))\n\011\011      %default-classsynopsis-language%)))\n    (case language\n      (("java") (with-mode cs-java-mode\n\011\011  (process-node-list (current-node))))\n      (("perl") (with-mode cs-perl-mode\n\011\011  (process-node-list (current-node))))\n      (("idl") (with-mode cs-idl-mode\n\011\011  (process-node-list (current-node))))\n      (("python") (with-mode cs-python-mode\n\011\011    (process-node-list (current-node))))\n      (else (with-mode cs-java-mode\n\011      (process-node-list (current-node)))))))\n\n(element methodsynopsis\n  (let ((language (if (attribute-string (normalize "language"))\n\011\011      (attribute-string (normalize "language"))\n\011\011      %default-classsynopsis-language%)))\n    (case language\n      (("java") (with-mode cs-java-mode\n\011\011  (process-node-list (current-node))))\n      (("perl") (with-mode cs-perl-mode\n\011\011  (process-node-list (current-node))))\n      (("idl") (with-mode cs-idl-mode\n\011\011  (process-node-list (current-node))))\n      (("python") (with-mode cs-python-mode\n\011\011    (process-node-list (current-node))))\n      (else (with-mode cs-java-mode\n\011      (process-node-list (current-node)))))))\n\n(element fieldsynopsis\n  (let ((language (if (attribute-string (normalize "language"))\n\011\011      (attribute-string (normalize "language"))\n\011\011      %default-classsynopsis-language%)))\n    (case language\n      (("java") (with-mode cs-java-mode\n\011\011  (process-node-list (current-node))))\n      (("perl") (with-mode cs-perl-mode\n\011\011  (process-node-list (current-node))))\n      (("idl") (with-mode cs-idl-mode\n\011\011  (process-node-list (current-node))))\n      (("python") (with-mode cs-python-mode\n\011\011    (process-node-list (current-node))))\n      (else (with-mode cs-java-mode\n\011      (process-node-list (current-node)))))))\n\n(element constructorynopsis\n  (let ((language (if (attribute-string (normalize "language"))\n\011\011      (attribute-string (normalize "language"))\n\011\011      %default-classsynopsis-language%)))\n    (case language\n      (("java") (with-mode cs-java-mode\n\011\011  (process-node-list (current-node))))\n      (("perl") (with-mode cs-perl-mode\n\011\011  (process-node-list (current-node))))\n      (("idl") (with-mode cs-idl-mode\n\011\011  (process-node-list (current-node))))\n      (("python") (with-mode cs-python-mode\n\011\011    (process-node-list (current-node))))\n      (else (with-mode cs-java-mode\n\011      (process-node-list (current-node)))))))\n\n(element destructorsynopsis\n  (let ((language (if (attribute-string (normalize "language"))\n\011\011      (attribute-string (normalize "language"))\n\011\011      %default-classsynopsis-language%)))\n    (case language\n      (("java") (with-mode cs-java-mode\n\011\011  (process-node-list (current-node))))\n      (("perl") (with-mode cs-perl-mode\n\011\011  (process-node-list (current-node))))\n      (("idl") (with-mode cs-idl-mode\n\011\011  (process-node-list (current-node))))\n      (("python") (with-mode cs-python-mode\n\011\011    (process-node-list (current-node))))\n      (else (with-mode cs-java-mode\n\011      (process-node-list (current-node)))))))\n\n;; ===== Java ========================================================\n\n(mode cs-java-mode\n\n(element classsynopsis\n  (let* ((classes      (select-elements (children (current-node))\n\011\011\011\011\011(normalize "ooclass")))\n\011 (classname    (node-list-first classes))\n\011 (superclasses (node-list-rest classes)))\n  (make display-group\n    use: verbatim-style\n    (make paragraph\n      (process-node-list classname)\n      (process-node-list superclasses)\n      (literal "{"))\n    (process-node-list\n     (node-list-filter-by-gi\n      (children (current-node))\n      (list (normalize "constructorsynopsis")\n\011    (normalize "destructorsynopsis")\n\011    (normalize "fieldsynopsis")\n\011    (normalize "methodsynopsis")\n\011    (normalize "classsynopsisinfo"))))\n    (make paragraph\n      (literal "}")))))\n\n(element classsynopsisinfo\n  ($verbatim-display$ %indent-classsynopsisinfo-lines%\n\011\011      %number-classsynopsisinfo-lines%))\n\n(element ooclass\n  (make sequence\n    (if (first-sibling?)\n\011(literal " ")\n\011(literal ", "))\n    (process-children)))\n\n(element oointerface\n  (make sequence\n    (if (first-sibling?)\n\011(literal " ")\n\011(literal ", "))\n    (process-children)))\n\n(element ooexception\n  (make sequence\n    (if (first-sibling?)\n\011(literal " ")\n\011(literal ", "))\n    (process-children)))\n\n(element modifier\n  (make sequence\n    (process-children)\n    (literal " ")))\n\n(element classname\n  (if (first-sibling?)\n      (make sequence\n\011(literal "class ")\n\011(process-children)\n\011(literal " ")\n\011(if (last-sibling?)\n\011    (empty-sosofo)\n\011    (literal "extends ")))\n      (make sequence\n\011(process-children)\n\011(if (last-sibling?)\n\011    (literal " ")\n\011    (literal ", ")))))\n\n(element fieldsynopsis\n  (make paragraph\n    use: inline-verbatim-style\n    (literal "  ")\n    (process-children)\n    (literal ";")))\n\n(element type\n  (make sequence\n    (process-children)\n    (literal " ")))\n\n(element varname\n  (make sequence\n    (process-children)))\n\n(element initializer\n  (make sequence\n    (literal " = ")\n    (process-children)))\n\n(element constructorsynopsis\n  (java-method-synopsis))\n\n(element destructorsynopsis\n  (java-method-synopsis))\n\n(element methodsynopsis\n  (java-method-synopsis))\n\n(element void\n  (literal "void "))\n\n(element methodname\n  (process-children))\n\n(element methodparam\n  (make sequence\n    (if (first-sibling?)\n\011(empty-sosofo)\n\011(literal ", "))\n    (process-children)))\n\n(element parameter\n  (process-children))\n\n(element exceptionname\n  (make sequence\n    (if (first-sibling?)\n\011(literal " throws ")\n\011(literal ", "))\n    (process-children)))\n)\n\n(define (java-method-synopsis #!optional (nd (current-node)))\n  (let* ((modifiers  (select-elements (children nd)\n\011\011\011\011      (normalize "modifier")))\n\011 (notmod     (node-list-filter-by-not-gi\n\011\011      (children nd)\n\011\011      (list (normalize "modifier"))))\n\011 (type       (if (equal? (gi (node-list-first notmod)) \n\011\011\011\011 (normalize "methodname"))\n\011\011\011 (empty-node-list)\n\011\011\011 (node-list-first notmod)))\n\011 (methodname (select-elements (children nd)\n\011\011\011\011      (normalize "methodname")))\n\011 (param      (node-list-filter-by-gi (node-list-rest notmod)\n\011\011\011\011\011     (list (normalize "methodparam"))))\n\011 (excep      (select-elements (children nd)\n\011\011\011\011      (normalize "exceptionname"))))\n    (make paragraph\n      use: inline-verbatim-style\n      (literal "  ")\n      (process-node-list modifiers)\n      (process-node-list type)\n      (process-node-list methodname)\n      (literal "(")\n      (process-node-list param)\n      (literal ")")\n      (process-node-list excep)\n      (literal ";"))))\n\n;; ===== Perl ========================================================\n\n(mode cs-perl-mode\n\n(element classsynopsis\n  (let* ((modifiers    (select-elements (children (current-node))\n\011\011\011\011\011(normalize "modifier")))\n\011 (classes      (select-elements (children (current-node))\n\011\011\011\011\011(normalize "classname")))\n\011 (classname    (node-list-first classes))\n\011 (superclasses (node-list-rest classes)))\n  (make display-group\n    use: verbatim-style;\n    (make paragraph\n      (literal "package ")\n      (process-node-list classname)\n      (literal ";"))\n    (if (node-list-empty? superclasses)\n\011(empty-sosofo)\n\011(make sequence\n\011  (literal "@ISA = (");\n\011  (process-node-list superclasses)\n\011  (literal ";")))\n    (process-node-list\n     (node-list-filter-by-gi\n      (children (current-node))\n      (list (normalize "constructorsynopsis")\n\011    (normalize "destructorsynopsis")\n\011    (normalize "fieldsynopsis")\n\011    (normalize "methodsynopsis")\n\011    (normalize "classsynopsisinfo")))))))\n\n(element classsynopsisinfo\n  ($verbatim-display$ %indent-classsynopsisinfo-lines%\n\011\011      %number-classsynopsisinfo-lines%))\n\n(element modifier\n  (literal "Perl ClassSynopses don't use Modifiers"))\n\n(element classname\n  (if (first-sibling?)\n      (process-children)\n      (make sequence\n\011(process-children)\n\011(if (last-sibling?)\n\011    (empty-sosofo)\n\011    (literal ", ")))))\n\n(element fieldsynopsis\n  (make paragraph\n    use: inline-verbatim-style\n    (literal "  ");\n    (process-children)\n    (literal ";")))\n\n(element type\n  (make sequence\n    (process-children)\n    (literal " ")))\n\n(element varname\n  (make sequence\n    (process-children)))\n\n(element initializer\n  (make sequence\n    (literal " = ")\n    (process-children)))\n\n(element constructorsynopsis\n  (perl-method-synopsis))\n\n(element destructorsynopsis\n  (perl-method-synopsis))\n\n(element methodsynopsis\n  (perl-method-synopsis))\n\n(element void\n  (empty-sosofo))\n\n(element methodname\n  (process-children))\n\n(element methodparam\n  (make sequence\n    (if (first-sibling?)\n\011(empty-sosofo)\n\011(literal ", "))\n    (process-children)))\n\n(element parameter\n  (process-children))\n\n(element exceptionname\n  (literal "Perl ClassSynopses don't use Exceptions"))\n\n)\n\n(define (perl-method-synopsis #!optional (nd (current-node)))\n  (let* ((modifiers  (select-elements (children nd)\n\011\011\011\011      (normalize "modifier")))\n\011 (notmod     (node-list-filter-by-not-gi\n\011\011      (children nd)\n\011\011      (list (normalize "modifier"))))\n\011 (type       (if (equal? (gi (node-list-first notmod)) \n\011\011\011\011 (normalize "methodname"))\n\011\011\011 (empty-node-list)\n\011\011\011 (node-list-first notmod)))\n\011 (methodname (select-elements (children nd)\n\011\011\011\011      (normalize "methodname")))\n\011 (param      (node-list-filter-by-gi (node-list-rest notmod)\n\011\011\011\011\011     (list (normalize "type")\n\011\011\011\011\011\011   (normalize "void"))))\n\011 (excep      (select-elements (children nd)\n\011\011\011\011      (normalize "exceptionname"))))\n    (make paragraph\n      use: inline-verbatim-style\n      (literal "sub ")\n      (process-node-list modifiers)\n      (process-node-list type)\n      (process-node-list methodname)\n      (literal " { ... }"))))\n\n;; ===== IDL =========================================================\n\n(mode cs-idl-mode\n\n(element classsynopsis\n  (let* ((modifiers    (select-elements (children (current-node))\n\011\011\011\011\011(normalize "modifier")))\n\011 (classes      (select-elements (children (current-node))\n\011\011\011\011\011(normalize "classname")))\n\011 (classname    (node-list-first classes))\n\011 (superclasses (node-list-rest classes)))\n  (make display-group\n    use: verbatim-style;\n    (make paragraph\n      (literal "interface ")\n      (process-node-list modifiers)\n      (process-node-list classname)\n      (if (node-list-empty? superclasses)\n\011  (literal " ")\n\011  (make sequence\n\011    (literal " : ")\n\011    (process-node-list superclasses)))\n      (literal "{"))\n    (process-node-list\n     (node-list-filter-by-gi\n      (children (current-node))\n      (list (normalize "constructorsynopsis")\n\011    (normalize "destructorsynopsis")\n\011    (normalize "fieldsynopsis")\n\011    (normalize "methodsynopsis")\n\011    (normalize "classsynopsisinfo"))))\n    (make paragraph\n      (literal "}")))))\n\n(element classsynopsisinfo\n  ($verbatim-display$ %indent-classsynopsisinfo-lines%\n\011\011      %number-classsynopsisinfo-lines%))\n\n(element modifier\n  (make sequence\n    (process-children)\n    (literal " ")))\n\n(element classname\n  (if (first-sibling?)\n      (process-children)\n      (make sequence\n\011(process-children)\n\011(if (last-sibling?)\n\011    (empty-sosofo)\n\011    (literal ", ")))))\n\n(element fieldsynopsis\n  (make paragraph\n    use: inline-verbatim-style\n    (literal "  ");\n    (process-children)\n    (literal ";")))\n\n(element type\n  (make sequence\n    (process-children)\n    (literal " ")))\n\n(element varname\n  (make sequence\n    (process-children)))\n\n(element initializer\n  (make sequence\n    (literal " = ")\n    (process-children)))\n\n(element constructorsynopsis\n  (idl-method-synopsis))\n\n(element destructorsynopsis\n  (idl-method-synopsis))\n\n(element methodsynopsis\n  (idl-method-synopsis))\n\n(element void\n  (literal "void "))\n\n(element methodname\n  (process-children))\n\n(element methodparam\n  (make sequence\n    (if (first-sibling?)\n\011(empty-sosofo)\n\011(literal ", "))\n    (process-children)))\n\n(element parameter\n  (process-children))\n\n(element exceptionname\n  (make sequence\n    (if (first-sibling?)\n\011(literal " raises(")\n\011(literal ", "))\n    (process-children)\n    (if (last-sibling?)\n\011(literal ")")\n\011(empty-sosofo))))\n)\n\n(define (idl-method-synopsis #!optional (nd (current-node)))\n  (let* ((modifiers  (select-elements (children nd)\n\011\011\011\011      (normalize "modifier")))\n\011 (notmod     (node-list-filter-by-not-gi\n\011\011      (children nd)\n\011\011      (list (normalize "modifier"))))\n\011 (type       (if (equal? (gi (node-list-first notmod)) \n\011\011\011\011 (normalize "methodname"))\n\011\011\011 (empty-node-list)\n\011\011\011 (node-list-first notmod)))\n\011 (methodname (select-elements (children nd)\n\011\011\011\011      (normalize "methodname")))\n\011 (param      (node-list-filter-by-gi (node-list-rest notmod)\n\011\011\011\011\011     (list (normalize "methodparam"))))\n\011 (excep      (select-elements (children nd)\n\011\011\011\011      (normalize "exceptionname"))))\n    (make paragraph\n      use: inline-verbatim-style\n      (process-node-list modifiers)\n      (process-node-list type)\n      (process-node-list methodname)\n      (literal "(")\n      (process-node-list param)\n      (literal ")")\n      (process-node-list excep)\n      (literal ";"))))\n\n;; ===== Python ======================================================\n;; Contributed by Lane Stevens, lane@cycletime.com\n\n(mode cs-python-mode\n  (element classsynopsis\n    (let* ((classes      (select-elements (children (current-node))\n\011\011\011\011\011  (normalize "ooclass")))\n\011   (classname    (node-list-first classes))\n\011   (superclasses (node-list-rest classes)))\n      (make display-group\n\011use: verbatim-style\n\011(make paragraph\n\011  (literal "class ")\n\011  (process-node-list classname)\n\011  (literal "(")\n\011  (process-node-list superclasses)\n\011  (literal ") :"))\n\011(process-node-list\n\011 (node-list-filter-by-gi\n\011  (children (current-node))\n\011  (list (normalize "constructorsynopsis")\n\011\011(normalize "destructorsynopsis")\n\011\011(normalize "fieldsynopsis")\n\011\011(normalize "methodsynopsis")\n\011\011(normalize "classsynopsisinfo"))))\n\011)\n      )\n    )\n\n  (element ooclass\n    (make sequence\n      (process-children)\n      (cond\n       ((first-sibling?) (literal " "))\n       ((last-sibling?) (empty-sosofo))\n       (#t (literal ", "))\n       )\n      )\n    )\n  \n  (element methodsynopsis\n    (python-method-synopsis))\n  \n  (element classname\n    (process-children))\n\n  (element initializer\n    (make sequence\n      (literal " = ")\n      (process-children)))\n\n  (element methodname\n    (process-children))\n\n  (element methodparam\n    (make sequence\n      (process-children)\n      (if (last-sibling?)\n\011  (empty-sosofo)\n\011  (literal ", "))\n      )\n    )\n\n  (element parameter\n    (process-children))\n  )\n\n(define (python-method-synopsis #!optional (nd (current-node)))\n  (let* ((the-method-name (select-elements (children nd) (normalize "methodname")))\n\011 (the-method-params (select-elements (children nd) (normalize "methodparam")))\n\011 )\n    (make paragraph\n      use: inline-verbatim-style\n      (literal "    def ")\n      (process-node-list the-method-name)\n      (literal "(")\n      (process-node-list the-method-params)\n      (literal ") :"))\n    )\n  )\n\n;; EOF\n   \n;; dbprod.dsl - DSSSL stylesheet for BNF productions\n;; Custom addition for dazzzledoc project\n\n;; ==================== PARAMETERS ====================\n\n;; Enable section numbering down to sect3 (1.1.1)\n(define %section-autolabel% #t)\n\n;; Increase paragraph separation for better readability\n(define %para-sep%\n  (* %bf-size% 0.75))  ; Increased from default 0.5 to 0.75\n\n;; ==================== NOTES ====================\n\n;; Override note to use smaller font and add "NOTE N" or "NOTES" prefix\n(element note\n  (let* ((note-num (element-number))\n         ;; Check if this note is part of a multi-note sequence\n         ;; by checking if previous or next sibling is also a note\n         (prev-sib (ipreced (current-node)))\n         (next-sib (ifollow (current-node)))\n         (prev-is-note (and (not (node-list-empty? prev-sib))\n                            (equal? (gi prev-sib) (normalize "note"))))\n         (next-is-note (and (not (node-list-empty? next-sib))\n                            (equal? (gi next-sib) (normalize "note"))))\n         (is-multi-note-seq (or prev-is-note next-is-note))\n         (is-first-in-seq (and (not prev-is-note) next-is-note)))\n    (make display-group\n      space-before: %para-sep%\n      space-after: %para-sep%\n      font-size: (* %bf-size% 0.85)\n      line-spacing: (* (* %bf-size% 0.85) %line-spacing-factor%)\n      ;; Process children with custom handling for first para\n      (let loop ((nl (children (current-node))) (first-para? #t))\n        (if (node-list-empty? nl)\n            (empty-sosofo)\n            (let ((node (node-list-first nl))\n                  (rest (node-list-rest nl)))\n              (sosofo-append\n                (if (equal? (gi node) (normalize "para"))\n                    ;; Para element - render with optional NOTE/NOTES prefix\n                    (make paragraph\n                      space-before: (if first-para? 0pt %para-sep%)\n                      space-after: %para-sep%\n                      start-indent: (inherited-start-indent)\n                      (make sequence\n                        ;; Add prefix only for first para\n                        (if first-para?\n                            (cond\n                              ;; First note in multi-note sequence: "NOTES" heading + number\n                              (is-first-in-seq\n                               (make sequence\n                                 (literal "NOTES")\n                                 (make paragraph-break)\n                                 (literal (string-append (number->string note-num) "  "))))\n                              ;; Subsequent note in multi-note sequence: just the number\n                              ((and is-multi-note-seq prev-is-note)\n                               (literal (string-append (number->string note-num) "  ")))\n                              ;; Regular single note: "NOTE N "\n                              (else\n                               (literal (string-append "NOTE " (number->string note-num) " "))))\n                            (empty-sosofo))\n                        ;; Process para's children (not the para element itself)\n                        (with-mode note-para-mode\n                          (process-node-list (children node)))))\n                    ;; Other elements - process normally\n                    (process-node-list node))\n                (loop rest (if (equal? (gi node) (normalize "para")) #f first-para?)))))\n\n      ))))\n\n;; Mode for processing para content without para wrapper\n(mode note-para-mode\n  ;; Inline elements need explicit rules to preserve their formatting\n  (element code ($mono-seq$))\n  (element literal ($mono-seq$))\n  (element replaceable ($italic-seq$))\n  (element emphasis\n    (if (and (attribute-string (normalize "role"))\n             (or (equal? (attribute-string (normalize "role")) "strong")\n                 (equal? (attribute-string (normalize "role")) "bold")))\n        ($bold-seq$)\n        ($italic-seq$)))\n  (element superscript ($ss-seq$ +))\n  (element subscript ($ss-seq$ -))\n  ;; Default for other elements\n  (default (process-children)))\n\n;; ==================== EXAMPLES ====================\n\n;; Override informalexample to add titles based on xml:id\n;; This overrides the default in dbblock.dsl\n(mode informalexample-mode\n  (element programlisting\n    (process-children)))\n\n(element informalexample\n  (let* ((id (attribute-string (normalize "xml:id")))\n         (example-num (if id\n                          (substring id 8 (string-length id))  ; Extract number from "example-N"\n                          #f)))\n    (if example-num\n        ;; Has xml:id - add EXAMPLE title\n        (make display-group\n          space-before: %para-sep%\n          space-after: 0pt\n          start-indent: (inherited-start-indent)\n          ;; Add title\n          (make paragraph\n            space-after: 3pt  ; Small space after EXAMPLE title\n            (literal (string-append "EXAMPLE " example-num)))\n          ;; Process content\n          (process-children))\n        ;; No xml:id - use default handling\n        ($informal-object$ %informalexample-rules% %informalexample-rules%))))\n\n;; ==================== PRODUCTIONS ====================\n\n(element productionset\n  (make display-group\n    space-before: %para-sep%\n    space-after: %para-sep%\n    start-indent: (inherited-start-indent)\n    (process-children)))\n\n(element production\n  (let ((prod-id (attribute-string (normalize "xml:id"))))\n    (make paragraph\n      space-before: %para-sep%  ; Use standard paragraph spacing before each production\n      space-after: 0pt\n      start-indent: (inherited-start-indent)\n      ;; Production number in brackets\n      (make sequence\n        (literal "[")\n        (literal (if prod-id\n                    ;; Extract number from "prod-N" ID\n                    (let ((num-str (substring prod-id 5 (string-length prod-id))))\n                      num-str)\n                    "?"))\n        (literal "] ")\n        (process-children)))))\n\n(element (production lhs)\n  (make sequence\n    (process-children)\n    (literal " = ")))\n\n(element (production rhs)\n  (make sequence\n    font-family-name: %mono-font-family%\n    (process-children)))\n\n(element (production rhs lineannotation)\n  (let ((role (attribute-string (normalize "role"))))\n    (if (equal? role "meta")\n        ;; Meta-characters in proportional font\n        (make sequence\n          font-family-name: %body-font-family%\n          (process-children))\n        ;; Default lineannotation handling\n        (process-children))))\n\n(element (production rhs sbr)\n  (make sequence\n    font-family-name: %body-font-family%\n    (literal " ")\n    (make line-field\n      field-width: 0pt)\n    (literal "| ")))\n\n(element (production rhs nonterminal)\n  (let ((role (attribute-string (normalize "role"))))\n    (make sequence\n      font-family-name: %body-font-family%\n      font-posture: 'italic\n      font-weight: (if (equal? role "strong") 'bold 'medium)\n      (process-children))))\n    \n;; $Id: dbtable.dsl,v 1.3 2003/02/17 08:56:46 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n;; Table support completely reimplemented by norm 15/16 Nov 1997\n;;\n;; ======================================================================\n;;\n;; This code is intended to implement the SGML Open Exchange Table Model\n;; (http://www.sgmlopen.org/sgml/docs/techpubs.htm) as far as is possible\n;; in RTF.  There are a few areas where this code probably fails to \n;; perfectly implement the model:\n;;\n;; - Mixed column width units (4*+2pi) are not supported.\n;; - The behavior that results from mixing relative units with \n;;   absolute units has not been carefully considered.\n;; - TFOOT appears at the bottom of the table, but is not repeated\n;;   across the bottom of pages (RTF limitation).\n;; - ENTRYTBL is not supported.\n;; - Rotated tables (e.g. landscape tables in a portrait document)\n;;   cannot be supported in a simple-page-sequence\n;;\n;; ======================================================================\n;; \n;; My goal in reimplementing the table model was to provide correct\n;; formatting in tables that use MOREROWS. The difficulty is that\n;; correct formatting depends on calculating the column into which\n;; an ENTRY will fall.\n;;\n;; This is a non-trivial problem because MOREROWS can hang down from\n;; preceding rows and ENTRYs may specify starting columns (skipping\n;; preceding ones).\n;;\n;; A simple, elegant recursive algorithm exists. Unfortunately it \n;; requires calculating the column number of every preceding cell \n;; in the entire table. Without memoization, performance is unacceptable\n;; even in relatively small tables (5x5, for example).\n;;\n;; In order to avoid recursion, the algorithm used below is one that\n;; works forward from the beginning of the table and "passes along"\n;; the relevant information (column number of the preceding cell and\n;; overhang from the MOREROWS in preceding rows).\n;;\n;; Unfortunately, this means that element construction rules\n;; can't always be used to fire the appropriate rule.  Instead,\n;; each TGROUP has to process each THEAD/BODY/FOOT explicitly.\n;; And each of those must process each ROW explicitly, then each\n;; ENTRY/ENTRYTBL explicitly.\n;;\n;; ----------------------------------------------------------------------\n;;\n;; I attempted to simplify this code by relying on inheritence from\n;; table-column flow objects, but that wasn't entirely successful.\n;; Horizontally spanning cells didn't seem to inherit from table-column\n;; flow objects that didn't specify equal spanning.  There seemed to\n;; be other problems as well, but they could have been caused by coding\n;; errors on my part.\n;; \n;; Anyway, by the time I understood how I could use table-column\n;; flow objects for inheritence, I'd already implemented all the\n;; machinery below to "work it out by hand".  \n;;\n;; ======================================================================\n;; NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE \n;; ----------------------------------------------------------------------\n;; A fairly large chunk of this code is in dbcommon.dsl!\n;; ======================================================================\n;;\n\n;; Default value for FRAME= on tables\n(define ($cals-frame-default$) (normalize "all"))\n\n;; Default for COLSEP/ROWSEP if unspecified.\n(define ($cals-rowsep-default$ #!optional (node (current-node)))\n  ;; Return "0" for #f, "1" for #t\n  ;; Default is to have rules if FRAME=ALL, otherwise not.  Except\n  ;; that a separator between HEAD and BODY is controlled by\n  ;; %table-head-body-border%.\n  ;; \n  (let* ((table (ancestor-member node ($table-element-list$)))\n\011 (frame (if (attribute-string (normalize "frame") table)\n\011\011    (attribute-string (normalize "frame") table)\n\011\011    ($cals-frame-default$)))\n\011 (row   (ancestor-member node (list (normalize "row")))))\n    (if (equal? frame (normalize "all"))\n\011#t\n\011(if (and (equal? (gi (parent row)) (normalize "thead"))\n\011\011 (last-sibling? row))\n\011    %table-head-body-border%\n\011    #f))))\n\n(define ($cals-colsep-default$ #!optional (node (current-node)))\n  ;; Default is to have rules if FRAME=ALL, otherwise not.\n  ;;\n  (let* ((table (ancestor-member node ($table-element-list$)))\n\011 (frame (if (attribute-string (normalize "frame") table)\n\011\011    (attribute-string (normalize "frame") table)\n\011\011    ($cals-frame-default$))))\n    (equal? frame (normalize "all"))))\n\n;; Default for VALIGN if unspecified\n(define ($cals-valign-default$) (normalize "top"))\n\n;; Margins around cell contents\n(define %cals-cell-before-row-margin% 3pt)\n(define %cals-cell-after-row-margin% 3pt)\n\n(define %cals-cell-before-column-margin% 3pt)\n\n(define %cals-cell-after-column-margin% 3pt)\n\n;; Inheritable start and end indent for cell contents\n(define %cals-cell-content-start-indent% 2pt)\n(define %cals-cell-content-end-indent% 2pt)\n\n;; How to indent pgwide tables?  (Non-pgwide tables get inherited-start-indent\n(define %cals-pgwide-start-indent% %body-start-indent%)\n\n;; What alignment should tables have on the page\n(define %cals-display-align% 'start)\n\n;; ----------------------------------------------------------------------\n;; Table rule widths\n\n(define %table-before-row-border% #t)\n(define %table-after-row-border% #t)\n(define %table-before-column-border% #t) \n(define %table-after-column-border% #t)\n(define %table-head-body-border% #t)\n(define %table-cell-after-column-border% #t)\n(define %table-cell-after-row-border% #t)\n\n;;(define tbl-color-space \n;;  (color-space "ISO/IEC 10179:1996//Color-Space Family::Device RGB"))\n;;\n;;(define tbl-red (color tbl-color-space 1 0 0))\n;;(define tbl-green (color tbl-color-space 0 1 0))\n;;(define tbl-blue (color tbl-color-space 0 0 1))\n\n(define calc-table-before-row-border\n  (if (boolean? %table-before-row-border%)\n      %table-before-row-border%\n      ;; Avoid problems with the DSSSL compiler when \n      ;; %table-before-row-border% is boolean.\n      (let ((border-width %table-before-row-border%))\n\011(make table-border\n\011  line-thickness: border-width))))\n\n(define calc-table-after-row-border\n  (if (boolean? %table-after-row-border%)\n      %table-after-row-border%\n      (let ((border-width %table-after-row-border%))\n\011(make table-border\n\011  line-thickness: border-width))))\n\n(define calc-table-before-column-border\n  (if (boolean? %table-before-column-border%)\n      %table-before-column-border%\n      (let ((border-width %table-before-column-border%))\n\011(make table-border\n\011  line-thickness: border-width))))\n\n(define calc-table-after-column-border\n  (if (boolean? %table-after-column-border%)\n      %table-after-column-border%\n      (let ((border-width %table-after-column-border%))\n\011(make table-border\n\011  line-thickness: border-width))))\n\n(define calc-table-head-body-border\n  (if (boolean? %table-head-body-border%)\n      %table-head-body-border%\n      (let ((border-width %table-head-body-border%))\n\011(make table-border\n\011  line-thickness: border-width))))\n\n(define calc-table-cell-after-column-border\n  (if (boolean? %table-cell-after-column-border%)\n      %table-cell-after-column-border%\n      (let ((border-width %table-cell-after-column-border%))\n\011(make table-border\n\011  line-thickness: border-width))))\n\n(define calc-table-cell-after-row-border\n  (if (boolean? %table-cell-after-row-border%)\n      %table-cell-after-row-border%\n      (let ((border-width %table-cell-after-row-border%))\n\011(make table-border\n\011  line-thickness: border-width))))\n\n;; ----------------------------------------------------------------------\n;; Convert colwidth units into table-unit measurements\n\n(define (colwidth-unit lenstr)\n  (if (string? lenstr)\n      (let ((number (length-string-number-part lenstr))\n\011    (units  (length-string-unit-part lenstr)))\n\011(if (string=? units "*")\n\011    (if (string=? number "")\n\011\011(table-unit 1)\n\011\011(table-unit (string->number number)))\n\011    (if (string=? units "")\n\011\011;; no units, default to points\n\011\011(* (string->number number) 1pt)\n\011\011(let* ((unum  (string->number number))\n\011\011       (uname (case-fold-down units)))\n\011\011  (case uname\n\011\011    (("mm") (* unum 1mm))\n\011\011    (("cm") (* unum 1cm))\n\011\011    (("in") (* unum 1in))\n\011\011    (("pi") (* unum 1pi))\n\011\011    (("pt") (* unum 1pt))\n\011\011    (("px") (* unum 1px))\n\011\011    ;; unrecognized units; use points\n\011\011    (else   (* unum 1pt)))))))\n      ;; lenstr is not a string...probably #f\n      (table-unit 1)))\n\n\n(define (cell-align cell colnum)\n  (let* ((entry     (ancestor-member cell (list (normalize "entry")\n\011\011\011\011\011\011(normalize "entrytbl"))))\n\011 (tgroup    (find-tgroup entry))\n\011 (spanname  (attribute-string (normalize "spanname") entry))\n\011 (calsalign (if (attribute-string (normalize "align") entry)\n\011\011\011(attribute-string (normalize "align") entry)\n\011\011\011(if (and spanname \n\011\011\011\011 (spanspec-align (find-spanspec spanname)))\n\011\011\011    (spanspec-align (find-spanspec spanname))\n\011\011\011    (if (colspec-align (find-colspec-by-number colnum))\n\011\011\011\011(colspec-align (find-colspec-by-number colnum))\n\011\011\011\011(if (tgroup-align tgroup)\n\011\011\011\011    (tgroup-align tgroup)\n\011\011\011\011    (normalize "left")))))))\n    (cond\n     ((equal? calsalign (normalize "left")) 'start)\n     ((equal? calsalign (normalize "center")) 'center)\n     ((equal? calsalign (normalize "right")) 'end)\n     (else 'start))))\n    \n(define (cell-valign cell colnum)\n  (let* ((entry      (ancestor-member cell (list (normalize "entry")\n\011\011\011\011\011\011 (normalize "entrytbl"))))\n\011 (row        (ancestor (normalize "row") entry))\n\011 (tbody      (ancestor-member cell (list (normalize "tbody") \n\011\011\011\011\011\011 (normalize "thead")\n\011\011\011\011\011\011 (normalize "tfoot"))))\n\011 (tgroup     (ancestor (normalize "tgroup") entry))\n\011 (calsvalign (if (attribute-string (normalize "valign") entry)\n\011\011\011 (attribute-string (normalize "valign") entry)\n\011\011\011 (if (attribute-string (normalize "valign") row)\n\011\011\011     (attribute-string (normalize "valign") row)\n\011\011\011     (if (attribute-string (normalize "valign") tbody)\n\011\011\011\011 (attribute-string (normalize "valign") tbody)\n\011\011\011\011 ($cals-valign-default$))))))\n    (cond\n     ((equal? calsvalign (normalize "top")) 'start)\n     ((equal? calsvalign (normalize "middle")) 'center)\n     ((equal? calsvalign (normalize "bottom")) 'end)\n     (else 'start))))\n\n;; ======================================================================\n;; Element rules\n\n(element tgroup\n  (let ((frame-attribute (if (inherited-attribute-string (normalize "frame"))\n\011\011\011     (inherited-attribute-string (normalize "frame"))\n\011\011\011     ($cals-frame-default$))))\n    (make table\n      ;; These values are used for the outer edges (well, the top, bottom\n      ;; and left edges for sure; I think the right edge actually comes\n      ;; from the cells in the last column\n      before-row-border:  (if (cond\n\011\011\011       ((equal? frame-attribute (normalize "all")) #t)\n\011\011\011       ((equal? frame-attribute (normalize "sides")) #f)\n\011\011\011       ((equal? frame-attribute (normalize "top")) #t)\n\011\011\011       ((equal? frame-attribute (normalize "bottom")) #f)\n\011\011\011       ((equal? frame-attribute (normalize "topbot")) #t)\n\011\011\011       ((equal? frame-attribute (normalize "none")) #f)\n\011\011\011       (else #f))\n\011\011\011      calc-table-before-row-border\n\011\011\011      #f)\n      after-row-border:   (if (cond\n\011\011\011       ((equal? frame-attribute (normalize "all")) #t)\n\011\011\011       ((equal? frame-attribute (normalize "sides")) #f)\n\011\011\011       ((equal? frame-attribute (normalize "top")) #f)\n\011\011\011       ((equal? frame-attribute (normalize "bottom")) #t)\n\011\011\011       ((equal? frame-attribute (normalize "topbot")) #t)\n\011\011\011       ((equal? frame-attribute (normalize "none")) #f)\n\011\011\011       (else #f))\n\011\011\011      calc-table-after-row-border\n\011\011\011      #f)\n      before-column-border: (if (cond\n\011\011\011\011 ((equal? frame-attribute (normalize "all")) #t)\n\011\011\011\011 ((equal? frame-attribute (normalize "sides")) #t)\n\011\011\011\011 ((equal? frame-attribute (normalize "top")) #f)\n\011\011\011\011 ((equal? frame-attribute (normalize "bottom")) #f)\n\011\011\011\011 ((equal? frame-attribute (normalize "topbot")) #f)\n\011\011\011\011 ((equal? frame-attribute (normalize "none")) #f)\n\011\011\011\011 (else #f))\n\011\011\011\011calc-table-before-column-border\n\011\011\011\011#f)\n      after-column-border:  (if (cond\n\011\011\011\011 ((equal? frame-attribute (normalize "all")) #t)\n\011\011\011\011 ((equal? frame-attribute (normalize "sides")) #t)\n\011\011\011\011 ((equal? frame-attribute (normalize "top")) #f)\n\011\011\011\011 ((equal? frame-attribute (normalize "bottom")) #f)\n\011\011\011\011 ((equal? frame-attribute (normalize "topbot")) #f)\n\011\011\011\011 ((equal? frame-attribute (normalize "none")) #f)\n\011\011\011\011 (else #f))\n\011\011\011\011calc-table-after-column-border\n\011\011\011\011#f)\n      display-alignment: %cals-display-align%\n      (make table-part\n\011content-map: '((thead header)\n\011\011       (tbody #f)\n\011\011       (tfoot footer))\n\011($process-colspecs$ (current-node))\n\011(process-children)\n\011(make-table-endnotes)))))\n\n(element colspec\n  ;; now handled by $process-colspecs$ at the top of each tgroup...\n  (empty-sosofo))\n\n(element spanspec\n  (empty-sosofo))\n\n(element thead\n  ($process-table-body$ (current-node)))\n\n(element tfoot\n  ($process-table-body$ (current-node)))\n\n(element tbody\n  ($process-table-body$ (current-node)))\n\n(element row\n  (empty-sosofo)) ;; this should never happen, they're processed explicitly\n\n(element entry\n  (empty-sosofo)) ;; this should never happen, they're processed explicitly\n\n;; ======================================================================\n;; Functions that handle processing of table bodies, rows, and cells\n\n(define ($process-colspecs$ tgroup)\n  (let* ((cols (string->number (attribute-string (normalize "cols")))))\n    (let loop ((colnum 1))\n      (if (> colnum cols)\n\011  (empty-sosofo)\n\011  (make sequence\n\011    (let ((colspec (find-colspec-by-number colnum)))\n\011      (if (node-list-empty? colspec)\n\011\011  (make table-column\n\011\011    column-number: colnum\n\011\011    width: (colwidth-unit "1*"))\n\011\011  ($process-colspec$ colspec colnum)))\n\011    (loop (+ colnum 1)))))))\n\n(define ($process-colspec$ colspec colnum)\n  (let* ((colwidth (if (attribute-string (normalize "colwidth") colspec)\n\011\011       (attribute-string (normalize "colwidth") colspec)\n\011\011       "1*")))\n    (make table-column\n      column-number: colnum\n      width: (colwidth-unit colwidth))))\n\n(define ($process-table-body$ body)\n  (let* ((tgroup (ancestor (normalize "tgroup") body))\n\011 (cols   (string->number (attribute-string (normalize "cols") tgroup)))\n\011 (blabel (cond \n\011\011   ((equal? (gi body) (normalize "thead")) 'thead)\n\011\011   ((equal? (gi body) (normalize "tbody")) 'tbody)\n\011\011   ((equal? (gi body) (normalize "tfoot")) 'tfoot))))\n    (make sequence\n      label: blabel\n      (let loop ((rows (select-elements (children body) (normalize "row")))\n\011\011 (overhang (constant-list 0 cols)))\n\011(if (node-list-empty? rows)\n\011    (empty-sosofo)\n\011    (make sequence\n\011      ($process-row$ (node-list-first rows) overhang)\n\011      (loop (node-list-rest rows)\n\011\011    (update-overhang (node-list-first rows) overhang))))))))\n\n(define ($process-row$ row overhang)\n  (let* ((tgroup           (ancestor (normalize "tgroup") row))\n\011 (maxcol           (string->number (attribute-string \n\011\011\011\011\011    (normalize "cols") tgroup)))\n\011 (lastentry        (node-list-last (node-list-filter-out-pis \n\011\011\011\011\011    (children row))))\n\011 (table            (parent tgroup)))\n    ;; there's no point calculating the row or colsep here, each cell\n    ;; specifies it which overrides anything we might say here...\n    (make table-row\n      (let loop ((cells (node-list-filter-out-pis (children row)))\n\011\011 (prevcell (empty-node-list)))\n\011(if (node-list-empty? cells)\n\011    (empty-sosofo)\n\011    (make sequence\n\011      ($process-cell$ (node-list-first cells) prevcell row overhang)\n\011      (loop (node-list-rest cells) (node-list-first cells)))))\n      \n      ;; add any necessary empty cells to the end of the row\n      (let loop ((colnum (+ (cell-column-number lastentry overhang)\n\011\011\011    (hspan lastentry))))\n\011(if (> colnum maxcol)\n\011    (empty-sosofo)\n\011    (make sequence\n\011      ($process-empty-cell$ colnum row)\n\011      (loop (+ colnum 1))))))))\n\n(define ($process-cell$ entry preventry row overhang)\n  (let* ((colnum    (cell-column-number entry overhang))\n\011 (lastcellcolumn (if (node-list-empty? preventry)\n\011\011\011     0\n\011\011\011     (- (+ (cell-column-number preventry overhang)\n\011\011\011\011   (hspan preventry))\n\011\011\011\0111)))\n\011 (lastcolnum (if (> lastcellcolumn 0)\n\011\011\011 (overhang-skip overhang lastcellcolumn)\n\011\011\011 0))\n\011 (font-name (if (have-ancestor? (normalize "thead") entry)\n\011\011\011%title-font-family%\n\011\011\011%body-font-family%))\n\011 (weight    (if (have-ancestor? (normalize "thead") entry)\n\011\011\011'bold\n\011\011\011'medium))\n\011 (align     (cell-align entry colnum)))\n\n    (make sequence\n      ;; This is a little bit complicated.  We want to output empty cells\n      ;; to skip over missing data.  We start count at the column number\n      ;; arrived at by adding 1 to the column number of the previous entry\n      ;; and skipping over any MOREROWS overhanging entrys.  Then for each\n      ;; iteration, we add 1 and skip over any overhanging entrys.\n      (let loop ((count (overhang-skip overhang (+ lastcolnum 1))))\n\011(if (>= count colnum)\n\011    (empty-sosofo)\n\011    (make sequence\n\011      ($process-empty-cell$ count row)\n\011      (loop (overhang-skip overhang (+ count 1))))))\n\n      ;; Now we've output empty cells for any missing entries, so we \n      ;; are ready to output the cell for this entry...\n      (make table-cell \n\011column-number: colnum\n\011n-columns-spanned: (hspan entry)\n\011n-rows-spanned: (vspan entry)\n\n\011cell-row-alignment: (cell-valign entry colnum)\n\n\011cell-after-column-border: (if (cell-colsep entry colnum)\n\011\011\011\011      calc-table-cell-after-column-border\n\011\011\011\011      #f)\n\n\011cell-after-row-border: (if (cell-rowsep entry colnum)\n\011\011\011\011   (if (last-sibling? (parent entry))\n\011\011\011\011       calc-table-head-body-border\n\011\011\011\011       calc-table-cell-after-row-border)\n\011\011\011\011   #f)\n\n\011cell-before-row-margin: %cals-cell-before-row-margin%\n\011cell-after-row-margin: %cals-cell-after-row-margin%\n\011cell-before-column-margin: %cals-cell-before-column-margin%\n\011cell-after-column-margin: %cals-cell-after-column-margin%\n\n\011;; If there is some additional indentation (because we're in a list,\n\011;; for example) make sure that gets passed along, but don't add\n\011;; the normal body-start-indent.\n\011start-indent: (+ (- (inherited-start-indent) %body-start-indent%)\n\011\011\011 %cals-cell-content-start-indent%)\n\011end-indent: %cals-cell-content-end-indent%\n\011(if (equal? (gi entry) (normalize "entrytbl"))\n\011    (make paragraph \n\011      (literal "ENTRYTBL not supported."))\n\011    (make paragraph\n\011      font-family-name: font-name\n\011      font-weight: weight\n\011      quadding: align\n\011      (process-node-list (children entry))))))))\n\n(define (empty-cell-colsep colnum row)\n  (let* ((tgroup    (ancestor (normalize "tgroup") row))\n\011 (table     (parent tgroup))\n\011 (calscolsep \n\011  (if (tgroup-colsep tgroup)\n\011      (tgroup-colsep tgroup)\n\011      (if (attribute-string (normalize "colsep") table)\n\011\011  (attribute-string (normalize "colsep") table)\n\011\011  (if ($cals-colsep-default$ row)\n\011\011      "1"\n\011\011      "0")))))\n    (> (string->number calscolsep) 0)))\n\n;; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n(define (cell-colsep cell colnum)\n  (let* ((entry     (ancestor-member cell (list (normalize "entry") (normalize "entrytbl"))))\n\011 (spanname  (attribute-string (normalize "spanname") entry))\n\011 (tgroup    (find-tgroup entry))\n\011 (table     (parent tgroup))\n\011 (calscolsep \n\011  (if (attribute-string (normalize "colsep") entry)\n\011      (attribute-string (normalize "colsep") entry)\n\011      (if (and spanname \n\011\011       (spanspec-colsep (find-spanspec spanname)))\n\011\011  (spanspec-colsep (find-spanspec spanname))\n\011\011  (if (colspec-colsep (find-colspec-by-number colnum))\n\011\011      (colspec-colsep (find-colspec-by-number colnum))\n\011\011      (if (tgroup-colsep tgroup)\n\011\011\011  (tgroup-colsep tgroup)\n\011\011\011  (if (attribute-string (normalize "colsep") table)\n\011\011\011      (attribute-string (normalize "colsep") table)\n\011\011\011      (if ($cals-colsep-default$ cell)\n\011\011\011\011  "1"\n\011\011\011\011  "0"))))))))\n    (> (string->number calscolsep) 0)))\n\n(define (cell-rowsep cell colnum)\n  (let* ((entry     (ancestor-member cell (list (normalize "entry") \n\011\011\011\011\011\011(normalize "entrytbl"))))\n\011 (spanname  (attribute-string (normalize "spanname") entry))\n\011 (row       (ancestor (normalize "row") entry))\n\011 (tgroup    (find-tgroup entry))\n\011 (table     (parent tgroup))\n\011 (calsrowsep \n\011  (if (attribute-string (normalize "rowsep") entry)\n\011      (attribute-string (normalize "rowsep") entry)\n\011      (if (and spanname (spanspec-rowsep (find-spanspec spanname)))\n\011\011  (spanspec-rowsep (find-spanspec spanname))\n\011\011  (if (colspec-rowsep (find-colspec-by-number colnum))\n\011\011      (colspec-rowsep (find-colspec-by-number colnum))\n\011\011      (if (attribute-string (normalize "rowsep") row)\n\011\011\011  (attribute-string (normalize "rowsep") row)\n\011\011\011  (if (tgroup-rowsep tgroup)\n\011\011\011      (tgroup-rowsep tgroup)\n\011\011\011      (if (attribute-string (normalize "rowsep") table)\n\011\011\011\011  (attribute-string (normalize "rowsep") table)\n\011\011\011\011  (if ($cals-rowsep-default$ cell)\n\011\011\011\011      "1"\n\011\011\011\011      "0")))))))))\n    (> (string->number calsrowsep) 0)))\n\n(define (empty-cell-rowsep colnum row)\n  (let* ((tgroup    (ancestor (normalize "tgroup") row))\n\011 (table     (parent tgroup))\n\011 (calsrowsep \n\011  (if (attribute-string (normalize "rowsep") row)\n\011      (attribute-string (normalize "rowsep") row)\n\011      (if (tgroup-rowsep tgroup)\n\011\011  (tgroup-rowsep tgroup)\n\011\011  (if (attribute-string (normalize "rowsep") table)\n\011\011      (attribute-string (normalize "rowsep") table)\n\011\011      (if ($cals-rowsep-default$ row)\n\011\011\011  "1"\n\011\011\011  "0"))))))\n    (> (string->number calsrowsep) 0)))\n\n;; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n(define ($process-empty-cell$ colnum row)\n  (make table-cell \n    column-number: colnum\n    n-columns-spanned: 1\n    n-rows-spanned: 1\n    cell-after-column-border: (if (empty-cell-colsep colnum row)\n\011\011\011\011  calc-table-cell-after-column-border\n\011\011\011\011  #f)\n    \n    cell-after-row-border: (if (empty-cell-rowsep colnum row)\n\011\011\011       (if (last-sibling? row)\n\011\011\011\011   calc-table-head-body-border\n\011\011\011\011   calc-table-cell-after-row-border)\n\011\011\011       #f)\n    \n    cell-before-row-margin: %cals-cell-before-row-margin%\n    cell-after-row-margin: %cals-cell-after-row-margin%\n    cell-before-column-margin: %cals-cell-before-column-margin%\n    cell-after-column-margin: %cals-cell-after-column-margin%\n    start-indent: %cals-cell-content-start-indent%\n    end-indent: %cals-cell-content-end-indent%\n    (empty-sosofo)))\n\n;; EOF\n   \n;; $Id: dbtitle.dsl,v 1.4 2003/02/17 19:42:45 adicarlo Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n(define title-style\n  (style\n   font-family-name: %title-font-family%\n   font-weight: 'bold\n   quadding: 'start))\n\n;; So we can pass different sosofo's to this routine and get identical\n;; treatment (see REFNAME in dbrfntry.dsl)\n;;\n(define ($lowtitlewithsosofo$ tlevel hlevel sosofo)\n  (let ((hs (HSIZE (- 3 tlevel))))\n    (make paragraph\n\011  font-family-name: %title-font-family%\n\011  font-weight: 'bold\n\011  font-size: hs\n\011  line-spacing: (* hs %line-spacing-factor%)\n\011  space-before: (* hs %head-before-factor%)\n\011  space-after: (* hs %head-after-factor%)\n\011  start-indent: %body-start-indent%\n\011  quadding: 'start\n\011  keep-with-next?: #t\n\011  heading-level: (if %generate-heading-level% hlevel 0)\n\011  sosofo)))\n\n(define ($lowtitle$ tlevel hlevel)\n  ($lowtitlewithsosofo$ tlevel hlevel (process-children)))\n\n(define ($runinhead$)\n  (let* ((title    (data (current-node)))\n\011 (titlelen (string-length title))\n\011 (lastchar (string-ref title (- titlelen 1)))\n\011 (punct    (if (member lastchar %content-title-end-punct%)\n\011\011       ""\n\011\011       %default-title-end-punct%)))\n    (make sequence\n      font-weight: 'bold\n      (process-children-trim)\n      (literal punct " "))))\n\n(element title ($lowtitle$ 2 4))         ;; the default TITLE format\n(element titleabbrev (empty-sosofo))\n(element subtitle (empty-sosofo))\n\n(mode title-mode\n  (element title\n    (process-children)))\n   \n;; $Id: dbttlpg.dsl,v 1.13 2004/10/10 21:15:06 petere78 Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://nwalsh.com/docbook/dsssl/\n;;\n\n(define (have-sibling? sibling-gi #!optional (node (current-node)))\n  (let loop ((nl (children (parent node))))\n    (if (node-list-empty? nl) \n\011#f\n\011(if (equal? (gi (node-list-first nl)) sibling-gi)\n\011    #t\n\011    (loop (node-list-rest nl))))))\n\n(define (titlepage-content? elements gis)\n  (let giloop ((gilist gis))\n    (if (null? gilist)\n\011#f\n\011(if (not (node-list-empty? (node-list-filter-by-gi \n\011\011\011\011    elements \n\011\011\011\011    (list (car gilist)))))\n\011    #t\n\011    (giloop (cdr gilist))))))\n\n(define (titlepage-gi-list-by-elements elements nodelist) \n  ;; Elements is a list of GIs.  Nodelist is a list of nodes.\n  ;; This function returns all of the nodes in nodelist that\n  ;; are in elements in the order they occur in elements.\n  (let loop ((gilist elements) (rlist (empty-node-list)))\n    (if (null? gilist)\n\011rlist\n\011(loop (cdr gilist) \n\011      (node-list rlist (node-list-filter-by-gi \n\011\011\011\011nodelist (list (car gilist))))))))\n\n(define (titlepage-gi-list-by-nodelist elements nodelist) \n  ;; Elements is a list of GIs.  Nodelist is a list of nodes.\n  ;; This function returns all of the nodes in nodelist that\n  ;; are in elements in the order they occur in nodelist.\n  (let loop ((nl nodelist) (rlist (empty-node-list)))\n    (if (node-list-empty? nl)\n\011rlist\n\011(if (member (gi (node-list-first nl)) elements)\n\011    (loop (node-list-rest nl)\n\011\011  (node-list rlist (node-list-first nl)))\n\011    (loop (node-list-rest nl) rlist)))))\n\n(define (titlepage-nodelist elements nodelist)\n  ;; We expand BOOKBIBLIO, BIBLIOMISC, and BIBLIOSET in the element\n  ;; list because that level of wrapper usually isn't significant.\n  (let ((exp-nodelist (expand-children nodelist (list (normalize "bookbiblio") \n\011\011\011\011\011\011      (normalize "bibliomisc")\n\011\011\011\011\011\011      (normalize "biblioset")))))\n    (if %titlepage-in-info-order%\n\011(titlepage-gi-list-by-nodelist elements exp-nodelist)\n\011(titlepage-gi-list-by-elements elements exp-nodelist))))\n\n(mode titlepage-address-mode\n  (default (process-children)))\n\n;; == Title pages for SETs ==============================================\n\n(define (set-titlepage-recto-elements)\n  (list (normalize "title") \n\011(normalize "subtitle") \n\011(normalize "graphic") \n\011(normalize "mediaobject")\n\011(normalize "corpauthor") \n\011(normalize "authorgroup") \n\011(normalize "author") \n\011(normalize "editor")))\n\n(define (set-titlepage-verso-elements)\n  (list (normalize "title") \n\011(normalize "subtitle") \n\011(normalize "corpauthor") \n\011(normalize "authorgroup") \n\011(normalize "author") \n\011(normalize "editor")\n\011(normalize "edition") \n\011(normalize "pubdate") \n\011(normalize "copyright")\n\011(normalize "legalnotice") \n\011(normalize "revhistory")))\n\n(define (set-titlepage-content? elements side)\n  (titlepage-content? elements (if (equal? side 'recto)\n\011\011\011\011   (set-titlepage-recto-elements)\n\011\011\011\011   (set-titlepage-verso-elements))))\n\n(define (set-titlepage elements #!optional (side 'recto))\n  (let ((nodelist (titlepage-nodelist \n\011\011   (if (equal? side 'recto)\n\011\011       (set-titlepage-recto-elements)\n\011\011       (set-titlepage-verso-elements))\n\011\011   elements)))\n;;    (make simple-page-sequence\n;;      page-n-columns: %titlepage-n-columns%\n;;      input-whitespace-treatment: 'collapse\n;;      use: default-text-style\n      (make sequence\n\n      ;; This hack is required for the RTF backend. If an external-graphic\n      ;; is the first thing on the page, RTF doesn't seem to do the right\n      ;; thing (the graphic winds up on the baseline of the first line\n      ;; of the page, left justified).  This "one point rule" fixes\n      ;; that problem.\n      (make paragraph\n\011line-spacing: 1pt\n\011(literal ""))\n\n      (let loop ((nl nodelist) (lastnode (empty-node-list)))\n\011(if (node-list-empty? nl)\n\011    (empty-sosofo)\n\011    (make sequence\n\011      (if (or (node-list-empty? lastnode)\n\011\011      (not (equal? (gi (node-list-first nl))\n\011\011\011\011   (gi lastnode))))\n\011\011  (set-titlepage-before (node-list-first nl) side)\n\011\011  (empty-sosofo))\n\011      (cond\n\011\011((equal? (gi (node-list-first nl)) (normalize "abbrev"))\n\011\011 (set-titlepage-abbrev (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "abstract"))\n\011\011 (set-titlepage-abstract (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "address"))\n\011\011 (set-titlepage-address (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "affiliation"))\n\011\011 (set-titlepage-affiliation (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "artpagenums"))\n\011\011 (set-titlepage-artpagenums (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "author"))\n\011\011 (set-titlepage-author (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "authorblurb"))\n\011\011 (set-titlepage-authorblurb (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "authorgroup"))\n\011\011 (set-titlepage-authorgroup (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "authorinitials"))\n\011\011 (set-titlepage-authorinitials (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "bibliomisc"))\n\011\011 (set-titlepage-bibliomisc (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "biblioset"))\n\011\011 (set-titlepage-biblioset (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "bookbiblio"))\n\011\011 (set-titlepage-bookbiblio (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "citetitle"))\n\011\011 (set-titlepage-citetitle (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "collab"))\n\011\011 (set-titlepage-collab (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "confgroup"))\n\011\011 (set-titlepage-confgroup (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "contractnum"))\n\011\011 (set-titlepage-contractnum (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "contractsponsor"))\n\011\011 (set-titlepage-contractsponsor (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "contrib"))\n\011\011 (set-titlepage-contrib (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "copyright"))\n\011\011 (set-titlepage-copyright (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "corpauthor"))\n\011\011 (set-titlepage-corpauthor (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "corpname"))\n\011\011 (set-titlepage-corpname (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "date"))\n\011\011 (set-titlepage-date (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "edition"))\n\011\011 (set-titlepage-edition (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "editor"))\n\011\011 (set-titlepage-editor (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "firstname"))\n\011\011 (set-titlepage-firstname (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "graphic"))\n\011\011 (set-titlepage-graphic (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "honorific"))\n\011\011 (set-titlepage-honorific (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "indexterm"))\n\011\011 (set-titlepage-indexterm (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "invpartnumber"))\n\011\011 (set-titlepage-invpartnumber (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "isbn"))\n\011\011 (set-titlepage-isbn (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "issn"))\n\011\011 (set-titlepage-issn (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "issuenum"))\n\011\011 (set-titlepage-issuenum (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "itermset"))\n\011\011 (set-titlepage-itermset (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "keywordset"))\n\011\011 (set-titlepage-keywordset (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "legalnotice"))\n\011\011 (set-titlepage-legalnotice (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "lineage"))\n\011\011 (set-titlepage-lineage (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "mediaobject"))\n\011\011 (set-titlepage-mediaobject (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "modespec"))\n\011\011 (set-titlepage-modespec (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "orgname"))\n\011\011 (set-titlepage-orgname (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "othercredit"))\n\011\011 (set-titlepage-othercredit (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "othername"))\n\011\011 (set-titlepage-othername (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "pagenums"))\n\011\011 (set-titlepage-pagenums (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "printhistory"))\n\011\011 (set-titlepage-printhistory (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "productname"))\n\011\011 (set-titlepage-productname (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "productnumber"))\n\011\011 (set-titlepage-productnumber (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "pubdate"))\n\011\011 (set-titlepage-pubdate (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "publisher"))\n\011\011 (set-titlepage-publisher (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "publishername"))\n\011\011 (set-titlepage-publishername (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "pubsnumber"))\n\011\011 (set-titlepage-pubsnumber (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "releaseinfo"))\n\011\011 (set-titlepage-releaseinfo (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "revhistory"))\n\011\011 (set-titlepage-revhistory (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "seriesinfo"))\n\011\011 (set-titlepage-seriesinfo (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "seriesvolnums"))\n\011\011 (set-titlepage-seriesvolnums (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "subjectset"))\n\011\011 (set-titlepage-subjectset (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "subtitle"))\n\011\011 (set-titlepage-subtitle (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "surname"))\n\011\011 (set-titlepage-surname (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "title"))\n\011\011 (set-titlepage-title (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "titleabbrev"))\n\011\011 (set-titlepage-titleabbrev (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "volumenum"))\n\011\011 (set-titlepage-volumenum (node-list-first nl) side))\n\011\011(else\n\011\011 (set-titlepage-default (node-list-first nl) side)))\n\011      (loop (node-list-rest nl) (node-list-first nl))))))))\n\n(define (set-titlepage-before node side)\n  (if (equal? side 'recto)\n      (cond\n       ((equal? (gi node) (normalize "corpauthor"))\n\011(make paragraph\n\011  space-after: (* (HSIZE 5) %head-after-factor% 8)\n\011  (literal "\\no-break-space;")))\n       ((equal? (gi node) (normalize "authorgroup"))\n\011(if (have-sibling? (normalize "corpauthor") node)\n\011    (empty-sosofo)\n\011    (make paragraph\n\011      space-after: (* (HSIZE 5) %head-after-factor% 8)\n\011      (literal "\\no-break-space;"))))\n       ((equal? (gi node) (normalize "author"))\n\011(if (or (have-sibling? (normalize "corpauthor") node) \n\011\011(have-sibling? (normalize "authorgroup") node))\n\011    (empty-sosofo)\n\011    (make paragraph\n\011      space-after: (* (HSIZE 5) %head-after-factor% 8)\n\011      (literal "\\no-break-space;"))))\n       (else (empty-sosofo)))\n      (empty-sosofo)))\n\n(define (set-titlepage-default node side)\n  (let ((foo (debug (string-append "No set-titlepage-* for " (gi node) "!"))))\n    (empty-sosofo)))\n\n(define (set-titlepage-element node side)\n  (if (equal? side 'recto)\n      (with-mode set-titlepage-recto-mode\n\011(process-node-list node))\n      (with-mode set-titlepage-verso-mode\n\011(process-node-list node))))\n\n(define (set-titlepage-abbrev node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-abstract node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-address node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-affiliation node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-artpagenums node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-author node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-authorblurb node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-authorgroup node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-authorinitials node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-bibliomisc node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-biblioset node side)\n  (set-titlepage node side))\n(define (set-titlepage-bookbiblio node side)\n  (set-titlepage node side))\n(define (set-titlepage-citetitle node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-collab node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-confgroup node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-contractnum node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-contractsponsor node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-contrib  node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-copyright node side)\n  (set-titlepage-element node side))\n\n(define (set-titlepage-corpauthor node side)\n  (if (equal? side 'recto)\n      (set-titlepage-element node side)\n      (if (first-sibling? node)\n\011  (make paragraph\n\011    (with-mode set-titlepage-verso-mode\n\011      (process-node-list\n\011       (select-elements (children (parent node))\n\011\011\011\011(normalize "corpauthor")))))\n\011  (empty-sosofo))))\n\n(define (set-titlepage-corpname node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-date node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-edition node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-editor node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-firstname node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-graphic node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-honorific node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-indexterm node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-invpartnumber node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-isbn node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-issn node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-issuenum node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-itermset node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-keywordset node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-legalnotice node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-lineage node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-mediaobject node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-modespec node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-orgname node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-othercredit node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-othername node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-pagenums node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-printhistory node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-productname node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-productnumber node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-pubdate node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-publisher node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-publishername node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-pubsnumber node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-releaseinfo node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-revhistory node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-seriesinfo node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-seriesvolnums node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-subjectset node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-subtitle node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-surname node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-title node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-titleabbrev node side)\n  (set-titlepage-element node side))\n(define (set-titlepage-volumenum node side)\n  (set-titlepage-element node side))\n\n(define set-titlepage-recto-style\n  (style\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      font-size: (HSIZE 1)))\n\n(define set-titlepage-verso-style\n  (style\n      font-family-name: %body-font-family%))\n\n(mode set-titlepage-recto-mode\n  (element abbrev\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element abstract\n    (make display-group\n      use: set-titlepage-recto-style\n      quadding: 'start\n      ($semiformal-object$)))\n\n  (element (abstract title) (empty-sosofo))\n\n  (element (abstract para)\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element address \n    (make display-group\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (with-mode titlepage-address-mode \n\011($linespecific-display$ %indent-address-lines% %number-address-lines%))))\n\n  (element affiliation\n    (make display-group\n      use: set-titlepage-recto-style\n      (process-children)))\n\n  (element artpagenums\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element author\n    (let ((author-name  (author-string))\n\011  (author-affil (select-elements (children (current-node)) \n\011\011\011\011\011 (normalize "affiliation"))))\n      (make sequence      \n\011(make paragraph\n          use: set-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-before: (* (HSIZE 2) %head-before-factor%)\n\011  quadding: %division-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal author-name))\n\011(process-node-list author-affil))))\n\n  (element authorblurb\n    (make display-group\n      use: set-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element (authorblurb para)\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element authorgroup\n    (make display-group\n      (process-children)))\n\n  (element authorinitials\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element bibliomisc (process-children))\n\n  (element bibliomset (process-children))\n\n  (element collab\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element confgroup\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element contractnum\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element contractsponsor\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element contrib\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element copyright\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      space-before: (* (HSIZE 2) %head-before-factor%)\n      (literal (gentext-element-name (current-node)))\n      (literal "\\no-break-space;")\n      (literal (dingbat "copyright"))\n      (literal "\\no-break-space;")\n      (process-children)))\n\n  (element (copyright year)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling? (current-node)))\n\011  (literal ", ")\n\011  (literal " "))))\n  \n  (element (copyright holder) ($charseq$))\n\n  (element corpauthor\n    (make sequence\n      (make paragraph\n\011use: set-titlepage-recto-style\n\011font-size: (HSIZE 3)\n\011line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011space-before: (* (HSIZE 2) %head-before-factor%)\n\011quadding: %division-title-quadding%\n\011keep-with-next?: #t\n\011(process-children))\n      ;; This paragraph is a hack to get the spacing right.\n      ;; Authors always have an affiliation paragraph below them, even if\n      ;; it's empty, so corpauthors need one too.\n      (make paragraph\n\011use: set-titlepage-recto-style\n\011font-size: (HSIZE 1)\n\011line-spacing: (* (HSIZE 1) %line-spacing-factor%)\n\011space-after: (* (HSIZE 2) %head-after-factor% 4)\n\011quadding: %division-title-quadding%\n\011keep-with-next?: #t\n\011(literal "\\no-break-space;"))))\n\n  (element corpname\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element date\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element edition\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)\n      (literal "\\no-break-space;")\n      (literal (gentext-element-name-space (gi (current-node))))))\n\n  (element editor\n    (let ((editor-name (author-string)))\n      (make sequence      \n\011(if (first-sibling?) \n\011    (make paragraph\n\011      use: set-titlepage-recto-style\n\011      font-size: (HSIZE 1)\n\011      line-spacing: (* (HSIZE 1) %line-spacing-factor%)\n\011      space-before: (* (HSIZE 2) %head-before-factor% 6)\n\011      quadding: %division-title-quadding%\n\011      keep-with-next?: #t\n\011      (literal (gentext-edited-by)))\n\011    (empty-sosofo))\n\011(make paragraph\n\011  use: set-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-after: (* (HSIZE 2) %head-after-factor% 4)\n\011  quadding: %division-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal editor-name)))))\n\n  (element firstname\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element graphic\n    (let* ((nd (current-node))\n\011   (fileref (attribute-string "fileref" nd))\n\011   (entityref (attribute-string "entityref" nd))\n\011   (format (attribute-string "format" nd))\n\011   (align (attribute-string "align" nd)))\n      (if (or fileref entityref) \n\011  (make external-graphic\n\011    notation-system-id: (if format format "")\n\011    entity-system-id: (if fileref \n\011\011\011\011  (graphic-file fileref)\n\011\011\011\011  (if entityref \n\011\011\011\011      (entity-generated-system-id entityref)\n\011\011\011\011      ""))\n\011    display?: #t\n\011    display-alignment: 'center)\n\011  (empty-sosofo))))\n\n  (element honorific\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element isbn\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element issn\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element itermset (empty-sosofo))\n\n  (element invpartnumber\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element issuenum\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element jobtitle\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element keywordset\n    (make paragraph\n      quadding: 'start\n      (make sequence\n\011font-weight: 'bold\n\011(literal "Keywords: "))\n      (process-children)))\n\n  (element (keyword)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling?))\n\011  (literal ", ")\n\011  (literal ""))))\n\n  (element legalnotice\n    (make display-group\n      use: set-titlepage-recto-style\n      ($semiformal-object$)))\n\n  (element (legalnotice title) (empty-sosofo))\n\n  (element (legalnotice para)\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: 'start\n      line-spacing: (* 0.8 (inherited-line-spacing))\n      font-size: (* 0.8 (inherited-font-size))\n      (process-children)))\n\n  (element lineage\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element modespec (empty-sosofo))\n\n  (element orgdiv\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element orgname\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element othercredit\n    (let ((author-name  (author-string))\n\011  (author-affil (select-elements (children (current-node)) \n\011\011\011\011\011 (normalize "affiliation"))))\n      (make sequence      \n\011(make paragraph\n          use: set-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-before: (* (HSIZE 2) %head-before-factor%)\n\011  quadding: %division-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal author-name))\n\011(process-node-list author-affil))))\n\n  (element othername\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element pagenums\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element printhistory\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element productname\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element productnumber\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element pubdate\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element publisher\n    (make display-group\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element publishername\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element pubsnumber\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element releaseinfo\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element revhistory\n    (make sequence\n      (make paragraph\n\011use: set-titlepage-recto-style\n\011space-before: (* (HSIZE 3) %head-before-factor%)\n\011space-after: (/ (* (HSIZE 1) %head-before-factor%) 2)\n\011(literal (gentext-element-name (current-node))))\n      (make table\n\011before-row-border: #f\n\011(process-children))))\n  \n  (element (revhistory revision)\n    (let ((revnumber (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "revnumber")))\n\011  (revdate   (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "date")))\n\011  (revauthor (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "authorinitials")))\n\011  (revremark (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revremark")))\n\011  (revdescription (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revdescription"))))\n      (make sequence\n\011(make table-row\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (if (not (node-list-empty? revnumber))\n\011\011(make paragraph\n\011\011  use: set-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-element-name-space (current-node)))\n\011\011  (process-node-list revnumber))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 2\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revdate))\n\011\011(make paragraph\n\011\011  use: set-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (process-node-list revdate))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 3\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revauthor))\n\011\011(make paragraph\n\011\011  use: set-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-revised-by))\n\011\011  (process-node-list revauthor))\n\011\011(empty-sosofo))))\n\011(make table-row\n\011  cell-after-row-border: #f\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 3\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (cond ((not (node-list-empty? revremark))\n\011\011   (make paragraph\n\011\011     use: set-titlepage-recto-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     space-after: (if (last-sibling?) \n\011\011\011\011      0pt\n\011\011\011\011      (/ %block-sep% 2))\n\011\011     (process-node-list revremark)))\n\011\011  ((not (node-list-empty? revdescription))\n\011\011   (make sequence\n\011\011     use: set-titlepage-recto-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     (process-node-list revdescription)))\n\011\011(else (empty-sosofo))))))))\n  \n  (element (revision revnumber) (process-children-trim))\n  (element (revision date) (process-children-trim))\n  (element (revision authorinitials) (process-children-trim))\n  (element (revision revremark) (process-children-trim))\n  (element (revision revdescription) (process-children))\n\n  (element seriesvolnums\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element shortaffil\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element subjectset (empty-sosofo))\n\n  (element subtitle \n    (make paragraph\n      use: set-titlepage-recto-style\n      font-size: (HSIZE 4)\n      line-spacing: (* (HSIZE 4) %line-spacing-factor%)\n      space-before: (* (HSIZE 4) %head-before-factor%)\n      quadding: %division-subtitle-quadding%\n      keep-with-next?: #t\n      (process-children-trim)))\n\n  (element surname\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element title \n    (make paragraph\n      use: set-titlepage-recto-style\n      font-size: (HSIZE 5)\n      line-spacing: (* (HSIZE 5) %line-spacing-factor%)\n      space-before: (* (HSIZE 5) %head-before-factor%)\n      quadding: %division-title-quadding%\n      keep-with-next?: #t\n      heading-level: (if %generate-heading-level% 1 0)\n      (with-mode title-mode\n\011(process-children-trim))))\n\n  (element formalpara ($para-container$))\n  (element (formalpara title) ($runinhead$))\n  (element (formalpara para) (make sequence (process-children)))\n\n  (element titleabbrev (empty-sosofo))\n\n  (element volumenum\n    (make paragraph\n      use: set-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n)\n\n(mode set-titlepage-verso-mode\n  (element abbrev\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element abstract ($semiformal-object$))\n\n  (element (abstract title) (empty-sosofo))\n\n  (element address \n    (make display-group\n      use: set-titlepage-verso-style\n      (with-mode titlepage-address-mode \n\011($linespecific-display$ %indent-address-lines% %number-address-lines%))))\n\n  (element affiliation\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element artpagenums\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element author\n    ;; Print the author name.  Handle the case where there's no AUTHORGROUP\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (not in-group)\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-list-string))))\n\011  (make sequence \n\011    (literal (author-list-string))))))  \n\n  (element authorblurb\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element authorgroup\n    (make paragraph\n      space-after: (* %bf-size% %line-spacing-factor%)\n      (make sequence\n\011(literal (gentext-by))\n\011(literal "\\no-break-space;")\n\011(process-children-trim))))\n\n  (element authorinitials\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element bibliomisc (process-children))\n\n  (element bibliomset (process-children))\n\n  (element collab\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element confgroup\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element contractnum\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element contractsponsor\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element contrib\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element copyright\n    (make paragraph\n      use: set-titlepage-verso-style\n      (literal (gentext-element-name (current-node)))\n      (literal "\\no-break-space;")\n      (literal (dingbat "copyright"))\n      (literal "\\no-break-space;")\n      (process-children)))\n\n  (element (copyright year)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling? (current-node)))\n\011  (literal ", ")\n\011  (literal " "))))\n\n  (element (copyright holder) ($charseq$))\n\n  (element corpauthor\n    ;; note: set-titlepage-corpauthor takes care of wrapping multiple\n    ;; corpauthors\n    (make sequence\n      (if (first-sibling?)\n\011  (if (equal? (gi (parent (current-node))) (normalize "authorgroup"))\n\011      (empty-sosofo)\n\011      (literal (gentext-by) " "))\n\011  (literal ", "))\n      (process-children)))\n\n  (element corpname\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element date\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element edition\n    (make paragraph\n      (process-children)\n      (literal "\\no-break-space;")\n      (literal (gentext-element-name-space (gi (current-node))))))\n\n  (element editor\n    ;; Print the editor name.\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (or #t (not in-group)) ; nevermind, always put out the Edited by\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-edited-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-string))))\n\011  (make sequence \n\011    (literal (author-string))))))\n\n  (element firstname\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element graphic\n    (let* ((nd (current-node))\n\011   (fileref (attribute-string "fileref" nd))\n\011   (entityref (attribute-string "entityref" nd))\n\011   (format (attribute-string "format" nd))\n\011   (align (attribute-string "align" nd)))\n      (if (or fileref entityref) \n\011  (make external-graphic\n\011    notation-system-id: (if format format "")\n\011    entity-system-id: (if fileref \n\011\011\011\011  (graphic-file fileref)\n\011\011\011\011  (if entityref \n\011\011\011\011      (entity-generated-system-id entityref)\n\011\011\011\011      ""))\n\011    display?: #t\n\011    display-alignment: 'start)\n\011  (empty-sosofo))))\n\n  (element honorific\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element isbn\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element issn\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element itermset (empty-sosofo))\n\n  (element invpartnumber\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element issuenum\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element jobtitle\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element keywordset\n    (make paragraph\n      quadding: 'start\n      (make sequence\n\011font-weight: 'bold\n\011(literal "Keywords: "))\n      (process-children)))\n\n  (element (keyword)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling?))\n\011  (literal ", ")\n\011  (literal ""))))\n\n  (element legalnotice\n    (make display-group\n      use: set-titlepage-verso-style\n      ($semiformal-object$)))\n\n  (element (legalnotice title) (empty-sosofo))\n\n  (element (legalnotice para) \n    (make paragraph\n      use: set-titlepage-verso-style\n      font-size: (* (inherited-font-size) 0.8)\n      (process-children-trim)))\n\n  (element lineage\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element modespec (empty-sosofo))\n\n  (element orgdiv\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element orgname\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element othercredit\n    ;; Print the author name.  Handle the case where there's no AUTHORGROUP\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (not in-group)\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-list-string))))\n\011  (make sequence \n\011    (literal (author-list-string))))))  \n\n  (element othername\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element pagenums\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element printhistory\n    (make display-group\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element productname\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element productnumber\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element pubdate\n    (make paragraph\n      (literal (gentext-element-name-space (gi (current-node))))\n      (process-children)))\n\n  (element publisher\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element publishername\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element pubsnumber\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element releaseinfo\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element revhistory\n    (make sequence\n      (make paragraph\n\011use: set-titlepage-verso-style\n\011space-before: (* (HSIZE 3) %head-before-factor%)\n\011space-after: (/ (* (HSIZE 1) %head-before-factor%) 2)\n\011(literal (gentext-element-name (current-node))))\n      (make table\n\011before-row-border: #f\n\011(process-children))))\n  \n  (element (revhistory revision)\n    (let ((revnumber (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "revnumber")))\n\011  (revdate   (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "date")))\n\011  (revauthor (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "authorinitials")))\n\011  (revremark (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revremark")))\n\011  (revdescription (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revdescription"))))\n      (make sequence\n\011(make table-row\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (if (not (node-list-empty? revnumber))\n\011\011(make paragraph\n\011\011  use: set-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-element-name-space (current-node)))\n\011\011  (process-node-list revnumber))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 2\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revdate))\n\011\011(make paragraph\n\011\011  use: set-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (process-node-list revdate))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 3\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revauthor))\n\011\011(make paragraph\n\011\011  use: set-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-revised-by))\n\011\011  (process-node-list revauthor))\n\011\011(empty-sosofo))))\n\011(make table-row\n\011  cell-after-row-border: #f\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 3\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (cond ((not (node-list-empty? revremark))\n\011\011   (make paragraph\n\011\011     use: set-titlepage-verso-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     space-after: (if (last-sibling?) \n\011\011\011\011      0pt\n\011\011\011\011      (/ %block-sep% 2))\n\011\011     ;(process-node-list revremark)))\n\011\011     (empty-sosofo)))\n\011\011  ((not (node-list-empty? revdescription))\n\011\011   (make sequence\n\011\011     use: set-titlepage-verso-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     (process-node-list revdescription)))\n\011\011(else (empty-sosofo))))))))\n  \n  (element (revision revnumber) (process-children-trim))\n  (element (revision date) (process-children-trim))\n  (element (revision authorinitials) (process-children-trim))\n  (element (revision revremark) (process-children-trim))\n  (element (revision revdescription) (process-children))\n\n  (element seriesvolnums\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element shortaffil\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element subjectset (empty-sosofo))\n\n  (element subtitle\n    (make sequence\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      (literal (if (first-sibling?) ": " "; "))\n      (process-children)))\n\n  (element surname\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n  (element title\n    (make sequence\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      (with-mode title-mode\n\011(process-children))))\n\n  (element formalpara ($para-container$))\n  (element (formalpara title) ($runinhead$))\n  (element (formalpara para) (make sequence (process-children)))\n\n  (element titleabbrev (empty-sosofo))\n\n  (element volumenum\n    (make paragraph\n      use: set-titlepage-verso-style\n      (process-children)))\n\n)\n\n;; == Title pages for BOOKs =============================================\n\n(define (book-titlepage-recto-elements)\n  (list (normalize "title") \n\011(normalize "subtitle") \n\011(normalize "graphic") \n\011(normalize "mediaobject")\n\011(normalize "corpauthor") \n\011(normalize "authorgroup") \n\011(normalize "author") \n\011(normalize "editor")))\n\n(define (book-titlepage-verso-elements)\n  (list (normalize "title") \n\011(normalize "subtitle") \n\011(normalize "corpauthor") \n\011(normalize "authorgroup") \n\011(normalize "author") \n\011(normalize "editor")\n\011(normalize "edition") \n\011(normalize "pubdate") \n\011(normalize "copyright")\n\011(normalize "abstract") \n\011(normalize "legalnotice") \n\011(normalize "revhistory")))\n\n(define (book-titlepage-content? elements side)\n  (titlepage-content? elements (if (equal? side 'recto)\n\011\011\011\011   (book-titlepage-recto-elements)\n\011\011\011\011   (book-titlepage-verso-elements))))\n\n(define (book-titlepage elements #!optional (side 'recto))\n  (let ((nodelist (titlepage-nodelist \n\011\011   (if (equal? side 'recto)\n\011\011       (book-titlepage-recto-elements)\n\011\011       (book-titlepage-verso-elements))\n\011\011   elements)))\n;;    (make simple-page-sequence\n;;      page-n-columns: %titlepage-n-columns%\n;;      input-whitespace-treatment: 'collapse\n;;      use: default-text-style\n      (make sequence\n\n      ;; This hack is required for the RTF backend. If an external-graphic\n      ;; is the first thing on the page, RTF doesn't seem to do the right\n      ;; thing (the graphic winds up on the baseline of the first line\n      ;; of the page, left justified).  This "one point rule" fixes\n      ;; that problem.\n      (make paragraph\n\011line-spacing: 1pt\n\011(literal ""))\n      \n      (let loop ((nl nodelist) (lastnode (empty-node-list)))\n\011(if (node-list-empty? nl)\n\011    (empty-sosofo)\n\011    (make sequence\n\011      (if (or (node-list-empty? lastnode)\n\011\011      (not (equal? (gi (node-list-first nl))\n\011\011\011\011   (gi lastnode))))\n\011\011  (book-titlepage-before (node-list-first nl) side)\n\011\011  (empty-sosofo))\n\011      (cond\n\011\011((equal? (gi (node-list-first nl)) (normalize "abbrev"))\n\011\011 (book-titlepage-abbrev (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "abstract"))\n\011\011 (book-titlepage-abstract (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "address"))\n\011\011 (book-titlepage-address (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "affiliation"))\n\011\011 (book-titlepage-affiliation (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "artpagenums"))\n\011\011 (book-titlepage-artpagenums (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "author"))\n\011\011 (book-titlepage-author (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "authorblurb"))\n\011\011 (book-titlepage-authorblurb (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "authorgroup"))\n\011\011 (book-titlepage-authorgroup (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "authorinitials"))\n\011\011 (book-titlepage-authorinitials (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "bibliomisc"))\n\011\011 (book-titlepage-bibliomisc (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "biblioset"))\n\011\011 (book-titlepage-biblioset (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "bookbiblio"))\n\011\011 (book-titlepage-bookbiblio (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "citetitle"))\n\011\011 (book-titlepage-citetitle (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "collab"))\n\011\011 (book-titlepage-collab (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "confgroup"))\n\011\011 (book-titlepage-confgroup (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "contractnum"))\n\011\011 (book-titlepage-contractnum (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "contractsponsor"))\n\011\011 (book-titlepage-contractsponsor (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "contrib"))\n\011\011 (book-titlepage-contrib (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "copyright"))\n\011\011 (book-titlepage-copyright (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "corpauthor"))\n\011\011 (book-titlepage-corpauthor (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "corpname"))\n\011\011 (book-titlepage-corpname (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "date"))\n\011\011 (book-titlepage-date (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "edition"))\n\011\011 (book-titlepage-edition (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "editor"))\n\011\011 (book-titlepage-editor (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "firstname"))\n\011\011 (book-titlepage-firstname (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "graphic"))\n\011\011 (book-titlepage-graphic (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "honorific"))\n\011\011 (book-titlepage-honorific (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "indexterm"))\n\011\011 (book-titlepage-indexterm (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "invpartnumber"))\n\011\011 (book-titlepage-invpartnumber (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "isbn"))\n\011\011 (book-titlepage-isbn (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "issn"))\n\011\011 (book-titlepage-issn (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "issuenum"))\n\011\011 (book-titlepage-issuenum (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "itermset"))\n\011\011 (book-titlepage-itermset (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "keywordset"))\n\011\011 (book-titlepage-keywordset (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "legalnotice"))\n\011\011 (book-titlepage-legalnotice (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "lineage"))\n\011\011 (book-titlepage-lineage (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "mediaobject"))\n\011\011 (book-titlepage-mediaobject (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "modespec"))\n\011\011 (book-titlepage-modespec (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "orgname"))\n\011\011 (book-titlepage-orgname (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "othercredit"))\n\011\011 (book-titlepage-othercredit (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "othername"))\n\011\011 (book-titlepage-othername (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "pagenums"))\n\011\011 (book-titlepage-pagenums (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "printhistory"))\n\011\011 (book-titlepage-printhistory (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "productname"))\n\011\011 (book-titlepage-productname (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "productnumber"))\n\011\011 (book-titlepage-productnumber (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "pubdate"))\n\011\011 (book-titlepage-pubdate (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "publisher"))\n\011\011 (book-titlepage-publisher (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "publishername"))\n\011\011 (book-titlepage-publishername (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "pubsnumber"))\n\011\011 (book-titlepage-pubsnumber (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "releaseinfo"))\n\011\011 (book-titlepage-releaseinfo (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "revhistory"))\n\011\011 (book-titlepage-revhistory (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "seriesinfo"))\n\011\011 (book-titlepage-seriesinfo (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "seriesvolnums"))\n\011\011 (book-titlepage-seriesvolnums (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "subjectset"))\n\011\011 (book-titlepage-subjectset (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "subtitle"))\n\011\011 (book-titlepage-subtitle (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "surname"))\n\011\011 (book-titlepage-surname (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "title"))\n\011\011 (book-titlepage-title (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "titleabbrev"))\n\011\011 (book-titlepage-titleabbrev (node-list-first nl) side))\n\011\011((equal? (gi (node-list-first nl)) (normalize "volumenum"))\n\011\011 (book-titlepage-volumenum (node-list-first nl) side))\n\011\011(else\n\011\011 (book-titlepage-default (node-list-first nl) side)))\n\011      (loop (node-list-rest nl) (node-list-first nl))))))))\n\n(define (book-titlepage-before node side)\n  (if (equal? side 'recto)\n      (cond\n       ((equal? (gi node) (normalize "corpauthor"))\n\011(make paragraph\n\011  space-after: (* (HSIZE 5) %head-after-factor% 8)\n\011  (literal "\\no-break-space;")))\n       ((equal? (gi node) (normalize "authorgroup"))\n\011(if (have-sibling? (normalize "corpauthor") node)\n\011    (empty-sosofo)\n\011    (make paragraph\n\011      space-after: (* (HSIZE 5) %head-after-factor% 8)\n\011      (literal "\\no-break-space;"))))\n       ((equal? (gi node) (normalize "author"))\n\011(if (or (have-sibling? (normalize "corpauthor") node) \n\011\011(have-sibling? (normalize "authorgroup") node))\n\011    (empty-sosofo)\n\011    (make paragraph\n\011      space-after: (* (HSIZE 5) %head-after-factor% 8)\n\011      (literal "\\no-break-space;"))))\n       (else (empty-sosofo)))\n      (empty-sosofo)))\n\n(define (book-titlepage-default node side)\n  (let ((foo (debug (string-append "No book-titlepage-* for " (gi node) "!"))))\n    (empty-sosofo)))\n\n(define (book-titlepage-element node side)\n  (if (equal? side 'recto)\n      (with-mode book-titlepage-recto-mode\n\011(process-node-list node))\n      (with-mode book-titlepage-verso-mode\n\011(process-node-list node))))\n\n(define (book-titlepage-abbrev node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-abstract node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-address node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-affiliation node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-artpagenums node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-author node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-authorblurb node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-authorgroup node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-authorinitials node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-bibliomisc node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-biblioset node side)\n  (book-titlepage node side))\n(define (book-titlepage-bookbiblio node side)\n  (book-titlepage node side))\n(define (book-titlepage-citetitle node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-collab node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-confgroup node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-contractnum node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-contractsponsor node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-contrib  node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-copyright node side)\n  (book-titlepage-element node side))\n\n(define (book-titlepage-corpauthor node side)\n  (if (equal? side 'recto)\n      (book-titlepage-element node side)\n      (if (first-sibling? node)\n\011  (make paragraph\n\011    (with-mode book-titlepage-verso-mode\n\011      (process-node-list\n\011       (select-elements (children (parent node)) \n\011\011\011\011(normalize "corpauthor")))))\n\011  (empty-sosofo))))\n\n(define (book-titlepage-corpname node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-date node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-edition node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-editor node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-firstname node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-graphic node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-honorific node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-indexterm node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-invpartnumber node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-isbn node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-issn node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-issuenum node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-itermset node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-keywordset node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-legalnotice node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-lineage node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-mediaobject node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-modespec node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-orgname node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-othercredit node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-othername node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-pagenums node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-printhistory node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-productname node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-productnumber node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-pubdate node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-publisher node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-publishername node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-pubsnumber node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-releaseinfo node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-revhistory node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-seriesinfo node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-seriesvolnums node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-subjectset node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-subtitle node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-surname node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-title node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-titleabbrev node side)\n  (book-titlepage-element node side))\n(define (book-titlepage-volumenum node side)\n  (book-titlepage-element node side))\n\n(define book-titlepage-recto-style\n  (style\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      font-size: (HSIZE 1)))\n\n(define book-titlepage-verso-style\n  (style\n      font-family-name: %body-font-family%))\n\n(mode book-titlepage-recto-mode\n  (element abbrev\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element abstract\n    (make display-group\n      use: book-titlepage-recto-style\n      quadding: 'start\n      ($semiformal-object$)))\n\n  (element (abstract title) (empty-sosofo))\n\n  (element (abstract para)\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element address \n    (make display-group\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (with-mode titlepage-address-mode \n\011($linespecific-display$ %indent-address-lines% %number-address-lines%))))\n\n  (element affiliation\n    (make display-group\n      use: book-titlepage-recto-style\n      (process-children)))\n\n  (element artpagenums\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element author\n    (let ((author-name  (author-string))\n\011  (author-affil (select-elements (children (current-node)) \n\011\011\011\011\011 (normalize "affiliation"))))\n      (make sequence      \n\011(make paragraph\n\011  use: book-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-before: (* (HSIZE 2) %head-before-factor%)\n\011  quadding: %division-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal author-name))\n\011(process-node-list author-affil))))\n\n  (element authorblurb\n    (make display-group\n      use: book-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element (authorblurb para)\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element authorgroup\n    (make display-group\n      (process-children)))\n\n  (element authorinitials\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element bibliomisc (process-children))\n\n  (element bibliomset (process-children))\n\n  (element collab\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element confgroup\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element contractnum\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element contractsponsor\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element contrib\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element copyright\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      space-before: (* (HSIZE 2) %head-before-factor%)\n      (literal (gentext-element-name (current-node)))\n      (literal "\\no-break-space;")\n      (literal (dingbat "copyright"))\n      (literal "\\no-break-space;")\n      (process-children)))\n\n  (element (copyright year)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling? (current-node)))\n\011  (literal ", ")\n\011  (literal " "))))\n\n  (element (copyright holder) ($charseq$))\n\n  (element corpauthor\n    (make sequence\n      (make paragraph\n\011use: book-titlepage-recto-style\n\011font-size: (HSIZE 3)\n\011line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011space-before: (* (HSIZE 2) %head-before-factor%)\n\011quadding: %division-title-quadding%\n\011keep-with-next?: #t\n\011(process-children))\n      ;; This paragraph is a hack to get the spacing right.\n      ;; Authors always have an affiliation paragraph below them, even if\n      ;; it's empty, so corpauthors need one too.\n      (make paragraph\n\011use: book-titlepage-recto-style\n\011font-size: (HSIZE 1)\n\011line-spacing: (* (HSIZE 1) %line-spacing-factor%)\n\011space-after: (* (HSIZE 2) %head-after-factor% 4)\n\011quadding: %division-title-quadding%\n\011keep-with-next?: #t\n\011(literal "\\no-break-space;"))))\n\n  (element corpname\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element date\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element edition\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)\n      (literal "\\no-break-space;")\n      (literal (gentext-element-name-space (gi (current-node))))))\n\n  (element editor\n    (let ((editor-name (author-string)))\n      (make sequence      \n\011(if (first-sibling?) \n\011    (make paragraph\n\011      use: book-titlepage-recto-style\n\011      font-size: (HSIZE 1)\n\011      line-spacing: (* (HSIZE 1) %line-spacing-factor%)\n\011      space-before: (* (HSIZE 2) %head-before-factor% 6)\n\011      quadding: %division-title-quadding%\n\011      keep-with-next?: #t\n\011      (literal (gentext-edited-by)))\n\011    (empty-sosofo))\n\011(make paragraph\n\011  use: book-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-after: (* (HSIZE 2) %head-after-factor% 4)\n\011  quadding: %division-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal editor-name)))))\n\n  (element firstname\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element graphic\n    (let* ((nd (current-node))\n\011   (fileref (attribute-string "fileref" nd))\n\011   (entityref (attribute-string "entityref" nd))\n\011   (format (attribute-string "format" nd))\n\011   (align (attribute-string "align" nd)))\n      (if (or fileref entityref) \n\011  (make external-graphic\n\011    notation-system-id: (if format format "")\n\011    entity-system-id: (if fileref \n\011\011\011\011  (graphic-file fileref)\n\011\011\011\011  (if entityref \n\011\011\011\011      (entity-generated-system-id entityref)\n\011\011\011\011      ""))\n\011    display?: #t\n\011    display-alignment: 'center)\n\011  (empty-sosofo))))\n\n  (element honorific\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element isbn\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element issn\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element itermset (empty-sosofo))\n\n  (element invpartnumber\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element issuenum\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element jobtitle\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element keywordset\n    (make paragraph\n      quadding: 'start\n      (make sequence\n\011font-weight: 'bold\n\011(literal "Keywords: "))\n      (process-children)))\n\n  (element (keyword)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling?))\n\011  (literal ", ")\n\011  (literal ""))))\n\n  (element legalnotice\n    (make display-group\n      use: book-titlepage-recto-style\n      ($semiformal-object$)))\n\n  (element (legalnotice title) (empty-sosofo))\n\n  (element (legalnotice para)\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: 'start\n      line-spacing: (* 0.8 (inherited-line-spacing))\n      font-size: (* 0.8 (inherited-font-size))\n      (process-children)))\n\n  (element lineage\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element modespec (empty-sosofo))\n\n  (element orgdiv\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element orgname\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element othercredit\n    (let ((author-name  (author-string))\n\011  (author-affil (select-elements (children (current-node)) \n\011\011\011\011\011 (normalize "affiliation"))))\n      (make sequence      \n\011(make paragraph\n\011  use: book-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-before: (* (HSIZE 2) %head-before-factor%)\n\011  quadding: %division-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal author-name))\n\011(process-node-list author-affil))))\n\n  (element othername\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element pagenums\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element printhistory\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element productname\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element productnumber\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element pubdate\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element publisher\n    (make display-group\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element publishername\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element pubsnumber\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element releaseinfo\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element revhistory\n    (make sequence\n      (make paragraph\n\011use: book-titlepage-recto-style\n\011space-before: (* (HSIZE 3) %head-before-factor%)\n\011space-after: (/ (* (HSIZE 1) %head-before-factor%) 2)\n\011(literal (gentext-element-name (current-node))))\n      (make table\n\011before-row-border: #f\n\011(process-children))))\n  \n  (element (revhistory revision)\n    (let ((revnumber (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "revnumber")))\n\011  (revdate   (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "date")))\n\011  (revauthor (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "authorinitials")))\n\011  (revremark (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revremark")))\n\011  (revdescription (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revdescription"))))\n      (make sequence\n\011(make table-row\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (if (not (node-list-empty? revnumber))\n\011\011(make paragraph\n\011\011  use: book-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-element-name-space (current-node)))\n\011\011  (process-node-list revnumber))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 2\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revdate))\n\011\011(make paragraph\n\011\011  use: book-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (process-node-list revdate))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 3\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revauthor))\n\011\011(make paragraph\n\011\011  use: book-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-revised-by))\n\011\011  (process-node-list revauthor))\n\011\011(empty-sosofo))))\n\011(make table-row\n\011  cell-after-row-border: #f\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 3\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (cond ((not (node-list-empty? revremark))\n\011\011   (make paragraph\n\011\011     use: book-titlepage-recto-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     space-after: (if (last-sibling?) \n\011\011\011\011      0pt\n\011\011\011\011      (/ %block-sep% 2))\n\011\011     (process-node-list revremark)))\n\011\011  ((not (node-list-empty? revdescription))\n\011\011   (make sequence\n\011\011     use: book-titlepage-recto-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     (process-node-list revremark)))\n\011\011  (else (empty-sosofo))))))))\n  \n  (element (revision revnumber) (process-children-trim))\n  (element (revision date) (process-children-trim))\n  (element (revision authorinitials) (process-children-trim))\n  (element (revision revremark) (process-children-trim))\n  (element (revision revdescription) (process-children))\n\n  (element seriesvolnums\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element shortaffil\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element subjectset (empty-sosofo))\n\n  (element subtitle \n    (make paragraph\n      use: book-titlepage-recto-style\n      font-size: (HSIZE 4)\n      line-spacing: (* (HSIZE 4) %line-spacing-factor%)\n      space-before: (* (HSIZE 4) %head-before-factor%)\n      quadding: %division-subtitle-quadding%\n      keep-with-next?: #t\n      (process-children-trim)))\n\n  (element surname\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element title \n    (make paragraph\n      use: book-titlepage-recto-style\n      font-size: (HSIZE 5)\n      line-spacing: (* (HSIZE 5) %line-spacing-factor%)\n      space-before: (* (HSIZE 5) %head-before-factor%)\n      quadding: %division-title-quadding%\n      keep-with-next?: #t\n      heading-level: (if %generate-heading-level% 1 0)\n      (with-mode title-mode\n\011(process-children-trim))))\n\n  (element formalpara ($para-container$))\n  (element (formalpara title) ($runinhead$))\n  (element (formalpara para) (make sequence (process-children)))\n\n  (element titleabbrev (empty-sosofo))\n\n  (element volumenum\n    (make paragraph\n      use: book-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n)\n\n(mode book-titlepage-verso-mode\n  (element abbrev\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element abstract ($semiformal-object$))\n\n  (element (abstract title) (empty-sosofo))\n\n  (element address \n    (make display-group\n      use: book-titlepage-verso-style\n      (with-mode titlepage-address-mode \n\011($linespecific-display$ %indent-address-lines% %number-address-lines%))))\n\n  (element affiliation\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element artpagenums\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element author\n    ;; Print the author name.  Handle the case where there's no AUTHORGROUP\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (not in-group)\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-list-string))))\n\011  (make sequence \n\011    (literal (author-list-string))))))  \n\n  (element authorblurb\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element authorgroup\n    (let* ((editors (select-elements (children (current-node)) (normalize "editor"))))\n      (make paragraph\n\011space-after: (* %bf-size% %line-spacing-factor%)\n\011(make sequence\n\011  (if (node-list-empty? editors)\n\011      (literal (gentext-by))\n\011      (literal (gentext-edited-by)))\n\011  (literal "\\no-break-space;")\n\011  (process-children-trim)))))\n\n  (element authorinitials\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element bibliomisc (process-children))\n\n  (element bibliomset (process-children))\n\n  (element collab\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element confgroup\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element contractnum\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element contractsponsor\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element contrib\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element copyright\n    (make paragraph\n      use: book-titlepage-verso-style\n      (literal (gentext-element-name (current-node)))\n      (literal "\\no-break-space;")\n      (literal (dingbat "copyright"))\n      (literal "\\no-break-space;")\n      (process-children)))\n\n  (element (copyright year)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling? (current-node)))\n\011  (literal ", ")\n\011  (literal " "))))\n\n  (element (copyright holder) ($charseq$))\n\n  (element corpauthor\n    ;; note: book-titlepage-corpauthor takes care of wrapping multiple\n    ;; corpauthors\n    (make sequence\n      (if (first-sibling?)\n\011  (if (equal? (gi (parent (current-node))) (normalize "authorgroup"))\n\011      (empty-sosofo)\n\011      (literal (gentext-by) " "))\n\011  (literal ", "))\n      (process-children)))\n\n  (element corpname\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element date\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element edition\n    (make paragraph\n      (process-children)\n      (literal "\\no-break-space;")\n      (literal (gentext-element-name-space (gi (current-node))))))\n\n  (element editor\n    ;; Print the editor name.\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (or #f (not in-group)) ; nevermind, always put out the Edited by\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-edited-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-string))))\n\011  (make sequence\n\011    (literal (author-list-string))))))\n\n  (element firstname\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element graphic\n    (let* ((nd (current-node))\n\011   (fileref (attribute-string "fileref" nd))\n\011   (entityref (attribute-string "entityref" nd))\n\011   (format (attribute-string "format" nd))\n\011   (align (attribute-string "align" nd)))\n      (if (or fileref entityref) \n\011  (make external-graphic\n\011    notation-system-id: (if format format "")\n\011    entity-system-id: (if fileref \n\011\011\011\011  (graphic-file fileref)\n\011\011\011\011  (if entityref \n\011\011\011\011      (entity-generated-system-id entityref)\n\011\011\011\011      ""))\n\011    display?: #t\n\011    display-alignment: 'start)\n\011  (empty-sosofo))))\n\n  (element honorific\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element isbn\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element issn\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element itermset (empty-sosofo))\n\n  (element invpartnumber\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element issuenum\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element jobtitle\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element keywordset\n    (make paragraph\n      quadding: 'start\n      (make sequence\n\011font-weight: 'bold\n\011(literal "Keywords: "))\n      (process-children)))\n\n  (element (keyword)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling?))\n\011  (literal ", ")\n\011  (literal ""))))\n\n  (element legalnotice\n    (make display-group\n      use: book-titlepage-verso-style\n      ($semiformal-object$)))\n\n  (element (legalnotice title) (empty-sosofo))\n\n  (element (legalnotice para) \n    (make paragraph\n      use: book-titlepage-verso-style\n      font-size: (* (inherited-font-size) 0.8)\n      (process-children-trim)))\n\n  (element lineage\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element modespec (empty-sosofo))\n\n  (element orgdiv\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element orgname\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element othercredit\n    ;; Print the author name.  Handle the case where there's no AUTHORGROUP\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (not in-group)\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-list-string))))\n\011  (make sequence \n\011    (literal (author-list-string))))))  \n\n  (element othername\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element pagenums\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element printhistory\n    (make display-group\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element productname\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element productnumber\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element pubdate\n    (make paragraph\n      (literal (gentext-element-name-space (gi (current-node))))\n      (process-children)))\n\n  (element publisher\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element publishername\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element pubsnumber\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element releaseinfo\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element revhistory\n    (make sequence\n      (make paragraph\n\011use: book-titlepage-verso-style\n\011space-before: (* (HSIZE 3) %head-before-factor%)\n\011space-after: (/ (* (HSIZE 1) %head-before-factor%) 2)\n\011(literal (gentext-element-name (current-node))))\n      (make table\n\011before-row-border: #f\n\011(process-children))))\n  \n  (element (revhistory revision)\n    (let ((revnumber (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "revnumber")))\n\011  (revdate   (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "date")))\n\011  (revauthor (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "authorinitials")))\n\011  (revremark (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revremark")))\n\011  (revdescription (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revdescription"))))\n      (make sequence\n\011(make table-row\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (if (not (node-list-empty? revnumber))\n\011\011(make paragraph\n\011\011  use: book-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-element-name-space (current-node)))\n\011\011  (process-node-list revnumber))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 2\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revdate))\n\011\011(make paragraph\n\011\011  use: book-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (process-node-list revdate))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 3\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revauthor))\n\011\011(make paragraph\n\011\011  use: book-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-revised-by))\n\011\011  (process-node-list revauthor))\n\011\011(empty-sosofo))))\n\011(make table-row\n\011  cell-after-row-border: #f\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 3\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (cond ((not (node-list-empty? revremark))\n\011\011   (make paragraph\n\011\011     use: book-titlepage-verso-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     space-after: (if (last-sibling?) \n\011\011\011\011      0pt\n\011\011\011\011      (/ %block-sep% 2))\n\011\011     (process-node-list revremark)))\n\011\011  ((not (node-list-empty? revdescription))\n\011\011   (make sequence\n\011\011     use: book-titlepage-verso-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     (process-node-list revdescription)))\n\011\011(else (empty-sosofo)))))))) \n  \n  (element (revision revnumber) (process-children-trim))\n  (element (revision date) (process-children-trim))\n  (element (revision authorinitials) (process-children-trim))\n  (element (revision revremark) (process-children-trim))\n  (element (revision revdescription) (process-children))\n\n  (element seriesvolnums\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element shortaffil\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element subjectset (empty-sosofo))\n\n  (element subtitle\n    (make sequence\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      (literal (if (first-sibling?) ": " "; "))\n      (process-children)))\n\n  (element surname\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n\n  (element title\n    (make sequence\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      (with-mode title-mode\n\011(process-children))))\n\n  (element formalpara ($para-container$))\n  (element (formalpara title) ($runinhead$))\n  (element (formalpara para) (make sequence (process-children)))\n\n  (element titleabbrev (empty-sosofo))\n\n  (element volumenum\n    (make paragraph\n      use: book-titlepage-verso-style\n      (process-children)))\n)\n\n;; == Title pages for PARTs =============================================\n\n(define (part-titlepage-recto-elements)\n  (list (normalize "title")\n\011(normalize "subtitle")))\n\n(define (part-titlepage-verso-elements)\n  '())\n\n(define (part-titlepage-content? elements side)\n  (titlepage-content? elements (if (equal? side 'recto)\n\011\011\011\011   (part-titlepage-recto-elements)\n\011\011\011\011   (part-titlepage-verso-elements))))\n\n(define (part-titlepage elements #!optional (side 'recto))\n  (let ((nodelist (titlepage-nodelist \n\011\011   (if (equal? side 'recto)\n\011\011       (part-titlepage-recto-elements)\n\011\011       (part-titlepage-verso-elements))\n\011\011   elements))\n        ;; partintro is a special case...\n\011(partintro (node-list-first\n\011\011    (node-list-filter-by-gi elements (list (normalize "partintro"))))))\n    (if (part-titlepage-content? elements side)\n;;\011(make simple-page-sequence\n;;\011  page-n-columns: %titlepage-n-columns%\n;;\011  input-whitespace-treatment: 'collapse\n;;\011  use: default-text-style\n\011(make sequence\n  \n\011  ;; This hack is required for the RTF backend. If an external-graphic\n\011  ;; is the first thing on the page, RTF doesn't seem to do the right\n\011  ;; thing (the graphic winds up on the baseline of the first line\n\011  ;; of the page, left justified).  This "one point rule" fixes\n\011  ;; that problem.\n\011  (make paragraph\n\011    line-spacing: 1pt\n\011    (literal ""))\n\n\011  (let loop ((nl nodelist) (lastnode (empty-node-list)))\n\011    (if (node-list-empty? nl)\n\011\011(empty-sosofo)\n\011\011(make sequence\n\011\011  (if (or (node-list-empty? lastnode)\n\011\011\011  (not (equal? (gi (node-list-first nl))\n\011\011\011\011       (gi lastnode))))\n\011\011      (part-titlepage-before (node-list-first nl) side)\n\011\011      (empty-sosofo))\n\011\011  (cond\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "abbrev"))\n\011\011    (part-titlepage-abbrev (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "abstract"))\n\011\011    (part-titlepage-abstract (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "address"))\n\011\011    (part-titlepage-address (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "affiliation"))\n\011\011    (part-titlepage-affiliation (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "artpagenums"))\n\011\011    (part-titlepage-artpagenums (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "author"))\n\011\011    (part-titlepage-author (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "authorblurb"))\n\011\011    (part-titlepage-authorblurb (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "authorgroup"))\n\011\011    (part-titlepage-authorgroup (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "authorinitials"))\n\011\011    (part-titlepage-authorinitials (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "bibliomisc"))\n\011\011    (part-titlepage-bibliomisc (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "biblioset"))\n\011\011    (part-titlepage-biblioset (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "bookbiblio"))\n\011\011    (part-titlepage-bookbiblio (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "citetitle"))\n\011\011    (part-titlepage-citetitle (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "collab"))\n\011\011    (part-titlepage-collab (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "confgroup"))\n\011\011    (part-titlepage-confgroup (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "contractnum"))\n\011\011    (part-titlepage-contractnum (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "contractsponsor"))\n\011\011    (part-titlepage-contractsponsor (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "contrib"))\n\011\011    (part-titlepage-contrib (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "copyright"))\n\011\011    (part-titlepage-copyright (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "corpauthor"))\n\011\011    (part-titlepage-corpauthor (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "corpname"))\n\011\011    (part-titlepage-corpname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "date"))\n\011\011    (part-titlepage-date (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "edition"))\n\011\011    (part-titlepage-edition (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "editor"))\n\011\011    (part-titlepage-editor (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "firstname"))\n\011\011    (part-titlepage-firstname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "graphic"))\n\011\011    (part-titlepage-graphic (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "honorific"))\n\011\011    (part-titlepage-honorific (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "indexterm"))\n\011\011    (part-titlepage-indexterm (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "invpartnumber"))\n\011\011    (part-titlepage-invpartnumber (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "isbn"))\n\011\011    (part-titlepage-isbn (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "issn"))\n\011\011    (part-titlepage-issn (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "issuenum"))\n\011\011    (part-titlepage-issuenum (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "itermset"))\n\011\011    (part-titlepage-itermset (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "keywordset"))\n\011\011    (part-titlepage-keywordset (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "legalnotice"))\n\011\011    (part-titlepage-legalnotice (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "lineage"))\n\011\011    (part-titlepage-lineage (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "mediaobject"))\n\011\011    (part-titlepage-mediaobject (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "modespec"))\n\011\011    (part-titlepage-modespec (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "orgname"))\n\011\011    (part-titlepage-orgname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "othercredit"))\n\011\011    (part-titlepage-othercredit (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "othername"))\n\011\011    (part-titlepage-othername (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "pagenums"))\n\011\011    (part-titlepage-pagenums (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "printhistory"))\n\011\011    (part-titlepage-printhistory (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "productname"))\n\011\011    (part-titlepage-productname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "productnumber"))\n\011\011    (part-titlepage-productnumber (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "pubdate"))\n\011\011    (part-titlepage-pubdate (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "publisher"))\n\011\011    (part-titlepage-publisher (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "publishername"))\n\011\011    (part-titlepage-publishername (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "pubsnumber"))\n\011\011    (part-titlepage-pubsnumber (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "releaseinfo"))\n\011\011    (part-titlepage-releaseinfo (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "revhistory"))\n\011\011    (part-titlepage-revhistory (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "seriesinfo"))\n\011\011    (part-titlepage-seriesinfo (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "seriesvolnums"))\n\011\011    (part-titlepage-seriesvolnums (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "subjectset"))\n\011\011    (part-titlepage-subjectset (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "subtitle"))\n\011\011    (part-titlepage-subtitle (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "surname"))\n\011\011    (part-titlepage-surname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "title"))\n\011\011    (part-titlepage-title (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "titleabbrev"))\n\011\011    (part-titlepage-titleabbrev (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "volumenum"))\n\011\011    (part-titlepage-volumenum (node-list-first nl) side))\n\011\011   (else\n\011\011    (part-titlepage-default (node-list-first nl) side)))\n\011\011  (loop (node-list-rest nl) (node-list-first nl)))))\n\n\011  (if (and %generate-part-toc%\n\011\011   %generate-part-toc-on-titlepage%\n\011\011   (equal? side 'recto))\n\011      (make display-group\n\011\011(build-toc (current-node)\n\011\011\011   (toc-depth (current-node))))\n\011      (empty-sosofo))\n\n\011  ;; PartIntro is a special case\n\011  (if (and (equal? side 'recto)\n\011\011   (not (node-list-empty? partintro))\n\011\011   %generate-partintro-on-titlepage%)\n\011      ($process-partintro$ partintro #f)\n\011      (empty-sosofo)))\n\011(empty-sosofo))))\n\n(define (part-titlepage-before node side)\n  (if (equal? side 'recto)\n      (cond\n       ((equal? (gi node) (normalize "corpauthor"))\n\011(make paragraph\n\011  space-after: (* (HSIZE 5) %head-after-factor% 8)\n\011  (literal "\\no-break-space;")))\n       ((equal? (gi node) (normalize "authorgroup"))\n\011(if (have-sibling? (normalize "corpauthor") node)\n\011    (empty-sosofo)\n\011    (make paragraph\n\011      space-after: (* (HSIZE 5) %head-after-factor% 8)\n\011      (literal "\\no-break-space;"))))\n       ((equal? (gi node) (normalize "author"))\n\011(if (or (have-sibling? (normalize "corpauthor") node) \n\011\011(have-sibling? (normalize "authorgroup") node))\n\011    (empty-sosofo)\n\011    (make paragraph\n\011      space-after: (* (HSIZE 5) %head-after-factor% 8)\n\011      (literal "\\no-break-space;"))))\n       (else (empty-sosofo)))\n      (empty-sosofo)))\n\n(define (part-titlepage-default node side)\n  (let ((foo (debug (string-append "No part-titlepage-* for " (gi node) "!"))))\n    (empty-sosofo)))\n\n(define (part-titlepage-element node side)\n  (if (equal? side 'recto)\n      (with-mode part-titlepage-recto-mode\n\011(process-node-list node))\n      (with-mode part-titlepage-verso-mode\n\011(process-node-list node))))\n\n(define (part-titlepage-abbrev node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-abstract node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-address node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-affiliation node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-artpagenums node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-author node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-authorblurb node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-authorgroup node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-authorinitials node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-bibliomisc node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-biblioset node side)\n  (part-titlepage node side))\n(define (part-titlepage-bookbiblio node side)\n  (part-titlepage node side))\n(define (part-titlepage-citetitle node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-collab node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-confgroup node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-contractnum node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-contractsponsor node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-contrib  node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-copyright node side)\n  (part-titlepage-element node side))\n\n(define (part-titlepage-corpauthor node side)\n  (if (equal? side 'recto)\n      (book-titlepage-element node side)\n      (if (first-sibling? node)\n\011  (make paragraph\n\011    (with-mode book-titlepage-verso-mode\n\011      (process-node-list\n\011       (select-elements (children (parent node)) \n\011\011\011\011(normalize "corpauthor")))))\n\011  (empty-sosofo))))\n\n(define (part-titlepage-corpname node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-date node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-edition node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-editor node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-firstname node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-graphic node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-honorific node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-indexterm node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-invpartnumber node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-isbn node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-issn node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-issuenum node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-itermset node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-keywordset node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-legalnotice node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-lineage node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-mediaobject node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-modespec node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-orgname node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-othercredit node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-othername node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-pagenums node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-printhistory node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-productname node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-productnumber node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-pubdate node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-publisher node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-publishername node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-pubsnumber node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-releaseinfo node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-revhistory node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-seriesinfo node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-seriesvolnums node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-subjectset node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-subtitle node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-surname node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-title node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-titleabbrev node side)\n  (part-titlepage-element node side))\n(define (part-titlepage-volumenum node side)\n  (part-titlepage-element node side))\n\n(define part-titlepage-recto-style\n  (style\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      font-size: (HSIZE 1)))\n\n(define part-titlepage-verso-style\n  (style\n      font-family-name: %body-font-family%))\n\n(mode part-titlepage-recto-mode\n  (element abbrev\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element abstract\n    (make display-group\n      use: part-titlepage-recto-style\n      quadding: 'start\n      ($semiformal-object$)))\n\n  (element (abstract title) (empty-sosofo))\n\n  (element (abstract para)\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element address \n    (make display-group\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (with-mode titlepage-address-mode \n\011($linespecific-display$ %indent-address-lines% %number-address-lines%))))\n\n  (element affiliation\n    (make display-group\n      use: part-titlepage-recto-style\n      (process-children)))\n\n  (element artpagenums\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element author\n    (let ((author-name  (author-string))\n\011  (author-affil (select-elements (children (current-node)) \n\011\011\011\011\011 (normalize "affiliation"))))\n      (make sequence      \n\011(make paragraph\n          use: part-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-before: (* (HSIZE 2) %head-before-factor%)\n\011  quadding: %division-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal author-name))\n\011(process-node-list author-affil))))\n\n  (element authorblurb\n    (make display-group\n      use: part-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element (authorblurb para)\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element authorgroup\n    (make display-group\n      (process-children)))\n\n  (element authorinitials\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element bibliomisc (process-children))\n\n  (element bibliomset (process-children))\n\n  (element collab\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element confgroup\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element contractnum\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element contractsponsor\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element contrib\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element copyright\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      space-before: (* (HSIZE 2) %head-before-factor%)\n      (literal (gentext-element-name (current-node)))\n      (literal "\\no-break-space;")\n      (literal (dingbat "copyright"))\n      (literal "\\no-break-space;")\n      (process-children)))\n\n  (element (copyright year)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling? (current-node)))\n\011  (literal ", ")\n\011  (literal " "))))\n\n  (element (copyright holder) ($charseq$))\n\n  (element corpauthor\n    (make sequence\n      (make paragraph\n        use: part-titlepage-recto-style\n\011font-size: (HSIZE 3)\n\011line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011space-before: (* (HSIZE 2) %head-before-factor%)\n\011quadding: %division-title-quadding%\n\011keep-with-next?: #t\n\011(process-children))\n      ;; This paragraph is a hack to get the spacing right.\n      ;; Authors always have an affiliation paragraph below them, even if\n      ;; it's empty, so corpauthors need one too.\n      (make paragraph\n        use: part-titlepage-recto-style\n\011font-size: (HSIZE 1)\n\011line-spacing: (* (HSIZE 1) %line-spacing-factor%)\n\011space-after: (* (HSIZE 2) %head-after-factor% 4)\n\011quadding: %division-title-quadding%\n\011keep-with-next?: #t\n\011(literal "\\no-break-space;"))))\n\n  (element corpname\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element date\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element edition\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)\n      (literal "\\no-break-space;")\n      (literal (gentext-element-name-space (gi (current-node))))))\n\n  (element editor\n    (let ((editor-name (author-string)))\n      (make sequence      \n\011(if (first-sibling?) \n\011    (make paragraph\n              use: part-titlepage-recto-style\n\011      font-size: (HSIZE 1)\n\011      line-spacing: (* (HSIZE 1) %line-spacing-factor%)\n\011      space-before: (* (HSIZE 2) %head-before-factor% 6)\n\011      quadding: %division-title-quadding%\n\011      keep-with-next?: #t\n\011      (literal (gentext-edited-by)))\n\011    (empty-sosofo))\n\011(make paragraph\n          use: part-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-after: (* (HSIZE 2) %head-after-factor% 4)\n\011  quadding: %division-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal editor-name)))))\n\n  (element firstname\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element graphic\n    (let* ((nd (current-node))\n\011   (fileref (attribute-string "fileref" nd))\n\011   (entityref (attribute-string "entityref" nd))\n\011   (format (attribute-string "format" nd))\n\011   (align (attribute-string "align" nd)))\n      (if (or fileref entityref) \n\011  (make external-graphic\n\011    notation-system-id: (if format format "")\n\011    entity-system-id: (if fileref \n\011\011\011\011  (graphic-file fileref)\n\011\011\011\011  (if entityref \n\011\011\011\011      (entity-generated-system-id entityref)\n\011\011\011\011      ""))\n\011    display?: #t\n\011    display-alignment: 'center)\n\011  (empty-sosofo))))\n\n  (element honorific\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element isbn\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element issn\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element itermset (empty-sosofo))\n\n  (element invpartnumber\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element issuenum\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element jobtitle\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element keywordset\n    (make paragraph\n      quadding: 'start\n      (make sequence\n\011font-weight: 'bold\n\011(literal "Keywords: "))\n      (process-children)))\n\n  (element (keyword)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling?))\n\011  (literal ", ")\n\011  (literal ""))))\n\n  (element legalnotice\n    (make display-group\n      use: part-titlepage-recto-style\n      ($semiformal-object$)))\n\n  (element (legalnotice title) (empty-sosofo))\n\n  (element (legalnotice para)\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: 'start\n      line-spacing: (* 0.8 (inherited-line-spacing))\n      font-size: (* 0.8 (inherited-font-size))\n      (process-children)))\n\n  (element lineage\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element modespec (empty-sosofo))\n\n  (element orgdiv\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element orgname\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element othercredit\n    (let ((author-name  (author-string))\n\011  (author-affil (select-elements (children (current-node)) \n\011\011\011\011\011 (normalize "affiliation"))))\n      (make sequence      \n\011(make paragraph\n          use: part-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-before: (* (HSIZE 2) %head-before-factor%)\n\011  quadding: %division-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal author-name))\n\011(process-node-list author-affil))))\n\n  (element othername\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element pagenums\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element printhistory\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element productname\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element productnumber\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element pubdate\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element publisher\n    (make display-group\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element publishername\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element pubsnumber\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element releaseinfo\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element revhistory\n    (make sequence\n      (make paragraph\n\011use: part-titlepage-recto-style\n\011space-before: (* (HSIZE 3) %head-before-factor%)\n\011space-after: (/ (* (HSIZE 1) %head-before-factor%) 2)\n\011(literal (gentext-element-name (current-node))))\n      (make table\n\011before-row-border: #f\n\011(process-children))))\n  \n  (element (revhistory revision)\n    (let ((revnumber (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "revnumber")))\n\011  (revdate   (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "date")))\n\011  (revauthor (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "authorinitials")))\n\011  (revremark (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revremark")))\n\011  (revdescription (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revdescription"))))\n      (make sequence\n\011(make table-row\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (if (not (node-list-empty? revnumber))\n\011\011(make paragraph\n\011\011  use: part-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-element-name-space (current-node)))\n\011\011  (process-node-list revnumber))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 2\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revdate))\n\011\011(make paragraph\n\011\011  use: part-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (process-node-list revdate))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 3\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revauthor))\n\011\011(make paragraph\n\011\011  use: part-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-revised-by))\n\011\011  (process-node-list revauthor))\n\011\011(empty-sosofo))))\n\011(make table-row\n\011  cell-after-row-border: #f\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 3\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (cond ((not (node-list-empty? revremark))\n\011\011   (make paragraph\n\011\011     use: part-titlepage-recto-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     space-after: (if (last-sibling?) \n\011\011\011\011      0pt\n\011\011\011\011      (/ %block-sep% 2))\n\011\011     (process-node-list revremark)))\n\011\011  ((not (node-list-empty? revdescription))\n\011\011   (make sequence\n\011\011     use: part-titlepage-recto-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     (process-node-list revdescription)))\n\011\011  (else (empty-sosofo)))))))) \n  \n  (element (revision revnumber) (process-children-trim))\n  (element (revision date) (process-children-trim))\n  (element (revision authorinitials) (process-children-trim))\n  (element (revision revremark) (process-children-trim))\n  (element (revision revdescription) (process-children))\n\n  (element seriesvolnums\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element shortaffil\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element subjectset (empty-sosofo))\n\n  (element subtitle \n    (make paragraph\n      use: part-titlepage-recto-style\n      font-size: (HSIZE 4)\n      line-spacing: (* (HSIZE 4) %line-spacing-factor%)\n      space-before: (* (HSIZE 4) %head-before-factor%)\n      quadding: %division-subtitle-quadding%\n      keep-with-next?: #t\n      (process-children-trim)))\n\n  (element surname\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element title\n    (let ((division (ancestor-member (current-node) (division-element-list))))\n      (make paragraph\n        use: part-titlepage-recto-style\n\011font-size: (HSIZE 5)\n\011line-spacing: (* (HSIZE 5) %line-spacing-factor%)\n\011space-before: (* (HSIZE 5) %head-before-factor%)\n\011quadding: %division-title-quadding%\n\011keep-with-next?: #t\n\011heading-level: (if %generate-heading-level% 1 0)\n\011(if (string=? (element-label division) "")\n\011    (empty-sosofo)\n\011    (literal (element-label division) \n\011\011     (gentext-label-title-sep (gi division))))\n\011(with-mode title-mode\n\011  (process-children)))))\n\n  (element formalpara ($para-container$))\n  (element (formalpara title) ($runinhead$))\n  (element (formalpara para) (make sequence (process-children)))\n\n  (element titleabbrev (empty-sosofo))\n\n  (element volumenum\n    (make paragraph\n      use: part-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n)\n\n(mode part-titlepage-verso-mode\n  (element abbrev\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element abstract ($semiformal-object$))\n\n  (element (abstract title) (empty-sosofo))\n\n  (element address \n    (make display-group\n      use: part-titlepage-verso-style\n      (with-mode titlepage-address-mode \n\011($linespecific-display$ %indent-address-lines% %number-address-lines%))))\n\n  (element affiliation\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element artpagenums\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element author\n    ;; Print the author name.  Handle the case where there's no AUTHORGROUP\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (not in-group)\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-list-string))))\n\011  (make sequence \n\011    (literal (author-list-string))))))  \n\n  (element authorblurb\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element authorgroup\n    (make paragraph\n      space-after: (* %bf-size% %line-spacing-factor%)\n      (make sequence\n\011(literal (gentext-by))\n\011(literal "\\no-break-space;")\n\011(process-children-trim))))\n\n  (element authorinitials\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element bibliomisc (process-children))\n\n  (element bibliomset (process-children))\n\n  (element collab\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element confgroup\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element contractnum\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element contractsponsor\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element contrib\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element copyright\n    (make paragraph\n      use: part-titlepage-verso-style\n      (literal (gentext-element-name (current-node)))\n      (literal "\\no-break-space;")\n      (literal (dingbat "copyright"))\n      (literal "\\no-break-space;")\n      (process-children)))\n\n  (element (copyright year)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling? (current-node)))\n\011  (literal ", ")\n\011  (literal " "))))\n\n  (element (copyright holder) ($charseq$))\n\n  (element corpauthor\n    ;; note: part-titlepage-corpauthor takes care of wrapping multiple\n    ;; corpauthors\n    (make sequence\n      (if (first-sibling?)\n\011  (if (equal? (gi (parent (current-node))) (normalize "authorgroup"))\n\011      (empty-sosofo)\n\011      (literal (gentext-by) " "))\n\011  (literal ", "))\n      (process-children)))\n\n  (element corpname\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element date\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element edition\n    (make paragraph\n      (process-children)\n      (literal "\\no-break-space;")\n      (literal (gentext-element-name-space (gi (current-node))))))\n\n  (element editor\n    ;; Print the editor name.\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (or #t (not in-group)) ; nevermind, always put out the Edited by\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-edited-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-string))))\n\011  (make sequence \n\011    (literal (author-string))))))\n\n  (element firstname\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element graphic\n    (let* ((nd (current-node))\n\011   (fileref (attribute-string "fileref" nd))\n\011   (entityref (attribute-string "entityref" nd))\n\011   (format (attribute-string "format" nd))\n\011   (align (attribute-string "align" nd)))\n      (if (or fileref entityref) \n\011  (make external-graphic\n\011    notation-system-id: (if format format "")\n\011    entity-system-id: (if fileref \n\011\011\011\011  (graphic-file fileref)\n\011\011\011\011  (if entityref \n\011\011\011\011      (entity-generated-system-id entityref)\n\011\011\011\011      ""))\n\011    display?: #t\n\011    display-alignment: 'start)\n\011  (empty-sosofo))))\n\n  (element honorific\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element isbn\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element issn\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element itermset (empty-sosofo))\n\n  (element invpartnumber\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element issuenum\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element jobtitle\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element keywordset\n    (make paragraph\n      quadding: 'start\n      (make sequence\n\011font-weight: 'bold\n\011(literal "Keywords: "))\n      (process-children)))\n\n  (element (keyword)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling?))\n\011  (literal ", ")\n\011  (literal ""))))\n\n  (element legalnotice\n    (make display-group\n      use: part-titlepage-verso-style\n      ($semiformal-object$)))\n\n  (element (legalnotice title) (empty-sosofo))\n\n  (element (legalnotice para) \n    (make paragraph\n      use: part-titlepage-verso-style\n      font-size: (* (inherited-font-size) 0.8)\n      (process-children-trim)))\n\n  (element lineage\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element modespec (empty-sosofo))\n\n  (element orgdiv\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element orgname\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element othercredit\n    ;; Print the author name.  Handle the case where there's no AUTHORGROUP\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (not in-group)\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-list-string))))\n\011  (make sequence \n\011    (literal (author-list-string))))))  \n\n  (element othername\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element pagenums\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element printhistory\n    (make display-group\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element productname\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element productnumber\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element pubdate\n    (make paragraph\n      (literal (gentext-element-name-space (gi (current-node))))\n      (process-children)))\n\n  (element publisher\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element publishername\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element pubsnumber\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element releaseinfo\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element revhistory\n    (make sequence\n      (make paragraph\n\011use: part-titlepage-verso-style\n\011space-before: (* (HSIZE 3) %head-before-factor%)\n\011space-after: (/ (* (HSIZE 1) %head-before-factor%) 2)\n\011(literal (gentext-element-name (current-node))))\n      (make table\n\011before-row-border: #f\n\011(process-children))))\n  \n  (element (revhistory revision)\n    (let ((revnumber (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "revnumber")))\n\011  (revdate   (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "date")))\n\011  (revauthor (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "authorinitials")))\n\011  (revremark (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revremark")))\n\011  (revdescription (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revdescription"))))\n      (make sequence\n\011(make table-row\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (if (not (node-list-empty? revnumber))\n\011\011(make paragraph\n\011\011  use: part-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-element-name-space (current-node)))\n\011\011  (process-node-list revnumber))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 2\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revdate))\n\011\011(make paragraph\n\011\011  use: part-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (process-node-list revdate))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 3\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revauthor))\n\011\011(make paragraph\n\011\011  use: part-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-revised-by))\n\011\011  (process-node-list revauthor))\n\011\011(empty-sosofo))))\n\011(make table-row\n\011  cell-after-row-border: #f\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 3\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (cond ((not (node-list-empty? revremark))\n\011\011   (make paragraph\n\011\011     use: part-titlepage-verso-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     space-after: (if (last-sibling?) \n\011\011\011\011      0pt\n\011\011\011\011      (/ %block-sep% 2))\n\011\011     (process-node-list revremark)))\n\011\011  ((not (node-list-empty? revdescription))\n\011\011   (make sequence\n\011\011     use: part-titlepage-verso-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     (process-node-list revremark)))\n\011\011  (else (empty-sosofo)))))))) \n  \n  (element (revision revnumber) (process-children-trim))\n  (element (revision date) (process-children-trim))\n  (element (revision authorinitials) (process-children-trim))\n  (element (revision revremark) (process-children-trim))\n  (element (revision revdescription) (process-children))\n\n  (element seriesvolnums\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element shortaffil\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element subjectset (empty-sosofo))\n\n  (element subtitle\n    (make sequence\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      (literal (if (first-sibling?) ": " "; "))\n      (process-children)))\n\n  (element surname\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n\n  (element title\n    (let ((division (ancestor-member (current-node) (division-element-list))))\n      (make sequence\n        font-family-name: %title-font-family%\n\011font-weight: 'bold\n\011(if (string=? (element-label division) "")\n\011    (empty-sosofo)\n\011    (literal (element-label division) \n\011\011     (gentext-label-title-sep (gi division))))\n\011(with-mode title-mode\n\011  (process-children)))))\n\n  (element formalpara ($para-container$))\n  (element (formalpara title) ($runinhead$))\n  (element (formalpara para) (make sequence (process-children)))\n\n  (element titleabbrev (empty-sosofo))\n\n  (element volumenum\n    (make paragraph\n      use: part-titlepage-verso-style\n      (process-children)))\n)\n\n;; == Title pages for ARTICLEs ==========================================\n;;\n;; Note: Article title pages are a little different in that they do not\n;; create their own simple-page-sequence.\n;;\n\n(define (article-titlepage-recto-elements)\n  (list (normalize "title")\n\011(normalize "subtitle")\n\011(normalize "corpauthor")\n\011(normalize "authorgroup")\n\011(normalize "author")\n\011(normalize "releaseinfo")\n\011(normalize "copyright")\n\011(normalize "pubdate")\n\011(normalize "revhistory")\n\011(normalize "abstract")))\n\n(define (article-titlepage-verso-elements)\n  '())\n\n(define (article-titlepage-content? elements side)\n  (titlepage-content? elements (if (equal? side 'recto)\n\011\011\011\011   (article-titlepage-recto-elements)\n\011\011\011\011   (article-titlepage-verso-elements))))\n\n(define (article-titlepage elements #!optional (side 'recto))\n  (let* ((nodelist (titlepage-nodelist \n\011\011    (if (equal? side 'recto)\n\011\011\011(article-titlepage-recto-elements)\n\011\011\011(article-titlepage-verso-elements))\n\011\011    elements)))\n    (if (article-titlepage-content? elements side)\n\011(make sequence\n\011  (let loop ((nl nodelist) (lastnode (empty-node-list)))\n\011    (if (node-list-empty? nl)\n\011\011(empty-sosofo)\n\011\011(make sequence\n\011\011  (if (or (node-list-empty? lastnode)\n\011\011\011  (not (equal? (gi (node-list-first nl))\n\011\011\011\011       (gi lastnode))))\n\011\011      (article-titlepage-before (node-list-first nl) side)\n\011\011      (empty-sosofo))\n\011\011  (cond\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "abbrev"))\n\011\011    (article-titlepage-abbrev (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "abstract"))\n\011\011    (article-titlepage-abstract (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "address"))\n\011\011    (article-titlepage-address (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "affiliation"))\n\011\011    (article-titlepage-affiliation (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "artpagenums"))\n\011\011    (article-titlepage-artpagenums (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "author"))\n\011\011    (article-titlepage-author (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "authorblurb"))\n\011\011    (article-titlepage-authorblurb (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "authorgroup"))\n\011\011    (article-titlepage-authorgroup (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "authorinitials"))\n\011\011    (article-titlepage-authorinitials (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "bibliomisc"))\n\011\011    (article-titlepage-bibliomisc (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "biblioset"))\n\011\011    (article-titlepage-biblioset (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "bookbiblio"))\n\011\011    (article-titlepage-bookbiblio (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "citetitle"))\n\011\011    (article-titlepage-citetitle (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "collab"))\n\011\011    (article-titlepage-collab (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "confgroup"))\n\011\011    (article-titlepage-confgroup (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "contractnum"))\n\011\011    (article-titlepage-contractnum (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "contractsponsor"))\n\011\011    (article-titlepage-contractsponsor (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "contrib"))\n\011\011    (article-titlepage-contrib (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "copyright"))\n\011\011    (article-titlepage-copyright (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "corpauthor"))\n\011\011    (article-titlepage-corpauthor (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "corpname"))\n\011\011    (article-titlepage-corpname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "date"))\n\011\011    (article-titlepage-date (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "edition"))\n\011\011    (article-titlepage-edition (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "editor"))\n\011\011    (article-titlepage-editor (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "firstname"))\n\011\011    (article-titlepage-firstname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "graphic"))\n\011\011    (article-titlepage-graphic (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "honorific"))\n\011\011    (article-titlepage-honorific (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "indexterm"))\n\011\011    (article-titlepage-indexterm (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "invpartnumber"))\n\011\011    (article-titlepage-invpartnumber (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "isbn"))\n\011\011    (article-titlepage-isbn (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "issn"))\n\011\011    (article-titlepage-issn (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "issuenum"))\n\011\011    (article-titlepage-issuenum (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "itermset"))\n\011\011    (article-titlepage-itermset (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "keywordset"))\n\011\011    (article-titlepage-keywordset (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "legalnotice"))\n\011\011    (article-titlepage-legalnotice (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "lineage"))\n\011\011    (article-titlepage-lineage (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "mediaobject"))\n\011\011    (article-titlepage-mediaobject (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "modespec"))\n\011\011    (article-titlepage-modespec (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "orgname"))\n\011\011    (article-titlepage-orgname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "othercredit"))\n\011\011    (article-titlepage-othercredit (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "othername"))\n\011\011    (article-titlepage-othername (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "pagenums"))\n\011\011    (article-titlepage-pagenums (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "printhistory"))\n\011\011    (article-titlepage-printhistory (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "productname"))\n\011\011    (article-titlepage-productname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "productnumber"))\n\011\011    (article-titlepage-productnumber (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "pubdate"))\n\011\011    (article-titlepage-pubdate (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "publisher"))\n\011\011    (article-titlepage-publisher (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "publishername"))\n\011\011    (article-titlepage-publishername (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "pubsnumber"))\n\011\011    (article-titlepage-pubsnumber (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "releaseinfo"))\n\011\011    (article-titlepage-releaseinfo (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "revhistory"))\n\011\011    (article-titlepage-revhistory (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "seriesinfo"))\n\011\011    (article-titlepage-seriesinfo (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "seriesvolnums"))\n\011\011    (article-titlepage-seriesvolnums (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "subjectset"))\n\011\011    (article-titlepage-subjectset (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "subtitle"))\n\011\011    (article-titlepage-subtitle (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "surname"))\n\011\011    (article-titlepage-surname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "title"))\n\011\011    (article-titlepage-title (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "titleabbrev"))\n\011\011    (article-titlepage-titleabbrev (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "volumenum"))\n\011\011    (article-titlepage-volumenum (node-list-first nl) side))\n\011\011   (else\n\011\011    (article-titlepage-default (node-list-first nl) side)))\n\011\011  (loop (node-list-rest nl) (node-list-first nl)))))\n\n\011  (if (and %generate-article-toc%\n\011\011   %generate-article-toc-on-titlepage%\n\011\011   (equal? side 'recto))\n\011      (make display-group\n\011\011(build-toc (current-node)\n\011\011\011   (toc-depth (current-node))))\n\011      (empty-sosofo)))\n\011(empty-sosofo))))\n\n(define (article-titlepage-before node side)\n  (empty-sosofo))\n\n(define (article-titlepage-default node side)\n  (let ((foo (debug (string-append "No article-titlepage-* for " (gi node) "!"))))\n    (empty-sosofo)))\n\n(define (article-titlepage-element node side)\n  (if (equal? side 'recto)\n      (with-mode article-titlepage-recto-mode\n\011(process-node-list node))\n      (with-mode article-titlepage-verso-mode\n\011(process-node-list node))))\n\n(define (article-titlepage-abbrev node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-abstract node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-address node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-affiliation node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-artpagenums node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-author node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-authorblurb node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-authorgroup node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-authorinitials node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-bibliomisc node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-biblioset node side)\n  (article-titlepage node side))\n(define (article-titlepage-bookbiblio node side)\n  (article-titlepage node side))\n(define (article-titlepage-citetitle node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-collab node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-confgroup node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-contractnum node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-contractsponsor node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-contrib  node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-copyright node side)\n  (article-titlepage-element node side))\n\n(define (article-titlepage-corpauthor node side)\n  (if (equal? side 'recto)\n      (book-titlepage-element node side)\n      (if (first-sibling? node)\n\011  (make paragraph\n\011    (with-mode book-titlepage-verso-mode\n\011      (process-node-list\n\011       (select-elements (children (parent node)) \n\011\011\011\011(normalize "corpauthor")))))\n\011  (empty-sosofo))))\n\n(define (article-titlepage-corpname node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-date node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-edition node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-editor node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-firstname node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-graphic node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-honorific node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-indexterm node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-invpartnumber node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-isbn node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-issn node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-issuenum node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-itermset node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-keywordset node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-legalnotice node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-lineage node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-mediaobject node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-modespec node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-orgname node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-othercredit node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-othername node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-pagenums node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-printhistory node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-productname node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-productnumber node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-pubdate node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-publisher node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-publishername node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-pubsnumber node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-releaseinfo node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-revhistory node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-seriesinfo node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-seriesvolnums node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-subjectset node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-subtitle node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-surname node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-title node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-titleabbrev node side)\n  (article-titlepage-element node side))\n(define (article-titlepage-volumenum node side)\n  (article-titlepage-element node side))\n\n(define article-titlepage-recto-style\n  (style\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      font-size: (HSIZE 1)))\n\n(define article-titlepage-verso-style\n  (style\n      font-family-name: %body-font-family%))\n\n(mode article-titlepage-recto-mode\n  (element abbrev\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element abstract\n    (make display-group\n      use: article-titlepage-verso-style ;; EVEN THOUGH IT'S RECTO!\n      quadding: 'start\n      start-indent: (+ (inherited-start-indent) (/ %body-width% 24))\n      end-indent: (+ (inherited-end-indent) (/ %body-width% 24))\n      ($semiformal-object$)))\n\n  (element (abstract title) (empty-sosofo))\n\n  (element address \n    (make display-group\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (with-mode titlepage-address-mode \n\011($linespecific-display$ %indent-address-lines% %number-address-lines%))))\n\n  (element affiliation\n    (make display-group\n      use: article-titlepage-recto-style\n      (process-children)))\n\n  (element artpagenums\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element author\n    (let ((author-name  (author-string))\n\011  (author-affil (select-elements (children (current-node)) \n\011\011\011\011\011 (normalize "affiliation"))))\n      (make sequence      \n\011(make paragraph\n          use: article-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-before: (* (HSIZE 2) %head-before-factor%)\n\011  quadding: %article-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal author-name))\n\011(process-node-list author-affil))))\n\n  (element authorblurb\n    (make display-group\n      use: article-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element (authorblurb para)\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element authorgroup\n    (make display-group\n      (process-children)))\n\n  (element authorinitials\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element bibliomisc (process-children))\n\n  (element bibliomset (process-children))\n\n  (element collab\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element confgroup\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element contractnum\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element contractsponsor\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element contrib\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element copyright\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      space-before: (* (HSIZE 2) %head-before-factor%)\n      (literal (gentext-element-name (current-node)))\n      (literal "\\no-break-space;")\n      (literal (dingbat "copyright"))\n      (literal "\\no-break-space;")\n      (process-children)))\n\n  (element (copyright year)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling? (current-node)))\n\011  (literal ", ")\n\011  (literal " "))))\n\n  (element (copyright holder) ($charseq$))\n\n  (element corpauthor\n    (make sequence\n      (make paragraph\n        use: article-titlepage-recto-style\n\011font-size: (HSIZE 3)\n\011line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011space-before: (* (HSIZE 2) %head-before-factor%)\n\011quadding: %article-title-quadding%\n\011keep-with-next?: #t\n\011(process-children))\n      ;; This paragraph is a hack to get the spacing right.\n      ;; Authors always have an affiliation paragraph below them, even if\n      ;; it's empty, so corpauthors need one too.\n      (make paragraph\n        use: article-titlepage-recto-style\n\011font-size: (HSIZE 1)\n\011line-spacing: (* (HSIZE 1) %line-spacing-factor%)\n\011space-after: (* (HSIZE 2) %head-after-factor% 4)\n\011quadding: %article-title-quadding%\n\011keep-with-next?: #t\n\011(literal "\\no-break-space;"))))\n\n  (element corpname\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element date\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element edition\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)\n      (literal "\\no-break-space;")\n      (literal (gentext-element-name-space (gi (current-node))))))\n\n  (element editor\n    (let ((editor-name (author-string)))\n      (make sequence      \n\011(if (first-sibling?) \n\011    (make paragraph\n              use: article-titlepage-recto-style\n\011      font-size: (HSIZE 1)\n\011      line-spacing: (* (HSIZE 1) %line-spacing-factor%)\n\011      space-before: (* (HSIZE 2) %head-before-factor% 6)\n\011      quadding: %article-title-quadding%\n\011      keep-with-next?: #t\n\011      (literal (gentext-edited-by)))\n\011    (empty-sosofo))\n\011(make paragraph\n          use: article-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-after: (* (HSIZE 2) %head-after-factor% 4)\n\011  quadding: %article-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal editor-name)))))\n\n  (element firstname\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element graphic\n    (let* ((nd (current-node))\n\011   (fileref (attribute-string "fileref" nd))\n\011   (entityref (attribute-string "entityref" nd))\n\011   (format (attribute-string "format" nd))\n\011   (align (attribute-string "align" nd)))\n      (if (or fileref entityref) \n\011  (make external-graphic\n\011    notation-system-id: (if format format "")\n\011    entity-system-id: (if fileref \n\011\011\011\011  (graphic-file fileref)\n\011\011\011\011  (if entityref \n\011\011\011\011      (entity-generated-system-id entityref)\n\011\011\011\011      ""))\n\011    display?: #t\n\011    display-alignment: 'center)\n\011  (empty-sosofo))))\n\n  (element honorific\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element isbn\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element issn\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element itermset (empty-sosofo))\n\n  (element invpartnumber\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element issuenum\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element jobtitle\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element keywordset\n    (make paragraph\n      quadding: 'start\n      (make sequence\n\011font-weight: 'bold\n\011(literal "Keywords: "))\n      (process-children)))\n\n  (element keyword\n    (make sequence\n      (process-children)\n      (if (not (last-sibling?))\n\011  (literal ", ")\n\011  (literal ""))))\n\n  (element legalnotice\n    (make display-group\n      use: article-titlepage-recto-style\n      ($semiformal-object$)))\n\n  (element (legalnotice title) (empty-sosofo))\n\n  (element (legalnotice para)\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: 'start\n      line-spacing: (* 0.8 (inherited-line-spacing))\n      font-size: (* 0.8 (inherited-font-size))\n      (process-children)))\n\n  (element lineage\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element modespec (empty-sosofo))\n\n  (element orgdiv\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element orgname\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element othercredit\n    (let ((author-name  (author-string))\n\011  (author-affil (select-elements (children (current-node)) \n\011\011\011\011\011 (normalize "affiliation"))))\n      (make sequence      \n\011(make paragraph\n          use: article-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-before: (* (HSIZE 2) %head-before-factor%)\n\011  quadding: %article-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal author-name))\n\011(process-node-list author-affil))))\n\n  (element othername\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element pagenums\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element printhistory\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element productname\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element productnumber\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element pubdate\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element publisher\n    (make display-group\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element publishername\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element pubsnumber\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element releaseinfo\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element revhistory\n    (make sequence\n      (make paragraph\n\011use: article-titlepage-recto-style\n\011space-before: (* (HSIZE 3) %head-before-factor%)\n\011space-after: (/ (* (HSIZE 1) %head-before-factor%) 2)\n\011(literal (gentext-element-name (current-node))))\n      (make table\n\011before-row-border: #f\n\011(process-children))))\n  \n  (element (revhistory revision)\n    (let ((revnumber (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "revnumber")))\n\011  (revdate   (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "date")))\n\011  (revauthor (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "authorinitials")))\n\011  (revremark (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revremark")))\n\011  (revdescription (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revdescription"))))\n      (make sequence\n\011(make table-row\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (if (not (node-list-empty? revnumber))\n\011\011(make paragraph\n\011\011  use: article-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-element-name-space (current-node)))\n\011\011  (process-node-list revnumber))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 2\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revdate))\n\011\011(make paragraph\n\011\011  use: article-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (process-node-list revdate))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 3\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revauthor))\n\011\011(make paragraph\n\011\011  use: article-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-revised-by))\n\011\011  (process-node-list revauthor))\n\011\011(empty-sosofo))))\n\011(make table-row\n\011  cell-after-row-border: #f\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 3\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (cond ((not (node-list-empty? revremark))\n\011\011   (make paragraph\n\011\011     use: article-titlepage-recto-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     space-after: (if (last-sibling?) \n\011\011\011\011      0pt\n\011\011\011\011      (/ %block-sep% 2))\n\011\011     (process-node-list revremark)))\n\011\011  ((not (node-list-empty? revdescription))\n\011\011   (make sequence\n\011\011     use: article-titlepage-recto-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     (process-node-list revdescription)))\n\011\011  (else (empty-sosofo))))))))\n  \n  (element (revision revnumber) (process-children-trim))\n  (element (revision date) (process-children-trim))\n  (element (revision authorinitials) (process-children-trim))\n  (element (revision revremark) (process-children-trim))\n  (element (revision revdescription) (process-children))\n\n  (element seriesvolnums\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element shortaffil\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element subjectset (empty-sosofo))\n\n  (element subtitle \n    (make paragraph\n      use: article-titlepage-recto-style\n      font-size: (HSIZE 4)\n      line-spacing: (* (HSIZE 4) %line-spacing-factor%)\n      space-before: (* (HSIZE 4) %head-before-factor%)\n      quadding: %article-subtitle-quadding%\n      keep-with-next?: #t\n      (process-children-trim)))\n\n  (element surname\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n\n  (element title \n    (make paragraph\n      use: article-titlepage-recto-style\n      font-size: (HSIZE 5)\n      line-spacing: (* (HSIZE 5) %line-spacing-factor%)\n      space-before: (* (HSIZE 5) %head-before-factor%)\n      quadding: %article-title-quadding%\n      keep-with-next?: #t\n      (with-mode title-mode\n\011(process-children-trim))))\n\n  (element formalpara ($para-container$))\n  (element (formalpara title) ($runinhead$))\n  (element (formalpara para) (make sequence (process-children)))\n\n  (element titleabbrev (empty-sosofo))\n\n  (element volumenum\n    (make paragraph\n      use: article-titlepage-recto-style\n      quadding: %article-title-quadding%\n      (process-children)))\n)\n\n(mode article-titlepage-verso-mode\n  (element abbrev\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element abstract ($semiformal-object$))\n\n  (element (abstract title) (empty-sosofo))\n\n  (element address \n    (make display-group\n      use: article-titlepage-verso-style\n      (with-mode titlepage-address-mode \n\011($linespecific-display$ %indent-address-lines% %number-address-lines%))))\n\n  (element affiliation\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element artpagenums\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element author\n    ;; Print the author name.  Handle the case where there's no AUTHORGROUP\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (not in-group)\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-list-string))))\n\011  (make sequence \n\011    (literal (author-list-string))))))  \n\n  (element authorblurb\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element authorgroup\n    (make paragraph\n      space-after: (* %bf-size% %line-spacing-factor%)\n      (make sequence\n\011(literal (gentext-by))\n\011(literal "\\no-break-space;")\n\011(process-children-trim))))\n\n  (element authorinitials\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element bibliomisc (process-children))\n\n  (element bibliomset (process-children))\n\n  (element collab\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element confgroup\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element contractnum\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element contractsponsor\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element contrib\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element copyright\n    (make paragraph\n      use: article-titlepage-verso-style\n      (literal (gentext-element-name (current-node)))\n      (literal "\\no-break-space;")\n      (literal (dingbat "copyright"))\n      (literal "\\no-break-space;")\n      (process-children)))\n\n  (element (copyright year)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling? (current-node)))\n\011  (literal ", ")\n\011  (literal " "))))\n\n  (element (copyright holder) ($charseq$))\n\n  (element corpauthor\n    ;; note: article-titlepage-corpauthor takes care of wrapping multiple\n    ;; corpauthors\n    (make sequence\n      (if (first-sibling?)\n\011  (if (equal? (gi (parent (current-node))) (normalize "authorgroup"))\n\011      (empty-sosofo)\n\011      (literal (gentext-by) " "))\n\011  (literal ", "))\n      (process-children)))\n\n  (element corpname\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element date\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element edition\n    (make paragraph\n      (process-children)\n      (literal "\\no-break-space;")\n      (literal (gentext-element-name-space (gi (current-node))))))\n\n  (element editor\n    ;; Print the editor name.\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (or #t (not in-group)) ; nevermind, always put out the Edited by\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-edited-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-string))))\n\011  (make sequence \n\011    (literal (author-string))))))\n\n  (element firstname\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element graphic\n    (let* ((nd (current-node))\n\011   (fileref (attribute-string "fileref" nd))\n\011   (entityref (attribute-string "entityref" nd))\n\011   (format (attribute-string "format" nd))\n\011   (align (attribute-string "align" nd)))\n      (if (or fileref entityref) \n\011  (make external-graphic\n\011    notation-system-id: (if format format "")\n\011    entity-system-id: (if fileref \n\011\011\011\011  (graphic-file fileref)\n\011\011\011\011  (if entityref \n\011\011\011\011      (entity-generated-system-id entityref)\n\011\011\011\011      ""))\n\011    display?: #t\n\011    display-alignment: 'start)\n\011  (empty-sosofo))))\n\n  (element honorific\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element isbn\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element issn\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element itermset (empty-sosofo))\n\n  (element invpartnumber\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element issuenum\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element jobtitle\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element keywordset\n    (make paragraph\n      quadding: 'start\n      (make sequence\n\011font-weight: 'bold\n\011(literal "Keywords: "))\n      (process-children)))\n\n  (element (keyword)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling?))\n\011  (literal ", ")\n\011  (literal ""))))\n\n  (element legalnotice\n    (make display-group\n      use: article-titlepage-verso-style\n      ($semiformal-object$)))\n\n  (element (legalnotice title) (empty-sosofo))\n\n  (element (legalnotice para) \n    (make paragraph\n      use: article-titlepage-verso-style\n      font-size: (* (inherited-font-size) 0.8)\n      (process-children-trim)))\n\n  (element lineage\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element modespec (empty-sosofo))\n\n  (element orgdiv\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element orgname\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element othercredit\n    ;; Print the author name.  Handle the case where there's no AUTHORGROUP\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (not in-group)\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-list-string))))\n\011  (make sequence \n\011    (literal (author-list-string))))))  \n\n  (element othername\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element pagenums\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element printhistory\n    (make display-group\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element productname\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element productnumber\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element pubdate\n    (make paragraph\n      (literal (gentext-element-name-space (gi (current-node))))\n      (process-children)))\n\n  (element publisher\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element publishername\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element pubsnumber\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element releaseinfo\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element revhistory\n    (make sequence\n      (make paragraph\n\011use: article-titlepage-verso-style\n\011font-family-name: %title-font-family%\n\011font-weight: 'bold\n\011space-before: (* (HSIZE 3) %head-before-factor%)\n\011space-after: (/ (* (HSIZE 1) %head-before-factor%) 2)\n\011(literal (gentext-element-name (current-node))))\n      (make table\n\011before-row-border: #f\n\011(process-children))))\n  \n  (element (revhistory revision)\n    (let ((revnumber (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "revnumber")))\n\011  (revdate   (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "date")))\n\011  (revauthor (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "authorinitials")))\n\011  (revremark (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revremark")))\n\011  (revdescription (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revdescription"))))\n      (make sequence\n\011(make table-row\n\011  cell-after-row-border: #f\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (if (node-list-empty? revnumber)\n\011\011(empty-sosofo)\n\011\011(make paragraph\n\011\011  use: article-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-element-name-space (current-node)))\n\011\011  (process-node-list revnumber))))\n\011  (make table-cell\n\011    column-number: 2\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (node-list-empty? revdate)\n\011\011(empty-sosofo)\n\011\011(make paragraph\n\011\011  use: article-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (process-node-list revdate))))\n\011  (make table-cell\n\011    column-number: 3\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (node-list-empty? revauthor)\n\011\011(empty-sosofo)\n\011\011(make paragraph\n\011\011  use: article-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-revised-by))\n\011\011  (process-node-list revauthor)))))\n\011(make table-row\n\011  cell-after-row-border: #f\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 3\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (cond ((not (node-list-empty? revremark))\n\011\011   (make paragraph\n\011\011     use: article-titlepage-verso-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     space-after: (if (last-sibling?) \n\011\011\011\011      0pt\n\011\011\011\011      (/ %block-sep% 2))\n\011\011     (process-node-list revremark)))\n\011\011  ((not (node-list-empty? revdescription))\n\011\011   (make sequence\n\011\011     use: article-titlepage-verso-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     (process-node-list revdescription)))\n\011\011  (else (empty-sosofo)))))))) \n  \n  (element (revision revnumber) (process-children-trim))\n  (element (revision date) (process-children-trim))\n  (element (revision authorinitials) (process-children-trim))\n  (element (revision revremark) (process-children-trim))\n  (element (revision revdescription) (process-children))\n\n  (element seriesvolnums\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element shortaffil\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element subjectset (empty-sosofo))\n\n  (element subtitle\n    (make sequence\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      (literal (if (first-sibling?) ": " "; "))\n      (process-children)))\n\n  (element surname\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n  (element title\n    (make sequence\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      (with-mode title-mode\n\011(process-children))))\n\n  (element formalpara ($para-container$))\n  (element (formalpara title) ($runinhead$))\n  (element (formalpara para) (make sequence (process-children)))\n\n  (element titleabbrev (empty-sosofo))\n\n  (element volumenum\n    (make paragraph\n      use: article-titlepage-verso-style\n      (process-children)))\n\n)\n\n;; == Title pages for REFERENCEs ========================================\n\n(define (reference-titlepage-recto-elements)\n  (list (normalize "title") \n\011(normalize "subtitle")\n\011(normalize "corpauthor") \n\011(normalize "authorgroup") \n\011(normalize "author") \n\011(normalize "editor")))\n\n(define (reference-titlepage-verso-elements)\n  '())\n\n(define (reference-titlepage-content? elements side)\n  (titlepage-content? elements (if (equal? side 'recto)\n\011\011\011\011   (reference-titlepage-recto-elements)\n\011\011\011\011   (reference-titlepage-verso-elements))))\n\n(define (reference-titlepage elements #!optional (side 'recto))\n  (let ((nodelist (titlepage-nodelist \n\011\011   (if (equal? side 'recto)\n\011\011       (reference-titlepage-recto-elements)\n\011\011       (reference-titlepage-verso-elements))\n\011\011   elements))\n        ;; partintro is a special case...\n\011(partintro (node-list-first\n\011\011    (node-list-filter-by-gi elements (list (normalize "partintro"))))))\n    (if (reference-titlepage-content? elements side)\n\011(make simple-page-sequence\n\011  page-n-columns: %titlepage-n-columns%\n\011  input-whitespace-treatment: 'collapse\n\011  use: default-text-style\n\011  \n\011  ;; This hack is required for the RTF backend. If an external-graphic\n\011  ;; is the first thing on the page, RTF doesn't seem to do the right\n\011  ;; thing (the graphic winds up on the baseline of the first line\n\011  ;; of the page, left justified).  This "one point rule" fixes\n\011  ;; that problem.\n\011  (make paragraph\n\011    line-spacing: 1pt\n\011    (literal ""))\n      \n\011  (let loop ((nl nodelist) (lastnode (empty-node-list)))\n\011    (if (node-list-empty? nl)\n\011\011(empty-sosofo)\n\011\011(make sequence\n\011\011  (if (or (node-list-empty? lastnode)\n\011\011\011  (not (equal? (gi (node-list-first nl))\n\011\011\011\011       (gi lastnode))))\n\011\011      (reference-titlepage-before (node-list-first nl) side)\n\011\011      (empty-sosofo))\n\011\011  (cond\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "abbrev"))\n\011\011    (reference-titlepage-abbrev (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "abstract"))\n\011\011    (reference-titlepage-abstract (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "address"))\n\011\011    (reference-titlepage-address (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "affiliation"))\n\011\011    (reference-titlepage-affiliation (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "artpagenums"))\n\011\011    (reference-titlepage-artpagenums (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "author"))\n\011\011    (reference-titlepage-author (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "authorblurb"))\n\011\011    (reference-titlepage-authorblurb (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "authorgroup"))\n\011\011    (reference-titlepage-authorgroup (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "authorinitials"))\n\011\011    (reference-titlepage-authorinitials (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "bibliomisc"))\n\011\011    (reference-titlepage-bibliomisc (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "biblioset"))\n\011\011    (reference-titlepage-biblioset (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "bookbiblio"))\n\011\011    (reference-titlepage-bookbiblio (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "citetitle"))\n\011\011    (reference-titlepage-citetitle (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "collab"))\n\011\011    (reference-titlepage-collab (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "confgroup"))\n\011\011    (reference-titlepage-confgroup (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "contractnum"))\n\011\011    (reference-titlepage-contractnum (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "contractsponsor"))\n\011\011    (reference-titlepage-contractsponsor (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "contrib"))\n\011\011    (reference-titlepage-contrib (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "copyright"))\n\011\011    (reference-titlepage-copyright (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "corpauthor"))\n\011\011    (reference-titlepage-corpauthor (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "corpname"))\n\011\011    (reference-titlepage-corpname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "date"))\n\011\011    (reference-titlepage-date (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "edition"))\n\011\011    (reference-titlepage-edition (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "editor"))\n\011\011    (reference-titlepage-editor (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "firstname"))\n\011\011    (reference-titlepage-firstname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "graphic"))\n\011\011    (reference-titlepage-graphic (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "honorific"))\n\011\011    (reference-titlepage-honorific (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "indexterm"))\n\011\011    (reference-titlepage-indexterm (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "invpartnumber"))\n\011\011    (reference-titlepage-invpartnumber (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "isbn"))\n\011\011    (reference-titlepage-isbn (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "issn"))\n\011\011    (reference-titlepage-issn (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "issuenum"))\n\011\011    (reference-titlepage-issuenum (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "itermset"))\n\011\011    (reference-titlepage-itermset (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "keywordset"))\n\011\011    (reference-titlepage-keywordset (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "legalnotice"))\n\011\011    (reference-titlepage-legalnotice (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "lineage"))\n\011\011    (reference-titlepage-lineage (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "mediaobject"))\n\011\011    (reference-titlepage-mediaobject (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "modespec"))\n\011\011    (reference-titlepage-modespec (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "orgname"))\n\011\011    (reference-titlepage-orgname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "othercredit"))\n\011\011    (reference-titlepage-othercredit (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "othername"))\n\011\011    (reference-titlepage-othername (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "pagenums"))\n\011\011    (reference-titlepage-pagenums (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "printhistory"))\n\011\011    (reference-titlepage-printhistory (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "productname"))\n\011\011    (reference-titlepage-productname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "productnumber"))\n\011\011    (reference-titlepage-productnumber (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "pubdate"))\n\011\011    (reference-titlepage-pubdate (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "publisher"))\n\011\011    (reference-titlepage-publisher (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "publishername"))\n\011\011    (reference-titlepage-publishername (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "pubsnumber"))\n\011\011    (reference-titlepage-pubsnumber (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "releaseinfo"))\n\011\011    (reference-titlepage-releaseinfo (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "revhistory"))\n\011\011    (reference-titlepage-revhistory (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "seriesinfo"))\n\011\011    (reference-titlepage-seriesinfo (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "seriesvolnums"))\n\011\011    (reference-titlepage-seriesvolnums (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "subjectset"))\n\011\011    (reference-titlepage-subjectset (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "subtitle"))\n\011\011    (reference-titlepage-subtitle (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "surname"))\n\011\011    (reference-titlepage-surname (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "title"))\n\011\011    (reference-titlepage-title (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "titleabbrev"))\n\011\011    (reference-titlepage-titleabbrev (node-list-first nl) side))\n\011\011   ((equal? (gi (node-list-first nl)) (normalize "volumenum"))\n\011\011    (reference-titlepage-volumenum (node-list-first nl) side))\n\011\011   (else\n\011\011    (reference-titlepage-default (node-list-first nl) side)))\n\011\011  (loop (node-list-rest nl) (node-list-first nl)))))\n\n\011  (if (and %generate-reference-toc%\n\011\011   %generate-reference-toc-on-titlepage%\n\011\011   (equal? side 'recto))\n\011      (make display-group\n\011\011(build-toc (current-node)\n\011\011\011   (toc-depth (current-node))))\n\011      (empty-sosofo))\n\n\011  ;; PartIntro is a special case\n\011  (if (and (equal? side 'recto)\n\011\011   (not (node-list-empty? partintro))\n\011\011   %generate-partintro-on-titlepage%)\n\011      ($process-partintro$ partintro #f)\n\011      (empty-sosofo)))\n\n\011(empty-sosofo))))\n\n(define (reference-titlepage-before node side)\n  (if (equal? side 'recto)\n      (cond\n       ((equal? (gi node) (normalize "corpauthor"))\n\011(make paragraph\n\011  space-after: (* (HSIZE 5) %head-after-factor% 8)\n\011  (literal "\\no-break-space;")))\n       ((equal? (gi node) (normalize "authorgroup"))\n\011(if (have-sibling? (normalize "corpauthor") node)\n\011    (empty-sosofo)\n\011    (make paragraph\n\011      space-after: (* (HSIZE 5) %head-after-factor% 8)\n\011      (literal "\\no-break-space;"))))\n       ((equal? (gi node) (normalize "author"))\n\011(if (or (have-sibling? (normalize "corpauthor") node) \n\011\011(have-sibling? (normalize "authorgroup") node))\n\011    (empty-sosofo)\n\011    (make paragraph\n\011      space-after: (* (HSIZE 5) %head-after-factor% 8)\n\011      (literal "\\no-break-space;"))))\n       (else (empty-sosofo)))\n      (empty-sosofo)))\n\n(define (reference-titlepage-default node side)\n  (let ((foo (debug (string-append "No reference-titlepage-* for " (gi node) "!"))))\n    (empty-sosofo)))\n\n(define (reference-titlepage-element node side)\n  (if (equal? side 'recto)\n      (with-mode reference-titlepage-recto-mode\n\011(process-node-list node))\n      (with-mode reference-titlepage-verso-mode\n\011(process-node-list node))))\n\n(define (reference-titlepage-abbrev node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-abstract node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-address node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-affiliation node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-artpagenums node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-author node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-authorblurb node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-authorgroup node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-authorinitials node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-bibliomisc node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-biblioset node side)\n  (reference-titlepage node side))\n(define (reference-titlepage-bookbiblio node side)\n  (reference-titlepage node side))\n(define (reference-titlepage-citetitle node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-collab node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-confgroup node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-contractnum node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-contractsponsor node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-contrib  node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-copyright node side)\n  (reference-titlepage-element node side))\n\n(define (reference-titlepage-corpauthor node side)\n  (if (equal? side 'recto)\n      (book-titlepage-element node side)\n      (if (first-sibling? node)\n\011  (make paragraph\n\011    (with-mode book-titlepage-verso-mode\n\011      (process-node-list\n\011       (select-elements (children (parent node)) \n\011\011\011\011(normalize "corpauthor")))))\n\011  (empty-sosofo))))\n\n(define (reference-titlepage-corpname node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-date node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-edition node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-editor node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-firstname node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-graphic node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-honorific node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-indexterm node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-invpartnumber node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-isbn node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-issn node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-issuenum node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-itermset node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-keywordset node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-legalnotice node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-lineage node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-mediaobject node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-modespec node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-orgname node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-othercredit node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-othername node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-pagenums node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-printhistory node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-productname node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-productnumber node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-pubdate node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-publisher node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-publishername node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-pubsnumber node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-releaseinfo node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-revhistory node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-seriesinfo node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-seriesvolnums node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-subjectset node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-subtitle node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-surname node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-title node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-titleabbrev node side)\n  (reference-titlepage-element node side))\n(define (reference-titlepage-volumenum node side)\n  (reference-titlepage-element node side))\n\n(define reference-titlepage-recto-style\n  (style\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      font-size: (HSIZE 1)))\n\n(define reference-titlepage-verso-style\n  (style\n      font-family-name: %body-font-family%))\n\n(mode reference-titlepage-recto-mode\n  (element abbrev\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element abstract\n    (make display-group\n      use: reference-titlepage-recto-style\n      quadding: 'start\n      ($semiformal-object$)))\n\n  (element (abstract title) (empty-sosofo))\n\n  (element (abstract para)\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element address \n    (make display-group\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (with-mode titlepage-address-mode \n\011($linespecific-display$ %indent-address-lines% %number-address-lines%))))\n\n  (element affiliation\n    (make display-group\n      use: reference-titlepage-recto-style\n      (process-children)))\n\n  (element artpagenums\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element author\n    (let ((author-name  (author-string))\n\011  (author-affil (select-elements (children (current-node)) \n\011\011\011\011\011 (normalize "affiliation"))))\n      (make sequence      \n\011(make paragraph\n\011  use: reference-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-before: (* (HSIZE 2) %head-before-factor%)\n\011  quadding: %division-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal author-name))\n\011(process-node-list author-affil))))\n\n  (element authorblurb\n    (make display-group\n      use: reference-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element (authorblurb para)\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: 'start\n      (process-children)))\n\n  (element authorgroup\n    (make display-group\n      (process-children)))\n\n  (element authorinitials\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element bibliomisc (process-children))\n\n  (element bibliomset (process-children))\n\n  (element collab\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element confgroup\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element contractnum\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element contractsponsor\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element contrib\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element copyright\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      space-before: (* (HSIZE 2) %head-before-factor%)\n      (literal (gentext-element-name (current-node)))\n      (literal "\\no-break-space;")\n      (literal (dingbat "copyright"))\n      (literal "\\no-break-space;")\n      (process-children)))\n\n  (element (copyright year)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling? (current-node)))\n\011  (literal ", ")\n\011  (literal " "))))\n\n  (element (copyright holder) ($charseq$))\n\n  (element corpauthor\n    (make sequence\n      (make paragraph\n        use: reference-titlepage-recto-style\n\011font-size: (HSIZE 3)\n\011line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011space-before: (* (HSIZE 2) %head-before-factor%)\n\011quadding: %division-title-quadding%\n\011keep-with-next?: #t\n\011(process-children))\n      ;; This paragraph is a hack to get the spacing right.\n      ;; Authors always have an affiliation paragraph below them, even if\n      ;; it's empty, so corpauthors need one too.\n      (make paragraph\n        use: reference-titlepage-recto-style\n\011font-size: (HSIZE 1)\n\011line-spacing: (* (HSIZE 1) %line-spacing-factor%)\n\011space-after: (* (HSIZE 2) %head-after-factor% 4)\n\011quadding: %division-title-quadding%\n\011keep-with-next?: #t\n\011(literal "\\no-break-space;"))))\n\n  (element corpname\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element date\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element edition\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)\n      (literal "\\no-break-space;")\n      (literal (gentext-element-name-space (gi (current-node))))))\n\n  (element editor\n    (let ((editor-name (author-string)))\n      (make sequence      \n\011(if (first-sibling?) \n\011    (make paragraph\n              use: reference-titlepage-recto-style\n\011      font-size: (HSIZE 1)\n\011      line-spacing: (* (HSIZE 1) %line-spacing-factor%)\n\011      space-before: (* (HSIZE 2) %head-before-factor% 6)\n\011      quadding: %division-title-quadding%\n\011      keep-with-next?: #t\n\011      (literal (gentext-edited-by)))\n\011    (empty-sosofo))\n\011(make paragraph\n          use: reference-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-after: (* (HSIZE 2) %head-after-factor% 4)\n\011  quadding: %division-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal editor-name)))))\n\n  (element firstname\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element graphic\n    (let* ((nd (current-node))\n\011   (fileref (attribute-string "fileref" nd))\n\011   (entityref (attribute-string "entityref" nd))\n\011   (format (attribute-string "format" nd))\n\011   (align (attribute-string "align" nd)))\n      (if (or fileref entityref) \n\011  (make external-graphic\n\011    notation-system-id: (if format format "")\n\011    entity-system-id: (if fileref \n\011\011\011\011  (graphic-file fileref)\n\011\011\011\011  (if entityref \n\011\011\011\011      (entity-generated-system-id entityref)\n\011\011\011\011      ""))\n\011    display?: #t\n\011    display-alignment: 'center)\n\011  (empty-sosofo))))\n\n  (element honorific\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element isbn\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element issn\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element itermset (empty-sosofo))\n\n  (element invpartnumber\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element issuenum\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element jobtitle\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element keywordset\n    (make paragraph\n      quadding: 'start\n      (make sequence\n\011font-weight: 'bold\n\011(literal "Keywords: "))\n      (process-children)))\n\n  (element (keyword)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling?))\n\011  (literal ", ")\n\011  (literal ""))))\n\n  (element legalnotice\n    (make display-group\n      use: reference-titlepage-recto-style\n      ($semiformal-object$)))\n\n  (element (legalnotice title) (empty-sosofo))\n\n  (element (legalnotice para)\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: 'start\n      line-spacing: (* 0.8 (inherited-line-spacing))\n      font-size: (* 0.8 (inherited-font-size))\n      (process-children)))\n\n  (element lineage\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element modespec (empty-sosofo))\n\n  (element orgdiv\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element orgname\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element othercredit\n    (let ((author-name  (author-string))\n\011  (author-affil (select-elements (children (current-node)) \n\011\011\011\011\011 (normalize "affiliation"))))\n      (make sequence      \n\011(make paragraph\n\011  use: reference-titlepage-recto-style\n\011  font-size: (HSIZE 3)\n\011  line-spacing: (* (HSIZE 3) %line-spacing-factor%)\n\011  space-before: (* (HSIZE 2) %head-before-factor%)\n\011  quadding: %division-title-quadding%\n\011  keep-with-next?: #t\n\011  (literal author-name))\n\011(process-node-list author-affil))))\n\n  (element othername\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element pagenums\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element printhistory\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element productname\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element productnumber\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element pubdate\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element publisher\n    (make display-group\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element publishername\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element pubsnumber\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element releaseinfo\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element revhistory\n    (make sequence\n      (make paragraph\n\011use: reference-titlepage-recto-style\n\011space-before: (* (HSIZE 3) %head-before-factor%)\n\011space-after: (/ (* (HSIZE 1) %head-before-factor%) 2)\n\011(literal (gentext-element-name (current-node))))\n      (make table\n\011before-row-border: #f\n\011(process-children))))\n  \n  (element (revhistory revision)\n    (let ((revnumber (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "revnumber")))\n\011  (revdate   (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "date")))\n\011  (revauthor (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "authorinitials")))\n\011  (revremark (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revremark")))\n\011  (revdescription (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revdescription"))))\n      (make sequence\n\011(make table-row\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (if (not (node-list-empty? revnumber))\n\011\011(make paragraph\n\011\011  use: reference-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-element-name-space (current-node)))\n\011\011  (process-node-list revnumber))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 2\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revdate))\n\011\011(make paragraph\n\011\011  use: reference-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (process-node-list revdate))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 3\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revauthor))\n\011\011(make paragraph\n\011\011  use: reference-titlepage-recto-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-revised-by))\n\011\011  (process-node-list revauthor))\n\011\011(empty-sosofo))))\n\011(make table-row\n\011  cell-after-row-border: #f\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 3\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (cond ((not (node-list-empty? revremark))\n\011\011   (make paragraph\n\011\011     use: reference-titlepage-recto-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     space-after: (if (last-sibling?) \n\011\011\011\011      0pt\n\011\011\011\011      (/ %block-sep% 2))\n\011\011     (process-node-list revremark)))\n\011\011  ((not (node-list-empty? revdescription))\n\011\011   (make sequence\n\011\011     use: reference-titlepage-recto-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     (process-node-list revdescription)))\n\011\011(else (empty-sosofo)))))))) \n  \n  (element (revision revnumber) (process-children-trim))\n  (element (revision date) (process-children-trim))\n  (element (revision authorinitials) (process-children-trim))\n  (element (revision revremark) (process-children-trim))\n  (element (revision revdescription) (process-children))\n\n  (element seriesvolnums\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element shortaffil\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element subjectset (empty-sosofo))\n\n  (element subtitle \n    (make paragraph\n      use: reference-titlepage-recto-style\n      font-size: (HSIZE 4)\n      line-spacing: (* (HSIZE 4) %line-spacing-factor%)\n      space-before: (* (HSIZE 4) %head-before-factor%)\n      quadding: %division-subtitle-quadding%\n      keep-with-next?: #t\n      (process-children-trim)))\n\n  (element surname\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n\n  (element title\n    (let ((ref (ancestor-member (current-node)\n\011\011\011\011(list (normalize "reference")))))\n      (make paragraph\n        use: reference-titlepage-recto-style\n\011font-size: (HSIZE 5)\n\011line-spacing: (* (HSIZE 5) %line-spacing-factor%)\n\011space-before: (* (HSIZE 5) %head-before-factor%)\n\011quadding: %division-title-quadding%\n\011keep-with-next?: #t\n\011heading-level: (if %generate-heading-level% 1 0)\n\011(literal (element-label ref)\n\011\011 (gentext-label-title-sep (gi ref)))\n\011(with-mode title-mode\n\011  (process-children)))))\n\n  (element formalpara ($para-container$))\n  (element (formalpara title) ($runinhead$))\n  (element (formalpara para) (make sequence (process-children)))\n\n  (element titleabbrev (empty-sosofo))\n\n  (element volumenum\n    (make paragraph\n      use: reference-titlepage-recto-style\n      quadding: %division-title-quadding%\n      (process-children)))\n)\n\n(mode reference-titlepage-verso-mode\n  (element abbrev\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element abstract ($semiformal-object$))\n\n  (element (abstract title) (empty-sosofo))\n\n  (element address \n    (make display-group\n      use: reference-titlepage-verso-style\n      (with-mode titlepage-address-mode \n\011($linespecific-display$ %indent-address-lines% %number-address-lines%))))\n\n  (element affiliation\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element artpagenums\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element author\n    ;; Print the author name.  Handle the case where there's no AUTHORGROUP\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (not in-group)\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-list-string))))\n\011  (make sequence \n\011    (literal (author-list-string))))))  \n\n  (element authorblurb\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element authorgroup\n    (make paragraph\n      space-after: (* %bf-size% %line-spacing-factor%)\n      (make sequence\n\011(literal (gentext-by))\n\011(literal "\\no-break-space;")\n\011(process-children-trim))))\n\n  (element authorinitials\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element bibliomisc (process-children))\n\n  (element bibliomset (process-children))\n\n  (element collab\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element confgroup\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element contractnum\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element contractsponsor\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element contrib\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element copyright\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (literal (gentext-element-name (current-node)))\n      (literal "\\no-break-space;")\n      (literal (dingbat "copyright"))\n      (literal "\\no-break-space;")\n      (process-children)))\n\n  (element (copyright year)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling? (current-node)))\n\011  (literal ", ")\n\011  (literal " "))))\n\n  (element (copyright holder) ($charseq$))\n\n  (element corpauthor\n    ;; note: reference-titlepage-corpauthor takes care of wrapping multiple\n    ;; corpauthors\n    (make sequence\n      (if (first-sibling?)\n\011  (if (equal? (gi (parent (current-node))) (normalize "authorgroup"))\n\011      (empty-sosofo)\n\011      (literal (gentext-by) " "))\n\011  (literal ", "))\n      (process-children)))\n\n  (element corpname\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element date\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element edition\n    (make paragraph\n      (process-children)\n      (literal "\\no-break-space;")\n      (literal (gentext-element-name-space (gi (current-node))))))\n\n  (element editor\n    ;; Print the editor name.\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (or #t (not in-group)) ; nevermind, always put out the Edited by\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-edited-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-string))))\n\011  (make sequence \n\011    (literal (author-string))))))\n\n  (element firstname\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element graphic\n    (let* ((nd (current-node))\n\011   (fileref (attribute-string "fileref" nd))\n\011   (entityref (attribute-string "entityref" nd))\n\011   (format (attribute-string "format" nd))\n\011   (align (attribute-string "align" nd)))\n      (if (or fileref entityref) \n\011  (make external-graphic\n\011    notation-system-id: (if format format "")\n\011    entity-system-id: (if fileref \n\011\011\011\011  (graphic-file fileref)\n\011\011\011\011  (if entityref \n\011\011\011\011      (entity-generated-system-id entityref)\n\011\011\011\011      ""))\n\011    display?: #t\n\011    display-alignment: 'start)\n\011  (empty-sosofo))))\n\n  (element honorific\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element isbn\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element issn\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element itermset (empty-sosofo))\n\n  (element invpartnumber\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element issuenum\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element jobtitle\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element keywordset\n    (make paragraph\n      quadding: 'start\n      (make sequence\n\011font-weight: 'bold\n\011(literal "Keywords: "))\n      (process-children)))\n\n  (element (keyword)\n    (make sequence\n      (process-children)\n      (if (not (last-sibling?))\n\011  (literal ", ")\n\011  (literal ""))))\n\n  (element legalnotice\n    (make display-group\n      use: reference-titlepage-verso-style\n      ($semiformal-object$)))\n\n  (element (legalnotice title) (empty-sosofo))\n\n  (element (legalnotice para) \n    (make paragraph\n      use: reference-titlepage-verso-style\n      font-size: (* (inherited-font-size) 0.8)\n      (process-children-trim)))\n\n  (element lineage\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element modespec (empty-sosofo))\n\n  (element orgdiv\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element orgname\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element othercredit\n    ;; Print the author name.  Handle the case where there's no AUTHORGROUP\n    (let ((in-group (have-ancestor? (normalize "authorgroup") (current-node))))\n      (if (not in-group)\n\011  (make paragraph\n\011    ;; Hack to get the spacing right below the author name line...\n\011    space-after: (* %bf-size% %line-spacing-factor%)\n\011    (make sequence\n\011      (literal (gentext-by))\n\011      (literal "\\no-break-space;")\n\011      (literal (author-list-string))))\n\011  (make sequence \n\011    (literal (author-list-string))))))  \n\n  (element othername\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element pagenums\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element printhistory\n    (make display-group\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element productname\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element productnumber\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element pubdate\n    (make paragraph\n      (literal (gentext-element-name-space (gi (current-node))))\n      (process-children)))\n\n  (element publisher\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element publishername\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element pubsnumber\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element releaseinfo\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element revhistory\n    (make sequence\n      (make paragraph\n\011use: reference-titlepage-verso-style\n\011space-before: (* (HSIZE 3) %head-before-factor%)\n\011space-after: (/ (* (HSIZE 1) %head-before-factor%) 2)\n\011(literal (gentext-element-name (current-node))))\n      (make table\n\011before-row-border: #f\n\011(process-children))))\n  \n  (element (revhistory revision)\n    (let ((revnumber (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "revnumber")))\n\011  (revdate   (select-elements (descendants (current-node)) \n\011\011\011\011      (normalize "date")))\n\011  (revauthor (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "authorinitials")))\n\011  (revremark (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revremark")))\n\011  (revdescription (select-elements (descendants (current-node))\n\011\011\011\011      (normalize "revdescription"))))\n      (make sequence\n\011(make table-row\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (if (not (node-list-empty? revnumber))\n\011\011(make paragraph\n\011\011  use: reference-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-element-name-space (current-node)))\n\011\011  (process-node-list revnumber))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 2\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revdate))\n\011\011(make paragraph\n\011\011  use: reference-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (process-node-list revdate))\n\011\011(empty-sosofo)))\n\011  (make table-cell\n\011    column-number: 3\n\011    n-columns-spanned: 1\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    cell-before-column-margin: (if (equal? (print-backend) 'tex)\n\011\011\011\011\011   6pt\n\011\011\011\011\011   0pt)\n\011    (if (not (node-list-empty? revauthor))\n\011\011(make paragraph\n\011\011  use: reference-titlepage-verso-style\n\011\011  font-size: %bf-size%\n\011\011  font-weight: 'medium\n\011\011  (literal (gentext-revised-by))\n\011\011  (process-node-list revauthor))\n\011\011(empty-sosofo))))\n\011(make table-row\n\011  cell-after-row-border: #f\n\011  (make table-cell\n\011    column-number: 1\n\011    n-columns-spanned: 3\n\011    n-rows-spanned: 1\n\011    start-indent: 0pt\n\011    (cond ((not (node-list-empty? revremark))\n\011\011   (make paragraph\n\011\011     use: reference-titlepage-verso-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     space-after: (if (last-sibling?) \n\011\011\011\011      0pt\n\011\011\011\011      (/ %block-sep% 2))\n\011\011     (process-node-list revremark)))\n\011\011  ((not (node-list-empty? revdescription))\n\011\011   (make sequence\n\011\011     use: reference-titlepage-verso-style\n\011\011     font-size: %bf-size%\n\011\011     font-weight: 'medium\n\011\011     (process-node-list revdescription)))\n\011\011(else (empty-sosofo)))))))) \n  \n  (element (revision revnumber) (process-children-trim))\n  (element (revision date) (process-children-trim))\n  (element (revision authorinitials) (process-children-trim))\n  (element (revision revremark) (process-children-trim))\n  (element (revision revdescription) (process-children))\n\n  (element seriesvolnums\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element shortaffil\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element subjectset (empty-sosofo))\n\n  (element subtitle\n    (make sequence\n      font-family-name: %title-font-family%\n      font-weight: 'bold\n      (literal (if (first-sibling?) ": " "; "))\n      (process-children)))\n\n  (element surname\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n  (element title\n    (let ((ref (ancestor-member (current-node)\n\011\011\011\011(list (normalize "reference")))))\n      (make sequence\n        font-family-name: %title-font-family%\n        font-weight: 'bold\n\011(literal (element-label ref)\n\011\011 (gentext-label-title-sep (gi ref)))\n\011(with-mode title-mode\n\011  (process-children)))))\n\n  (element formalpara ($para-container$))\n  (element (formalpara title) ($runinhead$))\n  (element (formalpara para) (make sequence (process-children)))\n\n  (element titleabbrev (empty-sosofo))\n\n  (element volumenum\n    (make paragraph\n      use: reference-titlepage-verso-style\n      (process-children)))\n\n)\n   \n;; $Id: dbverb.dsl,v 1.6 2004/10/09 19:46:33 petere78 Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://docbook.sourceforge.net/projects/dsssl/\n;;\n\n(define verbatim-style\n  (style\n      font-family-name: %mono-font-family%\n      font-size:        (* (inherited-font-size) \n\011\011\011   (if %verbatim-size-factor%\n\011\011\011       %verbatim-size-factor%\n\011\011\011       1.0))\n      font-weight:      'medium\n      font-posture:     'upright\n      line-spacing:     (* (* (inherited-font-size) \n\011\011\011      (if %verbatim-size-factor%\n\011\011\011\011  %verbatim-size-factor%\n\011\011\011\011  1.0))\n\011\011\011   %line-spacing-factor%)\n      first-line-start-indent: 0pt\n      lines: 'asis\n      input-whitespace-treatment: 'preserve))\n\n(define inline-verbatim-style\n  (style\n      font-family-name: %mono-font-family%\n      font-size:        (* (inherited-font-size) \n\011\011\011   (if %verbatim-size-factor%\n\011\011\011       %verbatim-size-factor%\n\011\011\011       1.0))\n      font-weight:      'medium\n      font-posture:     'upright\n      lines: 'asis\n      input-whitespace-treatment: 'preserve))\n\n(define linespecific-style\n  (style\n      first-line-start-indent: 0pt\n      lines: 'asis\n      input-whitespace-treatment: 'preserve))\n\n(define ($format-indent$ indent)\n  (literal indent))\n\n(define ($format-linenumber$ linenumber)\n  ;; A line-field would make more sense here, and allow proportional\n  ;; fonts, but you can't put line-fields in the middle of a paragraph\n  ;; in the current RTF backend of Jade\n  (let ((%factor% (if %verbatim-size-factor%\n\011\011      %verbatim-size-factor%\n\011\011      1.0)))\n    (if (equal? (remainder linenumber %linenumber-mod%) 0)\n\011(make sequence\n\011  use: verbatim-style\n\011  (literal (pad-string (format-number linenumber "1") \n\011\011\011       %linenumber-length% %linenumber-padchar%))\n\011  ($linenumber-space$))\n\011(make sequence\n\011  use: verbatim-style\n\011  (literal (pad-string "" %linenumber-length% " "))\n\011  ($linenumber-space$)))))\n\n(define ($line-start$ indent line-numbers? #!optional (line-number 1))\n  (make sequence\n    (if indent\n\011($format-indent$ indent)\n\011(empty-sosofo))\n    (if line-numbers?\n\011($format-linenumber$ line-number)\n\011(empty-sosofo))))\n\n(define ($linespecific-display$ indent line-numbers?)\n  (let ((vspace (if (INBLOCK?)\n\011\011   0pt\n\011\011   (if (INLIST?) \n\011\011       %para-sep% \n\011\011       %block-sep%))))\n    (make paragraph\n      use: linespecific-style\n      space-before: (if (and (string=? (gi (parent)) (normalize "entry"))\n \011\011\011     (absolute-first-sibling?))\n\011\011\0110pt\n\011\011\011vspace)\n      space-after:  (if (and (string=? (gi (parent)) (normalize "entry"))\n \011\011\011     (absolute-last-sibling?))\n\011\011\0110pt\n\011\011\011vspace)\n      start-indent: (if (INBLOCK?)\n\011\011\011(inherited-start-indent)\n\011\011\011(+ %block-start-indent% (inherited-start-indent)))\n      (if (or indent line-numbers?)\n\011  ($linespecific-line-by-line$ indent line-numbers?)\n\011  (process-children)))))\n\n(define ($linespecific-line-by-line$ indent line-numbers?)\n  (let ((expanded-content\n\011 ;; this is the content with\n\011 ;; inlinemediaobject/imageobject[@format='linespecific']\n\011 ;; expanded\n\011 (let loop ((kl (children (current-node))) (rl (empty-node-list)))\n\011   (if (node-list-empty? kl)\n\011       rl\n\011       (if (equal? (gi (node-list-first kl))\n\011\011\011   (normalize "inlinemediaobject"))\n\011\011   (let* ((imgobj (node-list-filter-by-gi\n\011\011\011\011   (children (node-list-first kl))\n\011\011\011\011   (list (normalize "imageobject"))))\n\011\011\011  (datobj (node-list-filter-by-gi\n\011\011\011\011   (children imgobj)\n\011\011\011\011   (list (normalize "imagedata")))))\n\011\011     (if (and (not (node-list-empty? imgobj))\n\011\011\011      (not (node-list-empty? datobj))\n\011\011\011      (equal? (attribute-string (normalize "format") datobj)\n\011\011\011\011      (normalize "linespecific")))\n\011\011\011 (loop (node-list-rest kl)\n\011\011\011       (node-list rl (string->nodes (include-characters\n\011\011\011\011\011\011\011     (if (attribute-string (normalize "fileref") datobj)\n\011\011\011\011\011\011\011\011 (attribute-string (normalize "fileref") datobj)\n\011\011\011\011\011\011\011\011 (entity-generated-system-id (attribute-string (normalize "entityref") datobj)))))))\n\011\011\011 (loop (node-list-rest kl)\n\011\011\011       (node-list rl (node-list-first kl)))))\n\011\011   (loop (node-list-rest kl) (node-list rl (node-list-first kl))))))))\n  (make sequence\n    ($line-start$ indent line-numbers? 1)\n    (let loop ((kl expanded-content)\n\011       (linecount 1)\n\011       (res (empty-sosofo)))\n      (if (node-list-empty? kl)\n\011  res\n\011  (loop\n\011   (node-list-rest kl)\n\011   (if (char=? (node-property 'char (node-list-first kl)\n\011\011\011\011      default: #\\U-0000) #\\U-000D)\n\011       (+ linecount 1)\n\011       linecount)\n\011   (let ((c (node-list-first kl)))\n\011     (if (char=? (node-property 'char c default: #\\U-0000) \n\011\011\011 #\\U-000D)\n\011\011 (sosofo-append res\n\011\011\011\011(process-node-list c)\n\011\011\011\011($line-start$ indent line-numbers?\n\011\011\011\011\011      (+ linecount 1)))\n\011\011 (sosofo-append res (process-node-list c))))))))))\n\n(define ($verbatim-display$ indent line-numbers?)\n  (let* ((width-in-chars (if (attribute-string (normalize "width"))\n\011\011\011     (string->number (attribute-string (normalize "width")))\n\011\011\011     %verbatim-default-width%))\n\011 (fsize (lambda () (if (or (attribute-string (normalize "width"))\n\011\011\011\011   (not %programlisting-size-factor%))\n\011\011\011       (/ (/ (- %text-width% (inherited-start-indent))\n\011\011\011\011     width-in-chars)\n\011\011\011\011  0.7)\n\011\011\011       (* (inherited-font-size)\n\011\011\011\011  %programlisting-size-factor%))))\n\011 (vspace-before (if (INBLOCK?)\n\011\011\011    0pt\n\011\011\011    (if (INLIST?)\n\011\011\011\011%para-sep%\n\011\011\011\011%block-sep%)))\n\011 (vspace-after (if (INBLOCK?)\n\011\011\011   0pt\n\011\011\011   (if (INLIST?)\n\011\011\011       0pt\n\011\011\011       %block-sep%))))\n    (make paragraph\n      use: verbatim-style\n      space-before: (if (and (string=? (gi (parent)) (normalize "entry"))\n \011\011\011     (absolute-first-sibling?))\n\011\011\0110pt\n\011\011\011vspace-before)\n      space-after:  (if (and (string=? (gi (parent)) (normalize "entry"))\n \011\011\011     (absolute-last-sibling?))\n\011\011\0110pt\n\011\011\011vspace-after)\n      font-size: (fsize)\n      line-spacing: (* (fsize) %line-spacing-factor%)\n      start-indent: (if (INBLOCK?)\n\011\011\011(inherited-start-indent)\n\011\011\011(+ %block-start-indent% (inherited-start-indent)))\n      (if (or indent line-numbers?)\n\011  ($linespecific-line-by-line$ indent line-numbers?)\n\011  (process-children)))))\n\n(element literallayout\n  (if (equal? (attribute-string "class") (normalize "monospaced"))\n      ($verbatim-display$\n       %indent-literallayout-lines%\n       (or %number-literallayout-lines%\n\011   (equal? (attribute-string (normalize "linenumbering"))\n\011\011   (normalize "numbered"))))\n      ($linespecific-display$\n       %indent-literallayout-lines%\n       (or %number-literallayout-lines%\n\011   (equal? (attribute-string (normalize "linenumbering"))\n\011\011   (normalize "numbered"))))))\n\n(element address\n  ($linespecific-display$\n   %indent-address-lines%\n   (or %number-address-lines%\n       (equal? (attribute-string (normalize "linenumbering"))\n\011       (normalize "numbered")))))\n\n(element programlisting\n  ($verbatim-display$\n   %indent-programlisting-lines%\n   (or %number-programlisting-lines%\n       (equal? (attribute-string (normalize "linenumbering"))\n\011       (normalize "numbered")))))\n\n(element screen\n  ($verbatim-display$\n   %indent-screen-lines%\n   (or %number-screen-lines%\n       (equal? (attribute-string (normalize "linenumbering"))\n\011       (normalize "numbered")))))\n\n(element screenshot (process-children))\n(element screeninfo (empty-sosofo))\n\n    \n;; $Id: version.dsl,v 1.2 2004/07/11 06:21:00 nyraghu Exp $\n;;\n;; This file is part of the Modular DocBook Stylesheet distribution.\n;; See ../README or http://www.nwalsh.com/docbook/dsssl/\n;;\n\n;; If **ANY** change is made to this file, you _MUST_ alter the\n;; following definition:\n\n(define (stylesheet-version)\n  (string-append\n   "Modular DocBook Print Stylesheet Version "\n   ;; Trim off bounding white space.\n   (strip "1.79\n")))\n\n
)STYLE-SPECIFICATION-BODY
)STYLE-SPECIFICATION
AID TOKEN DBPARAM
pISO/IEC 10179:1996//NOTATION DSSSL Architecture Definition Document//EN
NDSSSL
sdbparam.dsl
f<OSFILE>dsssl-stylesheets/print/dbparam.dsl
Edbparam.dsl CDATA DSSSL
Ddbparam.dsl ARCQUANT CDATA NAMELEN 64
Ddbparam.dsl ARCDTD CDATA %DSSSLDTD
Ddbparam.dsl ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbparam.dsl ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbparam.dsl
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN DBLIB
p-//Norman Walsh//DOCUMENT DSSSL Library V2//EN
f<OSFILE>dsssl-stylesheets/print/../lib/dblib.dsl
Edblib.dsl CDATA DSSSL
Ddblib.dsl ARCQUANT CDATA NAMELEN 64
Ddblib.dsl ARCDTD CDATA %DSSSLDTD
Ddblib.dsl ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddblib.dsl ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dblib.dsl
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN AF
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//AF
s../common/dbl1af.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1af.dsl
Edbl1af CDATA DSSSL
Ddbl1af ARCQUANT CDATA NAMELEN 64
Ddbl1af ARCDTD CDATA %DSSSLDTD
Ddbl1af ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1af ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1af
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN BG
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//BG
s../common/dbl1bg.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1bg.dsl
Edbl1bg CDATA DSSSL
Ddbl1bg ARCQUANT CDATA NAMELEN 64
Ddbl1bg ARCDTD CDATA %DSSSLDTD
Ddbl1bg ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1bg ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1bg
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN BS
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//BS
s../common/dbl1bs.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1bs.dsl
Edbl1bs CDATA DSSSL
Ddbl1bs ARCQUANT CDATA NAMELEN 64
Ddbl1bs ARCDTD CDATA %DSSSLDTD
Ddbl1bs ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1bs ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1bs
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN CA
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//CA
s../common/dbl1ca.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1ca.dsl
Edbl1ca CDATA DSSSL
Ddbl1ca ARCQUANT CDATA NAMELEN 64
Ddbl1ca ARCDTD CDATA %DSSSLDTD
Ddbl1ca ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1ca ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1ca
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN CS
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//CS
s../common/dbl1cs.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1cs.dsl
Edbl1cs CDATA DSSSL
Ddbl1cs ARCQUANT CDATA NAMELEN 64
Ddbl1cs ARCDTD CDATA %DSSSLDTD
Ddbl1cs ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1cs ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1cs
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN DA
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//DA
s../common/dbl1da.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1da.dsl
Edbl1da CDATA DSSSL
Ddbl1da ARCQUANT CDATA NAMELEN 64
Ddbl1da ARCDTD CDATA %DSSSLDTD
Ddbl1da ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1da ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1da
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN DE
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//DE
s../common/dbl1de.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1de.dsl
Edbl1de CDATA DSSSL
Ddbl1de ARCQUANT CDATA NAMELEN 64
Ddbl1de ARCDTD CDATA %DSSSLDTD
Ddbl1de ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1de ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1de
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN EL
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//EL
s../common/dbl1el.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1el.dsl
Edbl1el CDATA DSSSL
Ddbl1el ARCQUANT CDATA NAMELEN 64
Ddbl1el ARCDTD CDATA %DSSSLDTD
Ddbl1el ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1el ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1el
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN EN
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//EN
s../common/dbl1en.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1en.dsl
Edbl1en CDATA DSSSL
Ddbl1en ARCQUANT CDATA NAMELEN 64
Ddbl1en ARCDTD CDATA %DSSSLDTD
Ddbl1en ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1en ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1en
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN ES
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//ES
s../common/dbl1es.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1es.dsl
Edbl1es CDATA DSSSL
Ddbl1es ARCQUANT CDATA NAMELEN 64
Ddbl1es ARCDTD CDATA %DSSSLDTD
Ddbl1es ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1es ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1es
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN ET
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//ET
s../common/dbl1et.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1et.dsl
Edbl1et CDATA DSSSL
Ddbl1et ARCQUANT CDATA NAMELEN 64
Ddbl1et ARCDTD CDATA %DSSSLDTD
Ddbl1et ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1et ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1et
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN EU
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//EU
s../common/dbl1eu.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1eu.dsl
Edbl1eu CDATA DSSSL
Ddbl1eu ARCQUANT CDATA NAMELEN 64
Ddbl1eu ARCDTD CDATA %DSSSLDTD
Ddbl1eu ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1eu ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1eu
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN FI
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//FI
s../common/dbl1fi.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1fi.dsl
Edbl1fi CDATA DSSSL
Ddbl1fi ARCQUANT CDATA NAMELEN 64
Ddbl1fi ARCDTD CDATA %DSSSLDTD
Ddbl1fi ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1fi ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1fi
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN FR
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//FR
s../common/dbl1fr.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1fr.dsl
Edbl1fr CDATA DSSSL
Ddbl1fr ARCQUANT CDATA NAMELEN 64
Ddbl1fr ARCDTD CDATA %DSSSLDTD
Ddbl1fr ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1fr ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1fr
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN HU
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//HU
s../common/dbl1hu.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1hu.dsl
Edbl1hu CDATA DSSSL
Ddbl1hu ARCQUANT CDATA NAMELEN 64
Ddbl1hu ARCDTD CDATA %DSSSLDTD
Ddbl1hu ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1hu ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1hu
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN ID
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//ID
s../common/dbl1id.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1id.dsl
Edbl1id CDATA DSSSL
Ddbl1id ARCQUANT CDATA NAMELEN 64
Ddbl1id ARCDTD CDATA %DSSSLDTD
Ddbl1id ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1id ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1id
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN IT
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//IT
s../common/dbl1it.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1it.dsl
Edbl1it CDATA DSSSL
Ddbl1it ARCQUANT CDATA NAMELEN 64
Ddbl1it ARCDTD CDATA %DSSSLDTD
Ddbl1it ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1it ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1it
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN JA
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//JA
s../common/dbl1ja.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1ja.dsl
Edbl1ja CDATA DSSSL
Ddbl1ja ARCQUANT CDATA NAMELEN 64
Ddbl1ja ARCDTD CDATA %DSSSLDTD
Ddbl1ja ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1ja ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1ja
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN KO
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//KO
s../common/dbl1ko.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1ko.dsl
Edbl1ko CDATA DSSSL
Ddbl1ko ARCQUANT CDATA NAMELEN 64
Ddbl1ko ARCDTD CDATA %DSSSLDTD
Ddbl1ko ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1ko ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1ko
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN NL
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//NL
s../common/dbl1nl.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1nl.dsl
Edbl1nl CDATA DSSSL
Ddbl1nl ARCQUANT CDATA NAMELEN 64
Ddbl1nl ARCDTD CDATA %DSSSLDTD
Ddbl1nl ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1nl ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1nl
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN NN
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//NN
s../common/dbl1nn.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1nn.dsl
Edbl1nn CDATA DSSSL
Ddbl1nn ARCQUANT CDATA NAMELEN 64
Ddbl1nn ARCDTD CDATA %DSSSLDTD
Ddbl1nn ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1nn ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1nn
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN NO
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//NO
s../common/dbl1no.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1no.dsl
Edbl1no CDATA DSSSL
Ddbl1no ARCQUANT CDATA NAMELEN 64
Ddbl1no ARCDTD CDATA %DSSSLDTD
Ddbl1no ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1no ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1no
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN PL
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//PL
s../common/dbl1pl.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1pl.dsl
Edbl1pl CDATA DSSSL
Ddbl1pl ARCQUANT CDATA NAMELEN 64
Ddbl1pl ARCDTD CDATA %DSSSLDTD
Ddbl1pl ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1pl ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1pl
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN PT
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//PT
s../common/dbl1pt.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1pt.dsl
Edbl1pt CDATA DSSSL
Ddbl1pt ARCQUANT CDATA NAMELEN 64
Ddbl1pt ARCDTD CDATA %DSSSLDTD
Ddbl1pt ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1pt ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1pt
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN PTBR
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//PTBR
s../common/dbl1ptbr.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1ptbr.dsl
Edbl1ptbr CDATA DSSSL
Ddbl1ptbr ARCQUANT CDATA NAMELEN 64
Ddbl1ptbr ARCDTD CDATA %DSSSLDTD
Ddbl1ptbr ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1ptbr ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1ptbr
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN RO
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//RO
s../common/dbl1ro.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1ro.dsl
Edbl1ro CDATA DSSSL
Ddbl1ro ARCQUANT CDATA NAMELEN 64
Ddbl1ro ARCDTD CDATA %DSSSLDTD
Ddbl1ro ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1ro ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1ro
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN RU
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//RU
s../common/dbl1ru.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1ru.dsl
Edbl1ru CDATA DSSSL
Ddbl1ru ARCQUANT CDATA NAMELEN 64
Ddbl1ru ARCDTD CDATA %DSSSLDTD
Ddbl1ru ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1ru ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1ru
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN SK
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//SK
s../common/dbl1sk.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1sk.dsl
Edbl1sk CDATA DSSSL
Ddbl1sk ARCQUANT CDATA NAMELEN 64
Ddbl1sk ARCDTD CDATA %DSSSLDTD
Ddbl1sk ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1sk ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1sk
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN SL
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//SL
s../common/dbl1sl.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1sl.dsl
Edbl1sl CDATA DSSSL
Ddbl1sl ARCQUANT CDATA NAMELEN 64
Ddbl1sl ARCDTD CDATA %DSSSLDTD
Ddbl1sl ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1sl ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1sl
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN SR
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//SR
s../common/dbl1sr.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1sr.dsl
Edbl1sr CDATA DSSSL
Ddbl1sr ARCQUANT CDATA NAMELEN 64
Ddbl1sr ARCDTD CDATA %DSSSLDTD
Ddbl1sr ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1sr ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1sr
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN SV
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//SV
s../common/dbl1sv.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1sv.dsl
Edbl1sv CDATA DSSSL
Ddbl1sv ARCQUANT CDATA NAMELEN 64
Ddbl1sv ARCDTD CDATA %DSSSLDTD
Ddbl1sv ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1sv ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1sv
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN TR
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//TR
s../common/dbl1tr.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1tr.dsl
Edbl1tr CDATA DSSSL
Ddbl1tr ARCQUANT CDATA NAMELEN 64
Ddbl1tr ARCDTD CDATA %DSSSLDTD
Ddbl1tr ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1tr ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1tr
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN UK
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//UK
s../common/dbl1uk.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1uk.dsl
Edbl1uk CDATA DSSSL
Ddbl1uk ARCQUANT CDATA NAMELEN 64
Ddbl1uk ARCDTD CDATA %DSSSLDTD
Ddbl1uk ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1uk ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1uk
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN XH
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//XH
s../common/dbl1xh.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1xh.dsl
Edbl1xh CDATA DSSSL
Ddbl1xh ARCQUANT CDATA NAMELEN 64
Ddbl1xh ARCDTD CDATA %DSSSLDTD
Ddbl1xh ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1xh ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1xh
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN ZHCN
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//ZHCN
s../common/dbl1zhcn.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1zhcn.dsl
Edbl1zhcn CDATA DSSSL
Ddbl1zhcn ARCQUANT CDATA NAMELEN 64
Ddbl1zhcn ARCDTD CDATA %DSSSLDTD
Ddbl1zhcn ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1zhcn ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1zhcn
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
AID TOKEN ZHTW
p-//Norman Walsh//DOCUMENT DocBook Stylesheet Localization//ZHTW
s../common/dbl1zhtw.dsl
f<OSFILE>dsssl-stylesheets/print/../common/../common/dbl1zhtw.dsl
Edbl1zhtw CDATA DSSSL
Ddbl1zhtw ARCQUANT CDATA NAMELEN 64
Ddbl1zhtw ARCDTD CDATA %DSSSLDTD
Ddbl1zhtw ARCDOCF TOKEN DSSSL-SPECIFICATION
Ddbl1zhtw ARCDATAF TOKEN DSSSL-SPECIFICATION
ADOCUMENT ENTITY dbl1zhtw
ASPECID IMPLIED
(EXTERNAL-SPECIFICATION
)EXTERNAL-SPECIFICATION
)STYLE-SHEET
C
