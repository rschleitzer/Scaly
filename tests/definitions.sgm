<!DOCTYPE suite SYSTEM "../test.dtd">

<suite id = definitions-tests title = "Definition Tests">

<category id = definitions title = "Definitions">

    <prose>Definitions declare new types that can be used throughout a program.

    <tests id = structure-definitions title = "Structure Definitions">
        <prose>The define keyword creates a new structure type with named properties.
        <test id = define-point program = program><input>define Point(x: int, y: int)
Point(3, 4)<expect>{"_type":"Point","x":3,"y":4}
        <test id = define-field-access program = program><input>define Point(x: int, y: int)
Point(3, 4).x<expect>3
        <test id = define-with-let program = program><input>define Point(x: int, y: int)
let p Point(3, 4)
p.x + p.y<expect>7
        <test id = define-nested program = program><input>define Point(x: int, y: int)
define Rectangle(origin: Point, width: int, height: int)
Rectangle(Point(0, 0), 10, 5).width<expect>10

    <tests id = union-definitions title = "Union Definitions">
        <prose>Unions define types with multiple variants. Each variant can optionally carry a value.
        <test id = option-some program = program><input>define Option union(Some: int, None)
Some(5)<expect>{"_type":"Option","_variant":"Some","value":5}
        <test id = option-none program = program><input>define Option union(Some: int, None)
None<expect>{"_type":"Option","_variant":"None"}
        <test id = result-ok program = program><input>define Result union(Ok: int, Err: String)
Ok(42)<expect>{"_type":"Result","_variant":"Ok","value":42}
        <test id = result-err program = program><input>define Result union(Ok: int, Err: String)
Err("error")<expect>{"_type":"Result","_variant":"Err","value":"error"}
        <!-- TODO: Member access on union variants not yet implemented
        <test id = option-some-value program = program><input>define Option union(Some: int, None)
Some(5).value<expect>5
        -->

</category>

</suite>
