<!DOCTYPE suite SYSTEM "../test.dtd">

<suite id = choose-tests title = "Choose Expression Tests">

<category id = choose-expressions title = "Choose Expressions">

    <prose>Choose expressions pattern match on union types, allowing different code paths based on which variant is present.

    <tests id = choose-on-variants title = "Choose on Variant Construction">
        <prose>Choose can match directly on constructed variants.
        <test id = choose-match-some program = program><input>define Option union(Some: int, None)
choose Option.Some(7): when v: Some: v else 0<expect>7
        <test id = choose-match-none program = program><input>define Option union(Some: int, None)
choose Option.None: when v: Some: v else 0<expect>0

    <tests id = choose-binding title = "Choose with Binding">
        <prose>When a variant carries a value, the value can be bound to a name.
        <test id = choose-bind-value program = program><input>define Result union(Ok: int, Err: int)
choose Result.Ok(42): when x: Ok: x + 1 else 0<expect>43

    <tests id = choose-multiple-when title = "Multiple When Clauses">
        <prose>Choose can have multiple when clauses to match different variants.
        <test id = choose-multi-match-first program = program><input>define Result union(Ok: int, Err: int)
choose Result.Ok(10): when x: Ok: x when e: Err: e + 100<expect>10
        <test id = choose-multi-match-second program = program><input>define Result union(Ok: int, Err: int)
choose Result.Err(5): when x: Ok: x when e: Err: e + 100<expect>105

</category>

</suite>
